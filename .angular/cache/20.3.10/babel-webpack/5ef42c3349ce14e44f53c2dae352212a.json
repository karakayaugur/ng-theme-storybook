{"ast":null,"code":"import _asyncToGenerator from \"/Users/ugurcakil/Documents/projects/ugurk/ng-theme-storybook/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { isTestEnvironment, pauseAnimations, waitForAnimations } from \"./chunk-LYCSRYYR.js\";\nimport { require_main } from \"./chunk-Y3M7TW6K.js\";\nimport { SNIPPET_RENDERED, combineParameters } from \"./chunk-U2JWIJRX.js\";\nimport { isEqual } from \"./chunk-ZNRFDIVA.js\";\nimport { invariant } from \"./chunk-FUOHXXZT.js\";\nimport { require_ansi_to_html } from \"./chunk-F4Q6SGTB.js\";\nimport { mapValues, pickBy } from \"./chunk-KHNISLMN.js\";\nimport { isPlainObject } from \"./chunk-FSBVR7H5.js\";\nimport { require_memoizerific } from \"./chunk-NVV6MIOE.js\";\nimport { dedent } from \"./chunk-OPCDBBL3.js\";\nimport { __name, __toESM } from \"./chunk-MM7DTO55.js\";\n\n// src/preview-api/modules/addons/main.ts\nimport { global } from \"@storybook/global\";\n\n// src/preview-api/modules/addons/storybook-channel-mock.ts\nimport { Channel } from \"storybook/internal/channels\";\nfunction mockChannel() {\n  const transport = {\n    setHandler: /* @__PURE__ */__name(() => {}, \"setHandler\"),\n    send: /* @__PURE__ */__name(() => {}, \"send\")\n  };\n  return new Channel({\n    transport\n  });\n}\n__name(mockChannel, \"mockChannel\");\n\n// src/preview-api/modules/addons/main.ts\nvar _AddonStore = class _AddonStore {\n  constructor() {\n    this.getChannel = /* @__PURE__ */__name(() => {\n      if (!this.channel) {\n        const channel = mockChannel();\n        this.setChannel(channel);\n        return channel;\n      }\n      return this.channel;\n    }, \"getChannel\");\n    this.ready = /* @__PURE__ */__name(() => this.promise, \"ready\");\n    this.hasChannel = /* @__PURE__ */__name(() => !!this.channel, \"hasChannel\");\n    this.setChannel = /* @__PURE__ */__name(channel => {\n      this.channel = channel;\n      this.resolve();\n    }, \"setChannel\");\n    this.promise = new Promise(res => {\n      this.resolve = () => res(this.getChannel());\n    });\n  }\n};\n__name(_AddonStore, \"AddonStore\");\nvar AddonStore = _AddonStore;\nvar KEY = \"__STORYBOOK_ADDONS_PREVIEW\";\nfunction getAddonsStore() {\n  if (!global[KEY]) {\n    global[KEY] = new AddonStore();\n  }\n  return global[KEY];\n}\n__name(getAddonsStore, \"getAddonsStore\");\nvar addons = getAddonsStore();\n\n// src/preview-api/modules/addons/hooks.ts\nimport { logger } from \"storybook/internal/client-logger\";\nimport { FORCE_RE_RENDER, RESET_STORY_ARGS, STORY_RENDERED, UPDATE_GLOBALS, UPDATE_STORY_ARGS } from \"storybook/internal/core-events\";\nimport { global as global2 } from \"@storybook/global\";\nvar _HooksContext = class _HooksContext {\n  constructor() {\n    this.hookListsMap = void 0;\n    this.mountedDecorators = void 0;\n    this.prevMountedDecorators = void 0;\n    this.currentHooks = void 0;\n    this.nextHookIndex = void 0;\n    this.currentPhase = void 0;\n    this.currentEffects = void 0;\n    this.prevEffects = void 0;\n    this.currentDecoratorName = void 0;\n    this.hasUpdates = void 0;\n    this.currentContext = void 0;\n    this.renderListener = /* @__PURE__ */__name(storyId => {\n      if (storyId !== this.currentContext?.id) {\n        return;\n      }\n      this.triggerEffects();\n      this.currentContext = null;\n      this.removeRenderListeners();\n    }, \"renderListener\");\n    this.init();\n  }\n  init() {\n    this.hookListsMap = /* @__PURE__ */new WeakMap();\n    this.mountedDecorators = /* @__PURE__ */new Set();\n    this.prevMountedDecorators = /* @__PURE__ */new Set();\n    this.currentHooks = [];\n    this.nextHookIndex = 0;\n    this.currentPhase = \"NONE\";\n    this.currentEffects = [];\n    this.prevEffects = [];\n    this.currentDecoratorName = null;\n    this.hasUpdates = false;\n    this.currentContext = null;\n  }\n  clean() {\n    this.prevEffects.forEach(effect => {\n      if (effect.destroy) {\n        effect.destroy();\n      }\n    });\n    this.init();\n    this.removeRenderListeners();\n  }\n  getNextHook() {\n    const hook = this.currentHooks[this.nextHookIndex];\n    this.nextHookIndex += 1;\n    return hook;\n  }\n  triggerEffects() {\n    this.prevEffects.forEach(effect => {\n      if (!this.currentEffects.includes(effect) && effect.destroy) {\n        effect.destroy();\n      }\n    });\n    this.currentEffects.forEach(effect => {\n      if (!this.prevEffects.includes(effect)) {\n        effect.destroy = effect.create();\n      }\n    });\n    this.prevEffects = this.currentEffects;\n    this.currentEffects = [];\n  }\n  addRenderListeners() {\n    this.removeRenderListeners();\n    const channel = addons.getChannel();\n    channel.on(STORY_RENDERED, this.renderListener);\n  }\n  removeRenderListeners() {\n    const channel = addons.getChannel();\n    channel.removeListener(STORY_RENDERED, this.renderListener);\n  }\n};\n__name(_HooksContext, \"HooksContext\");\nvar HooksContext = _HooksContext;\nfunction hookify(fn) {\n  const hookified = /* @__PURE__ */__name((...args) => {\n    const {\n      hooks\n    } = typeof args[0] === \"function\" ? args[1] : args[0];\n    const prevPhase = hooks.currentPhase;\n    const prevHooks = hooks.currentHooks;\n    const prevNextHookIndex = hooks.nextHookIndex;\n    const prevDecoratorName = hooks.currentDecoratorName;\n    hooks.currentDecoratorName = fn.name;\n    if (hooks.prevMountedDecorators.has(fn)) {\n      hooks.currentPhase = \"UPDATE\";\n      hooks.currentHooks = hooks.hookListsMap.get(fn) || [];\n    } else {\n      hooks.currentPhase = \"MOUNT\";\n      hooks.currentHooks = [];\n      hooks.hookListsMap.set(fn, hooks.currentHooks);\n      hooks.prevMountedDecorators.add(fn);\n    }\n    hooks.nextHookIndex = 0;\n    const prevContext = global2.STORYBOOK_HOOKS_CONTEXT;\n    global2.STORYBOOK_HOOKS_CONTEXT = hooks;\n    const result = fn(...args);\n    global2.STORYBOOK_HOOKS_CONTEXT = prevContext;\n    if (hooks.currentPhase === \"UPDATE\" && hooks.getNextHook() != null) {\n      throw new Error(\"Rendered fewer hooks than expected. This may be caused by an accidental early return statement.\");\n    }\n    hooks.currentPhase = prevPhase;\n    hooks.currentHooks = prevHooks;\n    hooks.nextHookIndex = prevNextHookIndex;\n    hooks.currentDecoratorName = prevDecoratorName;\n    return result;\n  }, \"hookified\");\n  hookified.originalFn = fn;\n  return hookified;\n}\n__name(hookify, \"hookify\");\nvar numberOfRenders = 0;\nvar RENDER_LIMIT = 25;\nvar applyHooks = /* @__PURE__ */__name(applyDecorators => (storyFn, decorators) => {\n  const decorated = applyDecorators(hookify(storyFn), decorators.map(decorator => hookify(decorator)));\n  return context => {\n    const {\n      hooks\n    } = context;\n    hooks.prevMountedDecorators ??= /* @__PURE__ */new Set();\n    hooks.mountedDecorators = /* @__PURE__ */new Set([storyFn, ...decorators]);\n    hooks.currentContext = context;\n    hooks.hasUpdates = false;\n    let result = decorated(context);\n    numberOfRenders = 1;\n    while (hooks.hasUpdates) {\n      hooks.hasUpdates = false;\n      hooks.currentEffects = [];\n      result = decorated(context);\n      numberOfRenders += 1;\n      if (numberOfRenders > RENDER_LIMIT) {\n        throw new Error(\"Too many re-renders. Storybook limits the number of renders to prevent an infinite loop.\");\n      }\n    }\n    hooks.addRenderListeners();\n    return result;\n  };\n}, \"applyHooks\");\nvar areDepsEqual = /* @__PURE__ */__name((deps, nextDeps) => deps.length === nextDeps.length && deps.every((dep, i) => dep === nextDeps[i]), \"areDepsEqual\");\nvar invalidHooksError = /* @__PURE__ */__name(() => new Error(\"Storybook preview hooks can only be called inside decorators and story functions.\"), \"invalidHooksError\");\nfunction getHooksContextOrNull() {\n  return global2.STORYBOOK_HOOKS_CONTEXT || null;\n}\n__name(getHooksContextOrNull, \"getHooksContextOrNull\");\nfunction getHooksContextOrThrow() {\n  const hooks = getHooksContextOrNull();\n  if (hooks == null) {\n    throw invalidHooksError();\n  }\n  return hooks;\n}\n__name(getHooksContextOrThrow, \"getHooksContextOrThrow\");\nfunction useHook(name, callback, deps) {\n  const hooks = getHooksContextOrThrow();\n  if (hooks.currentPhase === \"MOUNT\") {\n    if (deps != null && !Array.isArray(deps)) {\n      logger.warn(`${name} received a final argument that is not an array (instead, received ${deps}). When specified, the final argument must be an array.`);\n    }\n    const hook = {\n      name,\n      deps\n    };\n    hooks.currentHooks.push(hook);\n    callback(hook);\n    return hook;\n  }\n  if (hooks.currentPhase === \"UPDATE\") {\n    const hook = hooks.getNextHook();\n    if (hook == null) {\n      throw new Error(\"Rendered more hooks than during the previous render.\");\n    }\n    if (hook.name !== name) {\n      logger.warn(`Storybook has detected a change in the order of Hooks${hooks.currentDecoratorName ? ` called by ${hooks.currentDecoratorName}` : \"\"}. This will lead to bugs and errors if not fixed.`);\n    }\n    if (deps != null && hook.deps == null) {\n      logger.warn(`${name} received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.`);\n    }\n    if (deps != null && hook.deps != null && deps.length !== hook.deps.length) {\n      logger.warn(`The final argument passed to ${name} changed size between renders. The order and size of this array must remain constant.\nPrevious: ${hook.deps}\nIncoming: ${deps}`);\n    }\n    if (deps == null || hook.deps == null || !areDepsEqual(deps, hook.deps)) {\n      callback(hook);\n      hook.deps = deps;\n    }\n    return hook;\n  }\n  throw invalidHooksError();\n}\n__name(useHook, \"useHook\");\nfunction useMemoLike(name, nextCreate, deps) {\n  const {\n    memoizedState\n  } = useHook(name, hook => {\n    hook.memoizedState = nextCreate();\n  }, deps);\n  return memoizedState;\n}\n__name(useMemoLike, \"useMemoLike\");\nfunction useMemo(nextCreate, deps) {\n  return useMemoLike(\"useMemo\", nextCreate, deps);\n}\n__name(useMemo, \"useMemo\");\nfunction useCallback(callback, deps) {\n  return useMemoLike(\"useCallback\", () => callback, deps);\n}\n__name(useCallback, \"useCallback\");\nfunction useRefLike(name, initialValue) {\n  return useMemoLike(name, () => ({\n    current: initialValue\n  }), []);\n}\n__name(useRefLike, \"useRefLike\");\nfunction useRef(initialValue) {\n  return useRefLike(\"useRef\", initialValue);\n}\n__name(useRef, \"useRef\");\nfunction triggerUpdate() {\n  const hooks = getHooksContextOrNull();\n  if (hooks != null && hooks.currentPhase !== \"NONE\") {\n    hooks.hasUpdates = true;\n  } else {\n    try {\n      addons.getChannel().emit(FORCE_RE_RENDER);\n    } catch (e) {\n      logger.warn(\"State updates of Storybook preview hooks work only in browser\");\n    }\n  }\n}\n__name(triggerUpdate, \"triggerUpdate\");\nfunction useStateLike(name, initialState) {\n  const stateRef = useRefLike(name,\n  // @ts-expect-error S type should never be function, but there's no way to tell that to TypeScript\n  typeof initialState === \"function\" ? initialState() : initialState);\n  const setState = /* @__PURE__ */__name(update => {\n    stateRef.current = typeof update === \"function\" ? update(stateRef.current) : update;\n    triggerUpdate();\n  }, \"setState\");\n  return [stateRef.current, setState];\n}\n__name(useStateLike, \"useStateLike\");\nfunction useState(initialState) {\n  return useStateLike(\"useState\", initialState);\n}\n__name(useState, \"useState\");\nfunction useReducer(reducer, initialArg, init) {\n  const initialState = init != null ? () => init(initialArg) : initialArg;\n  const [state, setState] = useStateLike(\"useReducer\", initialState);\n  const dispatch = /* @__PURE__ */__name(action => setState(prevState => reducer(prevState, action)), \"dispatch\");\n  return [state, dispatch];\n}\n__name(useReducer, \"useReducer\");\nfunction useEffect(create, deps) {\n  const hooks = getHooksContextOrThrow();\n  const effect = useMemoLike(\"useEffect\", () => ({\n    create\n  }), deps);\n  if (!hooks.currentEffects.includes(effect)) {\n    hooks.currentEffects.push(effect);\n  }\n}\n__name(useEffect, \"useEffect\");\nfunction useChannel(eventMap, deps = []) {\n  const channel = addons.getChannel();\n  useEffect(() => {\n    Object.entries(eventMap).forEach(([type, listener]) => channel.on(type, listener));\n    return () => {\n      Object.entries(eventMap).forEach(([type, listener]) => channel.removeListener(type, listener));\n    };\n  }, [...Object.keys(eventMap), ...deps]);\n  return useCallback(channel.emit.bind(channel), [channel]);\n}\n__name(useChannel, \"useChannel\");\nfunction useStoryContext() {\n  const {\n    currentContext\n  } = getHooksContextOrThrow();\n  if (currentContext == null) {\n    throw invalidHooksError();\n  }\n  return currentContext;\n}\n__name(useStoryContext, \"useStoryContext\");\nfunction useParameter(parameterKey, defaultValue) {\n  const {\n    parameters\n  } = useStoryContext();\n  if (parameterKey) {\n    return parameters[parameterKey] ?? defaultValue;\n  }\n  return void 0;\n}\n__name(useParameter, \"useParameter\");\nfunction useArgs() {\n  const channel = addons.getChannel();\n  const {\n    id: storyId,\n    args\n  } = useStoryContext();\n  const updateArgs = useCallback(updatedArgs => channel.emit(UPDATE_STORY_ARGS, {\n    storyId,\n    updatedArgs\n  }), [channel, storyId]);\n  const resetArgs = useCallback(argNames => channel.emit(RESET_STORY_ARGS, {\n    storyId,\n    argNames\n  }), [channel, storyId]);\n  return [args, updateArgs, resetArgs];\n}\n__name(useArgs, \"useArgs\");\nfunction useGlobals() {\n  const channel = addons.getChannel();\n  const {\n    globals\n  } = useStoryContext();\n  const updateGlobals = useCallback(newGlobals => channel.emit(UPDATE_GLOBALS, {\n    globals: newGlobals\n  }), [channel]);\n  return [globals, updateGlobals];\n}\n__name(useGlobals, \"useGlobals\");\n\n// src/preview-api/modules/addons/make-decorator.ts\nvar makeDecorator = /* @__PURE__ */__name(({\n  name,\n  parameterName,\n  wrapper,\n  skipIfNoParametersOrOptions = false\n}) => {\n  const decorator = /* @__PURE__ */__name(options => (storyFn, context) => {\n    const parameters = context.parameters && context.parameters[parameterName];\n    if (parameters && parameters.disable) {\n      return storyFn(context);\n    }\n    if (skipIfNoParametersOrOptions && !options && !parameters) {\n      return storyFn(context);\n    }\n    return wrapper(storyFn, context, {\n      options,\n      parameters\n    });\n  }, \"decorator\");\n  return (...args) => {\n    if (typeof args[0] === \"function\") {\n      return decorator()(...args);\n    }\n    return (...innerArgs) => {\n      if (innerArgs.length > 1) {\n        if (args.length > 1) {\n          return decorator(args)(...innerArgs);\n        }\n        return decorator(...args)(...innerArgs);\n      }\n      throw new Error(`Passing stories directly into ${name}() is not allowed,\n        instead use addDecorator(${name}) and pass options with the '${parameterName}' parameter`);\n    };\n  };\n}, \"makeDecorator\");\n\n// src/preview-api/modules/store/StoryStore.ts\nimport { getCoreAnnotations as getCoreAnnotations2 } from \"storybook/internal/csf\";\nimport { CalledExtractOnStoreError, MissingStoryFromCsfFileError } from \"storybook/internal/preview-errors\";\nvar import_memoizerific2 = __toESM(require_memoizerific(), 1);\n\n// src/preview-api/modules/store/args.ts\nimport { once } from \"storybook/internal/client-logger\";\nvar INCOMPATIBLE = Symbol(\"incompatible\");\nvar map = /* @__PURE__ */__name((arg, argType) => {\n  const type = argType.type;\n  if (arg === void 0 || arg === null || !type) {\n    return arg;\n  }\n  if (argType.mapping) {\n    return arg;\n  }\n  switch (type.name) {\n    case \"string\":\n      return String(arg);\n    case \"enum\":\n      return arg;\n    case \"number\":\n      return Number(arg);\n    case \"boolean\":\n      return String(arg) === \"true\";\n    case \"array\":\n      if (!type.value || !Array.isArray(arg)) {\n        return INCOMPATIBLE;\n      }\n      return arg.reduce((acc, item, index) => {\n        const mapped = map(item, {\n          type: type.value\n        });\n        if (mapped !== INCOMPATIBLE) {\n          acc[index] = mapped;\n        }\n        return acc;\n      }, new Array(arg.length));\n    case \"object\":\n      if (typeof arg === \"string\" || typeof arg === \"number\") {\n        return arg;\n      }\n      if (!type.value || typeof arg !== \"object\") {\n        return INCOMPATIBLE;\n      }\n      return Object.entries(arg).reduce((acc, [key, val]) => {\n        const mapped = map(val, {\n          type: type.value[key]\n        });\n        return mapped === INCOMPATIBLE ? acc : Object.assign(acc, {\n          [key]: mapped\n        });\n      }, {});\n    case \"other\":\n      {\n        const isPrimitiveArg = typeof arg === \"string\" || typeof arg === \"number\" || typeof arg === \"boolean\";\n        if (type.value === \"ReactNode\" && isPrimitiveArg) {\n          return arg;\n        }\n        return INCOMPATIBLE;\n      }\n    default:\n      return INCOMPATIBLE;\n  }\n}, \"map\");\nvar mapArgsToTypes = /* @__PURE__ */__name((args, argTypes) => {\n  return Object.entries(args).reduce((acc, [key, value]) => {\n    if (!argTypes[key]) {\n      return acc;\n    }\n    const mapped = map(value, argTypes[key]);\n    return mapped === INCOMPATIBLE ? acc : Object.assign(acc, {\n      [key]: mapped\n    });\n  }, {});\n}, \"mapArgsToTypes\");\nvar combineArgs = /* @__PURE__ */__name((value, update) => {\n  if (Array.isArray(value) && Array.isArray(update)) {\n    return update.reduce((acc, upd, index) => {\n      acc[index] = combineArgs(value[index], update[index]);\n      return acc;\n    }, [...value]).filter(v => v !== void 0);\n  }\n  if (!isPlainObject(value) || !isPlainObject(update)) {\n    return update;\n  }\n  return Object.keys({\n    ...value,\n    ...update\n  }).reduce((acc, key) => {\n    if (key in update) {\n      const combined = combineArgs(value[key], update[key]);\n      if (combined !== void 0) {\n        acc[key] = combined;\n      }\n    } else {\n      acc[key] = value[key];\n    }\n    return acc;\n  }, {});\n}, \"combineArgs\");\nvar validateOptions = /* @__PURE__ */__name((args, argTypes) => {\n  return Object.entries(argTypes).reduce((acc, [key, {\n    options\n  }]) => {\n    function allowArg() {\n      if (key in args) {\n        acc[key] = args[key];\n      }\n      return acc;\n    }\n    __name(allowArg, \"allowArg\");\n    if (!options) {\n      return allowArg();\n    }\n    if (!Array.isArray(options)) {\n      once.error(dedent`\n        Invalid argType: '${key}.options' should be an array.\n\n        More info: https://storybook.js.org/docs/api/arg-types?ref=error\n      `);\n      return allowArg();\n    }\n    if (options.some(opt => opt && [\"object\", \"function\"].includes(typeof opt))) {\n      once.error(dedent`\n        Invalid argType: '${key}.options' should only contain primitives. Use a 'mapping' for complex values.\n\n        More info: https://storybook.js.org/docs/writing-stories/args?ref=error#mapping-to-complex-arg-values\n      `);\n      return allowArg();\n    }\n    const isArray = Array.isArray(args[key]);\n    const invalidIndex = isArray && args[key].findIndex(val => !options.includes(val));\n    const isValidArray = isArray && invalidIndex === -1;\n    if (args[key] === void 0 || options.includes(args[key]) || isValidArray) {\n      return allowArg();\n    }\n    const field = isArray ? `${key}[${invalidIndex}]` : key;\n    const supportedOptions = options.map(opt => typeof opt === \"string\" ? `'${opt}'` : String(opt)).join(\", \");\n    once.warn(`Received illegal value for '${field}'. Supported options: ${supportedOptions}`);\n    return acc;\n  }, {});\n}, \"validateOptions\");\nvar DEEPLY_EQUAL = Symbol(\"Deeply equal\");\nvar deepDiff = /* @__PURE__ */__name((value, update) => {\n  if (typeof value !== typeof update) {\n    return update;\n  }\n  if (isEqual(value, update)) {\n    return DEEPLY_EQUAL;\n  }\n  if (Array.isArray(value) && Array.isArray(update)) {\n    const res = update.reduce((acc, upd, index) => {\n      const diff = deepDiff(value[index], upd);\n      if (diff !== DEEPLY_EQUAL) {\n        acc[index] = diff;\n      }\n      return acc;\n    }, new Array(update.length));\n    if (update.length >= value.length) {\n      return res;\n    }\n    return res.concat(new Array(value.length - update.length).fill(void 0));\n  }\n  if (isPlainObject(value) && isPlainObject(update)) {\n    return Object.keys({\n      ...value,\n      ...update\n    }).reduce((acc, key) => {\n      const diff = deepDiff(value?.[key], update?.[key]);\n      return diff === DEEPLY_EQUAL ? acc : Object.assign(acc, {\n        [key]: diff\n      });\n    }, {});\n  }\n  return update;\n}, \"deepDiff\");\nvar UNTARGETED = \"UNTARGETED\";\nfunction groupArgsByTarget({\n  args,\n  argTypes\n}) {\n  const groupedArgs = {};\n  Object.entries(args).forEach(([name, value]) => {\n    const {\n      target = UNTARGETED\n    } = argTypes[name] || {};\n    groupedArgs[target] = groupedArgs[target] || {};\n    groupedArgs[target][name] = value;\n  });\n  return groupedArgs;\n}\n__name(groupArgsByTarget, \"groupArgsByTarget\");\n\n// src/preview-api/modules/store/ArgsStore.ts\nfunction deleteUndefined(obj) {\n  Object.keys(obj).forEach(key => obj[key] === void 0 && delete obj[key]);\n  return obj;\n}\n__name(deleteUndefined, \"deleteUndefined\");\nvar _ArgsStore = class _ArgsStore {\n  constructor() {\n    this.initialArgsByStoryId = {};\n    this.argsByStoryId = {};\n  }\n  get(storyId) {\n    if (!(storyId in this.argsByStoryId)) {\n      throw new Error(`No args known for ${storyId} -- has it been rendered yet?`);\n    }\n    return this.argsByStoryId[storyId];\n  }\n  setInitial(story) {\n    if (!this.initialArgsByStoryId[story.id]) {\n      this.initialArgsByStoryId[story.id] = story.initialArgs;\n      this.argsByStoryId[story.id] = story.initialArgs;\n    } else if (this.initialArgsByStoryId[story.id] !== story.initialArgs) {\n      const delta = deepDiff(this.initialArgsByStoryId[story.id], this.argsByStoryId[story.id]);\n      this.initialArgsByStoryId[story.id] = story.initialArgs;\n      this.argsByStoryId[story.id] = story.initialArgs;\n      if (delta !== DEEPLY_EQUAL) {\n        this.updateFromDelta(story, delta);\n      }\n    }\n  }\n  updateFromDelta(story, delta) {\n    const validatedDelta = validateOptions(delta, story.argTypes);\n    this.argsByStoryId[story.id] = combineArgs(this.argsByStoryId[story.id], validatedDelta);\n  }\n  updateFromPersisted(story, persisted) {\n    const mappedPersisted = mapArgsToTypes(persisted, story.argTypes);\n    return this.updateFromDelta(story, mappedPersisted);\n  }\n  update(storyId, argsUpdate) {\n    if (!(storyId in this.argsByStoryId)) {\n      throw new Error(`No args known for ${storyId} -- has it been rendered yet?`);\n    }\n    this.argsByStoryId[storyId] = deleteUndefined({\n      ...this.argsByStoryId[storyId],\n      ...argsUpdate\n    });\n  }\n};\n__name(_ArgsStore, \"ArgsStore\");\nvar ArgsStore = _ArgsStore;\n\n// src/preview-api/modules/store/GlobalsStore.ts\nimport { logger as logger2 } from \"storybook/internal/client-logger\";\n\n// src/preview-api/modules/store/csf/getValuesFromArgTypes.ts\nvar getValuesFromArgTypes = /* @__PURE__ */__name((argTypes = {}) => Object.entries(argTypes).reduce((acc, [arg, {\n  defaultValue\n}]) => {\n  if (typeof defaultValue !== \"undefined\") {\n    acc[arg] = defaultValue;\n  }\n  return acc;\n}, {}), \"getValuesFromArgTypes\");\n\n// src/preview-api/modules/store/GlobalsStore.ts\nvar _GlobalsStore = class _GlobalsStore {\n  constructor({\n    globals = {},\n    globalTypes = {}\n  }) {\n    this.set({\n      globals,\n      globalTypes\n    });\n  }\n  set({\n    globals = {},\n    globalTypes = {}\n  }) {\n    const delta = this.initialGlobals && deepDiff(this.initialGlobals, this.globals);\n    this.allowedGlobalNames = /* @__PURE__ */new Set([...Object.keys(globals), ...Object.keys(globalTypes)]);\n    const defaultGlobals = getValuesFromArgTypes(globalTypes);\n    this.initialGlobals = {\n      ...defaultGlobals,\n      ...globals\n    };\n    this.globals = this.initialGlobals;\n    if (delta && delta !== DEEPLY_EQUAL) {\n      this.updateFromPersisted(delta);\n    }\n  }\n  filterAllowedGlobals(globals) {\n    return Object.entries(globals).reduce((acc, [key, value]) => {\n      if (this.allowedGlobalNames.has(key)) {\n        acc[key] = value;\n      } else {\n        logger2.warn(`Attempted to set a global (${key}) that is not defined in initial globals or globalTypes`);\n      }\n      return acc;\n    }, {});\n  }\n  updateFromPersisted(persisted) {\n    const allowedUrlGlobals = this.filterAllowedGlobals(persisted);\n    this.globals = {\n      ...this.globals,\n      ...allowedUrlGlobals\n    };\n  }\n  get() {\n    return this.globals;\n  }\n  update(newGlobals) {\n    this.globals = {\n      ...this.globals,\n      ...this.filterAllowedGlobals(newGlobals)\n    };\n    for (const key in newGlobals) {\n      if (newGlobals[key] === void 0) {\n        this.globals[key] = this.initialGlobals[key];\n      }\n    }\n  }\n};\n__name(_GlobalsStore, \"GlobalsStore\");\nvar GlobalsStore = _GlobalsStore;\n\n// src/preview-api/modules/store/StoryIndexStore.ts\nvar import_memoizerific = __toESM(require_memoizerific(), 1);\nimport { MissingStoryAfterHmrError } from \"storybook/internal/preview-errors\";\nvar getImportPathMap = (0, import_memoizerific.default)(1)(entries => Object.values(entries).reduce((acc, entry) => {\n  acc[entry.importPath] = acc[entry.importPath] || entry;\n  return acc;\n}, {}));\nvar _StoryIndexStore = class _StoryIndexStore {\n  constructor({\n    entries\n  } = {\n    v: 5,\n    entries: {}\n  }) {\n    this.entries = entries;\n  }\n  entryFromSpecifier(specifier) {\n    const entries = Object.values(this.entries);\n    if (specifier === \"*\") {\n      return entries[0];\n    }\n    if (typeof specifier === \"string\") {\n      if (this.entries[specifier]) {\n        return this.entries[specifier];\n      }\n      return entries.find(entry => entry.id.startsWith(specifier));\n    }\n    const {\n      name,\n      title\n    } = specifier;\n    return entries.find(entry => entry.name === name && entry.title === title);\n  }\n  storyIdToEntry(storyId) {\n    const storyEntry = this.entries[storyId];\n    if (!storyEntry) {\n      throw new MissingStoryAfterHmrError({\n        storyId\n      });\n    }\n    return storyEntry;\n  }\n  importPathToEntry(importPath) {\n    return getImportPathMap(this.entries)[importPath];\n  }\n};\n__name(_StoryIndexStore, \"StoryIndexStore\");\nvar StoryIndexStore = _StoryIndexStore;\n\n// src/preview-api/modules/store/csf/normalizeInputTypes.ts\nvar normalizeType = /* @__PURE__ */__name(type => {\n  return typeof type === \"string\" ? {\n    name: type\n  } : type;\n}, \"normalizeType\");\nvar normalizeControl = /* @__PURE__ */__name(control => typeof control === \"string\" ? {\n  type: control\n} : control, \"normalizeControl\");\nvar normalizeInputType = /* @__PURE__ */__name((inputType, key) => {\n  const {\n    type,\n    control,\n    ...rest\n  } = inputType;\n  const normalized = {\n    name: key,\n    ...rest\n  };\n  if (type) {\n    normalized.type = normalizeType(type);\n  }\n  if (control) {\n    normalized.control = normalizeControl(control);\n  } else if (control === false) {\n    normalized.control = {\n      disable: true\n    };\n  }\n  return normalized;\n}, \"normalizeInputType\");\nvar normalizeInputTypes = /* @__PURE__ */__name(inputTypes => mapValues(inputTypes, normalizeInputType), \"normalizeInputTypes\");\n\n// src/preview-api/modules/store/csf/normalizeStory.ts\nimport { deprecate, logger as logger3 } from \"storybook/internal/client-logger\";\nimport { storyNameFromExport, toId } from \"storybook/internal/csf\";\n\n// src/preview-api/modules/store/csf/normalizeArrays.ts\nvar normalizeArrays = /* @__PURE__ */__name(array => {\n  if (Array.isArray(array)) {\n    return array;\n  }\n  return array ? [array] : [];\n}, \"normalizeArrays\");\n\n// src/preview-api/modules/store/csf/normalizeStory.ts\nvar deprecatedStoryAnnotation = dedent`\nCSF .story annotations deprecated; annotate story functions directly:\n- StoryFn.story.name => StoryFn.storyName\n- StoryFn.story.(parameters|decorators) => StoryFn.(parameters|decorators)\nSee https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#hoisted-csf-annotations for details and codemod.\n`;\nfunction normalizeStory(key, storyAnnotations, meta) {\n  const storyObject = storyAnnotations;\n  const userStoryFn = typeof storyAnnotations === \"function\" ? storyAnnotations : null;\n  const {\n    story\n  } = storyObject;\n  if (story) {\n    logger3.debug(\"deprecated story\", story);\n    deprecate(deprecatedStoryAnnotation);\n  }\n  const exportName = storyNameFromExport(key);\n  const name = typeof storyObject !== \"function\" && storyObject.name || storyObject.storyName || story?.name || exportName;\n  const decorators = [...normalizeArrays(storyObject.decorators), ...normalizeArrays(story?.decorators)];\n  const parameters = {\n    ...story?.parameters,\n    ...storyObject.parameters\n  };\n  const args = {\n    ...story?.args,\n    ...storyObject.args\n  };\n  const argTypes = {\n    ...story?.argTypes,\n    ...storyObject.argTypes\n  };\n  const loaders = [...normalizeArrays(storyObject.loaders), ...normalizeArrays(story?.loaders)];\n  const beforeEach = [...normalizeArrays(storyObject.beforeEach), ...normalizeArrays(story?.beforeEach)];\n  const afterEach = [...normalizeArrays(storyObject.afterEach), ...normalizeArrays(story?.afterEach)];\n  const {\n    render,\n    play,\n    tags = [],\n    globals = {}\n  } = storyObject;\n  const id = parameters.__id || toId(meta.id, exportName);\n  return {\n    moduleExport: storyAnnotations,\n    id,\n    name,\n    tags,\n    decorators,\n    parameters,\n    args,\n    argTypes: normalizeInputTypes(argTypes),\n    loaders,\n    beforeEach,\n    afterEach,\n    globals,\n    ...(render && {\n      render\n    }),\n    ...(userStoryFn && {\n      userStoryFn\n    }),\n    ...(play && {\n      play\n    })\n  };\n}\n__name(normalizeStory, \"normalizeStory\");\n\n// src/preview-api/modules/store/csf/processCSFFile.ts\nimport { logger as logger4 } from \"storybook/internal/client-logger\";\nimport { getStoryChildren, isExportStory, isStory, toTestId } from \"storybook/internal/csf\";\n\n// src/preview-api/modules/store/csf/normalizeComponentAnnotations.ts\nimport { sanitize } from \"storybook/internal/csf\";\nfunction normalizeComponentAnnotations(defaultExport, title = defaultExport.title, importPath) {\n  const {\n    id,\n    argTypes\n  } = defaultExport;\n  return {\n    id: sanitize(id || title),\n    ...defaultExport,\n    title,\n    ...(argTypes && {\n      argTypes: normalizeInputTypes(argTypes)\n    }),\n    parameters: {\n      fileName: importPath,\n      ...defaultExport.parameters\n    }\n  };\n}\n__name(normalizeComponentAnnotations, \"normalizeComponentAnnotations\");\n\n// src/preview-api/modules/store/csf/processCSFFile.ts\nvar checkGlobals = /* @__PURE__ */__name(parameters => {\n  const {\n    globals,\n    globalTypes\n  } = parameters;\n  if (globals || globalTypes) {\n    logger4.error(\"Global args/argTypes can only be set globally\", JSON.stringify({\n      globals,\n      globalTypes\n    }));\n  }\n}, \"checkGlobals\");\nvar checkStorySort = /* @__PURE__ */__name(parameters => {\n  const {\n    options\n  } = parameters;\n  if (options?.storySort) {\n    logger4.error(\"The storySort option parameter can only be set globally\");\n  }\n}, \"checkStorySort\");\nvar checkDisallowedParameters = /* @__PURE__ */__name(parameters => {\n  if (!parameters) {\n    return;\n  }\n  checkGlobals(parameters);\n  checkStorySort(parameters);\n}, \"checkDisallowedParameters\");\nfunction processCSFFile(moduleExports, importPath, title) {\n  const {\n    default: defaultExport,\n    __namedExportsOrder,\n    ...namedExports\n  } = moduleExports;\n  const firstStory = Object.values(namedExports)[0];\n  if (isStory(firstStory)) {\n    const meta2 = normalizeComponentAnnotations(firstStory.meta.input, title, importPath);\n    checkDisallowedParameters(meta2.parameters);\n    const csfFile2 = {\n      meta: meta2,\n      stories: {},\n      moduleExports\n    };\n    Object.keys(namedExports).forEach(key => {\n      if (isExportStory(key, meta2)) {\n        const story = namedExports[key];\n        const storyMeta = normalizeStory(key, story.input, meta2);\n        checkDisallowedParameters(storyMeta.parameters);\n        csfFile2.stories[storyMeta.id] = storyMeta;\n        getStoryChildren(story).forEach(child => {\n          const name = child.input.name;\n          const childId = toTestId(storyMeta.id, name);\n          child.input.parameters ??= {};\n          child.input.parameters.__id = childId;\n          csfFile2.stories[childId] = normalizeStory(name, child.input, meta2);\n        });\n      }\n    });\n    csfFile2.projectAnnotations = firstStory.meta.preview.composed;\n    return csfFile2;\n  }\n  const meta = normalizeComponentAnnotations(defaultExport, title, importPath);\n  checkDisallowedParameters(meta.parameters);\n  const csfFile = {\n    meta,\n    stories: {},\n    moduleExports\n  };\n  Object.keys(namedExports).forEach(key => {\n    if (isExportStory(key, meta)) {\n      const storyMeta = normalizeStory(key, namedExports[key], meta);\n      checkDisallowedParameters(storyMeta.parameters);\n      csfFile.stories[storyMeta.id] = storyMeta;\n    }\n  });\n  return csfFile;\n}\n__name(processCSFFile, \"processCSFFile\");\n\n// src/preview-api/modules/store/csf/prepareStory.ts\nimport { combineTags, includeConditionalArg } from \"storybook/internal/csf\";\nimport { NoRenderFunctionError } from \"storybook/internal/preview-errors\";\nimport { global as global3 } from \"@storybook/global\";\nimport { global as globalThis2 } from \"@storybook/global\";\n\n// src/preview-api/modules/preview-web/render/mount-utils.ts\nfunction mountDestructured(playFunction) {\n  return playFunction != null && getUsedProps(playFunction).includes(\"mount\");\n}\n__name(mountDestructured, \"mountDestructured\");\nfunction getUsedProps(fn) {\n  const match = fn.toString().match(/[^(]*\\(([^)]*)/);\n  if (!match) {\n    return [];\n  }\n  const args = splitByComma(match[1]);\n  if (!args.length) {\n    return [];\n  }\n  const first = args[0];\n  if (!(first.startsWith(\"{\") && first.endsWith(\"}\"))) {\n    return [];\n  }\n  const props = splitByComma(first.slice(1, -1).replace(/\\s/g, \"\")).map(prop => {\n    return prop.replace(/:.*|=.*/g, \"\");\n  });\n  return props;\n}\n__name(getUsedProps, \"getUsedProps\");\nfunction splitByComma(s) {\n  const result = [];\n  const stack = [];\n  let start = 0;\n  for (let i = 0; i < s.length; i++) {\n    if (s[i] === \"{\" || s[i] === \"[\") {\n      stack.push(s[i] === \"{\" ? \"}\" : \"]\");\n    } else if (s[i] === stack[stack.length - 1]) {\n      stack.pop();\n    } else if (!stack.length && s[i] === \",\") {\n      const token = s.substring(start, i).trim();\n      if (token) {\n        result.push(token);\n      }\n      start = i + 1;\n    }\n  }\n  const lastToken = s.substring(start).trim();\n  if (lastToken) {\n    result.push(lastToken);\n  }\n  return result;\n}\n__name(splitByComma, \"splitByComma\");\n\n// src/preview-api/modules/store/decorators.ts\nfunction decorateStory(storyFn, decorator, bindWithContext) {\n  const boundStoryFunction = bindWithContext(storyFn);\n  return context => decorator(boundStoryFunction, context);\n}\n__name(decorateStory, \"decorateStory\");\nfunction sanitizeStoryContextUpdate({\n  componentId,\n  title,\n  kind,\n  id,\n  name,\n  story,\n  parameters,\n  initialArgs,\n  argTypes,\n  ...update\n} = {}) {\n  return update;\n}\n__name(sanitizeStoryContextUpdate, \"sanitizeStoryContextUpdate\");\nfunction defaultDecorateStory(storyFn, decorators) {\n  const contextStore = {};\n  const bindWithContext = /* @__PURE__ */__name(decoratedStoryFn => update => {\n    if (!contextStore.value) {\n      throw new Error(\"Decorated function called without init\");\n    }\n    contextStore.value = {\n      ...contextStore.value,\n      ...sanitizeStoryContextUpdate(update)\n    };\n    return decoratedStoryFn(contextStore.value);\n  }, \"bindWithContext\");\n  const decoratedWithContextStore = decorators.reduce((story, decorator) => decorateStory(story, decorator, bindWithContext), storyFn);\n  return context => {\n    contextStore.value = context;\n    return decoratedWithContextStore(context);\n  };\n}\n__name(defaultDecorateStory, \"defaultDecorateStory\");\n\n// src/preview-api/modules/store/csf/prepareStory.ts\nfunction prepareStory(storyAnnotations, componentAnnotations, projectAnnotations) {\n  const {\n    moduleExport,\n    id,\n    name\n  } = storyAnnotations || {};\n  const partialAnnotations = preparePartialAnnotations(storyAnnotations, componentAnnotations, projectAnnotations);\n  const applyLoaders = /* @__PURE__ */__name(/*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* (context) {\n      const loaded = {};\n      for (const loaders of [normalizeArrays(projectAnnotations.loaders), normalizeArrays(componentAnnotations.loaders), normalizeArrays(storyAnnotations.loaders)]) {\n        if (context.abortSignal.aborted) {\n          return loaded;\n        }\n        const loadResults = yield Promise.all(loaders.map(loader => loader(context)));\n        Object.assign(loaded, ...loadResults);\n      }\n      return loaded;\n    });\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }(), \"applyLoaders\");\n  const applyBeforeEach = /* @__PURE__ */__name(/*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator(function* (context) {\n      const cleanupCallbacks = new Array();\n      for (const beforeEach of [...normalizeArrays(projectAnnotations.beforeEach), ...normalizeArrays(componentAnnotations.beforeEach), ...normalizeArrays(storyAnnotations.beforeEach)]) {\n        if (context.abortSignal.aborted) {\n          return cleanupCallbacks;\n        }\n        const cleanup = yield beforeEach(context);\n        if (cleanup) {\n          cleanupCallbacks.push(cleanup);\n        }\n      }\n      return cleanupCallbacks;\n    });\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), \"applyBeforeEach\");\n  const applyAfterEach = /* @__PURE__ */__name(/*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator(function* (context) {\n      const reversedFinalizers = [...normalizeArrays(projectAnnotations.afterEach), ...normalizeArrays(componentAnnotations.afterEach), ...normalizeArrays(storyAnnotations.afterEach)].reverse();\n      for (const finalizer of reversedFinalizers) {\n        if (context.abortSignal.aborted) {\n          return;\n        }\n        yield finalizer(context);\n      }\n    });\n    return function (_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }(), \"applyAfterEach\");\n  const undecoratedStoryFn = /* @__PURE__ */__name(context => context.originalStoryFn(context.args, context), \"undecoratedStoryFn\");\n  const {\n    applyDecorators = defaultDecorateStory,\n    runStep\n  } = projectAnnotations;\n  const decorators = [...normalizeArrays(storyAnnotations?.decorators), ...normalizeArrays(componentAnnotations?.decorators), ...normalizeArrays(projectAnnotations?.decorators)];\n  const render = storyAnnotations?.userStoryFn || storyAnnotations?.render || componentAnnotations.render || projectAnnotations.render;\n  const decoratedStoryFn = applyHooks(applyDecorators)(undecoratedStoryFn, decorators);\n  const unboundStoryFn = /* @__PURE__ */__name(context => decoratedStoryFn(context), \"unboundStoryFn\");\n  const playFunction = storyAnnotations?.play ?? componentAnnotations?.play;\n  const usesMount = mountDestructured(playFunction);\n  if (!render && !usesMount) {\n    throw new NoRenderFunctionError({\n      id\n    });\n  }\n  const defaultMount = /* @__PURE__ */__name(context => {\n    return /*#__PURE__*/_asyncToGenerator(function* () {\n      yield context.renderToCanvas();\n      return context.canvas;\n    });\n  }, \"defaultMount\");\n  const mount = storyAnnotations.mount ?? componentAnnotations.mount ?? projectAnnotations.mount ?? defaultMount;\n  const testingLibraryRender = projectAnnotations.testingLibraryRender;\n  return {\n    storyGlobals: {},\n    ...partialAnnotations,\n    moduleExport,\n    id,\n    name,\n    story: name,\n    originalStoryFn: render,\n    undecoratedStoryFn,\n    unboundStoryFn,\n    applyLoaders,\n    applyBeforeEach,\n    applyAfterEach,\n    playFunction,\n    runStep,\n    mount,\n    testingLibraryRender,\n    renderToCanvas: projectAnnotations.renderToCanvas,\n    usesMount\n  };\n}\n__name(prepareStory, \"prepareStory\");\nfunction prepareMeta(componentAnnotations, projectAnnotations, moduleExport) {\n  return {\n    ...preparePartialAnnotations(void 0, componentAnnotations, projectAnnotations),\n    moduleExport\n  };\n}\n__name(prepareMeta, \"prepareMeta\");\nfunction preparePartialAnnotations(storyAnnotations, componentAnnotations, projectAnnotations) {\n  const defaultTags = [\"dev\", \"test\"];\n  const extraTags = globalThis2.DOCS_OPTIONS?.autodocs === true ? [\"autodocs\"] : [];\n  const overrideTags = storyAnnotations?.tags?.includes(\"test-fn\") ? [\"!autodocs\"] : [];\n  const tags = combineTags(...defaultTags, ...extraTags, ...(projectAnnotations.tags ?? []), ...(componentAnnotations.tags ?? []), ...overrideTags, ...(storyAnnotations?.tags ?? []));\n  const parameters = combineParameters(projectAnnotations.parameters, componentAnnotations.parameters, storyAnnotations?.parameters);\n  const {\n    argTypesEnhancers = [],\n    argsEnhancers = []\n  } = projectAnnotations;\n  const passedArgTypes = combineParameters(projectAnnotations.argTypes, componentAnnotations.argTypes, storyAnnotations?.argTypes);\n  if (storyAnnotations) {\n    const render = storyAnnotations?.userStoryFn || storyAnnotations?.render || componentAnnotations.render || projectAnnotations.render;\n    parameters.__isArgsStory = render && render.length > 0;\n  }\n  const passedArgs = {\n    ...projectAnnotations.args,\n    ...componentAnnotations.args,\n    ...storyAnnotations?.args\n  };\n  const storyGlobals = {\n    ...componentAnnotations.globals,\n    ...storyAnnotations?.globals\n  };\n  const contextForEnhancers = {\n    componentId: componentAnnotations.id,\n    title: componentAnnotations.title,\n    kind: componentAnnotations.title,\n    // Back compat\n    id: storyAnnotations?.id || componentAnnotations.id,\n    // if there's no story name, we create a fake one since enhancers expect a name\n    name: storyAnnotations?.name || \"__meta\",\n    story: storyAnnotations?.name || \"__meta\",\n    // Back compat\n    component: componentAnnotations.component,\n    subcomponents: componentAnnotations.subcomponents,\n    tags,\n    parameters,\n    initialArgs: passedArgs,\n    argTypes: passedArgTypes,\n    storyGlobals\n  };\n  contextForEnhancers.argTypes = argTypesEnhancers.reduce((accumulatedArgTypes, enhancer) => enhancer({\n    ...contextForEnhancers,\n    argTypes: accumulatedArgTypes\n  }), contextForEnhancers.argTypes);\n  const initialArgsBeforeEnhancers = {\n    ...passedArgs\n  };\n  contextForEnhancers.initialArgs = [...argsEnhancers].reduce((accumulatedArgs, enhancer) => ({\n    ...accumulatedArgs,\n    ...enhancer({\n      ...contextForEnhancers,\n      initialArgs: accumulatedArgs\n    })\n  }), initialArgsBeforeEnhancers);\n  const {\n    name,\n    story,\n    ...withoutStoryIdentifiers\n  } = contextForEnhancers;\n  return withoutStoryIdentifiers;\n}\n__name(preparePartialAnnotations, \"preparePartialAnnotations\");\nfunction prepareContext(context) {\n  const {\n    args: unmappedArgs\n  } = context;\n  let targetedContext = {\n    ...context,\n    allArgs: void 0,\n    argsByTarget: void 0\n  };\n  if (global3.FEATURES?.argTypeTargetsV7) {\n    const argsByTarget = groupArgsByTarget(context);\n    targetedContext = {\n      ...context,\n      allArgs: context.args,\n      argsByTarget,\n      args: argsByTarget[UNTARGETED] || {}\n    };\n  }\n  const mappedArgs = Object.entries(targetedContext.args).reduce((acc, [key, val]) => {\n    if (!targetedContext.argTypes[key]?.mapping) {\n      acc[key] = val;\n      return acc;\n    }\n    const mappingFn = /* @__PURE__ */__name(originalValue => {\n      const mapping = targetedContext.argTypes[key].mapping;\n      return mapping && originalValue in mapping ? mapping[originalValue] : originalValue;\n    }, \"mappingFn\");\n    acc[key] = Array.isArray(val) ? val.map(mappingFn) : mappingFn(val);\n    return acc;\n  }, {});\n  const includedArgs = Object.entries(mappedArgs).reduce((acc, [key, val]) => {\n    const argType = targetedContext.argTypes[key] || {};\n    if (includeConditionalArg(argType, mappedArgs, targetedContext.globals)) {\n      acc[key] = val;\n    }\n    return acc;\n  }, {});\n  return {\n    ...targetedContext,\n    unmappedArgs,\n    args: includedArgs\n  };\n}\n__name(prepareContext, \"prepareContext\");\n\n// src/preview-api/modules/store/inferArgTypes.ts\nimport { logger as logger5 } from \"storybook/internal/client-logger\";\nvar inferType = /* @__PURE__ */__name((value, name, visited) => {\n  const type = typeof value;\n  switch (type) {\n    case \"boolean\":\n    case \"string\":\n    case \"number\":\n    case \"function\":\n    case \"symbol\":\n      return {\n        name: type\n      };\n    default:\n      break;\n  }\n  if (value) {\n    if (visited.has(value)) {\n      logger5.warn(dedent`\n        We've detected a cycle in arg '${name}'. Args should be JSON-serializable.\n\n        Consider using the mapping feature or fully custom args:\n        - Mapping: https://storybook.js.org/docs/writing-stories/args#mapping-to-complex-arg-values\n        - Custom args: https://storybook.js.org/docs/essentials/controls#fully-custom-args\n      `);\n      return {\n        name: \"other\",\n        value: \"cyclic object\"\n      };\n    }\n    visited.add(value);\n    if (Array.isArray(value)) {\n      const childType = value.length > 0 ? inferType(value[0], name, new Set(visited)) : {\n        name: \"other\",\n        value: \"unknown\"\n      };\n      return {\n        name: \"array\",\n        value: childType\n      };\n    }\n    const fieldTypes = mapValues(value, field => inferType(field, name, new Set(visited)));\n    return {\n      name: \"object\",\n      value: fieldTypes\n    };\n  }\n  return {\n    name: \"object\",\n    value: {}\n  };\n}, \"inferType\");\nvar inferArgTypes = /* @__PURE__ */__name(context => {\n  const {\n    id,\n    argTypes: userArgTypes = {},\n    initialArgs = {}\n  } = context;\n  const argTypes = mapValues(initialArgs, (arg, key) => ({\n    name: key,\n    type: inferType(arg, `${id}.${key}`, /* @__PURE__ */new Set())\n  }));\n  const userArgTypesNames = mapValues(userArgTypes, (argType, key) => ({\n    name: key\n  }));\n  return combineParameters(argTypes, userArgTypesNames, userArgTypes);\n}, \"inferArgTypes\");\ninferArgTypes.secondPass = true;\n\n// src/preview-api/modules/store/inferControls.ts\nimport { logger as logger6 } from \"storybook/internal/client-logger\";\n\n// src/preview-api/modules/store/filterArgTypes.ts\nvar matches = /* @__PURE__ */__name((name, descriptor) => Array.isArray(descriptor) ? descriptor.includes(name) : name.match(descriptor), \"matches\");\nvar filterArgTypes = /* @__PURE__ */__name((argTypes, include, exclude) => {\n  if (!include && !exclude) {\n    return argTypes;\n  }\n  return argTypes && pickBy(argTypes, (argType, key) => {\n    const name = argType.name || key.toString();\n    return !!(!include || matches(name, include)) && (!exclude || !matches(name, exclude));\n  });\n}, \"filterArgTypes\");\n\n// src/preview-api/modules/store/inferControls.ts\nvar inferControl = /* @__PURE__ */__name((argType, name, matchers) => {\n  const {\n    type,\n    options\n  } = argType;\n  if (!type) {\n    return void 0;\n  }\n  if (matchers.color && matchers.color.test(name)) {\n    const controlType = type.name;\n    if (controlType === \"string\") {\n      return {\n        control: {\n          type: \"color\"\n        }\n      };\n    }\n    if (controlType !== \"enum\") {\n      logger6.warn(`Addon controls: Control of type color only supports string, received \"${controlType}\" instead`);\n    }\n  }\n  if (matchers.date && matchers.date.test(name)) {\n    return {\n      control: {\n        type: \"date\"\n      }\n    };\n  }\n  switch (type.name) {\n    case \"array\":\n      return {\n        control: {\n          type: \"object\"\n        }\n      };\n    case \"boolean\":\n      return {\n        control: {\n          type: \"boolean\"\n        }\n      };\n    case \"string\":\n      return {\n        control: {\n          type: \"text\"\n        }\n      };\n    case \"number\":\n      return {\n        control: {\n          type: \"number\"\n        }\n      };\n    case \"enum\":\n      {\n        const {\n          value\n        } = type;\n        return {\n          control: {\n            type: value?.length <= 5 ? \"radio\" : \"select\"\n          },\n          options: value\n        };\n      }\n    case \"function\":\n    case \"symbol\":\n      return null;\n    default:\n      return {\n        control: {\n          type: options ? \"select\" : \"object\"\n        }\n      };\n  }\n}, \"inferControl\");\nvar inferControls = /* @__PURE__ */__name(context => {\n  const {\n    argTypes,\n    parameters: {\n      __isArgsStory,\n      controls: {\n        include = null,\n        exclude = null,\n        matchers = {}\n      } = {}\n    }\n  } = context;\n  if (!__isArgsStory) {\n    return argTypes;\n  }\n  const filteredArgTypes = filterArgTypes(argTypes, include, exclude);\n  const withControls = mapValues(filteredArgTypes, (argType, name) => {\n    return argType?.type && inferControl(argType, name.toString(), matchers);\n  });\n  return combineParameters(withControls, filteredArgTypes);\n}, \"inferControls\");\ninferControls.secondPass = true;\n\n// src/preview-api/modules/store/csf/normalizeProjectAnnotations.ts\nfunction normalizeProjectAnnotations({\n  argTypes,\n  globalTypes,\n  argTypesEnhancers,\n  decorators,\n  loaders,\n  beforeEach,\n  afterEach,\n  initialGlobals,\n  ...annotations\n}) {\n  return {\n    ...(argTypes && {\n      argTypes: normalizeInputTypes(argTypes)\n    }),\n    ...(globalTypes && {\n      globalTypes: normalizeInputTypes(globalTypes)\n    }),\n    decorators: normalizeArrays(decorators),\n    loaders: normalizeArrays(loaders),\n    beforeEach: normalizeArrays(beforeEach),\n    afterEach: normalizeArrays(afterEach),\n    argTypesEnhancers: [...(argTypesEnhancers || []), inferArgTypes,\n    // There's an architectural decision to be made regarding embedded addons in core:\n    //\n    // Option 1: Keep embedded addons but ensure consistency by moving addon-specific code\n    // (like inferControls) to live alongside the addon code itself. This maintains the\n    // concept of core addons while improving code organization.\n    //\n    // Option 2: Fully integrate these addons into core, potentially moving UI components\n    // into the manager and treating them as core features rather than addons. This is a\n    // bigger architectural change requiring careful consideration.\n    //\n    // For now, we're keeping inferControls here as we need time to properly evaluate\n    // these options and their implications. Some features (like Angular's cleanArgsDecorator)\n    // currently rely on this behavior.\n    //\n    // TODO: Make an architectural decision on the handling of core addons\n    inferControls],\n    initialGlobals,\n    ...annotations\n  };\n}\n__name(normalizeProjectAnnotations, \"normalizeProjectAnnotations\");\n\n// src/preview-api/modules/store/csf/composeConfigs.ts\nimport { global as global4 } from \"@storybook/global\";\n\n// src/preview-api/modules/store/csf/beforeAll.ts\nvar composeBeforeAllHooks = /* @__PURE__ */__name(hooks => {\n  return /*#__PURE__*/_asyncToGenerator(function* () {\n    const cleanups2 = [];\n    for (const hook of hooks) {\n      const cleanup = yield hook();\n      if (cleanup) {\n        cleanups2.unshift(cleanup);\n      }\n    }\n    return /*#__PURE__*/_asyncToGenerator(function* () {\n      for (const cleanup of cleanups2) {\n        yield cleanup();\n      }\n    });\n  });\n}, \"composeBeforeAllHooks\");\n\n// src/preview-api/modules/store/csf/stepRunners.ts\nfunction composeStepRunners(stepRunners) {\n  return /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator(function* (label, play, playContext) {\n      const composedPlay = stepRunners.reduceRight((innerPlay, stepRunner) => /*#__PURE__*/_asyncToGenerator(function* () {\n        return stepRunner(label, innerPlay, playContext);\n      }), /*#__PURE__*/_asyncToGenerator(function* () {\n        return play(playContext);\n      }));\n      yield composedPlay();\n    });\n    return function (_x4, _x5, _x6) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n}\n__name(composeStepRunners, \"composeStepRunners\");\n\n// src/preview-api/modules/store/csf/composeConfigs.ts\nfunction getField(moduleExportList, field) {\n  return moduleExportList.map(xs => xs.default?.[field] ?? xs[field]).filter(Boolean);\n}\n__name(getField, \"getField\");\nfunction getArrayField(moduleExportList, field, options = {}) {\n  return getField(moduleExportList, field).reduce((prev, cur) => {\n    const normalized = normalizeArrays(cur);\n    return options.reverseFileOrder ? [...normalized, ...prev] : [...prev, ...normalized];\n  }, []);\n}\n__name(getArrayField, \"getArrayField\");\nfunction getObjectField(moduleExportList, field) {\n  return Object.assign({}, ...getField(moduleExportList, field));\n}\n__name(getObjectField, \"getObjectField\");\nfunction getSingletonField(moduleExportList, field) {\n  return getField(moduleExportList, field).pop();\n}\n__name(getSingletonField, \"getSingletonField\");\nfunction composeConfigs(moduleExportList) {\n  const allArgTypeEnhancers = getArrayField(moduleExportList, \"argTypesEnhancers\");\n  const stepRunners = getField(moduleExportList, \"runStep\");\n  const beforeAllHooks = getArrayField(moduleExportList, \"beforeAll\");\n  return {\n    parameters: combineParameters(...getField(moduleExportList, \"parameters\")),\n    decorators: getArrayField(moduleExportList, \"decorators\", {\n      reverseFileOrder: !(global4.FEATURES?.legacyDecoratorFileOrder ?? false)\n    }),\n    args: getObjectField(moduleExportList, \"args\"),\n    argsEnhancers: getArrayField(moduleExportList, \"argsEnhancers\"),\n    argTypes: getObjectField(moduleExportList, \"argTypes\"),\n    argTypesEnhancers: [...allArgTypeEnhancers.filter(e => !e.secondPass), ...allArgTypeEnhancers.filter(e => e.secondPass)],\n    initialGlobals: getObjectField(moduleExportList, \"initialGlobals\"),\n    globalTypes: getObjectField(moduleExportList, \"globalTypes\"),\n    loaders: getArrayField(moduleExportList, \"loaders\"),\n    beforeAll: composeBeforeAllHooks(beforeAllHooks),\n    beforeEach: getArrayField(moduleExportList, \"beforeEach\"),\n    afterEach: getArrayField(moduleExportList, \"afterEach\"),\n    render: getSingletonField(moduleExportList, \"render\"),\n    renderToCanvas: getSingletonField(moduleExportList, \"renderToCanvas\"),\n    applyDecorators: getSingletonField(moduleExportList, \"applyDecorators\"),\n    runStep: composeStepRunners(stepRunners),\n    tags: getArrayField(moduleExportList, \"tags\"),\n    mount: getSingletonField(moduleExportList, \"mount\"),\n    testingLibraryRender: getSingletonField(moduleExportList, \"testingLibraryRender\")\n  };\n}\n__name(composeConfigs, \"composeConfigs\");\n\n// src/preview-api/modules/store/csf/portable-stories.ts\nimport { isExportStory as isExportStory2 } from \"storybook/internal/csf\";\nimport { getCoreAnnotations } from \"storybook/internal/csf\";\nimport { MountMustBeDestructuredError } from \"storybook/internal/preview-errors\";\n\n// src/preview-api/modules/store/reporter-api.ts\nvar _ReporterAPI = class _ReporterAPI {\n  constructor() {\n    this.reports = [];\n  }\n  addReport(report) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.reports.push(report);\n    })();\n  }\n};\n__name(_ReporterAPI, \"ReporterAPI\");\nvar ReporterAPI = _ReporterAPI;\n\n// src/preview-api/modules/store/csf/csf-factory-utils.ts\nimport { isMeta, isStory as isStory2 } from \"storybook/internal/csf\";\nfunction getCsfFactoryAnnotations(story, meta, projectAnnotations) {\n  return isStory2(story) ? {\n    story: story.input,\n    meta: story.meta.input,\n    preview: story.meta.preview.composed\n  } : {\n    story,\n    meta: isMeta(meta) ? meta.input : meta,\n    preview: projectAnnotations\n  };\n}\n__name(getCsfFactoryAnnotations, \"getCsfFactoryAnnotations\");\n\n// src/preview-api/modules/store/csf/portable-stories.ts\nfunction setDefaultProjectAnnotations(_defaultProjectAnnotations) {\n  globalThis.defaultProjectAnnotations = _defaultProjectAnnotations;\n}\n__name(setDefaultProjectAnnotations, \"setDefaultProjectAnnotations\");\nvar DEFAULT_STORY_TITLE = \"ComposedStory\";\nvar DEFAULT_STORY_NAME = \"Unnamed Story\";\nfunction extractAnnotation(annotation) {\n  if (!annotation) {\n    return {};\n  }\n  return composeConfigs([annotation]);\n}\n__name(extractAnnotation, \"extractAnnotation\");\nfunction setProjectAnnotations(projectAnnotations) {\n  const annotations = Array.isArray(projectAnnotations) ? projectAnnotations : [projectAnnotations];\n  globalThis.globalProjectAnnotations = composeConfigs([...getCoreAnnotations(), globalThis.defaultProjectAnnotations ?? {}, composeConfigs(annotations.map(extractAnnotation))]);\n  return globalThis.globalProjectAnnotations ?? {};\n}\n__name(setProjectAnnotations, \"setProjectAnnotations\");\nvar cleanups = [];\nfunction composeStory(storyAnnotations, componentAnnotations, projectAnnotations, defaultConfig, exportsName) {\n  if (storyAnnotations === void 0) {\n    throw new Error(\"Expected a story but received undefined.\");\n  }\n  componentAnnotations.title = componentAnnotations.title ?? DEFAULT_STORY_TITLE;\n  const normalizedComponentAnnotations = normalizeComponentAnnotations(componentAnnotations);\n  const storyName = exportsName || storyAnnotations.storyName || storyAnnotations.story?.name || storyAnnotations.name || DEFAULT_STORY_NAME;\n  const normalizedStory = normalizeStory(storyName, storyAnnotations, normalizedComponentAnnotations);\n  const normalizedProjectAnnotations = normalizeProjectAnnotations(composeConfigs([defaultConfig ?? globalThis.globalProjectAnnotations ?? {}, projectAnnotations ?? {}]));\n  const story = prepareStory(normalizedStory, normalizedComponentAnnotations, normalizedProjectAnnotations);\n  const globalsFromGlobalTypes = getValuesFromArgTypes(normalizedProjectAnnotations.globalTypes);\n  const globals = {\n    ...globalsFromGlobalTypes,\n    ...normalizedProjectAnnotations.initialGlobals,\n    ...story.storyGlobals\n  };\n  const reporting = new ReporterAPI();\n  const initializeContext = /* @__PURE__ */__name(() => {\n    const context = prepareContext({\n      hooks: new HooksContext(),\n      globals,\n      args: {\n        ...story.initialArgs\n      },\n      viewMode: \"story\",\n      reporting,\n      loaded: {},\n      abortSignal: new AbortController().signal,\n      step: /* @__PURE__ */__name((label, play2) => story.runStep(label, play2, context), \"step\"),\n      canvasElement: null,\n      canvas: {},\n      userEvent: {},\n      globalTypes: normalizedProjectAnnotations.globalTypes,\n      ...story,\n      context: null,\n      mount: null\n    });\n    context.parameters.__isPortableStory = true;\n    context.context = context;\n    if (story.renderToCanvas) {\n      context.renderToCanvas = /*#__PURE__*/_asyncToGenerator(function* () {\n        const unmount = yield story.renderToCanvas?.({\n          componentId: story.componentId,\n          title: story.title,\n          id: story.id,\n          name: story.name,\n          tags: story.tags,\n          showMain: /* @__PURE__ */__name(() => {}, \"showMain\"),\n          showError: /* @__PURE__ */__name(error => {\n            throw new Error(`${error.title}\n${error.description}`);\n          }, \"showError\"),\n          showException: /* @__PURE__ */__name(error => {\n            throw error;\n          }, \"showException\"),\n          forceRemount: true,\n          storyContext: context,\n          storyFn: /* @__PURE__ */__name(() => story.unboundStoryFn(context), \"storyFn\"),\n          unboundStoryFn: story.unboundStoryFn\n        }, context.canvasElement);\n        if (unmount) {\n          cleanups.push(unmount);\n        }\n      });\n    }\n    context.mount = story.mount(context);\n    return context;\n  }, \"initializeContext\");\n  let loadedContext;\n  const play = /* @__PURE__ */__name(/*#__PURE__*/function () {\n    var _ref1 = _asyncToGenerator(function* (extraContext) {\n      const context = initializeContext();\n      context.canvasElement ??= globalThis?.document?.body;\n      if (loadedContext) {\n        context.loaded = loadedContext.loaded;\n      }\n      Object.assign(context, extraContext);\n      return story.playFunction(context);\n    });\n    return function (_x7) {\n      return _ref1.apply(this, arguments);\n    };\n  }(), \"play\");\n  const run = /* @__PURE__ */__name(extraContext => {\n    const context = initializeContext();\n    Object.assign(context, extraContext);\n    return runStory(story, context);\n  }, \"run\");\n  const playFunction = story.playFunction ? play : void 0;\n  const composedStory = Object.assign(/* @__PURE__ */__name(function storyFn(extraArgs) {\n    const context = initializeContext();\n    if (loadedContext) {\n      context.loaded = loadedContext.loaded;\n    }\n    context.args = {\n      ...context.initialArgs,\n      ...extraArgs\n    };\n    return story.unboundStoryFn(context);\n  }, \"storyFn\"), {\n    id: story.id,\n    storyName,\n    load: /* @__PURE__ */__name(/*#__PURE__*/_asyncToGenerator(function* () {\n      for (const callback of [...cleanups].reverse()) {\n        yield callback();\n      }\n      cleanups.length = 0;\n      const context = initializeContext();\n      context.loaded = yield story.applyLoaders(context);\n      cleanups.push(...(yield story.applyBeforeEach(context)).filter(Boolean));\n      loadedContext = context;\n    }), \"load\"),\n    globals,\n    args: story.initialArgs,\n    parameters: story.parameters,\n    argTypes: story.argTypes,\n    play: playFunction,\n    run,\n    reporting,\n    tags: story.tags\n  });\n  return composedStory;\n}\n__name(composeStory, \"composeStory\");\nvar defaultComposeStory = /* @__PURE__ */__name((story, component, project, exportsName) => composeStory(story, component, project, {}, exportsName), \"defaultComposeStory\");\nfunction composeStories(storiesImport, globalConfig, composeStoryFn = defaultComposeStory) {\n  const {\n    default: metaExport,\n    __esModule,\n    __namedExportsOrder,\n    ...stories\n  } = storiesImport;\n  let meta = metaExport;\n  const composedStories = Object.entries(stories).reduce((storiesMap, [exportsName, story]) => {\n    const {\n      story: storyAnnotations,\n      meta: componentAnnotations\n    } = getCsfFactoryAnnotations(story);\n    if (!meta && componentAnnotations) {\n      meta = componentAnnotations;\n    }\n    if (!isExportStory2(exportsName, meta)) {\n      return storiesMap;\n    }\n    const result = Object.assign(storiesMap, {\n      [exportsName]: composeStoryFn(storyAnnotations, meta, globalConfig, exportsName)\n    });\n    return result;\n  }, {});\n  return composedStories;\n}\n__name(composeStories, \"composeStories\");\nfunction createPlaywrightTest(baseTest) {\n  return baseTest.extend({\n    mount: /* @__PURE__ */__name(/*#__PURE__*/function () {\n      var _ref11 = _asyncToGenerator(function* ({\n        mount,\n        page\n      }, use) {\n        yield use(/*#__PURE__*/function () {\n          var _ref12 = _asyncToGenerator(function* (storyRef, ...restArgs) {\n            if (!(\"__pw_type\" in storyRef) || \"__pw_type\" in storyRef && storyRef.__pw_type !== \"jsx\") {\n              throw new Error(dedent`\n              Portable stories in Playwright CT only work when referencing JSX elements.\n              Please use JSX format for your components such as:\n\n              instead of:\n              await mount(MyComponent, { props: { foo: 'bar' } })\n\n              do:\n              await mount(<MyComponent foo=\"bar\"/>)\n\n              More info: https://storybook.js.org/docs/api/portable-stories/portable-stories-playwright?ref=error\n            `);\n            }\n            const {\n              props,\n              ...storyRefWithoutProps\n            } = storyRef;\n            yield page.evaluate(/*#__PURE__*/function () {\n              var _ref13 = _asyncToGenerator(function* (wrappedStoryRef) {\n                const unwrappedStoryRef = yield globalThis.__pwUnwrapObject?.(wrappedStoryRef);\n                const story = \"__pw_type\" in unwrappedStoryRef ? unwrappedStoryRef.type : unwrappedStoryRef;\n                return story?.load?.();\n              });\n              return function (_x1) {\n                return _ref13.apply(this, arguments);\n              };\n            }(), storyRefWithoutProps);\n            const mountResult = yield mount(storyRef, ...restArgs);\n            yield page.evaluate(/*#__PURE__*/function () {\n              var _ref14 = _asyncToGenerator(function* (wrappedStoryRef) {\n                const unwrappedStoryRef = yield globalThis.__pwUnwrapObject?.(wrappedStoryRef);\n                const story = \"__pw_type\" in unwrappedStoryRef ? unwrappedStoryRef.type : unwrappedStoryRef;\n                const canvasElement = document.querySelector(\"#root\");\n                return story?.play?.({\n                  canvasElement\n                });\n              });\n              return function (_x10) {\n                return _ref14.apply(this, arguments);\n              };\n            }(), storyRefWithoutProps);\n            return mountResult;\n          });\n          return function (_x0) {\n            return _ref12.apply(this, arguments);\n          };\n        }());\n      });\n      return function (_x8, _x9) {\n        return _ref11.apply(this, arguments);\n      };\n    }(), \"mount\")\n  });\n}\n__name(createPlaywrightTest, \"createPlaywrightTest\");\nfunction runStory(_x11, _x12) {\n  return _runStory.apply(this, arguments);\n}\nfunction _runStory() {\n  _runStory = _asyncToGenerator(function* (story, context) {\n    for (const callback of [...cleanups].reverse()) {\n      yield callback();\n    }\n    cleanups.length = 0;\n    if (!context.canvasElement) {\n      const container = document.createElement(\"div\");\n      globalThis?.document?.body?.appendChild(container);\n      context.canvasElement = container;\n      cleanups.push(() => {\n        if (globalThis?.document?.body?.contains(container)) {\n          globalThis?.document?.body?.removeChild(container);\n        }\n      });\n    }\n    context.loaded = yield story.applyLoaders(context);\n    if (context.abortSignal.aborted) {\n      return;\n    }\n    cleanups.push(...(yield story.applyBeforeEach(context)).filter(Boolean));\n    const playFunction = story.playFunction;\n    const isMountDestructured = story.usesMount;\n    if (!isMountDestructured) {\n      yield context.mount();\n    }\n    if (context.abortSignal.aborted) {\n      return;\n    }\n    if (playFunction) {\n      if (!isMountDestructured) {\n        context.mount = /*#__PURE__*/_asyncToGenerator(function* () {\n          throw new MountMustBeDestructuredError({\n            playFunction: playFunction.toString()\n          });\n        });\n      }\n      yield playFunction(context);\n    }\n    let cleanUp;\n    if (isTestEnvironment()) {\n      cleanUp = pauseAnimations();\n    } else {\n      yield waitForAnimations(context.abortSignal);\n    }\n    yield story.applyAfterEach(context);\n    yield cleanUp?.();\n  });\n  return _runStory.apply(this, arguments);\n}\n__name(runStory, \"runStory\");\n\n// src/preview-api/modules/store/StoryStore.ts\nvar CSF_CACHE_SIZE = 1e3;\nvar STORY_CACHE_SIZE = 1e4;\nvar _StoryStore = class _StoryStore {\n  constructor(storyIndex, importFn, projectAnnotations) {\n    this.importFn = importFn;\n    this.storyIndex = new StoryIndexStore(storyIndex);\n    this.projectAnnotations = normalizeProjectAnnotations(composeConfigs([...getCoreAnnotations2(), projectAnnotations]));\n    const {\n      initialGlobals,\n      globalTypes\n    } = this.projectAnnotations;\n    this.args = new ArgsStore();\n    this.userGlobals = new GlobalsStore({\n      globals: initialGlobals,\n      globalTypes\n    });\n    this.hooks = {};\n    this.cleanupCallbacks = {};\n    this.processCSFFileWithCache = (0, import_memoizerific2.default)(CSF_CACHE_SIZE)(processCSFFile);\n    this.prepareMetaWithCache = (0, import_memoizerific2.default)(CSF_CACHE_SIZE)(prepareMeta);\n    this.prepareStoryWithCache = (0, import_memoizerific2.default)(STORY_CACHE_SIZE)(prepareStory);\n  }\n  setProjectAnnotations(projectAnnotations) {\n    this.projectAnnotations = normalizeProjectAnnotations(projectAnnotations);\n    const {\n      initialGlobals,\n      globalTypes\n    } = projectAnnotations;\n    this.userGlobals.set({\n      globals: initialGlobals,\n      globalTypes\n    });\n  }\n  // This means that one of the CSF files has changed.\n  // If the `importFn` has changed, we will invalidate both caches.\n  // If the `storyIndex` data has changed, we may or may not invalidate the caches, depending\n  // on whether we've loaded the relevant files yet.\n  onStoriesChanged(_x13) {\n    var _this2 = this;\n    return _asyncToGenerator(function* ({\n      importFn,\n      storyIndex\n    }) {\n      if (importFn) {\n        _this2.importFn = importFn;\n      }\n      if (storyIndex) {\n        _this2.storyIndex.entries = storyIndex.entries;\n      }\n      if (_this2.cachedCSFFiles) {\n        yield _this2.cacheAllCSFFiles();\n      }\n    }).apply(this, arguments);\n  }\n  // Get an entry from the index, waiting on initialization if necessary\n  storyIdToEntry(storyId) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      return _this3.storyIndex.storyIdToEntry(storyId);\n    })();\n  }\n  // To load a single CSF file to service a story we need to look up the importPath in the index\n  loadCSFFileByStoryId(storyId) {\n    var _this4 = this;\n    return _asyncToGenerator(function* () {\n      const {\n        importPath,\n        title\n      } = _this4.storyIndex.storyIdToEntry(storyId);\n      const moduleExports = yield _this4.importFn(importPath);\n      return _this4.processCSFFileWithCache(moduleExports, importPath, title);\n    })();\n  }\n  loadAllCSFFiles() {\n    var _this5 = this;\n    return _asyncToGenerator(function* () {\n      const importPaths = {};\n      Object.entries(_this5.storyIndex.entries).forEach(([storyId, {\n        importPath\n      }]) => {\n        importPaths[importPath] = storyId;\n      });\n      const list = yield Promise.all(Object.entries(importPaths).map(/*#__PURE__*/function () {\n        var _ref15 = _asyncToGenerator(function* ([importPath, storyId]) {\n          return {\n            importPath,\n            csfFile: yield _this5.loadCSFFileByStoryId(storyId)\n          };\n        });\n        return function (_x14) {\n          return _ref15.apply(this, arguments);\n        };\n      }()));\n      return list.reduce((acc, {\n        importPath,\n        csfFile\n      }) => {\n        acc[importPath] = csfFile;\n        return acc;\n      }, {});\n    })();\n  }\n  cacheAllCSFFiles() {\n    var _this6 = this;\n    return _asyncToGenerator(function* () {\n      _this6.cachedCSFFiles = yield _this6.loadAllCSFFiles();\n    })();\n  }\n  preparedMetaFromCSFFile({\n    csfFile\n  }) {\n    const componentAnnotations = csfFile.meta;\n    return this.prepareMetaWithCache(componentAnnotations, this.projectAnnotations, csfFile.moduleExports.default);\n  }\n  // Load the CSF file for a story and prepare the story from it and the project annotations.\n  loadStory(_x15) {\n    var _this7 = this;\n    return _asyncToGenerator(function* ({\n      storyId\n    }) {\n      const csfFile = yield _this7.loadCSFFileByStoryId(storyId);\n      return _this7.storyFromCSFFile({\n        storyId,\n        csfFile\n      });\n    }).apply(this, arguments);\n  }\n  // This function is synchronous for convenience -- often times if you have a CSF file already\n  // it is easier not to have to await `loadStory`.\n  storyFromCSFFile({\n    storyId,\n    csfFile\n  }) {\n    const storyAnnotations = csfFile.stories[storyId];\n    if (!storyAnnotations) {\n      throw new MissingStoryFromCsfFileError({\n        storyId\n      });\n    }\n    const componentAnnotations = csfFile.meta;\n    const story = this.prepareStoryWithCache(storyAnnotations, componentAnnotations, csfFile.projectAnnotations ?? this.projectAnnotations);\n    this.args.setInitial(story);\n    this.hooks[story.id] = this.hooks[story.id] || new HooksContext();\n    return story;\n  }\n  // If we have a CSF file we can get all the stories from it synchronously\n  componentStoriesFromCSFFile({\n    csfFile\n  }) {\n    return Object.keys(this.storyIndex.entries).filter(storyId => !!csfFile.stories[storyId]).map(storyId => this.storyFromCSFFile({\n      storyId,\n      csfFile\n    }));\n  }\n  loadEntry(id) {\n    var _this8 = this;\n    return _asyncToGenerator(function* () {\n      const entry = yield _this8.storyIdToEntry(id);\n      const storyImports = entry.type === \"docs\" ? entry.storiesImports : [];\n      const [entryExports, ...csfFiles] = yield Promise.all([_this8.importFn(entry.importPath), ...storyImports.map(storyImportPath => {\n        const firstStoryEntry = _this8.storyIndex.importPathToEntry(storyImportPath);\n        return _this8.loadCSFFileByStoryId(firstStoryEntry.id);\n      })]);\n      return {\n        entryExports,\n        csfFiles\n      };\n    })();\n  }\n  // A prepared story does not include args, globals or hooks. These are stored in the story store\n  // and updated separately to the (immutable) story.\n  getStoryContext(story, {\n    forceInitialArgs = false\n  } = {}) {\n    const userGlobals = this.userGlobals.get();\n    const {\n      initialGlobals\n    } = this.userGlobals;\n    const reporting = new ReporterAPI();\n    return prepareContext({\n      ...story,\n      args: forceInitialArgs ? story.initialArgs : this.args.get(story.id),\n      initialGlobals,\n      globalTypes: this.projectAnnotations.globalTypes,\n      userGlobals,\n      reporting,\n      globals: {\n        ...userGlobals,\n        ...story.storyGlobals\n      },\n      hooks: this.hooks[story.id]\n    });\n  }\n  addCleanupCallbacks(story, ...callbacks) {\n    this.cleanupCallbacks[story.id] = (this.cleanupCallbacks[story.id] || []).concat(callbacks);\n  }\n  cleanupStory(story) {\n    var _this9 = this;\n    return _asyncToGenerator(function* () {\n      _this9.hooks[story.id].clean();\n      const callbacks = _this9.cleanupCallbacks[story.id];\n      if (callbacks) {\n        for (const callback of [...callbacks].reverse()) {\n          yield callback();\n        }\n      }\n      delete _this9.cleanupCallbacks[story.id];\n    })();\n  }\n  extract(options = {\n    includeDocsOnly: false\n  }) {\n    const {\n      cachedCSFFiles\n    } = this;\n    console.log(\"extract: extracting stories\", cachedCSFFiles);\n    if (!cachedCSFFiles) {\n      throw new CalledExtractOnStoreError();\n    }\n    const stories = Object.entries(this.storyIndex.entries).reduce((acc, [storyId, entry]) => {\n      if (entry.type === \"docs\") {\n        return acc;\n      }\n      const csfFile = cachedCSFFiles[entry.importPath];\n      const story = this.storyFromCSFFile({\n        storyId,\n        csfFile\n      });\n      if (!options.includeDocsOnly && story.parameters.docsOnly) {\n        return acc;\n      }\n      acc[storyId] = Object.entries(story).reduce((storyAcc, [key, value]) => {\n        if (key === \"story\" && entry.subtype === \"test\") {\n          return {\n            ...storyAcc,\n            story: entry.parentName\n          };\n        }\n        if (key === \"moduleExport\") {\n          return storyAcc;\n        }\n        if (typeof value === \"function\") {\n          return storyAcc;\n        }\n        if (Array.isArray(value)) {\n          return Object.assign(storyAcc, {\n            [key]: value.slice().sort()\n          });\n        }\n        return Object.assign(storyAcc, {\n          [key]: value\n        });\n      }, {\n        args: story.initialArgs,\n        globals: {\n          ...this.userGlobals.initialGlobals,\n          ...this.userGlobals.globals,\n          ...story.storyGlobals\n        },\n        storyId: entry.parent ? entry.parent : storyId\n      });\n      return acc;\n    }, {});\n    console.log(\"extract: stories\", stories);\n    return stories;\n  }\n};\n__name(_StoryStore, \"StoryStore\");\nvar StoryStore = _StoryStore;\n\n// src/preview-api/modules/store/autoTitle.ts\nimport { once as once2 } from \"storybook/internal/client-logger\";\n\n// ../node_modules/slash/index.js\nfunction slash(path) {\n  const isExtendedLengthPath = path.startsWith(\"\\\\\\\\?\\\\\");\n  if (isExtendedLengthPath) {\n    return path;\n  }\n  return path.replace(/\\\\/g, \"/\");\n}\n__name(slash, \"slash\");\n\n// src/preview-api/modules/store/autoTitle.ts\nvar sanitize2 = /* @__PURE__ */__name(parts => {\n  if (parts.length === 0) {\n    return parts;\n  }\n  const last = parts[parts.length - 1];\n  const lastStripped = last?.replace(/(?:[.](?:story|stories))?([.][^.]+)$/i, \"\");\n  if (parts.length === 1) {\n    return [lastStripped];\n  }\n  const nextToLast = parts[parts.length - 2];\n  if (lastStripped && nextToLast && lastStripped.toLowerCase() === nextToLast.toLowerCase()) {\n    return [...parts.slice(0, -2), lastStripped];\n  }\n  return lastStripped && (/^(story|stories)([.][^.]+)$/i.test(last) || /^index$/i.test(lastStripped)) ? parts.slice(0, -1) : [...parts.slice(0, -1), lastStripped];\n}, \"sanitize\");\nfunction pathJoin(paths) {\n  return paths.flatMap(p => p.split(\"/\")).filter(Boolean).join(\"/\");\n}\n__name(pathJoin, \"pathJoin\");\nvar userOrAutoTitleFromSpecifier = /* @__PURE__ */__name((fileName, entry, userTitle) => {\n  const {\n    directory,\n    importPathMatcher,\n    titlePrefix = \"\"\n  } = entry || {};\n  if (typeof fileName === \"number\") {\n    once2.warn(dedent`\n      CSF Auto-title received a numeric fileName. This typically happens when\n      webpack is mis-configured in production mode. To force webpack to produce\n      filenames, set optimization.moduleIds = \"named\" in your webpack config.\n    `);\n  }\n  const normalizedFileName = slash(String(fileName));\n  if (importPathMatcher.exec(normalizedFileName)) {\n    if (!userTitle) {\n      const suffix = normalizedFileName.replace(directory, \"\");\n      let parts = pathJoin([titlePrefix, suffix]).split(\"/\");\n      parts = sanitize2(parts);\n      return parts.join(\"/\");\n    }\n    if (!titlePrefix) {\n      return userTitle;\n    }\n    return pathJoin([titlePrefix, userTitle]);\n  }\n  return void 0;\n}, \"userOrAutoTitleFromSpecifier\");\nvar userOrAutoTitle = /* @__PURE__ */__name((fileName, storiesEntries, userTitle) => {\n  for (let i = 0; i < storiesEntries.length; i += 1) {\n    const title = userOrAutoTitleFromSpecifier(fileName, storiesEntries[i], userTitle);\n    if (title) {\n      return title;\n    }\n  }\n  return userTitle || void 0;\n}, \"userOrAutoTitle\");\n\n// src/preview-api/modules/store/storySort.ts\nvar STORY_KIND_PATH_SEPARATOR = /\\s*\\/\\s*/;\nvar storySort = /* @__PURE__ */__name((options = {}) => (a, b) => {\n  if (a.title === b.title && !options.includeNames) {\n    return 0;\n  }\n  const method = options.method || \"configure\";\n  let order = options.order || [];\n  const storyTitleA = a.title.trim().split(STORY_KIND_PATH_SEPARATOR);\n  const storyTitleB = b.title.trim().split(STORY_KIND_PATH_SEPARATOR);\n  if (options.includeNames) {\n    storyTitleA.push(a.name);\n    storyTitleB.push(b.name);\n  }\n  let depth = 0;\n  while (storyTitleA[depth] || storyTitleB[depth]) {\n    if (!storyTitleA[depth]) {\n      return -1;\n    }\n    if (!storyTitleB[depth]) {\n      return 1;\n    }\n    const nameA = storyTitleA[depth];\n    const nameB = storyTitleB[depth];\n    if (nameA !== nameB) {\n      let indexA = order.indexOf(nameA);\n      let indexB = order.indexOf(nameB);\n      const indexWildcard = order.indexOf(\"*\");\n      if (indexA !== -1 || indexB !== -1) {\n        if (indexA === -1) {\n          if (indexWildcard !== -1) {\n            indexA = indexWildcard;\n          } else {\n            indexA = order.length;\n          }\n        }\n        if (indexB === -1) {\n          if (indexWildcard !== -1) {\n            indexB = indexWildcard;\n          } else {\n            indexB = order.length;\n          }\n        }\n        return indexA - indexB;\n      }\n      if (method === \"configure\") {\n        return 0;\n      }\n      return nameA.localeCompare(nameB, options.locales ? options.locales : void 0, {\n        numeric: true,\n        sensitivity: \"accent\"\n      });\n    }\n    let index = order.indexOf(nameA);\n    if (index === -1) {\n      index = order.indexOf(\"*\");\n    }\n    order = index !== -1 && Array.isArray(order[index + 1]) ? order[index + 1] : [];\n    depth += 1;\n  }\n  return 0;\n}, \"storySort\");\n\n// src/preview-api/modules/store/sortStories.ts\nvar sortStoriesCommon = /* @__PURE__ */__name((stories, storySortParameter, fileNameOrder) => {\n  if (storySortParameter) {\n    let sortFn;\n    if (typeof storySortParameter === \"function\") {\n      sortFn = storySortParameter;\n    } else {\n      sortFn = storySort(storySortParameter);\n    }\n    stories.sort(sortFn);\n  } else {\n    stories.sort((s1, s2) => fileNameOrder.indexOf(s1.importPath) - fileNameOrder.indexOf(s2.importPath));\n  }\n  return stories;\n}, \"sortStoriesCommon\");\nvar sortStoriesV7 = /* @__PURE__ */__name((stories, storySortParameter, fileNameOrder) => {\n  try {\n    return sortStoriesCommon(stories, storySortParameter, fileNameOrder);\n  } catch (err) {\n    throw new Error(dedent`\n    Error sorting stories with sort parameter ${storySortParameter}:\n\n    > ${err.message}\n\n    Are you using a V6-style sort function in V7 mode?\n\n    More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#v7-style-story-sort\n  `);\n  }\n}, \"sortStoriesV7\");\n\n// src/preview-api/modules/preview-web/Preview.tsx\nimport { deprecate as deprecate2, logger as logger7 } from \"storybook/internal/client-logger\";\nimport { ARGTYPES_INFO_REQUEST, ARGTYPES_INFO_RESPONSE, CONFIG_ERROR, FORCE_REMOUNT, FORCE_RE_RENDER as FORCE_RE_RENDER2, GLOBALS_UPDATED, PREVIEW_INITIALIZED, RESET_STORY_ARGS as RESET_STORY_ARGS2, SET_GLOBALS, STORY_ARGS_UPDATED, STORY_HOT_UPDATED, STORY_INDEX_INVALIDATED, UPDATE_GLOBALS as UPDATE_GLOBALS2, UPDATE_STORY_ARGS as UPDATE_STORY_ARGS2 } from \"storybook/internal/core-events\";\nimport { CalledPreviewMethodBeforeInitializationError, MissingRenderToCanvasError, StoryIndexFetchError, StoryStoreAccessedBeforeInitializationError } from \"storybook/internal/preview-errors\";\nimport { global as global5 } from \"@storybook/global\";\n\n// src/preview-api/modules/preview-web/render/StoryRender.ts\nimport { PLAY_FUNCTION_THREW_EXCEPTION, STORY_FINISHED, STORY_RENDERED as STORY_RENDERED2, STORY_RENDER_PHASE_CHANGED, UNHANDLED_ERRORS_WHILE_PLAYING } from \"storybook/internal/core-events\";\nimport { MountMustBeDestructuredError as MountMustBeDestructuredError2, NoStoryMountedError } from \"storybook/internal/preview-errors\";\n\n// src/preview-api/modules/preview-web/render/Render.ts\nvar PREPARE_ABORTED = new Error(\"prepareAborted\");\n\n// src/preview-api/modules/preview-web/render/StoryRender.ts\nvar {\n  AbortController: AbortController2\n} = globalThis;\nfunction serializeError(error) {\n  try {\n    const {\n      name = \"Error\",\n      message = String(error),\n      stack\n    } = error;\n    return {\n      name,\n      message,\n      stack\n    };\n  } catch (e) {\n    return {\n      name: \"Error\",\n      message: String(error)\n    };\n  }\n}\n__name(serializeError, \"serializeError\");\nvar _StoryRender = class _StoryRender {\n  constructor(channel, store, renderToScreen, callbacks, id, viewMode, renderOptions = {\n    autoplay: true,\n    forceInitialArgs: false\n  }, story) {\n    this.channel = channel;\n    this.store = store;\n    this.renderToScreen = renderToScreen;\n    this.callbacks = callbacks;\n    this.id = id;\n    this.viewMode = viewMode;\n    this.renderOptions = renderOptions;\n    this.type = \"story\";\n    this.notYetRendered = true;\n    this.rerenderEnqueued = false;\n    this.disableKeyListeners = false;\n    this.teardownRender = /* @__PURE__ */__name(() => {}, \"teardownRender\");\n    this.torndown = false;\n    this.abortController = new AbortController2();\n    this.renderId = Date.now();\n    if (story) {\n      this.story = story;\n      this.phase = \"preparing\";\n    }\n  }\n  runPhase(signal, phase, phaseFn) {\n    var _this0 = this;\n    return _asyncToGenerator(function* () {\n      _this0.phase = phase;\n      _this0.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: _this0.phase,\n        renderId: _this0.renderId,\n        storyId: _this0.id\n      });\n      if (phaseFn) {\n        yield phaseFn();\n        _this0.checkIfAborted(signal);\n      }\n    })();\n  }\n  checkIfAborted(signal) {\n    if (signal.aborted && ![\"finished\", \"aborted\", \"errored\"].includes(this.phase)) {\n      this.phase = \"aborted\";\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: this.phase,\n        renderId: this.renderId,\n        storyId: this.id\n      });\n    }\n    return signal.aborted;\n  }\n  prepare() {\n    var _this1 = this;\n    return _asyncToGenerator(function* () {\n      yield _this1.runPhase(_this1.abortController.signal, \"preparing\", /*#__PURE__*/_asyncToGenerator(function* () {\n        _this1.story = yield _this1.store.loadStory({\n          storyId: _this1.id\n        });\n      }));\n      if (_this1.abortController.signal.aborted) {\n        yield _this1.store.cleanupStory(_this1.story);\n        throw PREPARE_ABORTED;\n      }\n    })();\n  }\n  // The two story \"renders\" are equal and have both loaded the same story\n  isEqual(other) {\n    return !!(this.id === other.id && this.story && this.story === other.story);\n  }\n  isPreparing() {\n    return [\"preparing\"].includes(this.phase);\n  }\n  isPending() {\n    return [\"loading\", \"beforeEach\", \"rendering\", \"playing\", \"afterEach\"].includes(this.phase);\n  }\n  renderToElement(canvasElement) {\n    var _this10 = this;\n    return _asyncToGenerator(function* () {\n      _this10.canvasElement = canvasElement;\n      return _this10.render({\n        initial: true,\n        forceRemount: true\n      });\n    })();\n  }\n  storyContext() {\n    if (!this.story) {\n      throw new Error(`Cannot call storyContext before preparing`);\n    }\n    const {\n      forceInitialArgs\n    } = this.renderOptions;\n    return this.store.getStoryContext(this.story, {\n      forceInitialArgs\n    });\n  }\n  render() {\n    var _this11 = this;\n    return _asyncToGenerator(function* ({\n      initial = false,\n      forceRemount = false\n    } = {}) {\n      const {\n        canvasElement\n      } = _this11;\n      if (!_this11.story) {\n        throw new Error(\"cannot render when not prepared\");\n      }\n      const story = _this11.story;\n      if (!canvasElement) {\n        throw new Error(\"cannot render when canvasElement is unset\");\n      }\n      const {\n        id,\n        componentId,\n        title,\n        name,\n        tags,\n        applyLoaders,\n        applyBeforeEach,\n        applyAfterEach,\n        unboundStoryFn,\n        playFunction,\n        runStep\n      } = story;\n      if (forceRemount && !initial) {\n        _this11.cancelRender();\n        _this11.abortController = new AbortController2();\n      }\n      const abortSignal = _this11.abortController.signal;\n      let mounted = false;\n      const isMountDestructured = story.usesMount;\n      try {\n        const context = {\n          ..._this11.storyContext(),\n          viewMode: _this11.viewMode,\n          abortSignal,\n          canvasElement,\n          loaded: {},\n          step: /* @__PURE__ */__name((label, play) => runStep(label, play, context), \"step\"),\n          context: null,\n          canvas: {},\n          userEvent: {},\n          renderToCanvas: /* @__PURE__ */__name(/*#__PURE__*/_asyncToGenerator(function* () {\n            const teardown = yield _this11.renderToScreen(renderContext, canvasElement);\n            _this11.teardownRender = teardown || (() => {});\n            mounted = true;\n          }), \"renderToCanvas\"),\n          // The story provides (set in a renderer) a mount function that is a higher order function\n          // (context) => (...args) => Canvas\n          //\n          // Before assigning it to the context, we resolve the context dependency,\n          // so that a user can just call it as await mount(...args) in their play function.\n          mount: /* @__PURE__ */__name(/*#__PURE__*/_asyncToGenerator(function* (...args) {\n            _this11.callbacks.showStoryDuringRender?.();\n            let mountReturn = null;\n            yield _this11.runPhase(abortSignal, \"rendering\", /*#__PURE__*/_asyncToGenerator(function* () {\n              mountReturn = yield story.mount(context)(...args);\n            }));\n            if (isMountDestructured) {\n              yield _this11.runPhase(abortSignal, \"playing\");\n            }\n            return mountReturn;\n          }), \"mount\")\n        };\n        context.context = context;\n        const renderContext = {\n          componentId,\n          title,\n          kind: title,\n          id,\n          name,\n          story: name,\n          tags,\n          ..._this11.callbacks,\n          showError: /* @__PURE__ */__name(error => {\n            _this11.phase = \"errored\";\n            return _this11.callbacks.showError(error);\n          }, \"showError\"),\n          showException: /* @__PURE__ */__name(error => {\n            _this11.phase = \"errored\";\n            return _this11.callbacks.showException(error);\n          }, \"showException\"),\n          forceRemount: forceRemount || _this11.notYetRendered,\n          storyContext: context,\n          storyFn: /* @__PURE__ */__name(() => unboundStoryFn(context), \"storyFn\"),\n          unboundStoryFn\n        };\n        yield _this11.runPhase(abortSignal, \"loading\", /*#__PURE__*/_asyncToGenerator(function* () {\n          context.loaded = yield applyLoaders(context);\n        }));\n        if (abortSignal.aborted) {\n          return;\n        }\n        const cleanupCallbacks = yield applyBeforeEach(context);\n        _this11.store.addCleanupCallbacks(story, ...cleanupCallbacks);\n        if (_this11.checkIfAborted(abortSignal)) {\n          return;\n        }\n        if (!mounted && !isMountDestructured) {\n          yield context.mount();\n        }\n        _this11.notYetRendered = false;\n        if (abortSignal.aborted) {\n          return;\n        }\n        const ignoreUnhandledErrors = _this11.story.parameters?.test?.dangerouslyIgnoreUnhandledErrors === true;\n        const unhandledErrors = /* @__PURE__ */new Set();\n        const onError = /* @__PURE__ */__name(event => {\n          if (event.error) {\n            unhandledErrors.add(event.error);\n          }\n        }, \"onError\");\n        const onUnhandledRejection = /* @__PURE__ */__name(event => {\n          if (event.reason) {\n            unhandledErrors.add(event.reason);\n          }\n        }, \"onUnhandledRejection\");\n        if (_this11.renderOptions.autoplay && forceRemount && playFunction && _this11.phase !== \"errored\") {\n          window?.addEventListener?.(\"error\", onError);\n          window?.addEventListener?.(\"unhandledrejection\", onUnhandledRejection);\n          _this11.disableKeyListeners = true;\n          try {\n            if (!isMountDestructured) {\n              context.mount = /*#__PURE__*/_asyncToGenerator(function* () {\n                throw new MountMustBeDestructuredError2({\n                  playFunction: playFunction.toString()\n                });\n              });\n              yield _this11.runPhase(abortSignal, \"playing\", /*#__PURE__*/_asyncToGenerator(function* () {\n                return playFunction(context);\n              }));\n            } else {\n              yield playFunction(context);\n            }\n            if (!mounted) {\n              throw new NoStoryMountedError();\n            }\n            _this11.checkIfAborted(abortSignal);\n            if (!ignoreUnhandledErrors && unhandledErrors.size > 0) {\n              yield _this11.runPhase(abortSignal, \"errored\");\n            } else {\n              yield _this11.runPhase(abortSignal, \"played\");\n            }\n          } catch (error) {\n            _this11.callbacks.showStoryDuringRender?.();\n            yield _this11.runPhase(abortSignal, \"errored\", /*#__PURE__*/_asyncToGenerator(function* () {\n              _this11.channel.emit(PLAY_FUNCTION_THREW_EXCEPTION, serializeError(error));\n            }));\n            if (_this11.story.parameters.throwPlayFunctionExceptions !== false) {\n              throw error;\n            }\n            console.error(error);\n          }\n          if (!ignoreUnhandledErrors && unhandledErrors.size > 0) {\n            _this11.channel.emit(UNHANDLED_ERRORS_WHILE_PLAYING, Array.from(unhandledErrors).map(serializeError));\n          }\n          _this11.disableKeyListeners = false;\n          window?.removeEventListener?.(\"unhandledrejection\", onUnhandledRejection);\n          window?.removeEventListener?.(\"error\", onError);\n          if (abortSignal.aborted) {\n            return;\n          }\n        }\n        yield _this11.runPhase(abortSignal, \"completing\", /*#__PURE__*/_asyncToGenerator(function* () {\n          if (isTestEnvironment()) {\n            _this11.store.addCleanupCallbacks(story, pauseAnimations());\n          } else {\n            yield waitForAnimations(abortSignal);\n          }\n        }));\n        yield _this11.runPhase(abortSignal, \"completed\", /*#__PURE__*/_asyncToGenerator(function* () {\n          _this11.channel.emit(STORY_RENDERED2, id);\n        }));\n        if (_this11.phase !== \"errored\") {\n          yield _this11.runPhase(abortSignal, \"afterEach\", /*#__PURE__*/_asyncToGenerator(function* () {\n            yield applyAfterEach(context);\n          }));\n        }\n        const hasUnhandledErrors = !ignoreUnhandledErrors && unhandledErrors.size > 0;\n        const hasSomeReportsFailed = context.reporting.reports.some(report => report.status === \"failed\");\n        const hasStoryErrored = hasUnhandledErrors || hasSomeReportsFailed;\n        yield _this11.runPhase(abortSignal, \"finished\", /*#__PURE__*/_asyncToGenerator(function* () {\n          return _this11.channel.emit(STORY_FINISHED, {\n            storyId: id,\n            status: hasStoryErrored ? \"error\" : \"success\",\n            reporters: context.reporting.reports\n          });\n        }));\n      } catch (err) {\n        _this11.phase = \"errored\";\n        _this11.callbacks.showException(err);\n        yield _this11.runPhase(abortSignal, \"finished\", /*#__PURE__*/_asyncToGenerator(function* () {\n          return _this11.channel.emit(STORY_FINISHED, {\n            storyId: id,\n            status: \"error\",\n            reporters: []\n          });\n        }));\n      }\n      if (_this11.rerenderEnqueued) {\n        _this11.rerenderEnqueued = false;\n        _this11.render();\n      }\n    }).apply(this, arguments);\n  }\n  /**\n   * Rerender the story. If the story is currently pending (loading/rendering), the rerender will be\n   * enqueued, and will be executed after the current render is completed. Rerendering while playing\n   * will not be enqueued, and will be executed immediately, to support rendering args changes while\n   * playing.\n   */\n  rerender() {\n    var _this12 = this;\n    return _asyncToGenerator(function* () {\n      if (_this12.isPending() && _this12.phase !== \"playing\") {\n        _this12.rerenderEnqueued = true;\n      } else {\n        return _this12.render();\n      }\n    })();\n  }\n  remount() {\n    var _this13 = this;\n    return _asyncToGenerator(function* () {\n      yield _this13.teardown();\n      return _this13.render({\n        forceRemount: true\n      });\n    })();\n  }\n  // If the story is torn down (either a new story is rendered or the docs page removes it)\n  // we need to consider the fact that the initial render may not be finished\n  // (possibly the loaders or the play function are still running). We use the controller\n  // as a method to abort them, ASAP, but this is not foolproof as we cannot control what\n  // happens inside the user's code.\n  cancelRender() {\n    this.abortController.abort();\n  }\n  cancelPlayFunction() {\n    if (this.phase === \"playing\") {\n      this.abortController.abort();\n      this.runPhase(this.abortController.signal, \"aborted\");\n    }\n  }\n  teardown() {\n    var _this14 = this;\n    return _asyncToGenerator(function* () {\n      _this14.torndown = true;\n      _this14.cancelRender();\n      if (_this14.story) {\n        yield _this14.store.cleanupStory(_this14.story);\n      }\n      for (let i = 0; i < 3; i += 1) {\n        if (!_this14.isPending()) {\n          yield _this14.teardownRender();\n          return;\n        }\n        yield new Promise(resolve => setTimeout(resolve, 0));\n      }\n      window?.location?.reload?.();\n      yield new Promise(() => {});\n    })();\n  }\n};\n__name(_StoryRender, \"StoryRender\");\nvar StoryRender = _StoryRender;\n\n// src/preview-api/modules/preview-web/Preview.tsx\nvar {\n  fetch\n} = global5;\nvar STORY_INDEX_PATH = \"./index.json\";\nvar _Preview = class _Preview {\n  constructor(importFn, getProjectAnnotations, channel = addons.getChannel(), shouldInitialize = true) {\n    this.importFn = importFn;\n    this.getProjectAnnotations = getProjectAnnotations;\n    this.channel = channel;\n    this.storyRenders = [];\n    this.storeInitializationPromise = new Promise((resolve, reject) => {\n      this.resolveStoreInitializationPromise = resolve;\n      this.rejectStoreInitializationPromise = reject;\n    });\n    if (shouldInitialize) {\n      this.initialize();\n    }\n  }\n  // Create a proxy object for `__STORYBOOK_STORY_STORE__` and `__STORYBOOK_PREVIEW__.storyStore`\n  // That proxies through to the store once ready, and errors beforehand. This means we can set\n  // `__STORYBOOK_STORY_STORE__ = __STORYBOOK_PREVIEW__.storyStore` without having to wait, and\n  // similarly integrators can access the `storyStore` on the preview at any time, although\n  // it is considered deprecated and we will no longer allow access in 9.0\n  get storyStore() {\n    return new Proxy({}, {\n      get: /* @__PURE__ */__name((_, method) => {\n        if (this.storyStoreValue) {\n          deprecate2(\"Accessing the Story Store is deprecated and will be removed in 9.0\");\n          return this.storyStoreValue[method];\n        }\n        throw new StoryStoreAccessedBeforeInitializationError();\n      }, \"get\")\n    });\n  }\n  // INITIALIZATION\n  initialize() {\n    var _this15 = this;\n    return _asyncToGenerator(function* () {\n      _this15.setupListeners();\n      try {\n        const projectAnnotations = yield _this15.getProjectAnnotationsOrRenderError();\n        yield _this15.runBeforeAllHook(projectAnnotations);\n        yield _this15.initializeWithProjectAnnotations(projectAnnotations);\n        const userAgent = globalThis?.navigator?.userAgent;\n        yield _this15.channel.emit(PREVIEW_INITIALIZED, {\n          userAgent\n        });\n      } catch (err) {\n        _this15.rejectStoreInitializationPromise(err);\n      }\n    })();\n  }\n  ready() {\n    return this.storeInitializationPromise;\n  }\n  setupListeners() {\n    this.channel.on(STORY_INDEX_INVALIDATED, this.onStoryIndexChanged.bind(this));\n    this.channel.on(UPDATE_GLOBALS2, this.onUpdateGlobals.bind(this));\n    this.channel.on(UPDATE_STORY_ARGS2, this.onUpdateArgs.bind(this));\n    this.channel.on(ARGTYPES_INFO_REQUEST, this.onRequestArgTypesInfo.bind(this));\n    this.channel.on(RESET_STORY_ARGS2, this.onResetArgs.bind(this));\n    this.channel.on(FORCE_RE_RENDER2, this.onForceReRender.bind(this));\n    this.channel.on(FORCE_REMOUNT, this.onForceRemount.bind(this));\n    this.channel.on(STORY_HOT_UPDATED, this.onStoryHotUpdated.bind(this));\n  }\n  getProjectAnnotationsOrRenderError() {\n    var _this16 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const projectAnnotations = yield _this16.getProjectAnnotations();\n        _this16.renderToCanvas = projectAnnotations.renderToCanvas;\n        if (!_this16.renderToCanvas) {\n          throw new MissingRenderToCanvasError();\n        }\n        return projectAnnotations;\n      } catch (err) {\n        _this16.renderPreviewEntryError(\"Error reading preview.js:\", err);\n        throw err;\n      }\n    })();\n  }\n  // If initialization gets as far as project annotations, this function runs.\n  initializeWithProjectAnnotations(projectAnnotations) {\n    var _this17 = this;\n    return _asyncToGenerator(function* () {\n      _this17.projectAnnotationsBeforeInitialization = projectAnnotations;\n      try {\n        const storyIndex = yield _this17.getStoryIndexFromServer();\n        return _this17.initializeWithStoryIndex(storyIndex);\n      } catch (err) {\n        _this17.renderPreviewEntryError(\"Error loading story index:\", err);\n        throw err;\n      }\n    })();\n  }\n  runBeforeAllHook(projectAnnotations) {\n    var _this18 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        yield _this18.beforeAllCleanup?.();\n        _this18.beforeAllCleanup = yield projectAnnotations.beforeAll?.();\n      } catch (err) {\n        _this18.renderPreviewEntryError(\"Error in beforeAll hook:\", err);\n        throw err;\n      }\n    })();\n  }\n  getStoryIndexFromServer() {\n    return _asyncToGenerator(function* () {\n      const result = yield fetch(STORY_INDEX_PATH);\n      if (result.status === 200) {\n        return result.json();\n      }\n      throw new StoryIndexFetchError({\n        text: yield result.text()\n      });\n    })();\n  }\n  // If initialization gets as far as the story index, this function runs.\n  initializeWithStoryIndex(storyIndex) {\n    if (!this.projectAnnotationsBeforeInitialization) {\n      throw new Error(\"Cannot call initializeWithStoryIndex until project annotations resolve\");\n    }\n    this.storyStoreValue = new StoryStore(storyIndex, this.importFn, this.projectAnnotationsBeforeInitialization);\n    delete this.projectAnnotationsBeforeInitialization;\n    this.setInitialGlobals();\n    this.resolveStoreInitializationPromise();\n  }\n  setInitialGlobals() {\n    var _this19 = this;\n    return _asyncToGenerator(function* () {\n      _this19.emitGlobals();\n    })();\n  }\n  emitGlobals() {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({\n        methodName: \"emitGlobals\"\n      });\n    }\n    const payload = {\n      globals: this.storyStoreValue.userGlobals.get() || {},\n      globalTypes: this.storyStoreValue.projectAnnotations.globalTypes || {}\n    };\n    this.channel.emit(SET_GLOBALS, payload);\n  }\n  // EVENT HANDLERS\n  // This happens when a config file gets reloaded\n  onGetProjectAnnotationsChanged(_x16) {\n    var _this20 = this;\n    return _asyncToGenerator(function* ({\n      getProjectAnnotations\n    }) {\n      delete _this20.previewEntryError;\n      _this20.getProjectAnnotations = getProjectAnnotations;\n      const projectAnnotations = yield _this20.getProjectAnnotationsOrRenderError();\n      yield _this20.runBeforeAllHook(projectAnnotations);\n      if (!_this20.storyStoreValue) {\n        yield _this20.initializeWithProjectAnnotations(projectAnnotations);\n        return;\n      }\n      _this20.storyStoreValue.setProjectAnnotations(projectAnnotations);\n      _this20.emitGlobals();\n    }).apply(this, arguments);\n  }\n  onStoryIndexChanged() {\n    var _this21 = this;\n    return _asyncToGenerator(function* () {\n      delete _this21.previewEntryError;\n      if (!_this21.storyStoreValue && !_this21.projectAnnotationsBeforeInitialization) {\n        return;\n      }\n      try {\n        const storyIndex = yield _this21.getStoryIndexFromServer();\n        if (_this21.projectAnnotationsBeforeInitialization) {\n          _this21.initializeWithStoryIndex(storyIndex);\n          return;\n        }\n        yield _this21.onStoriesChanged({\n          storyIndex\n        });\n      } catch (err) {\n        _this21.renderPreviewEntryError(\"Error loading story index:\", err);\n        throw err;\n      }\n    })();\n  }\n  // This happens when a glob gets HMR-ed\n  onStoriesChanged(_x17) {\n    var _this22 = this;\n    return _asyncToGenerator(function* ({\n      importFn,\n      storyIndex\n    }) {\n      if (!_this22.storyStoreValue) {\n        throw new CalledPreviewMethodBeforeInitializationError({\n          methodName: \"onStoriesChanged\"\n        });\n      }\n      yield _this22.storyStoreValue.onStoriesChanged({\n        importFn,\n        storyIndex\n      });\n    }).apply(this, arguments);\n  }\n  onUpdateGlobals(_x18) {\n    var _this23 = this;\n    return _asyncToGenerator(function* ({\n      globals: updatedGlobals,\n      currentStory\n    }) {\n      if (!_this23.storyStoreValue) {\n        yield _this23.storeInitializationPromise;\n      }\n      if (!_this23.storyStoreValue) {\n        throw new CalledPreviewMethodBeforeInitializationError({\n          methodName: \"onUpdateGlobals\"\n        });\n      }\n      _this23.storyStoreValue.userGlobals.update(updatedGlobals);\n      if (currentStory) {\n        const {\n          initialGlobals,\n          storyGlobals,\n          userGlobals,\n          globals\n        } = _this23.storyStoreValue.getStoryContext(currentStory);\n        _this23.channel.emit(GLOBALS_UPDATED, {\n          initialGlobals,\n          userGlobals,\n          storyGlobals,\n          globals\n        });\n      } else {\n        const {\n          initialGlobals,\n          globals\n        } = _this23.storyStoreValue.userGlobals;\n        _this23.channel.emit(GLOBALS_UPDATED, {\n          initialGlobals,\n          userGlobals: globals,\n          storyGlobals: {},\n          globals\n        });\n      }\n      yield Promise.all(_this23.storyRenders.map(r => r.rerender()));\n    }).apply(this, arguments);\n  }\n  onUpdateArgs(_x19) {\n    var _this24 = this;\n    return _asyncToGenerator(function* ({\n      storyId,\n      updatedArgs\n    }) {\n      if (!_this24.storyStoreValue) {\n        throw new CalledPreviewMethodBeforeInitializationError({\n          methodName: \"onUpdateArgs\"\n        });\n      }\n      _this24.storyStoreValue.args.update(storyId, updatedArgs);\n      yield Promise.all(_this24.storyRenders.filter(r => r.id === storyId && !r.renderOptions.forceInitialArgs).map(r =>\n      // We only run the play function, with in a force remount.\n      // But when mount is destructured, the rendering happens inside of the play function.\n      r.story && r.story.usesMount ? r.remount() : r.rerender()));\n      _this24.channel.emit(STORY_ARGS_UPDATED, {\n        storyId,\n        args: _this24.storyStoreValue.args.get(storyId)\n      });\n    }).apply(this, arguments);\n  }\n  onRequestArgTypesInfo(_x20) {\n    var _this25 = this;\n    return _asyncToGenerator(function* ({\n      id,\n      payload\n    }) {\n      try {\n        yield _this25.storeInitializationPromise;\n        const story = yield _this25.storyStoreValue?.loadStory(payload);\n        _this25.channel.emit(ARGTYPES_INFO_RESPONSE, {\n          id,\n          success: true,\n          payload: {\n            argTypes: story?.argTypes || {}\n          },\n          error: null\n        });\n      } catch (e) {\n        _this25.channel.emit(ARGTYPES_INFO_RESPONSE, {\n          id,\n          success: false,\n          error: e?.message\n        });\n      }\n    }).apply(this, arguments);\n  }\n  onResetArgs(_x21) {\n    var _this26 = this;\n    return _asyncToGenerator(function* ({\n      storyId,\n      argNames\n    }) {\n      if (!_this26.storyStoreValue) {\n        throw new CalledPreviewMethodBeforeInitializationError({\n          methodName: \"onResetArgs\"\n        });\n      }\n      const render = _this26.storyRenders.find(r => r.id === storyId);\n      const story = render?.story || (yield _this26.storyStoreValue.loadStory({\n        storyId\n      }));\n      const argNamesToReset = argNames || [... /* @__PURE__ */new Set([...Object.keys(story.initialArgs), ...Object.keys(_this26.storyStoreValue.args.get(storyId))])];\n      const updatedArgs = argNamesToReset.reduce((acc, argName) => {\n        acc[argName] = story.initialArgs[argName];\n        return acc;\n      }, {});\n      yield _this26.onUpdateArgs({\n        storyId,\n        updatedArgs\n      });\n    }).apply(this, arguments);\n  }\n  // ForceReRender does not include a story id, so we simply must\n  // re-render all stories in case they are relevant\n  onForceReRender() {\n    var _this27 = this;\n    return _asyncToGenerator(function* () {\n      yield Promise.all(_this27.storyRenders.map(r => r.rerender()));\n    })();\n  }\n  onForceRemount(_x22) {\n    var _this28 = this;\n    return _asyncToGenerator(function* ({\n      storyId\n    }) {\n      yield Promise.all(_this28.storyRenders.filter(r => r.id === storyId).map(r => r.remount()));\n    }).apply(this, arguments);\n  }\n  onStoryHotUpdated() {\n    var _this29 = this;\n    return _asyncToGenerator(function* () {\n      yield Promise.all(_this29.storyRenders.map(r => r.cancelPlayFunction()));\n    })();\n  }\n  // Used by docs to render a story to a given element\n  // Note this short-circuits the `prepare()` phase of the StoryRender,\n  // main to be consistent with the previous behaviour. In the future,\n  // we will change it to go ahead and load the story, which will end up being\n  // \"instant\", although async.\n  renderStoryToElement(story, element, callbacks, options) {\n    var _this30 = this;\n    if (!this.renderToCanvas || !this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({\n        methodName: \"renderStoryToElement\"\n      });\n    }\n    const render = new StoryRender(this.channel, this.storyStoreValue, this.renderToCanvas, callbacks, story.id, \"docs\", options, story);\n    render.renderToElement(element);\n    this.storyRenders.push(render);\n    return /*#__PURE__*/_asyncToGenerator(function* () {\n      yield _this30.teardownRender(render);\n    });\n  }\n  teardownRender(_x23) {\n    var _this31 = this;\n    return _asyncToGenerator(function* (render, {\n      viewModeChanged\n    } = {}) {\n      _this31.storyRenders = _this31.storyRenders.filter(r => r !== render);\n      yield render?.teardown?.({\n        viewModeChanged\n      });\n    }).apply(this, arguments);\n  }\n  // API\n  loadStory(_x24) {\n    var _this32 = this;\n    return _asyncToGenerator(function* ({\n      storyId\n    }) {\n      if (!_this32.storyStoreValue) {\n        throw new CalledPreviewMethodBeforeInitializationError({\n          methodName: \"loadStory\"\n        });\n      }\n      return _this32.storyStoreValue.loadStory({\n        storyId\n      });\n    }).apply(this, arguments);\n  }\n  getStoryContext(story, {\n    forceInitialArgs = false\n  } = {}) {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({\n        methodName: \"getStoryContext\"\n      });\n    }\n    return this.storyStoreValue.getStoryContext(story, {\n      forceInitialArgs\n    });\n  }\n  extract(options) {\n    var _this33 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this33.storyStoreValue) {\n        throw new CalledPreviewMethodBeforeInitializationError({\n          methodName: \"extract\"\n        });\n      }\n      if (_this33.previewEntryError) {\n        throw _this33.previewEntryError;\n      }\n      yield _this33.storyStoreValue.cacheAllCSFFiles();\n      return _this33.storyStoreValue.extract(options);\n    })();\n  }\n  // UTILITIES\n  renderPreviewEntryError(reason, err) {\n    this.previewEntryError = err;\n    logger7.error(reason);\n    logger7.error(err);\n    this.channel.emit(CONFIG_ERROR, err);\n  }\n};\n__name(_Preview, \"Preview\");\nvar Preview = _Preview;\n\n// src/preview-api/modules/preview-web/PreviewWeb.tsx\nimport { global as global8 } from \"@storybook/global\";\n\n// src/preview-api/modules/preview-web/PreviewWithSelection.tsx\nimport { logger as logger8 } from \"storybook/internal/client-logger\";\nimport { CURRENT_STORY_WAS_SET, DOCS_PREPARED, GLOBALS_UPDATED as GLOBALS_UPDATED2, PRELOAD_ENTRIES, PREVIEW_KEYDOWN, SET_CURRENT_STORY, STORY_CHANGED, STORY_ERRORED, STORY_MISSING, STORY_PREPARED, STORY_RENDER_PHASE_CHANGED as STORY_RENDER_PHASE_CHANGED2, STORY_SPECIFIED, STORY_THREW_EXCEPTION, STORY_UNCHANGED, UPDATE_QUERY_PARAMS } from \"storybook/internal/core-events\";\nimport { CalledPreviewMethodBeforeInitializationError as CalledPreviewMethodBeforeInitializationError2, EmptyIndexError, MdxFileWithNoCsfReferencesError, NoStoryMatchError } from \"storybook/internal/preview-errors\";\n\n// src/preview-api/modules/preview-web/render/CsfDocsRender.ts\nimport { DOCS_RENDERED } from \"storybook/internal/core-events\";\n\n// src/preview-api/modules/preview-web/docs-context/DocsContext.ts\nimport { isStory as isStory3 } from \"storybook/internal/csf\";\nvar _DocsContext = class _DocsContext {\n  constructor(channel, store, renderStoryToElement, csfFiles) {\n    this.channel = channel;\n    this.store = store;\n    this.renderStoryToElement = renderStoryToElement;\n    this.storyIdByName = /* @__PURE__ */__name(storyName => {\n      const storyId = this.nameToStoryId.get(storyName);\n      if (storyId) {\n        return storyId;\n      }\n      throw new Error(`No story found with that name: ${storyName}`);\n    }, \"storyIdByName\");\n    this.componentStories = /* @__PURE__ */__name(() => {\n      return this.componentStoriesValue;\n    }, \"componentStories\");\n    this.componentStoriesFromCSFFile = /* @__PURE__ */__name(csfFile => {\n      return this.store.componentStoriesFromCSFFile({\n        csfFile\n      });\n    }, \"componentStoriesFromCSFFile\");\n    this.storyById = /* @__PURE__ */__name(storyId => {\n      if (!storyId) {\n        if (!this.primaryStory) {\n          throw new Error(`No primary story defined for docs entry. Did you forget to use \\`<Meta>\\`?`);\n        }\n        return this.primaryStory;\n      }\n      const csfFile = this.storyIdToCSFFile.get(storyId);\n      if (!csfFile) {\n        throw new Error(`Called \\`storyById\\` for story that was never loaded: ${storyId}`);\n      }\n      return this.store.storyFromCSFFile({\n        storyId,\n        csfFile\n      });\n    }, \"storyById\");\n    this.getStoryContext = /* @__PURE__ */__name(story => {\n      return {\n        ...this.store.getStoryContext(story),\n        loaded: {},\n        viewMode: \"docs\"\n      };\n    }, \"getStoryContext\");\n    this.loadStory = /* @__PURE__ */__name(id => {\n      return this.store.loadStory({\n        storyId: id\n      });\n    }, \"loadStory\");\n    this.componentStoriesValue = [];\n    this.storyIdToCSFFile = /* @__PURE__ */new Map();\n    this.exportToStory = /* @__PURE__ */new Map();\n    this.exportsToCSFFile = /* @__PURE__ */new Map();\n    this.nameToStoryId = /* @__PURE__ */new Map();\n    this.attachedCSFFiles = /* @__PURE__ */new Set();\n    csfFiles.forEach((csfFile, index) => {\n      this.referenceCSFFile(csfFile);\n    });\n  }\n  // This docs entry references this CSF file and can synchronously load the stories, as well\n  // as reference them by module export. If the CSF is part of the \"component\" stories, they\n  // can also be referenced by name and are in the componentStories list.\n  referenceCSFFile(csfFile) {\n    this.exportsToCSFFile.set(csfFile.moduleExports, csfFile);\n    this.exportsToCSFFile.set(csfFile.moduleExports.default, csfFile);\n    const stories = this.store.componentStoriesFromCSFFile({\n      csfFile\n    });\n    stories.forEach(story => {\n      const annotation = csfFile.stories[story.id];\n      this.storyIdToCSFFile.set(annotation.id, csfFile);\n      this.exportToStory.set(annotation.moduleExport, story);\n    });\n  }\n  attachCSFFile(csfFile) {\n    if (!this.exportsToCSFFile.has(csfFile.moduleExports)) {\n      throw new Error(\"Cannot attach a CSF file that has not been referenced\");\n    }\n    if (this.attachedCSFFiles.has(csfFile)) {\n      return;\n    }\n    this.attachedCSFFiles.add(csfFile);\n    const stories = this.store.componentStoriesFromCSFFile({\n      csfFile\n    });\n    stories.forEach(story => {\n      this.nameToStoryId.set(story.name, story.id);\n      this.componentStoriesValue.push(story);\n      if (!this.primaryStory) {\n        this.primaryStory = story;\n      }\n    });\n  }\n  referenceMeta(metaExports, attach) {\n    const resolved = this.resolveModuleExport(metaExports);\n    if (resolved.type !== \"meta\") {\n      throw new Error(\"<Meta of={} /> must reference a CSF file module export or meta export. Did you mistakenly reference your component instead of your CSF file?\");\n    }\n    if (attach) {\n      this.attachCSFFile(resolved.csfFile);\n    }\n  }\n  get projectAnnotations() {\n    const {\n      projectAnnotations\n    } = this.store;\n    if (!projectAnnotations) {\n      throw new Error(\"Can't get projectAnnotations from DocsContext before they are initialized\");\n    }\n    return projectAnnotations;\n  }\n  resolveAttachedModuleExportType(moduleExportType) {\n    if (moduleExportType === \"story\") {\n      if (!this.primaryStory) {\n        throw new Error(`No primary story attached to this docs file, did you forget to use <Meta of={} />?`);\n      }\n      return {\n        type: \"story\",\n        story: this.primaryStory\n      };\n    }\n    if (this.attachedCSFFiles.size === 0) {\n      throw new Error(`No CSF file attached to this docs file, did you forget to use <Meta of={} />?`);\n    }\n    const firstAttachedCSFFile = Array.from(this.attachedCSFFiles)[0];\n    if (moduleExportType === \"meta\") {\n      return {\n        type: \"meta\",\n        csfFile: firstAttachedCSFFile\n      };\n    }\n    const {\n      component\n    } = firstAttachedCSFFile.meta;\n    if (!component) {\n      throw new Error(`Attached CSF file does not defined a component, did you forget to export one?`);\n    }\n    return {\n      type: \"component\",\n      component\n    };\n  }\n  resolveModuleExport(moduleExportOrType) {\n    const csfFile = this.exportsToCSFFile.get(moduleExportOrType);\n    if (csfFile) {\n      return {\n        type: \"meta\",\n        csfFile\n      };\n    }\n    const story = this.exportToStory.get(isStory3(moduleExportOrType) ? moduleExportOrType.input : moduleExportOrType);\n    if (story) {\n      return {\n        type: \"story\",\n        story\n      };\n    }\n    return {\n      type: \"component\",\n      component: moduleExportOrType\n    };\n  }\n  resolveOf(moduleExportOrType, validTypes = []) {\n    let resolved;\n    if ([\"component\", \"meta\", \"story\"].includes(moduleExportOrType)) {\n      const type = moduleExportOrType;\n      resolved = this.resolveAttachedModuleExportType(type);\n    } else {\n      resolved = this.resolveModuleExport(moduleExportOrType);\n    }\n    if (validTypes.length && !validTypes.includes(resolved.type)) {\n      const prettyType = resolved.type === \"component\" ? \"component or unknown\" : resolved.type;\n      throw new Error(dedent`Invalid value passed to the 'of' prop. The value was resolved to a '${prettyType}' type but the only types for this block are: ${validTypes.join(\", \")}.\n        - Did you pass a component to the 'of' prop when the block only supports a story or a meta?\n        - ... or vice versa?\n        - Did you pass a story, CSF file or meta to the 'of' prop that is not indexed, ie. is not targeted by the 'stories' globs in the main configuration?`);\n    }\n    switch (resolved.type) {\n      case \"component\":\n        {\n          return {\n            ...resolved,\n            projectAnnotations: this.projectAnnotations\n          };\n        }\n      case \"meta\":\n        {\n          return {\n            ...resolved,\n            preparedMeta: this.store.preparedMetaFromCSFFile({\n              csfFile: resolved.csfFile\n            })\n          };\n        }\n      case \"story\":\n      default:\n        {\n          return resolved;\n        }\n    }\n  }\n};\n__name(_DocsContext, \"DocsContext\");\nvar DocsContext = _DocsContext;\n\n// src/preview-api/modules/preview-web/render/CsfDocsRender.ts\nvar _CsfDocsRender = class _CsfDocsRender {\n  constructor(channel, store, entry, callbacks) {\n    this.channel = channel;\n    this.store = store;\n    this.entry = entry;\n    this.callbacks = callbacks;\n    this.type = \"docs\";\n    this.subtype = \"csf\";\n    this.torndown = false;\n    this.disableKeyListeners = false;\n    this.preparing = false;\n    this.id = entry.id;\n    this.renderId = Date.now();\n  }\n  isPreparing() {\n    return this.preparing;\n  }\n  prepare() {\n    var _this34 = this;\n    return _asyncToGenerator(function* () {\n      _this34.preparing = true;\n      const {\n        entryExports,\n        csfFiles = []\n      } = yield _this34.store.loadEntry(_this34.id);\n      if (_this34.torndown) {\n        throw PREPARE_ABORTED;\n      }\n      const {\n        importPath,\n        title\n      } = _this34.entry;\n      const primaryCsfFile = _this34.store.processCSFFileWithCache(entryExports, importPath, title);\n      const primaryStoryId = Object.keys(primaryCsfFile.stories)[0];\n      _this34.story = _this34.store.storyFromCSFFile({\n        storyId: primaryStoryId,\n        csfFile: primaryCsfFile\n      });\n      _this34.csfFiles = [primaryCsfFile, ...csfFiles];\n      _this34.preparing = false;\n    })();\n  }\n  isEqual(other) {\n    return !!(this.id === other.id && this.story && this.story === other.story);\n  }\n  docsContext(renderStoryToElement) {\n    if (!this.csfFiles) {\n      throw new Error(\"Cannot render docs before preparing\");\n    }\n    const docsContext = new DocsContext(this.channel, this.store, renderStoryToElement, this.csfFiles);\n    this.csfFiles.forEach(csfFile => docsContext.attachCSFFile(csfFile));\n    return docsContext;\n  }\n  renderToElement(canvasElement, renderStoryToElement) {\n    var _this35 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this35.story || !_this35.csfFiles) {\n        throw new Error(\"Cannot render docs before preparing\");\n      }\n      const docsContext = _this35.docsContext(renderStoryToElement);\n      const {\n        docs: docsParameter\n      } = _this35.story.parameters || {};\n      if (!docsParameter) {\n        throw new Error(`Cannot render a story in viewMode=docs if \\`@storybook/addon-docs\\` is not installed`);\n      }\n      const renderer = yield docsParameter.renderer();\n      const {\n        render\n      } = renderer;\n      const renderDocs = /* @__PURE__ */__name(/*#__PURE__*/_asyncToGenerator(function* () {\n        try {\n          yield render(docsContext, docsParameter, canvasElement);\n          _this35.channel.emit(DOCS_RENDERED, _this35.id);\n        } catch (err) {\n          _this35.callbacks.showException(err);\n        }\n      }), \"renderDocs\");\n      _this35.rerender = /*#__PURE__*/_asyncToGenerator(function* () {\n        return renderDocs();\n      });\n      _this35.teardownRender = /*#__PURE__*/function () {\n        var _ref32 = _asyncToGenerator(function* ({\n          viewModeChanged\n        }) {\n          if (!viewModeChanged || !canvasElement) {\n            return;\n          }\n          renderer.unmount(canvasElement);\n        });\n        return function (_x25) {\n          return _ref32.apply(this, arguments);\n        };\n      }();\n      return renderDocs();\n    })();\n  }\n  teardown() {\n    var _this36 = this;\n    return _asyncToGenerator(function* ({\n      viewModeChanged\n    } = {}) {\n      _this36.teardownRender?.({\n        viewModeChanged\n      });\n      _this36.torndown = true;\n    }).apply(this, arguments);\n  }\n};\n__name(_CsfDocsRender, \"CsfDocsRender\");\nvar CsfDocsRender = _CsfDocsRender;\n\n// src/preview-api/modules/preview-web/render/MdxDocsRender.ts\nimport { DOCS_RENDERED as DOCS_RENDERED2 } from \"storybook/internal/core-events\";\nvar _MdxDocsRender = class _MdxDocsRender {\n  constructor(channel, store, entry, callbacks) {\n    this.channel = channel;\n    this.store = store;\n    this.entry = entry;\n    this.callbacks = callbacks;\n    this.type = \"docs\";\n    this.subtype = \"mdx\";\n    this.torndown = false;\n    this.disableKeyListeners = false;\n    this.preparing = false;\n    this.id = entry.id;\n    this.renderId = Date.now();\n  }\n  isPreparing() {\n    return this.preparing;\n  }\n  prepare() {\n    var _this37 = this;\n    return _asyncToGenerator(function* () {\n      _this37.preparing = true;\n      const {\n        entryExports,\n        csfFiles = []\n      } = yield _this37.store.loadEntry(_this37.id);\n      if (_this37.torndown) {\n        throw PREPARE_ABORTED;\n      }\n      _this37.csfFiles = csfFiles;\n      _this37.exports = entryExports;\n      _this37.preparing = false;\n    })();\n  }\n  isEqual(other) {\n    return !!(this.id === other.id && this.exports && this.exports === other.exports);\n  }\n  docsContext(renderStoryToElement) {\n    if (!this.csfFiles) {\n      throw new Error(\"Cannot render docs before preparing\");\n    }\n    return new DocsContext(this.channel, this.store, renderStoryToElement, this.csfFiles);\n  }\n  renderToElement(canvasElement, renderStoryToElement) {\n    var _this38 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this38.exports || !_this38.csfFiles || !_this38.store.projectAnnotations) {\n        throw new Error(\"Cannot render docs before preparing\");\n      }\n      const docsContext = _this38.docsContext(renderStoryToElement);\n      const {\n        docs\n      } = _this38.store.projectAnnotations.parameters ?? {};\n      if (!docs) {\n        throw new Error(`Cannot render a story in viewMode=docs if \\`@storybook/addon-docs\\` is not installed`);\n      }\n      const docsParameter = {\n        ...docs,\n        page: _this38.exports.default\n      };\n      const renderer = yield docs.renderer();\n      const {\n        render\n      } = renderer;\n      const renderDocs = /* @__PURE__ */__name(/*#__PURE__*/_asyncToGenerator(function* () {\n        try {\n          yield render(docsContext, docsParameter, canvasElement);\n          _this38.channel.emit(DOCS_RENDERED2, _this38.id);\n        } catch (err) {\n          _this38.callbacks.showException(err);\n        }\n      }), \"renderDocs\");\n      _this38.rerender = /*#__PURE__*/_asyncToGenerator(function* () {\n        return renderDocs();\n      });\n      _this38.teardownRender = /*#__PURE__*/_asyncToGenerator(function* ({\n        viewModeChanged\n      } = {}) {\n        if (!viewModeChanged || !canvasElement) {\n          return;\n        }\n        renderer.unmount(canvasElement);\n        _this38.torndown = true;\n      });\n      return renderDocs();\n    })();\n  }\n  teardown() {\n    var _this39 = this;\n    return _asyncToGenerator(function* ({\n      viewModeChanged\n    } = {}) {\n      _this39.teardownRender?.({\n        viewModeChanged\n      });\n      _this39.torndown = true;\n    }).apply(this, arguments);\n  }\n};\n__name(_MdxDocsRender, \"MdxDocsRender\");\nvar MdxDocsRender = _MdxDocsRender;\n\n// src/preview-api/modules/preview-web/PreviewWithSelection.tsx\nvar globalWindow = globalThis;\nfunction focusInInput(event) {\n  const target = event.composedPath && event.composedPath()[0] || event.target;\n  return /input|textarea/i.test(target.tagName) || target.getAttribute(\"contenteditable\") !== null;\n}\n__name(focusInInput, \"focusInInput\");\nvar ATTACHED_MDX_TAG = \"attached-mdx\";\nvar UNATTACHED_MDX_TAG = \"unattached-mdx\";\nfunction isMdxEntry({\n  tags\n}) {\n  return tags?.includes(UNATTACHED_MDX_TAG) || tags?.includes(ATTACHED_MDX_TAG);\n}\n__name(isMdxEntry, \"isMdxEntry\");\nfunction isStoryRender(r) {\n  return r.type === \"story\";\n}\n__name(isStoryRender, \"isStoryRender\");\nfunction isDocsRender(r) {\n  return r.type === \"docs\";\n}\n__name(isDocsRender, \"isDocsRender\");\nfunction isCsfDocsRender(r) {\n  return isDocsRender(r) && r.subtype === \"csf\";\n}\n__name(isCsfDocsRender, \"isCsfDocsRender\");\nvar _PreviewWithSelection = class _PreviewWithSelection extends Preview {\n  constructor(importFn, getProjectAnnotations, selectionStore, view) {\n    super(importFn, getProjectAnnotations, void 0, false);\n    this.importFn = importFn;\n    this.getProjectAnnotations = getProjectAnnotations;\n    this.selectionStore = selectionStore;\n    this.view = view;\n    this.initialize();\n  }\n  setupListeners() {\n    super.setupListeners();\n    globalWindow.onkeydown = this.onKeydown.bind(this);\n    this.channel.on(SET_CURRENT_STORY, this.onSetCurrentStory.bind(this));\n    this.channel.on(UPDATE_QUERY_PARAMS, this.onUpdateQueryParams.bind(this));\n    this.channel.on(PRELOAD_ENTRIES, this.onPreloadStories.bind(this));\n  }\n  setInitialGlobals() {\n    var _this40 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this40.storyStoreValue) {\n        throw new CalledPreviewMethodBeforeInitializationError2({\n          methodName: \"setInitialGlobals\"\n        });\n      }\n      const {\n        globals\n      } = _this40.selectionStore.selectionSpecifier || {};\n      if (globals) {\n        _this40.storyStoreValue.userGlobals.updateFromPersisted(globals);\n      }\n      _this40.emitGlobals();\n    })();\n  }\n  // If initialization gets as far as the story index, this function runs.\n  initializeWithStoryIndex(storyIndex) {\n    var _superprop_getInitializeWithStoryIndex = () => super.initializeWithStoryIndex,\n      _this41 = this;\n    return _asyncToGenerator(function* () {\n      yield _superprop_getInitializeWithStoryIndex().call(_this41, storyIndex);\n      return _this41.selectSpecifiedStory();\n    })();\n  }\n  // Use the selection specifier to choose a story, then render it\n  selectSpecifiedStory() {\n    var _this42 = this;\n    return _asyncToGenerator(function* () {\n      if (!_this42.storyStoreValue) {\n        throw new CalledPreviewMethodBeforeInitializationError2({\n          methodName: \"selectSpecifiedStory\"\n        });\n      }\n      if (_this42.selectionStore.selection) {\n        yield _this42.renderSelection();\n        return;\n      }\n      if (!_this42.selectionStore.selectionSpecifier) {\n        _this42.renderMissingStory();\n        return;\n      }\n      const {\n        storySpecifier,\n        args\n      } = _this42.selectionStore.selectionSpecifier;\n      const entry = _this42.storyStoreValue.storyIndex.entryFromSpecifier(storySpecifier);\n      if (!entry) {\n        if (storySpecifier === \"*\") {\n          _this42.renderStoryLoadingException(storySpecifier, new EmptyIndexError());\n        } else {\n          _this42.renderStoryLoadingException(storySpecifier, new NoStoryMatchError({\n            storySpecifier: storySpecifier.toString()\n          }));\n        }\n        return;\n      }\n      const {\n        id: storyId,\n        type: viewMode\n      } = entry;\n      _this42.selectionStore.setSelection({\n        storyId,\n        viewMode\n      });\n      _this42.channel.emit(STORY_SPECIFIED, _this42.selectionStore.selection);\n      _this42.channel.emit(CURRENT_STORY_WAS_SET, _this42.selectionStore.selection);\n      yield _this42.renderSelection({\n        persistedArgs: args\n      });\n    })();\n  }\n  // EVENT HANDLERS\n  // This happens when a config file gets reloaded\n  onGetProjectAnnotationsChanged(_x26) {\n    var _superprop_getOnGetProjectAnnotationsChanged = () => super.onGetProjectAnnotationsChanged,\n      _this43 = this;\n    return _asyncToGenerator(function* ({\n      getProjectAnnotations\n    }) {\n      yield _superprop_getOnGetProjectAnnotationsChanged().call(_this43, {\n        getProjectAnnotations\n      });\n      if (_this43.selectionStore.selection) {\n        _this43.renderSelection();\n      }\n    }).apply(this, arguments);\n  }\n  // This happens when a glob gets HMR-ed\n  onStoriesChanged(_x27) {\n    var _superprop_getOnStoriesChanged = () => super.onStoriesChanged,\n      _this44 = this;\n    return _asyncToGenerator(function* ({\n      importFn,\n      storyIndex\n    }) {\n      yield _superprop_getOnStoriesChanged().call(_this44, {\n        importFn,\n        storyIndex\n      });\n      if (_this44.selectionStore.selection) {\n        yield _this44.renderSelection();\n      } else {\n        yield _this44.selectSpecifiedStory();\n      }\n    }).apply(this, arguments);\n  }\n  onKeydown(event) {\n    if (!this.storyRenders.find(r => r.disableKeyListeners) && !focusInInput(event)) {\n      const {\n        altKey,\n        ctrlKey,\n        metaKey,\n        shiftKey,\n        key,\n        code,\n        keyCode\n      } = event;\n      this.channel.emit(PREVIEW_KEYDOWN, {\n        event: {\n          altKey,\n          ctrlKey,\n          metaKey,\n          shiftKey,\n          key,\n          code,\n          keyCode\n        }\n      });\n    }\n  }\n  onSetCurrentStory(selection) {\n    var _this45 = this;\n    return _asyncToGenerator(function* () {\n      _this45.selectionStore.setSelection({\n        viewMode: \"story\",\n        ...selection\n      });\n      yield _this45.storeInitializationPromise;\n      _this45.channel.emit(CURRENT_STORY_WAS_SET, _this45.selectionStore.selection);\n      _this45.renderSelection();\n    })();\n  }\n  onUpdateQueryParams(queryParams) {\n    this.selectionStore.setQueryParams(queryParams);\n  }\n  onUpdateGlobals(_x28) {\n    var _superprop_getOnUpdateGlobals = () => super.onUpdateGlobals,\n      _this46 = this;\n    return _asyncToGenerator(function* ({\n      globals\n    }) {\n      const currentStory = _this46.currentRender instanceof StoryRender && _this46.currentRender.story || void 0;\n      _superprop_getOnUpdateGlobals().call(_this46, {\n        globals,\n        currentStory\n      });\n      if (_this46.currentRender instanceof MdxDocsRender || _this46.currentRender instanceof CsfDocsRender) {\n        yield _this46.currentRender.rerender?.();\n      }\n    }).apply(this, arguments);\n  }\n  onUpdateArgs(_x29) {\n    var _superprop_getOnUpdateArgs = () => super.onUpdateArgs,\n      _this47 = this;\n    return _asyncToGenerator(function* ({\n      storyId,\n      updatedArgs\n    }) {\n      _superprop_getOnUpdateArgs().call(_this47, {\n        storyId,\n        updatedArgs\n      });\n    }).apply(this, arguments);\n  }\n  onPreloadStories(_x30) {\n    var _this48 = this;\n    return _asyncToGenerator(function* ({\n      ids\n    }) {\n      yield _this48.storeInitializationPromise;\n      if (_this48.storyStoreValue) {\n        yield Promise.allSettled(ids.map(id => _this48.storyStoreValue?.loadEntry(id)));\n      }\n    }).apply(this, arguments);\n  }\n  // RENDERING\n  // We can either have:\n  // - a story selected in \"story\" viewMode,\n  //     in which case we render it to the root element, OR\n  // - a story selected in \"docs\" viewMode,\n  //     in which case we render the docsPage for that story\n  renderSelection() {\n    var _this49 = this;\n    return _asyncToGenerator(function* ({\n      persistedArgs\n    } = {}) {\n      const {\n        renderToCanvas\n      } = _this49;\n      if (!_this49.storyStoreValue || !renderToCanvas) {\n        throw new CalledPreviewMethodBeforeInitializationError2({\n          methodName: \"renderSelection\"\n        });\n      }\n      const {\n        selection\n      } = _this49.selectionStore;\n      if (!selection) {\n        throw new Error(\"Cannot call renderSelection as no selection was made\");\n      }\n      const {\n        storyId\n      } = selection;\n      let entry;\n      try {\n        entry = yield _this49.storyStoreValue.storyIdToEntry(storyId);\n      } catch (err) {\n        if (_this49.currentRender) {\n          yield _this49.teardownRender(_this49.currentRender);\n        }\n        _this49.renderStoryLoadingException(storyId, err);\n        return;\n      }\n      const storyIdChanged = _this49.currentSelection?.storyId !== storyId;\n      const viewModeChanged = _this49.currentRender?.type !== entry.type;\n      if (entry.type === \"story\") {\n        _this49.view.showPreparingStory({\n          immediate: viewModeChanged\n        });\n      } else {\n        _this49.view.showPreparingDocs({\n          immediate: viewModeChanged\n        });\n      }\n      if (_this49.currentRender?.isPreparing()) {\n        yield _this49.teardownRender(_this49.currentRender);\n      }\n      let render;\n      if (entry.type === \"story\") {\n        render = new StoryRender(_this49.channel, _this49.storyStoreValue, renderToCanvas, _this49.mainStoryCallbacks(storyId), storyId, \"story\");\n      } else if (isMdxEntry(entry)) {\n        render = new MdxDocsRender(_this49.channel, _this49.storyStoreValue, entry, _this49.mainStoryCallbacks(storyId));\n      } else {\n        render = new CsfDocsRender(_this49.channel, _this49.storyStoreValue, entry, _this49.mainStoryCallbacks(storyId));\n      }\n      const lastSelection = _this49.currentSelection;\n      _this49.currentSelection = selection;\n      const lastRender = _this49.currentRender;\n      _this49.currentRender = render;\n      try {\n        yield render.prepare();\n      } catch (err) {\n        if (lastRender) {\n          yield _this49.teardownRender(lastRender);\n        }\n        if (err !== PREPARE_ABORTED) {\n          _this49.renderStoryLoadingException(storyId, err);\n        }\n        return;\n      }\n      const implementationChanged = !storyIdChanged && lastRender && !render.isEqual(lastRender);\n      if (persistedArgs && isStoryRender(render)) {\n        invariant(!!render.story);\n        _this49.storyStoreValue.args.updateFromPersisted(render.story, persistedArgs);\n      }\n      if (lastRender && !lastRender.torndown && !storyIdChanged && !implementationChanged && !viewModeChanged) {\n        _this49.currentRender = lastRender;\n        _this49.channel.emit(STORY_UNCHANGED, storyId);\n        _this49.view.showMain();\n        return;\n      }\n      if (lastRender) {\n        yield _this49.teardownRender(lastRender, {\n          viewModeChanged\n        });\n      }\n      if (lastSelection && (storyIdChanged || viewModeChanged)) {\n        _this49.channel.emit(STORY_CHANGED, storyId);\n      }\n      if (isStoryRender(render)) {\n        invariant(!!render.story);\n        const {\n          parameters,\n          initialArgs,\n          argTypes,\n          unmappedArgs,\n          initialGlobals,\n          userGlobals,\n          storyGlobals,\n          globals\n        } = _this49.storyStoreValue.getStoryContext(render.story);\n        _this49.channel.emit(STORY_PREPARED, {\n          id: storyId,\n          parameters,\n          initialArgs,\n          argTypes,\n          args: unmappedArgs\n        });\n        _this49.channel.emit(GLOBALS_UPDATED2, {\n          userGlobals,\n          storyGlobals,\n          globals,\n          initialGlobals\n        });\n      } else {\n        let {\n          parameters\n        } = _this49.storyStoreValue.projectAnnotations;\n        const {\n          initialGlobals,\n          globals\n        } = _this49.storyStoreValue.userGlobals;\n        _this49.channel.emit(GLOBALS_UPDATED2, {\n          globals,\n          initialGlobals,\n          storyGlobals: {},\n          userGlobals: globals\n        });\n        if (isCsfDocsRender(render) || render.entry.tags?.includes(ATTACHED_MDX_TAG)) {\n          if (!render.csfFiles) {\n            throw new MdxFileWithNoCsfReferencesError({\n              storyId\n            });\n          }\n          ({\n            parameters\n          } = _this49.storyStoreValue.preparedMetaFromCSFFile({\n            csfFile: render.csfFiles[0]\n          }));\n        }\n        _this49.channel.emit(DOCS_PREPARED, {\n          id: storyId,\n          parameters\n        });\n      }\n      if (isStoryRender(render)) {\n        invariant(!!render.story);\n        _this49.storyRenders.push(render);\n        _this49.currentRender.renderToElement(_this49.view.prepareForStory(render.story));\n      } else {\n        _this49.currentRender.renderToElement(_this49.view.prepareForDocs(),\n        // This argument is used for docs, which is currently only compatible with HTMLElements\n        _this49.renderStoryToElement.bind(_this49));\n      }\n    }).apply(this, arguments);\n  }\n  teardownRender(_x31) {\n    var _this50 = this;\n    return _asyncToGenerator(function* (render, {\n      viewModeChanged = false\n    } = {}) {\n      _this50.storyRenders = _this50.storyRenders.filter(r => r !== render);\n      yield render?.teardown?.({\n        viewModeChanged\n      });\n    }).apply(this, arguments);\n  }\n  // UTILITIES\n  mainStoryCallbacks(storyId) {\n    return {\n      showStoryDuringRender: /* @__PURE__ */__name(() => this.view.showStoryDuringRender(), \"showStoryDuringRender\"),\n      showMain: /* @__PURE__ */__name(() => this.view.showMain(), \"showMain\"),\n      showError: /* @__PURE__ */__name(err => this.renderError(storyId, err), \"showError\"),\n      showException: /* @__PURE__ */__name(err => this.renderException(storyId, err), \"showException\")\n    };\n  }\n  renderPreviewEntryError(reason, err) {\n    super.renderPreviewEntryError(reason, err);\n    this.view.showErrorDisplay(err);\n  }\n  renderMissingStory() {\n    this.view.showNoPreview();\n    this.channel.emit(STORY_MISSING);\n  }\n  renderStoryLoadingException(storySpecifier, err) {\n    logger8.error(err);\n    this.view.showErrorDisplay(err);\n    this.channel.emit(STORY_MISSING, storySpecifier);\n  }\n  // renderException is used if we fail to render the story and it is uncaught by the app layer\n  renderException(storyId, error) {\n    const {\n      name = \"Error\",\n      message = String(error),\n      stack\n    } = error;\n    const renderId = this.currentRender?.renderId;\n    this.channel.emit(STORY_THREW_EXCEPTION, {\n      name,\n      message,\n      stack\n    });\n    this.channel.emit(STORY_RENDER_PHASE_CHANGED2, {\n      newPhase: \"errored\",\n      renderId,\n      storyId\n    });\n    this.view.showErrorDisplay(error);\n    logger8.error(`Error rendering story '${storyId}':`);\n    logger8.error(error);\n  }\n  // renderError is used by the various app layers to inform the user they have done something\n  // wrong -- for instance returned the wrong thing from a story\n  renderError(storyId, {\n    title,\n    description\n  }) {\n    const renderId = this.currentRender?.renderId;\n    this.channel.emit(STORY_ERRORED, {\n      title,\n      description\n    });\n    this.channel.emit(STORY_RENDER_PHASE_CHANGED2, {\n      newPhase: \"errored\",\n      renderId,\n      storyId\n    });\n    this.view.showErrorDisplay({\n      message: title,\n      stack: description\n    });\n    logger8.error(`Error rendering story ${title}: ${description}`);\n  }\n};\n__name(_PreviewWithSelection, \"PreviewWithSelection\");\nvar PreviewWithSelection = _PreviewWithSelection;\n\n// src/preview-api/modules/preview-web/UrlStore.ts\nvar import_picoquery2 = __toESM(require_main(), 1);\nimport { global as global6 } from \"@storybook/global\";\n\n// src/preview-api/modules/preview-web/parseArgsParam.ts\nimport { once as once3 } from \"storybook/internal/client-logger\";\nvar import_picoquery = __toESM(require_main(), 1);\nvar VALIDATION_REGEXP = /^[a-zA-Z0-9 _-]*$/;\nvar NUMBER_REGEXP = /^-?[0-9]+(\\.[0-9]+)?$/;\nvar HEX_REGEXP = /^#([a-f0-9]{3,4}|[a-f0-9]{6}|[a-f0-9]{8})$/i;\nvar COLOR_REGEXP = /^(rgba?|hsla?)\\(([0-9]{1,3}),\\s?([0-9]{1,3})%?,\\s?([0-9]{1,3})%?,?\\s?([0-9](\\.[0-9]{1,2})?)?\\)$/i;\nvar validateArgs = /* @__PURE__ */__name((key = \"\", value) => {\n  if (key === null) {\n    return false;\n  }\n  if (key === \"\" || !VALIDATION_REGEXP.test(key)) {\n    return false;\n  }\n  if (value === null || value === void 0) {\n    return true;\n  }\n  if (value instanceof Date) {\n    return true;\n  }\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return true;\n  }\n  if (typeof value === \"string\") {\n    return VALIDATION_REGEXP.test(value) || NUMBER_REGEXP.test(value) || HEX_REGEXP.test(value) || COLOR_REGEXP.test(value);\n  }\n  if (Array.isArray(value)) {\n    return value.every(v => validateArgs(key, v));\n  }\n  if (isPlainObject(value)) {\n    return Object.entries(value).every(([k, v]) => validateArgs(k, v));\n  }\n  return false;\n}, \"validateArgs\");\nvar QUERY_OPTIONS = {\n  delimiter: \";\",\n  // we're parsing a single query param\n  nesting: true,\n  arrayRepeat: true,\n  arrayRepeatSyntax: \"bracket\",\n  nestingSyntax: \"js\",\n  // objects are encoded using dot notation\n  valueDeserializer(str) {\n    if (str.startsWith(\"!\")) {\n      if (str === \"!undefined\") {\n        return void 0;\n      }\n      if (str === \"!null\") {\n        return null;\n      }\n      if (str === \"!true\") {\n        return true;\n      }\n      if (str === \"!false\") {\n        return false;\n      }\n      if (str.startsWith(\"!date(\") && str.endsWith(\")\")) {\n        return new Date(str.replaceAll(\" \", \"+\").slice(6, -1));\n      }\n      if (str.startsWith(\"!hex(\") && str.endsWith(\")\")) {\n        return `#${str.slice(5, -1)}`;\n      }\n      const color = str.slice(1).match(COLOR_REGEXP);\n      if (color) {\n        if (str.startsWith(\"!rgba\") || str.startsWith(\"!RGBA\")) {\n          return `${color[1]}(${color[2]}, ${color[3]}, ${color[4]}, ${color[5]})`;\n        }\n        if (str.startsWith(\"!hsla\") || str.startsWith(\"!HSLA\")) {\n          return `${color[1]}(${color[2]}, ${color[3]}%, ${color[4]}%, ${color[5]})`;\n        }\n        return str.startsWith(\"!rgb\") || str.startsWith(\"!RGB\") ? `${color[1]}(${color[2]}, ${color[3]}, ${color[4]})` : `${color[1]}(${color[2]}, ${color[3]}%, ${color[4]}%)`;\n      }\n    }\n    if (NUMBER_REGEXP.test(str)) {\n      return Number(str);\n    }\n    return str;\n  }\n};\nvar parseArgsParam = /* @__PURE__ */__name(argsString => {\n  const parts = argsString.split(\";\").map(part => part.replace(\"=\", \"~\").replace(\":\", \"=\"));\n  return Object.entries((0, import_picoquery.parse)(parts.join(\";\"), QUERY_OPTIONS)).reduce((acc, [key, value]) => {\n    if (validateArgs(key, value)) {\n      return Object.assign(acc, {\n        [key]: value\n      });\n    }\n    once3.warn(dedent`\n      Omitted potentially unsafe URL args.\n\n      More info: https://storybook.js.org/docs/writing-stories/args#setting-args-through-the-url?ref=error\n    `);\n    return acc;\n  }, {});\n}, \"parseArgsParam\");\n\n// src/preview-api/modules/preview-web/UrlStore.ts\nvar {\n  history,\n  document: document2\n} = global6;\nfunction pathToId(path) {\n  const match = (path || \"\").match(/^\\/story\\/(.+)/);\n  if (!match) {\n    throw new Error(`Invalid path '${path}',  must start with '/story/'`);\n  }\n  return match[1];\n}\n__name(pathToId, \"pathToId\");\nvar getQueryString = /* @__PURE__ */__name(({\n  selection,\n  extraParams\n}) => {\n  const search = document2?.location.search.slice(1);\n  const {\n    path,\n    selectedKind,\n    selectedStory,\n    ...rest\n  } = (0, import_picoquery2.parse)(search);\n  const queryStr = (0, import_picoquery2.stringify)({\n    ...rest,\n    ...extraParams,\n    ...(selection && {\n      id: selection.storyId,\n      viewMode: selection.viewMode\n    })\n  });\n  return `?${queryStr}`;\n}, \"getQueryString\");\nvar setPath = /* @__PURE__ */__name(selection => {\n  if (!selection) {\n    return;\n  }\n  const query = getQueryString({\n    selection\n  });\n  const {\n    hash = \"\"\n  } = document2.location;\n  document2.title = selection.storyId;\n  history.replaceState({}, \"\", `${document2.location.pathname}${query}${hash}`);\n}, \"setPath\");\nvar isObject = /* @__PURE__ */__name(val => val != null && typeof val === \"object\" && Array.isArray(val) === false, \"isObject\");\nvar getFirstString = /* @__PURE__ */__name(v => {\n  if (v === void 0) {\n    return void 0;\n  }\n  if (typeof v === \"string\") {\n    return v;\n  }\n  if (Array.isArray(v)) {\n    return getFirstString(v[0]);\n  }\n  if (isObject(v)) {\n    return getFirstString(Object.values(v).filter(Boolean));\n  }\n  return void 0;\n}, \"getFirstString\");\nvar getSelectionSpecifierFromPath = /* @__PURE__ */__name(() => {\n  if (typeof document2 !== \"undefined\") {\n    const queryStr = document2.location.search.slice(1);\n    const query = (0, import_picoquery2.parse)(queryStr);\n    const args = typeof query.args === \"string\" ? parseArgsParam(query.args) : void 0;\n    const globals = typeof query.globals === \"string\" ? parseArgsParam(query.globals) : void 0;\n    let viewMode = getFirstString(query.viewMode);\n    if (typeof viewMode !== \"string\" || !viewMode.match(/docs|story/)) {\n      viewMode = \"story\";\n    }\n    const path = getFirstString(query.path);\n    const storyId = path ? pathToId(path) : getFirstString(query.id);\n    if (storyId) {\n      return {\n        storySpecifier: storyId,\n        args,\n        globals,\n        viewMode\n      };\n    }\n  }\n  return null;\n}, \"getSelectionSpecifierFromPath\");\nvar _UrlStore = class _UrlStore {\n  constructor() {\n    this.selectionSpecifier = getSelectionSpecifierFromPath();\n  }\n  setSelection(selection) {\n    this.selection = selection;\n    setPath(this.selection);\n  }\n  setQueryParams(queryParams) {\n    const query = getQueryString({\n      extraParams: queryParams\n    });\n    const {\n      hash = \"\"\n    } = document2.location;\n    history.replaceState({}, \"\", `${document2.location.pathname}${query}${hash}`);\n  }\n};\n__name(_UrlStore, \"UrlStore\");\nvar UrlStore = _UrlStore;\n\n// src/preview-api/modules/preview-web/WebView.ts\nvar import_ansi_to_html = __toESM(require_ansi_to_html(), 1);\nvar import_picoquery3 = __toESM(require_main(), 1);\nimport { logger as logger9 } from \"storybook/internal/client-logger\";\nimport { global as global7 } from \"@storybook/global\";\nvar {\n  document: document3\n} = global7;\nvar PREPARING_DELAY = 100;\nvar Mode = /* @__PURE__ */(Mode2 => {\n  Mode2[\"MAIN\"] = \"MAIN\";\n  Mode2[\"NOPREVIEW\"] = \"NOPREVIEW\";\n  Mode2[\"PREPARING_STORY\"] = \"PREPARING_STORY\";\n  Mode2[\"PREPARING_DOCS\"] = \"PREPARING_DOCS\";\n  Mode2[\"ERROR\"] = \"ERROR\";\n  return Mode2;\n})(Mode || {});\nvar classes = {\n  PREPARING_STORY: \"sb-show-preparing-story\",\n  PREPARING_DOCS: \"sb-show-preparing-docs\",\n  MAIN: \"sb-show-main\",\n  NOPREVIEW: \"sb-show-nopreview\",\n  ERROR: \"sb-show-errordisplay\"\n};\nvar layoutClassMap = {\n  centered: \"sb-main-centered\",\n  fullscreen: \"sb-main-fullscreen\",\n  padded: \"sb-main-padded\"\n};\nvar ansiConverter = new import_ansi_to_html.default({\n  escapeXML: true\n});\nvar _WebView = class _WebView {\n  constructor() {\n    this.testing = false;\n    if (typeof document3 !== \"undefined\") {\n      const {\n        __SPECIAL_TEST_PARAMETER__\n      } = (0, import_picoquery3.parse)(document3.location.search.slice(1));\n      switch (__SPECIAL_TEST_PARAMETER__) {\n        case \"preparing-story\":\n          {\n            this.showPreparingStory();\n            this.testing = true;\n            break;\n          }\n        case \"preparing-docs\":\n          {\n            this.showPreparingDocs();\n            this.testing = true;\n            break;\n          }\n        default:\n      }\n    }\n  }\n  // Get ready to render a story, returning the element to render to\n  prepareForStory(story) {\n    this.showStory();\n    this.applyLayout(story.parameters.layout);\n    document3.documentElement.scrollTop = 0;\n    document3.documentElement.scrollLeft = 0;\n    return this.storyRoot();\n  }\n  storyRoot() {\n    return document3.getElementById(\"storybook-root\");\n  }\n  prepareForDocs() {\n    this.showMain();\n    this.showDocs();\n    this.applyLayout(\"fullscreen\");\n    document3.documentElement.scrollTop = 0;\n    document3.documentElement.scrollLeft = 0;\n    return this.docsRoot();\n  }\n  docsRoot() {\n    return document3.getElementById(\"storybook-docs\");\n  }\n  applyLayout(layout = \"padded\") {\n    if (layout === \"none\") {\n      document3.body.classList.remove(this.currentLayoutClass);\n      this.currentLayoutClass = null;\n      return;\n    }\n    this.checkIfLayoutExists(layout);\n    const layoutClass = layoutClassMap[layout];\n    document3.body.classList.remove(this.currentLayoutClass);\n    document3.body.classList.add(layoutClass);\n    this.currentLayoutClass = layoutClass;\n  }\n  checkIfLayoutExists(layout) {\n    if (!layoutClassMap[layout]) {\n      logger9.warn(dedent`\n          The desired layout: ${layout} is not a valid option.\n          The possible options are: ${Object.keys(layoutClassMap).join(\", \")}, none.\n        `);\n    }\n  }\n  showMode(mode) {\n    clearTimeout(this.preparingTimeout);\n    Object.keys(Mode).forEach(otherMode => {\n      if (otherMode === mode) {\n        document3.body.classList.add(classes[otherMode]);\n      } else {\n        document3.body.classList.remove(classes[otherMode]);\n      }\n    });\n  }\n  showErrorDisplay({\n    message = \"\",\n    stack = \"\"\n  }) {\n    let header = message;\n    let detail = stack;\n    const parts = message.split(\"\\n\");\n    if (parts.length > 1) {\n      [header] = parts;\n      detail = parts.slice(1).join(\"\\n\").replace(/^\\n/, \"\");\n    }\n    document3.getElementById(\"error-message\").innerHTML = ansiConverter.toHtml(header);\n    document3.getElementById(\"error-stack\").innerHTML = ansiConverter.toHtml(detail);\n    this.showMode(\"ERROR\" /* ERROR */);\n  }\n  showNoPreview() {\n    if (this.testing) {\n      return;\n    }\n    this.showMode(\"NOPREVIEW\" /* NOPREVIEW */);\n    this.storyRoot()?.setAttribute(\"hidden\", \"true\");\n    this.docsRoot()?.setAttribute(\"hidden\", \"true\");\n  }\n  showPreparingStory({\n    immediate = false\n  } = {}) {\n    clearTimeout(this.preparingTimeout);\n    if (immediate) {\n      this.showMode(\"PREPARING_STORY\" /* PREPARING_STORY */);\n    } else {\n      this.preparingTimeout = setTimeout(() => this.showMode(\"PREPARING_STORY\" /* PREPARING_STORY */), PREPARING_DELAY);\n    }\n  }\n  showPreparingDocs({\n    immediate = false\n  } = {}) {\n    clearTimeout(this.preparingTimeout);\n    if (immediate) {\n      this.showMode(\"PREPARING_DOCS\" /* PREPARING_DOCS */);\n    } else {\n      this.preparingTimeout = setTimeout(() => this.showMode(\"PREPARING_DOCS\" /* PREPARING_DOCS */), PREPARING_DELAY);\n    }\n  }\n  showMain() {\n    this.showMode(\"MAIN\" /* MAIN */);\n  }\n  showDocs() {\n    this.storyRoot().setAttribute(\"hidden\", \"true\");\n    this.docsRoot().removeAttribute(\"hidden\");\n  }\n  showStory() {\n    this.docsRoot().setAttribute(\"hidden\", \"true\");\n    this.storyRoot().removeAttribute(\"hidden\");\n  }\n  showStoryDuringRender() {\n    document3.body.classList.add(classes.MAIN);\n  }\n};\n__name(_WebView, \"WebView\");\nvar WebView = _WebView;\n\n// src/preview-api/modules/preview-web/PreviewWeb.tsx\nvar _PreviewWeb = class _PreviewWeb extends PreviewWithSelection {\n  constructor(importFn, getProjectAnnotations) {\n    super(importFn, getProjectAnnotations, new UrlStore(), new WebView());\n    this.importFn = importFn;\n    this.getProjectAnnotations = getProjectAnnotations;\n    global8.__STORYBOOK_PREVIEW__ = this;\n  }\n};\n__name(_PreviewWeb, \"PreviewWeb\");\nvar PreviewWeb = _PreviewWeb;\n\n// src/preview-api/modules/preview-web/simulate-pageload.ts\nimport { global as global9 } from \"@storybook/global\";\nvar {\n  document: document4\n} = global9;\nvar runScriptTypes = [\"application/javascript\", \"application/ecmascript\", \"application/x-ecmascript\", \"application/x-javascript\", \"text/ecmascript\", \"text/javascript\", \"text/javascript1.0\", \"text/javascript1.1\", \"text/javascript1.2\", \"text/javascript1.3\", \"text/javascript1.4\", \"text/javascript1.5\", \"text/jscript\", \"text/livescript\", \"text/x-ecmascript\", \"text/x-javascript\",\n// Support modern javascript\n\"module\"];\nvar SCRIPT = \"script\";\nvar SCRIPTS_ROOT_ID = \"scripts-root\";\nfunction simulateDOMContentLoaded() {\n  const DOMContentLoadedEvent = document4.createEvent(\"Event\");\n  DOMContentLoadedEvent.initEvent(\"DOMContentLoaded\", true, true);\n  document4.dispatchEvent(DOMContentLoadedEvent);\n}\n__name(simulateDOMContentLoaded, \"simulateDOMContentLoaded\");\nfunction insertScript($script, callback, $scriptRoot) {\n  const scriptEl = document4.createElement(\"script\");\n  scriptEl.type = $script.type === \"module\" ? \"module\" : \"text/javascript\";\n  if ($script.src) {\n    scriptEl.onload = callback;\n    scriptEl.onerror = callback;\n    scriptEl.src = $script.src;\n  } else {\n    scriptEl.textContent = $script.innerText;\n  }\n  if ($scriptRoot) {\n    $scriptRoot.appendChild(scriptEl);\n  } else {\n    document4.head.appendChild(scriptEl);\n  }\n  $script.parentNode.removeChild($script);\n  if (!$script.src) {\n    callback();\n  }\n}\n__name(insertScript, \"insertScript\");\nfunction insertScriptsSequentially(scriptsToExecute, callback, index = 0) {\n  scriptsToExecute[index](() => {\n    index++;\n    if (index === scriptsToExecute.length) {\n      callback();\n    } else {\n      insertScriptsSequentially(scriptsToExecute, callback, index);\n    }\n  });\n}\n__name(insertScriptsSequentially, \"insertScriptsSequentially\");\nfunction simulatePageLoad($container) {\n  let $scriptsRoot = document4.getElementById(SCRIPTS_ROOT_ID);\n  if (!$scriptsRoot) {\n    $scriptsRoot = document4.createElement(\"div\");\n    $scriptsRoot.id = SCRIPTS_ROOT_ID;\n    document4.body.appendChild($scriptsRoot);\n  } else {\n    $scriptsRoot.innerHTML = \"\";\n  }\n  const $scripts = Array.from($container.querySelectorAll(SCRIPT));\n  if ($scripts.length) {\n    const scriptsToExecute = [];\n    $scripts.forEach($script => {\n      const typeAttr = $script.getAttribute(\"type\");\n      if (!typeAttr || runScriptTypes.includes(typeAttr)) {\n        scriptsToExecute.push(callback => insertScript($script, callback, $scriptsRoot));\n      }\n    });\n    if (scriptsToExecute.length) {\n      insertScriptsSequentially(scriptsToExecute, simulateDOMContentLoaded, void 0);\n    }\n  } else {\n    simulateDOMContentLoaded();\n  }\n}\n__name(simulatePageLoad, \"simulatePageLoad\");\n\n// src/preview-api/modules/preview-web/emitTransformCode.ts\nfunction emitTransformCode(_x32, _x33) {\n  return _emitTransformCode.apply(this, arguments);\n}\nfunction _emitTransformCode() {\n  _emitTransformCode = _asyncToGenerator(function* (source, context) {\n    const transform = context.parameters?.docs?.source?.transform;\n    const {\n      id,\n      unmappedArgs\n    } = context;\n    const transformed = transform && source ? transform?.(source, context) : source;\n    const result = transformed ? yield transformed : void 0;\n    addons.getChannel().emit(SNIPPET_RENDERED, {\n      id,\n      source: result,\n      args: unmappedArgs\n    });\n  });\n  return _emitTransformCode.apply(this, arguments);\n}\n__name(emitTransformCode, \"emitTransformCode\");\nexport { mockChannel, addons, HooksContext, applyHooks, useMemo, useCallback, useRef, useState, useReducer, useEffect, useChannel, useStoryContext, useParameter, useArgs, useGlobals, makeDecorator, combineArgs, normalizeArrays, normalizeStory, mountDestructured, decorateStory, sanitizeStoryContextUpdate, defaultDecorateStory, prepareStory, prepareMeta, filterArgTypes, inferControls, normalizeProjectAnnotations, composeStepRunners, composeConfigs, ReporterAPI, getCsfFactoryAnnotations, setDefaultProjectAnnotations, setProjectAnnotations, composeStory, composeStories, createPlaywrightTest, StoryStore, userOrAutoTitleFromSpecifier, userOrAutoTitle, sortStoriesV7, Preview, DocsContext, PreviewWithSelection, UrlStore, WebView, PreviewWeb, simulateDOMContentLoaded, simulatePageLoad, emitTransformCode };","map":{"version":3,"names":["isTestEnvironment","pauseAnimations","waitForAnimations","require_main","SNIPPET_RENDERED","combineParameters","isEqual","invariant","require_ansi_to_html","mapValues","pickBy","isPlainObject","require_memoizerific","dedent","__name","__toESM","global","Channel","mockChannel","transport","setHandler","send","_AddonStore","constructor","getChannel","channel","setChannel","ready","promise","hasChannel","resolve","Promise","res","AddonStore","KEY","getAddonsStore","addons","logger","FORCE_RE_RENDER","RESET_STORY_ARGS","STORY_RENDERED","UPDATE_GLOBALS","UPDATE_STORY_ARGS","global2","_HooksContext","hookListsMap","mountedDecorators","prevMountedDecorators","currentHooks","nextHookIndex","currentPhase","currentEffects","prevEffects","currentDecoratorName","hasUpdates","currentContext","renderListener","storyId","id","triggerEffects","removeRenderListeners","init","WeakMap","Set","clean","forEach","effect","destroy","getNextHook","hook","includes","create","addRenderListeners","on","removeListener","HooksContext","hookify","fn","hookified","args","hooks","prevPhase","prevHooks","prevNextHookIndex","prevDecoratorName","name","has","get","set","add","prevContext","STORYBOOK_HOOKS_CONTEXT","result","Error","originalFn","numberOfRenders","RENDER_LIMIT","applyHooks","applyDecorators","storyFn","decorators","decorated","map","decorator","context","areDepsEqual","deps","nextDeps","length","every","dep","i","invalidHooksError","getHooksContextOrNull","getHooksContextOrThrow","useHook","callback","Array","isArray","warn","push","useMemoLike","nextCreate","memoizedState","useMemo","useCallback","useRefLike","initialValue","current","useRef","triggerUpdate","emit","e","useStateLike","initialState","stateRef","setState","update","useState","useReducer","reducer","initialArg","state","dispatch","action","prevState","useEffect","useChannel","eventMap","Object","entries","type","listener","keys","bind","useStoryContext","useParameter","parameterKey","defaultValue","parameters","useArgs","updateArgs","updatedArgs","resetArgs","argNames","useGlobals","globals","updateGlobals","newGlobals","makeDecorator","parameterName","wrapper","skipIfNoParametersOrOptions","options","disable","innerArgs","getCoreAnnotations","getCoreAnnotations2","CalledExtractOnStoreError","MissingStoryFromCsfFileError","import_memoizerific2","once","INCOMPATIBLE","Symbol","arg","argType","mapping","String","Number","value","reduce","acc","item","index","mapped","key","val","assign","isPrimitiveArg","mapArgsToTypes","argTypes","combineArgs","upd","filter","v","combined","validateOptions","allowArg","error","some","opt","invalidIndex","findIndex","isValidArray","field","supportedOptions","join","DEEPLY_EQUAL","deepDiff","diff","concat","fill","UNTARGETED","groupArgsByTarget","groupedArgs","target","deleteUndefined","obj","_ArgsStore","initialArgsByStoryId","argsByStoryId","setInitial","story","initialArgs","delta","updateFromDelta","validatedDelta","updateFromPersisted","persisted","mappedPersisted","argsUpdate","ArgsStore","logger2","getValuesFromArgTypes","_GlobalsStore","globalTypes","initialGlobals","allowedGlobalNames","defaultGlobals","filterAllowedGlobals","allowedUrlGlobals","GlobalsStore","import_memoizerific","MissingStoryAfterHmrError","getImportPathMap","default","values","entry","importPath","_StoryIndexStore","entryFromSpecifier","specifier","find","startsWith","title","storyIdToEntry","storyEntry","importPathToEntry","StoryIndexStore","normalizeType","normalizeControl","control","normalizeInputType","inputType","rest","normalized","normalizeInputTypes","inputTypes","deprecate","logger3","storyNameFromExport","toId","normalizeArrays","array","deprecatedStoryAnnotation","normalizeStory","storyAnnotations","meta","storyObject","userStoryFn","debug","exportName","storyName","loaders","beforeEach","afterEach","render","play","tags","__id","moduleExport","logger4","getStoryChildren","isExportStory","isStory","toTestId","sanitize","normalizeComponentAnnotations","defaultExport","fileName","checkGlobals","JSON","stringify","checkStorySort","storySort","checkDisallowedParameters","processCSFFile","moduleExports","__namedExportsOrder","namedExports","firstStory","meta2","input","csfFile2","stories","storyMeta","child","childId","projectAnnotations","preview","composed","csfFile","combineTags","includeConditionalArg","NoRenderFunctionError","global3","globalThis2","mountDestructured","playFunction","getUsedProps","match","toString","splitByComma","first","endsWith","props","slice","replace","prop","s","stack","start","pop","token","substring","trim","lastToken","decorateStory","bindWithContext","boundStoryFunction","sanitizeStoryContextUpdate","componentId","kind","defaultDecorateStory","contextStore","decoratedStoryFn","decoratedWithContextStore","prepareStory","componentAnnotations","partialAnnotations","preparePartialAnnotations","applyLoaders","_ref","_asyncToGenerator","loaded","abortSignal","aborted","loadResults","all","loader","_x","apply","arguments","applyBeforeEach","_ref2","cleanupCallbacks","cleanup","_x2","applyAfterEach","_ref3","reversedFinalizers","reverse","finalizer","_x3","undecoratedStoryFn","originalStoryFn","runStep","unboundStoryFn","usesMount","defaultMount","renderToCanvas","canvas","mount","testingLibraryRender","storyGlobals","prepareMeta","defaultTags","extraTags","DOCS_OPTIONS","autodocs","overrideTags","argTypesEnhancers","argsEnhancers","passedArgTypes","__isArgsStory","passedArgs","contextForEnhancers","component","subcomponents","accumulatedArgTypes","enhancer","initialArgsBeforeEnhancers","accumulatedArgs","withoutStoryIdentifiers","prepareContext","unmappedArgs","targetedContext","allArgs","argsByTarget","FEATURES","argTypeTargetsV7","mappedArgs","mappingFn","originalValue","includedArgs","logger5","inferType","visited","childType","fieldTypes","inferArgTypes","userArgTypes","userArgTypesNames","secondPass","logger6","matches","descriptor","filterArgTypes","include","exclude","inferControl","matchers","color","test","controlType","date","inferControls","controls","filteredArgTypes","withControls","normalizeProjectAnnotations","annotations","global4","composeBeforeAllHooks","cleanups2","unshift","composeStepRunners","stepRunners","_ref7","label","playContext","composedPlay","reduceRight","innerPlay","stepRunner","_x4","_x5","_x6","getField","moduleExportList","xs","Boolean","getArrayField","prev","cur","reverseFileOrder","getObjectField","getSingletonField","composeConfigs","allArgTypeEnhancers","beforeAllHooks","legacyDecoratorFileOrder","beforeAll","isExportStory2","MountMustBeDestructuredError","_ReporterAPI","reports","addReport","report","_this","ReporterAPI","isMeta","isStory2","getCsfFactoryAnnotations","setDefaultProjectAnnotations","_defaultProjectAnnotations","globalThis","defaultProjectAnnotations","DEFAULT_STORY_TITLE","DEFAULT_STORY_NAME","extractAnnotation","annotation","setProjectAnnotations","globalProjectAnnotations","cleanups","composeStory","defaultConfig","exportsName","normalizedComponentAnnotations","normalizedStory","normalizedProjectAnnotations","globalsFromGlobalTypes","reporting","initializeContext","viewMode","AbortController","signal","step","play2","canvasElement","userEvent","__isPortableStory","unmount","showMain","showError","description","showException","forceRemount","storyContext","loadedContext","_ref1","extraContext","document","body","_x7","run","runStory","composedStory","extraArgs","load","defaultComposeStory","project","composeStories","storiesImport","globalConfig","composeStoryFn","metaExport","__esModule","composedStories","storiesMap","createPlaywrightTest","baseTest","extend","_ref11","page","use","_ref12","storyRef","restArgs","__pw_type","storyRefWithoutProps","evaluate","_ref13","wrappedStoryRef","unwrappedStoryRef","__pwUnwrapObject","_x1","mountResult","_ref14","querySelector","_x10","_x0","_x8","_x9","_x11","_x12","_runStory","container","createElement","appendChild","contains","removeChild","isMountDestructured","cleanUp","CSF_CACHE_SIZE","STORY_CACHE_SIZE","_StoryStore","storyIndex","importFn","userGlobals","processCSFFileWithCache","prepareMetaWithCache","prepareStoryWithCache","onStoriesChanged","_x13","_this2","cachedCSFFiles","cacheAllCSFFiles","_this3","loadCSFFileByStoryId","_this4","loadAllCSFFiles","_this5","importPaths","list","_ref15","_x14","_this6","preparedMetaFromCSFFile","loadStory","_x15","_this7","storyFromCSFFile","componentStoriesFromCSFFile","loadEntry","_this8","storyImports","storiesImports","entryExports","csfFiles","storyImportPath","firstStoryEntry","getStoryContext","forceInitialArgs","addCleanupCallbacks","callbacks","cleanupStory","_this9","extract","includeDocsOnly","console","log","docsOnly","storyAcc","subtype","parentName","sort","parent","StoryStore","once2","slash","path","isExtendedLengthPath","sanitize2","parts","last","lastStripped","nextToLast","toLowerCase","pathJoin","paths","flatMap","p","split","userOrAutoTitleFromSpecifier","userTitle","directory","importPathMatcher","titlePrefix","normalizedFileName","exec","suffix","userOrAutoTitle","storiesEntries","STORY_KIND_PATH_SEPARATOR","a","b","includeNames","method","order","storyTitleA","storyTitleB","depth","nameA","nameB","indexA","indexOf","indexB","indexWildcard","localeCompare","locales","numeric","sensitivity","sortStoriesCommon","storySortParameter","fileNameOrder","sortFn","s1","s2","sortStoriesV7","err","message","deprecate2","logger7","ARGTYPES_INFO_REQUEST","ARGTYPES_INFO_RESPONSE","CONFIG_ERROR","FORCE_REMOUNT","FORCE_RE_RENDER2","GLOBALS_UPDATED","PREVIEW_INITIALIZED","RESET_STORY_ARGS2","SET_GLOBALS","STORY_ARGS_UPDATED","STORY_HOT_UPDATED","STORY_INDEX_INVALIDATED","UPDATE_GLOBALS2","UPDATE_STORY_ARGS2","CalledPreviewMethodBeforeInitializationError","MissingRenderToCanvasError","StoryIndexFetchError","StoryStoreAccessedBeforeInitializationError","global5","PLAY_FUNCTION_THREW_EXCEPTION","STORY_FINISHED","STORY_RENDERED2","STORY_RENDER_PHASE_CHANGED","UNHANDLED_ERRORS_WHILE_PLAYING","MountMustBeDestructuredError2","NoStoryMountedError","PREPARE_ABORTED","AbortController2","serializeError","_StoryRender","store","renderToScreen","renderOptions","autoplay","notYetRendered","rerenderEnqueued","disableKeyListeners","teardownRender","torndown","abortController","renderId","Date","now","phase","runPhase","phaseFn","_this0","newPhase","checkIfAborted","prepare","_this1","other","isPreparing","isPending","renderToElement","_this10","initial","_this11","cancelRender","mounted","teardown","renderContext","showStoryDuringRender","mountReturn","ignoreUnhandledErrors","dangerouslyIgnoreUnhandledErrors","unhandledErrors","onError","event","onUnhandledRejection","reason","window","addEventListener","size","throwPlayFunctionExceptions","from","removeEventListener","hasUnhandledErrors","hasSomeReportsFailed","status","hasStoryErrored","reporters","rerender","_this12","remount","_this13","abort","cancelPlayFunction","_this14","setTimeout","location","reload","StoryRender","fetch","STORY_INDEX_PATH","_Preview","getProjectAnnotations","shouldInitialize","storyRenders","storeInitializationPromise","reject","resolveStoreInitializationPromise","rejectStoreInitializationPromise","initialize","storyStore","Proxy","_","storyStoreValue","_this15","setupListeners","getProjectAnnotationsOrRenderError","runBeforeAllHook","initializeWithProjectAnnotations","userAgent","navigator","onStoryIndexChanged","onUpdateGlobals","onUpdateArgs","onRequestArgTypesInfo","onResetArgs","onForceReRender","onForceRemount","onStoryHotUpdated","_this16","renderPreviewEntryError","_this17","projectAnnotationsBeforeInitialization","getStoryIndexFromServer","initializeWithStoryIndex","_this18","beforeAllCleanup","json","text","setInitialGlobals","_this19","emitGlobals","methodName","payload","onGetProjectAnnotationsChanged","_x16","_this20","previewEntryError","_this21","_x17","_this22","_x18","_this23","updatedGlobals","currentStory","r","_x19","_this24","_x20","_this25","success","_x21","_this26","argNamesToReset","argName","_this27","_x22","_this28","_this29","renderStoryToElement","element","_this30","_x23","_this31","viewModeChanged","_x24","_this32","_this33","Preview","global8","logger8","CURRENT_STORY_WAS_SET","DOCS_PREPARED","GLOBALS_UPDATED2","PRELOAD_ENTRIES","PREVIEW_KEYDOWN","SET_CURRENT_STORY","STORY_CHANGED","STORY_ERRORED","STORY_MISSING","STORY_PREPARED","STORY_RENDER_PHASE_CHANGED2","STORY_SPECIFIED","STORY_THREW_EXCEPTION","STORY_UNCHANGED","UPDATE_QUERY_PARAMS","CalledPreviewMethodBeforeInitializationError2","EmptyIndexError","MdxFileWithNoCsfReferencesError","NoStoryMatchError","DOCS_RENDERED","isStory3","_DocsContext","storyIdByName","nameToStoryId","componentStories","componentStoriesValue","storyById","primaryStory","storyIdToCSFFile","Map","exportToStory","exportsToCSFFile","attachedCSFFiles","referenceCSFFile","attachCSFFile","referenceMeta","metaExports","attach","resolved","resolveModuleExport","resolveAttachedModuleExportType","moduleExportType","firstAttachedCSFFile","moduleExportOrType","resolveOf","validTypes","prettyType","preparedMeta","DocsContext","_CsfDocsRender","preparing","_this34","primaryCsfFile","primaryStoryId","docsContext","_this35","docs","docsParameter","renderer","renderDocs","_ref32","_x25","_this36","CsfDocsRender","DOCS_RENDERED2","_MdxDocsRender","_this37","exports","_this38","_this39","MdxDocsRender","globalWindow","focusInInput","composedPath","tagName","getAttribute","ATTACHED_MDX_TAG","UNATTACHED_MDX_TAG","isMdxEntry","isStoryRender","isDocsRender","isCsfDocsRender","_PreviewWithSelection","selectionStore","view","onkeydown","onKeydown","onSetCurrentStory","onUpdateQueryParams","onPreloadStories","_this40","selectionSpecifier","_superprop_getInitializeWithStoryIndex","_this41","call","selectSpecifiedStory","_this42","selection","renderSelection","renderMissingStory","storySpecifier","renderStoryLoadingException","setSelection","persistedArgs","_x26","_superprop_getOnGetProjectAnnotationsChanged","_this43","_x27","_superprop_getOnStoriesChanged","_this44","altKey","ctrlKey","metaKey","shiftKey","code","keyCode","_this45","queryParams","setQueryParams","_x28","_superprop_getOnUpdateGlobals","_this46","currentRender","_x29","_superprop_getOnUpdateArgs","_this47","_x30","_this48","ids","allSettled","_this49","storyIdChanged","currentSelection","showPreparingStory","immediate","showPreparingDocs","mainStoryCallbacks","lastSelection","lastRender","implementationChanged","prepareForStory","prepareForDocs","_x31","_this50","renderError","renderException","showErrorDisplay","showNoPreview","PreviewWithSelection","import_picoquery2","global6","once3","import_picoquery","VALIDATION_REGEXP","NUMBER_REGEXP","HEX_REGEXP","COLOR_REGEXP","validateArgs","k","QUERY_OPTIONS","delimiter","nesting","arrayRepeat","arrayRepeatSyntax","nestingSyntax","valueDeserializer","str","replaceAll","parseArgsParam","argsString","part","parse","history","document2","pathToId","getQueryString","extraParams","search","selectedKind","selectedStory","queryStr","setPath","query","hash","replaceState","pathname","isObject","getFirstString","getSelectionSpecifierFromPath","_UrlStore","UrlStore","import_ansi_to_html","import_picoquery3","logger9","global7","document3","PREPARING_DELAY","Mode","Mode2","classes","PREPARING_STORY","PREPARING_DOCS","MAIN","NOPREVIEW","ERROR","layoutClassMap","centered","fullscreen","padded","ansiConverter","escapeXML","_WebView","testing","__SPECIAL_TEST_PARAMETER__","showStory","applyLayout","layout","documentElement","scrollTop","scrollLeft","storyRoot","getElementById","showDocs","docsRoot","classList","remove","currentLayoutClass","checkIfLayoutExists","layoutClass","showMode","mode","clearTimeout","preparingTimeout","otherMode","header","detail","innerHTML","toHtml","setAttribute","removeAttribute","WebView","_PreviewWeb","__STORYBOOK_PREVIEW__","PreviewWeb","global9","document4","runScriptTypes","SCRIPT","SCRIPTS_ROOT_ID","simulateDOMContentLoaded","DOMContentLoadedEvent","createEvent","initEvent","dispatchEvent","insertScript","$script","$scriptRoot","scriptEl","src","onload","onerror","textContent","innerText","head","parentNode","insertScriptsSequentially","scriptsToExecute","simulatePageLoad","$container","$scriptsRoot","$scripts","querySelectorAll","typeAttr","emitTransformCode","_x32","_x33","_emitTransformCode","source","transform","transformed"],"sources":["/Users/ugurcakil/Documents/projects/ugurk/ng-theme-storybook/node_modules/storybook/dist/_browser-chunks/chunk-HERDX7MO.js"],"sourcesContent":["import {\n  isTestEnvironment,\n  pauseAnimations,\n  waitForAnimations\n} from \"./chunk-LYCSRYYR.js\";\nimport {\n  require_main\n} from \"./chunk-Y3M7TW6K.js\";\nimport {\n  SNIPPET_RENDERED,\n  combineParameters\n} from \"./chunk-U2JWIJRX.js\";\nimport {\n  isEqual\n} from \"./chunk-ZNRFDIVA.js\";\nimport {\n  invariant\n} from \"./chunk-FUOHXXZT.js\";\nimport {\n  require_ansi_to_html\n} from \"./chunk-F4Q6SGTB.js\";\nimport {\n  mapValues,\n  pickBy\n} from \"./chunk-KHNISLMN.js\";\nimport {\n  isPlainObject\n} from \"./chunk-FSBVR7H5.js\";\nimport {\n  require_memoizerific\n} from \"./chunk-NVV6MIOE.js\";\nimport {\n  dedent\n} from \"./chunk-OPCDBBL3.js\";\nimport {\n  __name,\n  __toESM\n} from \"./chunk-MM7DTO55.js\";\n\n// src/preview-api/modules/addons/main.ts\nimport { global } from \"@storybook/global\";\n\n// src/preview-api/modules/addons/storybook-channel-mock.ts\nimport { Channel } from \"storybook/internal/channels\";\nfunction mockChannel() {\n  const transport = {\n    setHandler: /* @__PURE__ */ __name(() => {\n    }, \"setHandler\"),\n    send: /* @__PURE__ */ __name(() => {\n    }, \"send\")\n  };\n  return new Channel({ transport });\n}\n__name(mockChannel, \"mockChannel\");\n\n// src/preview-api/modules/addons/main.ts\nvar _AddonStore = class _AddonStore {\n  constructor() {\n    this.getChannel = /* @__PURE__ */ __name(() => {\n      if (!this.channel) {\n        const channel = mockChannel();\n        this.setChannel(channel);\n        return channel;\n      }\n      return this.channel;\n    }, \"getChannel\");\n    this.ready = /* @__PURE__ */ __name(() => this.promise, \"ready\");\n    this.hasChannel = /* @__PURE__ */ __name(() => !!this.channel, \"hasChannel\");\n    this.setChannel = /* @__PURE__ */ __name((channel) => {\n      this.channel = channel;\n      this.resolve();\n    }, \"setChannel\");\n    this.promise = new Promise((res) => {\n      this.resolve = () => res(this.getChannel());\n    });\n  }\n};\n__name(_AddonStore, \"AddonStore\");\nvar AddonStore = _AddonStore;\nvar KEY = \"__STORYBOOK_ADDONS_PREVIEW\";\nfunction getAddonsStore() {\n  if (!global[KEY]) {\n    global[KEY] = new AddonStore();\n  }\n  return global[KEY];\n}\n__name(getAddonsStore, \"getAddonsStore\");\nvar addons = getAddonsStore();\n\n// src/preview-api/modules/addons/hooks.ts\nimport { logger } from \"storybook/internal/client-logger\";\nimport {\n  FORCE_RE_RENDER,\n  RESET_STORY_ARGS,\n  STORY_RENDERED,\n  UPDATE_GLOBALS,\n  UPDATE_STORY_ARGS\n} from \"storybook/internal/core-events\";\nimport { global as global2 } from \"@storybook/global\";\nvar _HooksContext = class _HooksContext {\n  constructor() {\n    this.hookListsMap = void 0;\n    this.mountedDecorators = void 0;\n    this.prevMountedDecorators = void 0;\n    this.currentHooks = void 0;\n    this.nextHookIndex = void 0;\n    this.currentPhase = void 0;\n    this.currentEffects = void 0;\n    this.prevEffects = void 0;\n    this.currentDecoratorName = void 0;\n    this.hasUpdates = void 0;\n    this.currentContext = void 0;\n    this.renderListener = /* @__PURE__ */ __name((storyId) => {\n      if (storyId !== this.currentContext?.id) {\n        return;\n      }\n      this.triggerEffects();\n      this.currentContext = null;\n      this.removeRenderListeners();\n    }, \"renderListener\");\n    this.init();\n  }\n  init() {\n    this.hookListsMap = /* @__PURE__ */ new WeakMap();\n    this.mountedDecorators = /* @__PURE__ */ new Set();\n    this.prevMountedDecorators = /* @__PURE__ */ new Set();\n    this.currentHooks = [];\n    this.nextHookIndex = 0;\n    this.currentPhase = \"NONE\";\n    this.currentEffects = [];\n    this.prevEffects = [];\n    this.currentDecoratorName = null;\n    this.hasUpdates = false;\n    this.currentContext = null;\n  }\n  clean() {\n    this.prevEffects.forEach((effect) => {\n      if (effect.destroy) {\n        effect.destroy();\n      }\n    });\n    this.init();\n    this.removeRenderListeners();\n  }\n  getNextHook() {\n    const hook = this.currentHooks[this.nextHookIndex];\n    this.nextHookIndex += 1;\n    return hook;\n  }\n  triggerEffects() {\n    this.prevEffects.forEach((effect) => {\n      if (!this.currentEffects.includes(effect) && effect.destroy) {\n        effect.destroy();\n      }\n    });\n    this.currentEffects.forEach((effect) => {\n      if (!this.prevEffects.includes(effect)) {\n        effect.destroy = effect.create();\n      }\n    });\n    this.prevEffects = this.currentEffects;\n    this.currentEffects = [];\n  }\n  addRenderListeners() {\n    this.removeRenderListeners();\n    const channel = addons.getChannel();\n    channel.on(STORY_RENDERED, this.renderListener);\n  }\n  removeRenderListeners() {\n    const channel = addons.getChannel();\n    channel.removeListener(STORY_RENDERED, this.renderListener);\n  }\n};\n__name(_HooksContext, \"HooksContext\");\nvar HooksContext = _HooksContext;\nfunction hookify(fn) {\n  const hookified = /* @__PURE__ */ __name((...args) => {\n    const { hooks } = typeof args[0] === \"function\" ? args[1] : args[0];\n    const prevPhase = hooks.currentPhase;\n    const prevHooks = hooks.currentHooks;\n    const prevNextHookIndex = hooks.nextHookIndex;\n    const prevDecoratorName = hooks.currentDecoratorName;\n    hooks.currentDecoratorName = fn.name;\n    if (hooks.prevMountedDecorators.has(fn)) {\n      hooks.currentPhase = \"UPDATE\";\n      hooks.currentHooks = hooks.hookListsMap.get(fn) || [];\n    } else {\n      hooks.currentPhase = \"MOUNT\";\n      hooks.currentHooks = [];\n      hooks.hookListsMap.set(fn, hooks.currentHooks);\n      hooks.prevMountedDecorators.add(fn);\n    }\n    hooks.nextHookIndex = 0;\n    const prevContext = global2.STORYBOOK_HOOKS_CONTEXT;\n    global2.STORYBOOK_HOOKS_CONTEXT = hooks;\n    const result = fn(...args);\n    global2.STORYBOOK_HOOKS_CONTEXT = prevContext;\n    if (hooks.currentPhase === \"UPDATE\" && hooks.getNextHook() != null) {\n      throw new Error(\n        \"Rendered fewer hooks than expected. This may be caused by an accidental early return statement.\"\n      );\n    }\n    hooks.currentPhase = prevPhase;\n    hooks.currentHooks = prevHooks;\n    hooks.nextHookIndex = prevNextHookIndex;\n    hooks.currentDecoratorName = prevDecoratorName;\n    return result;\n  }, \"hookified\");\n  hookified.originalFn = fn;\n  return hookified;\n}\n__name(hookify, \"hookify\");\nvar numberOfRenders = 0;\nvar RENDER_LIMIT = 25;\nvar applyHooks = /* @__PURE__ */ __name((applyDecorators) => (storyFn, decorators) => {\n  const decorated = applyDecorators(\n    hookify(storyFn),\n    decorators.map((decorator) => hookify(decorator))\n  );\n  return (context) => {\n    const { hooks } = context;\n    hooks.prevMountedDecorators ??= /* @__PURE__ */ new Set();\n    hooks.mountedDecorators = /* @__PURE__ */ new Set([storyFn, ...decorators]);\n    hooks.currentContext = context;\n    hooks.hasUpdates = false;\n    let result = decorated(context);\n    numberOfRenders = 1;\n    while (hooks.hasUpdates) {\n      hooks.hasUpdates = false;\n      hooks.currentEffects = [];\n      result = decorated(context);\n      numberOfRenders += 1;\n      if (numberOfRenders > RENDER_LIMIT) {\n        throw new Error(\n          \"Too many re-renders. Storybook limits the number of renders to prevent an infinite loop.\"\n        );\n      }\n    }\n    hooks.addRenderListeners();\n    return result;\n  };\n}, \"applyHooks\");\nvar areDepsEqual = /* @__PURE__ */ __name((deps, nextDeps) => deps.length === nextDeps.length && deps.every((dep, i) => dep === nextDeps[i]), \"areDepsEqual\");\nvar invalidHooksError = /* @__PURE__ */ __name(() => new Error(\"Storybook preview hooks can only be called inside decorators and story functions.\"), \"invalidHooksError\");\nfunction getHooksContextOrNull() {\n  return global2.STORYBOOK_HOOKS_CONTEXT || null;\n}\n__name(getHooksContextOrNull, \"getHooksContextOrNull\");\nfunction getHooksContextOrThrow() {\n  const hooks = getHooksContextOrNull();\n  if (hooks == null) {\n    throw invalidHooksError();\n  }\n  return hooks;\n}\n__name(getHooksContextOrThrow, \"getHooksContextOrThrow\");\nfunction useHook(name, callback, deps) {\n  const hooks = getHooksContextOrThrow();\n  if (hooks.currentPhase === \"MOUNT\") {\n    if (deps != null && !Array.isArray(deps)) {\n      logger.warn(\n        `${name} received a final argument that is not an array (instead, received ${deps}). When specified, the final argument must be an array.`\n      );\n    }\n    const hook = { name, deps };\n    hooks.currentHooks.push(hook);\n    callback(hook);\n    return hook;\n  }\n  if (hooks.currentPhase === \"UPDATE\") {\n    const hook = hooks.getNextHook();\n    if (hook == null) {\n      throw new Error(\"Rendered more hooks than during the previous render.\");\n    }\n    if (hook.name !== name) {\n      logger.warn(\n        `Storybook has detected a change in the order of Hooks${hooks.currentDecoratorName ? ` called by ${hooks.currentDecoratorName}` : \"\"}. This will lead to bugs and errors if not fixed.`\n      );\n    }\n    if (deps != null && hook.deps == null) {\n      logger.warn(\n        `${name} received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.`\n      );\n    }\n    if (deps != null && hook.deps != null && deps.length !== hook.deps.length) {\n      logger.warn(`The final argument passed to ${name} changed size between renders. The order and size of this array must remain constant.\nPrevious: ${hook.deps}\nIncoming: ${deps}`);\n    }\n    if (deps == null || hook.deps == null || !areDepsEqual(deps, hook.deps)) {\n      callback(hook);\n      hook.deps = deps;\n    }\n    return hook;\n  }\n  throw invalidHooksError();\n}\n__name(useHook, \"useHook\");\nfunction useMemoLike(name, nextCreate, deps) {\n  const { memoizedState } = useHook(\n    name,\n    (hook) => {\n      hook.memoizedState = nextCreate();\n    },\n    deps\n  );\n  return memoizedState;\n}\n__name(useMemoLike, \"useMemoLike\");\nfunction useMemo(nextCreate, deps) {\n  return useMemoLike(\"useMemo\", nextCreate, deps);\n}\n__name(useMemo, \"useMemo\");\nfunction useCallback(callback, deps) {\n  return useMemoLike(\"useCallback\", () => callback, deps);\n}\n__name(useCallback, \"useCallback\");\nfunction useRefLike(name, initialValue) {\n  return useMemoLike(name, () => ({ current: initialValue }), []);\n}\n__name(useRefLike, \"useRefLike\");\nfunction useRef(initialValue) {\n  return useRefLike(\"useRef\", initialValue);\n}\n__name(useRef, \"useRef\");\nfunction triggerUpdate() {\n  const hooks = getHooksContextOrNull();\n  if (hooks != null && hooks.currentPhase !== \"NONE\") {\n    hooks.hasUpdates = true;\n  } else {\n    try {\n      addons.getChannel().emit(FORCE_RE_RENDER);\n    } catch (e) {\n      logger.warn(\"State updates of Storybook preview hooks work only in browser\");\n    }\n  }\n}\n__name(triggerUpdate, \"triggerUpdate\");\nfunction useStateLike(name, initialState) {\n  const stateRef = useRefLike(\n    name,\n    // @ts-expect-error S type should never be function, but there's no way to tell that to TypeScript\n    typeof initialState === \"function\" ? initialState() : initialState\n  );\n  const setState = /* @__PURE__ */ __name((update) => {\n    stateRef.current = typeof update === \"function\" ? update(stateRef.current) : update;\n    triggerUpdate();\n  }, \"setState\");\n  return [stateRef.current, setState];\n}\n__name(useStateLike, \"useStateLike\");\nfunction useState(initialState) {\n  return useStateLike(\"useState\", initialState);\n}\n__name(useState, \"useState\");\nfunction useReducer(reducer, initialArg, init) {\n  const initialState = init != null ? () => init(initialArg) : initialArg;\n  const [state, setState] = useStateLike(\"useReducer\", initialState);\n  const dispatch = /* @__PURE__ */ __name((action) => setState((prevState) => reducer(prevState, action)), \"dispatch\");\n  return [state, dispatch];\n}\n__name(useReducer, \"useReducer\");\nfunction useEffect(create, deps) {\n  const hooks = getHooksContextOrThrow();\n  const effect = useMemoLike(\"useEffect\", () => ({ create }), deps);\n  if (!hooks.currentEffects.includes(effect)) {\n    hooks.currentEffects.push(effect);\n  }\n}\n__name(useEffect, \"useEffect\");\nfunction useChannel(eventMap, deps = []) {\n  const channel = addons.getChannel();\n  useEffect(() => {\n    Object.entries(eventMap).forEach(([type, listener]) => channel.on(type, listener));\n    return () => {\n      Object.entries(eventMap).forEach(\n        ([type, listener]) => channel.removeListener(type, listener)\n      );\n    };\n  }, [...Object.keys(eventMap), ...deps]);\n  return useCallback(channel.emit.bind(channel), [channel]);\n}\n__name(useChannel, \"useChannel\");\nfunction useStoryContext() {\n  const { currentContext } = getHooksContextOrThrow();\n  if (currentContext == null) {\n    throw invalidHooksError();\n  }\n  return currentContext;\n}\n__name(useStoryContext, \"useStoryContext\");\nfunction useParameter(parameterKey, defaultValue) {\n  const { parameters } = useStoryContext();\n  if (parameterKey) {\n    return parameters[parameterKey] ?? defaultValue;\n  }\n  return void 0;\n}\n__name(useParameter, \"useParameter\");\nfunction useArgs() {\n  const channel = addons.getChannel();\n  const { id: storyId, args } = useStoryContext();\n  const updateArgs = useCallback(\n    (updatedArgs) => channel.emit(UPDATE_STORY_ARGS, { storyId, updatedArgs }),\n    [channel, storyId]\n  );\n  const resetArgs = useCallback(\n    (argNames) => channel.emit(RESET_STORY_ARGS, { storyId, argNames }),\n    [channel, storyId]\n  );\n  return [args, updateArgs, resetArgs];\n}\n__name(useArgs, \"useArgs\");\nfunction useGlobals() {\n  const channel = addons.getChannel();\n  const { globals } = useStoryContext();\n  const updateGlobals = useCallback(\n    (newGlobals) => channel.emit(UPDATE_GLOBALS, { globals: newGlobals }),\n    [channel]\n  );\n  return [globals, updateGlobals];\n}\n__name(useGlobals, \"useGlobals\");\n\n// src/preview-api/modules/addons/make-decorator.ts\nvar makeDecorator = /* @__PURE__ */ __name(({\n  name,\n  parameterName,\n  wrapper,\n  skipIfNoParametersOrOptions = false\n}) => {\n  const decorator = /* @__PURE__ */ __name((options) => (storyFn, context) => {\n    const parameters = context.parameters && context.parameters[parameterName];\n    if (parameters && parameters.disable) {\n      return storyFn(context);\n    }\n    if (skipIfNoParametersOrOptions && !options && !parameters) {\n      return storyFn(context);\n    }\n    return wrapper(storyFn, context, {\n      options,\n      parameters\n    });\n  }, \"decorator\");\n  return (...args) => {\n    if (typeof args[0] === \"function\") {\n      return decorator()(...args);\n    }\n    return (...innerArgs) => {\n      if (innerArgs.length > 1) {\n        if (args.length > 1) {\n          return decorator(args)(...innerArgs);\n        }\n        return decorator(...args)(...innerArgs);\n      }\n      throw new Error(\n        `Passing stories directly into ${name}() is not allowed,\n        instead use addDecorator(${name}) and pass options with the '${parameterName}' parameter`\n      );\n    };\n  };\n}, \"makeDecorator\");\n\n// src/preview-api/modules/store/StoryStore.ts\nimport { getCoreAnnotations as getCoreAnnotations2 } from \"storybook/internal/csf\";\nimport {\n  CalledExtractOnStoreError,\n  MissingStoryFromCsfFileError\n} from \"storybook/internal/preview-errors\";\nvar import_memoizerific2 = __toESM(require_memoizerific(), 1);\n\n// src/preview-api/modules/store/args.ts\nimport { once } from \"storybook/internal/client-logger\";\nvar INCOMPATIBLE = Symbol(\"incompatible\");\nvar map = /* @__PURE__ */ __name((arg, argType) => {\n  const type = argType.type;\n  if (arg === void 0 || arg === null || !type) {\n    return arg;\n  }\n  if (argType.mapping) {\n    return arg;\n  }\n  switch (type.name) {\n    case \"string\":\n      return String(arg);\n    case \"enum\":\n      return arg;\n    case \"number\":\n      return Number(arg);\n    case \"boolean\":\n      return String(arg) === \"true\";\n    case \"array\":\n      if (!type.value || !Array.isArray(arg)) {\n        return INCOMPATIBLE;\n      }\n      return arg.reduce((acc, item, index) => {\n        const mapped = map(item, { type: type.value });\n        if (mapped !== INCOMPATIBLE) {\n          acc[index] = mapped;\n        }\n        return acc;\n      }, new Array(arg.length));\n    case \"object\":\n      if (typeof arg === \"string\" || typeof arg === \"number\") {\n        return arg;\n      }\n      if (!type.value || typeof arg !== \"object\") {\n        return INCOMPATIBLE;\n      }\n      return Object.entries(arg).reduce((acc, [key, val]) => {\n        const mapped = map(val, { type: type.value[key] });\n        return mapped === INCOMPATIBLE ? acc : Object.assign(acc, { [key]: mapped });\n      }, {});\n    case \"other\": {\n      const isPrimitiveArg = typeof arg === \"string\" || typeof arg === \"number\" || typeof arg === \"boolean\";\n      if (type.value === \"ReactNode\" && isPrimitiveArg) {\n        return arg;\n      }\n      return INCOMPATIBLE;\n    }\n    default:\n      return INCOMPATIBLE;\n  }\n}, \"map\");\nvar mapArgsToTypes = /* @__PURE__ */ __name((args, argTypes) => {\n  return Object.entries(args).reduce((acc, [key, value]) => {\n    if (!argTypes[key]) {\n      return acc;\n    }\n    const mapped = map(value, argTypes[key]);\n    return mapped === INCOMPATIBLE ? acc : Object.assign(acc, { [key]: mapped });\n  }, {});\n}, \"mapArgsToTypes\");\nvar combineArgs = /* @__PURE__ */ __name((value, update) => {\n  if (Array.isArray(value) && Array.isArray(update)) {\n    return update.reduce(\n      (acc, upd, index) => {\n        acc[index] = combineArgs(value[index], update[index]);\n        return acc;\n      },\n      [...value]\n    ).filter((v) => v !== void 0);\n  }\n  if (!isPlainObject(value) || !isPlainObject(update)) {\n    return update;\n  }\n  return Object.keys({ ...value, ...update }).reduce((acc, key) => {\n    if (key in update) {\n      const combined = combineArgs(value[key], update[key]);\n      if (combined !== void 0) {\n        acc[key] = combined;\n      }\n    } else {\n      acc[key] = value[key];\n    }\n    return acc;\n  }, {});\n}, \"combineArgs\");\nvar validateOptions = /* @__PURE__ */ __name((args, argTypes) => {\n  return Object.entries(argTypes).reduce((acc, [key, { options }]) => {\n    function allowArg() {\n      if (key in args) {\n        acc[key] = args[key];\n      }\n      return acc;\n    }\n    __name(allowArg, \"allowArg\");\n    if (!options) {\n      return allowArg();\n    }\n    if (!Array.isArray(options)) {\n      once.error(dedent`\n        Invalid argType: '${key}.options' should be an array.\n\n        More info: https://storybook.js.org/docs/api/arg-types?ref=error\n      `);\n      return allowArg();\n    }\n    if (options.some((opt) => opt && [\"object\", \"function\"].includes(typeof opt))) {\n      once.error(dedent`\n        Invalid argType: '${key}.options' should only contain primitives. Use a 'mapping' for complex values.\n\n        More info: https://storybook.js.org/docs/writing-stories/args?ref=error#mapping-to-complex-arg-values\n      `);\n      return allowArg();\n    }\n    const isArray = Array.isArray(args[key]);\n    const invalidIndex = isArray && args[key].findIndex((val) => !options.includes(val));\n    const isValidArray = isArray && invalidIndex === -1;\n    if (args[key] === void 0 || options.includes(args[key]) || isValidArray) {\n      return allowArg();\n    }\n    const field = isArray ? `${key}[${invalidIndex}]` : key;\n    const supportedOptions = options.map((opt) => typeof opt === \"string\" ? `'${opt}'` : String(opt)).join(\", \");\n    once.warn(`Received illegal value for '${field}'. Supported options: ${supportedOptions}`);\n    return acc;\n  }, {});\n}, \"validateOptions\");\nvar DEEPLY_EQUAL = Symbol(\"Deeply equal\");\nvar deepDiff = /* @__PURE__ */ __name((value, update) => {\n  if (typeof value !== typeof update) {\n    return update;\n  }\n  if (isEqual(value, update)) {\n    return DEEPLY_EQUAL;\n  }\n  if (Array.isArray(value) && Array.isArray(update)) {\n    const res = update.reduce((acc, upd, index) => {\n      const diff = deepDiff(value[index], upd);\n      if (diff !== DEEPLY_EQUAL) {\n        acc[index] = diff;\n      }\n      return acc;\n    }, new Array(update.length));\n    if (update.length >= value.length) {\n      return res;\n    }\n    return res.concat(new Array(value.length - update.length).fill(void 0));\n  }\n  if (isPlainObject(value) && isPlainObject(update)) {\n    return Object.keys({ ...value, ...update }).reduce((acc, key) => {\n      const diff = deepDiff(value?.[key], update?.[key]);\n      return diff === DEEPLY_EQUAL ? acc : Object.assign(acc, { [key]: diff });\n    }, {});\n  }\n  return update;\n}, \"deepDiff\");\nvar UNTARGETED = \"UNTARGETED\";\nfunction groupArgsByTarget({\n  args,\n  argTypes\n}) {\n  const groupedArgs = {};\n  Object.entries(args).forEach(([name, value]) => {\n    const { target = UNTARGETED } = argTypes[name] || {};\n    groupedArgs[target] = groupedArgs[target] || {};\n    groupedArgs[target][name] = value;\n  });\n  return groupedArgs;\n}\n__name(groupArgsByTarget, \"groupArgsByTarget\");\n\n// src/preview-api/modules/store/ArgsStore.ts\nfunction deleteUndefined(obj) {\n  Object.keys(obj).forEach((key) => obj[key] === void 0 && delete obj[key]);\n  return obj;\n}\n__name(deleteUndefined, \"deleteUndefined\");\nvar _ArgsStore = class _ArgsStore {\n  constructor() {\n    this.initialArgsByStoryId = {};\n    this.argsByStoryId = {};\n  }\n  get(storyId) {\n    if (!(storyId in this.argsByStoryId)) {\n      throw new Error(`No args known for ${storyId} -- has it been rendered yet?`);\n    }\n    return this.argsByStoryId[storyId];\n  }\n  setInitial(story) {\n    if (!this.initialArgsByStoryId[story.id]) {\n      this.initialArgsByStoryId[story.id] = story.initialArgs;\n      this.argsByStoryId[story.id] = story.initialArgs;\n    } else if (this.initialArgsByStoryId[story.id] !== story.initialArgs) {\n      const delta = deepDiff(this.initialArgsByStoryId[story.id], this.argsByStoryId[story.id]);\n      this.initialArgsByStoryId[story.id] = story.initialArgs;\n      this.argsByStoryId[story.id] = story.initialArgs;\n      if (delta !== DEEPLY_EQUAL) {\n        this.updateFromDelta(story, delta);\n      }\n    }\n  }\n  updateFromDelta(story, delta) {\n    const validatedDelta = validateOptions(delta, story.argTypes);\n    this.argsByStoryId[story.id] = combineArgs(this.argsByStoryId[story.id], validatedDelta);\n  }\n  updateFromPersisted(story, persisted) {\n    const mappedPersisted = mapArgsToTypes(persisted, story.argTypes);\n    return this.updateFromDelta(story, mappedPersisted);\n  }\n  update(storyId, argsUpdate) {\n    if (!(storyId in this.argsByStoryId)) {\n      throw new Error(`No args known for ${storyId} -- has it been rendered yet?`);\n    }\n    this.argsByStoryId[storyId] = deleteUndefined({\n      ...this.argsByStoryId[storyId],\n      ...argsUpdate\n    });\n  }\n};\n__name(_ArgsStore, \"ArgsStore\");\nvar ArgsStore = _ArgsStore;\n\n// src/preview-api/modules/store/GlobalsStore.ts\nimport { logger as logger2 } from \"storybook/internal/client-logger\";\n\n// src/preview-api/modules/store/csf/getValuesFromArgTypes.ts\nvar getValuesFromArgTypes = /* @__PURE__ */ __name((argTypes = {}) => Object.entries(argTypes).reduce((acc, [arg, { defaultValue }]) => {\n  if (typeof defaultValue !== \"undefined\") {\n    acc[arg] = defaultValue;\n  }\n  return acc;\n}, {}), \"getValuesFromArgTypes\");\n\n// src/preview-api/modules/store/GlobalsStore.ts\nvar _GlobalsStore = class _GlobalsStore {\n  constructor({\n    globals = {},\n    globalTypes = {}\n  }) {\n    this.set({ globals, globalTypes });\n  }\n  set({ globals = {}, globalTypes = {} }) {\n    const delta = this.initialGlobals && deepDiff(this.initialGlobals, this.globals);\n    this.allowedGlobalNames = /* @__PURE__ */ new Set([...Object.keys(globals), ...Object.keys(globalTypes)]);\n    const defaultGlobals = getValuesFromArgTypes(globalTypes);\n    this.initialGlobals = { ...defaultGlobals, ...globals };\n    this.globals = this.initialGlobals;\n    if (delta && delta !== DEEPLY_EQUAL) {\n      this.updateFromPersisted(delta);\n    }\n  }\n  filterAllowedGlobals(globals) {\n    return Object.entries(globals).reduce((acc, [key, value]) => {\n      if (this.allowedGlobalNames.has(key)) {\n        acc[key] = value;\n      } else {\n        logger2.warn(\n          `Attempted to set a global (${key}) that is not defined in initial globals or globalTypes`\n        );\n      }\n      return acc;\n    }, {});\n  }\n  updateFromPersisted(persisted) {\n    const allowedUrlGlobals = this.filterAllowedGlobals(persisted);\n    this.globals = { ...this.globals, ...allowedUrlGlobals };\n  }\n  get() {\n    return this.globals;\n  }\n  update(newGlobals) {\n    this.globals = { ...this.globals, ...this.filterAllowedGlobals(newGlobals) };\n    for (const key in newGlobals) {\n      if (newGlobals[key] === void 0) {\n        this.globals[key] = this.initialGlobals[key];\n      }\n    }\n  }\n};\n__name(_GlobalsStore, \"GlobalsStore\");\nvar GlobalsStore = _GlobalsStore;\n\n// src/preview-api/modules/store/StoryIndexStore.ts\nvar import_memoizerific = __toESM(require_memoizerific(), 1);\nimport { MissingStoryAfterHmrError } from \"storybook/internal/preview-errors\";\nvar getImportPathMap = (0, import_memoizerific.default)(1)(\n  (entries) => Object.values(entries).reduce(\n    (acc, entry) => {\n      acc[entry.importPath] = acc[entry.importPath] || entry;\n      return acc;\n    },\n    {}\n  )\n);\nvar _StoryIndexStore = class _StoryIndexStore {\n  constructor({ entries } = { v: 5, entries: {} }) {\n    this.entries = entries;\n  }\n  entryFromSpecifier(specifier) {\n    const entries = Object.values(this.entries);\n    if (specifier === \"*\") {\n      return entries[0];\n    }\n    if (typeof specifier === \"string\") {\n      if (this.entries[specifier]) {\n        return this.entries[specifier];\n      }\n      return entries.find((entry) => entry.id.startsWith(specifier));\n    }\n    const { name, title } = specifier;\n    return entries.find((entry) => entry.name === name && entry.title === title);\n  }\n  storyIdToEntry(storyId) {\n    const storyEntry = this.entries[storyId];\n    if (!storyEntry) {\n      throw new MissingStoryAfterHmrError({ storyId });\n    }\n    return storyEntry;\n  }\n  importPathToEntry(importPath) {\n    return getImportPathMap(this.entries)[importPath];\n  }\n};\n__name(_StoryIndexStore, \"StoryIndexStore\");\nvar StoryIndexStore = _StoryIndexStore;\n\n// src/preview-api/modules/store/csf/normalizeInputTypes.ts\nvar normalizeType = /* @__PURE__ */ __name((type) => {\n  return typeof type === \"string\" ? { name: type } : type;\n}, \"normalizeType\");\nvar normalizeControl = /* @__PURE__ */ __name((control) => typeof control === \"string\" ? { type: control } : control, \"normalizeControl\");\nvar normalizeInputType = /* @__PURE__ */ __name((inputType, key) => {\n  const { type, control, ...rest } = inputType;\n  const normalized = {\n    name: key,\n    ...rest\n  };\n  if (type) {\n    normalized.type = normalizeType(type);\n  }\n  if (control) {\n    normalized.control = normalizeControl(control);\n  } else if (control === false) {\n    normalized.control = { disable: true };\n  }\n  return normalized;\n}, \"normalizeInputType\");\nvar normalizeInputTypes = /* @__PURE__ */ __name((inputTypes) => mapValues(inputTypes, normalizeInputType), \"normalizeInputTypes\");\n\n// src/preview-api/modules/store/csf/normalizeStory.ts\nimport { deprecate, logger as logger3 } from \"storybook/internal/client-logger\";\nimport { storyNameFromExport, toId } from \"storybook/internal/csf\";\n\n// src/preview-api/modules/store/csf/normalizeArrays.ts\nvar normalizeArrays = /* @__PURE__ */ __name((array) => {\n  if (Array.isArray(array)) {\n    return array;\n  }\n  return array ? [array] : [];\n}, \"normalizeArrays\");\n\n// src/preview-api/modules/store/csf/normalizeStory.ts\nvar deprecatedStoryAnnotation = dedent`\nCSF .story annotations deprecated; annotate story functions directly:\n- StoryFn.story.name => StoryFn.storyName\n- StoryFn.story.(parameters|decorators) => StoryFn.(parameters|decorators)\nSee https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#hoisted-csf-annotations for details and codemod.\n`;\nfunction normalizeStory(key, storyAnnotations, meta) {\n  const storyObject = storyAnnotations;\n  const userStoryFn = typeof storyAnnotations === \"function\" ? storyAnnotations : null;\n  const { story } = storyObject;\n  if (story) {\n    logger3.debug(\"deprecated story\", story);\n    deprecate(deprecatedStoryAnnotation);\n  }\n  const exportName = storyNameFromExport(key);\n  const name = typeof storyObject !== \"function\" && storyObject.name || storyObject.storyName || story?.name || exportName;\n  const decorators = [\n    ...normalizeArrays(storyObject.decorators),\n    ...normalizeArrays(story?.decorators)\n  ];\n  const parameters = { ...story?.parameters, ...storyObject.parameters };\n  const args = { ...story?.args, ...storyObject.args };\n  const argTypes = { ...story?.argTypes, ...storyObject.argTypes };\n  const loaders = [...normalizeArrays(storyObject.loaders), ...normalizeArrays(story?.loaders)];\n  const beforeEach = [\n    ...normalizeArrays(storyObject.beforeEach),\n    ...normalizeArrays(story?.beforeEach)\n  ];\n  const afterEach = [\n    ...normalizeArrays(storyObject.afterEach),\n    ...normalizeArrays(story?.afterEach)\n  ];\n  const { render, play, tags = [], globals = {} } = storyObject;\n  const id = parameters.__id || toId(meta.id, exportName);\n  return {\n    moduleExport: storyAnnotations,\n    id,\n    name,\n    tags,\n    decorators,\n    parameters,\n    args,\n    argTypes: normalizeInputTypes(argTypes),\n    loaders,\n    beforeEach,\n    afterEach,\n    globals,\n    ...render && { render },\n    ...userStoryFn && { userStoryFn },\n    ...play && { play }\n  };\n}\n__name(normalizeStory, \"normalizeStory\");\n\n// src/preview-api/modules/store/csf/processCSFFile.ts\nimport { logger as logger4 } from \"storybook/internal/client-logger\";\nimport { getStoryChildren, isExportStory, isStory, toTestId } from \"storybook/internal/csf\";\n\n// src/preview-api/modules/store/csf/normalizeComponentAnnotations.ts\nimport { sanitize } from \"storybook/internal/csf\";\nfunction normalizeComponentAnnotations(defaultExport, title = defaultExport.title, importPath) {\n  const { id, argTypes } = defaultExport;\n  return {\n    id: sanitize(id || title),\n    ...defaultExport,\n    title,\n    ...argTypes && { argTypes: normalizeInputTypes(argTypes) },\n    parameters: {\n      fileName: importPath,\n      ...defaultExport.parameters\n    }\n  };\n}\n__name(normalizeComponentAnnotations, \"normalizeComponentAnnotations\");\n\n// src/preview-api/modules/store/csf/processCSFFile.ts\nvar checkGlobals = /* @__PURE__ */ __name((parameters) => {\n  const { globals, globalTypes } = parameters;\n  if (globals || globalTypes) {\n    logger4.error(\n      \"Global args/argTypes can only be set globally\",\n      JSON.stringify({\n        globals,\n        globalTypes\n      })\n    );\n  }\n}, \"checkGlobals\");\nvar checkStorySort = /* @__PURE__ */ __name((parameters) => {\n  const { options } = parameters;\n  if (options?.storySort) {\n    logger4.error(\"The storySort option parameter can only be set globally\");\n  }\n}, \"checkStorySort\");\nvar checkDisallowedParameters = /* @__PURE__ */ __name((parameters) => {\n  if (!parameters) {\n    return;\n  }\n  checkGlobals(parameters);\n  checkStorySort(parameters);\n}, \"checkDisallowedParameters\");\nfunction processCSFFile(moduleExports, importPath, title) {\n  const { default: defaultExport, __namedExportsOrder, ...namedExports } = moduleExports;\n  const firstStory = Object.values(namedExports)[0];\n  if (isStory(firstStory)) {\n    const meta2 = normalizeComponentAnnotations(firstStory.meta.input, title, importPath);\n    checkDisallowedParameters(meta2.parameters);\n    const csfFile2 = { meta: meta2, stories: {}, moduleExports };\n    Object.keys(namedExports).forEach((key) => {\n      if (isExportStory(key, meta2)) {\n        const story = namedExports[key];\n        const storyMeta = normalizeStory(key, story.input, meta2);\n        checkDisallowedParameters(storyMeta.parameters);\n        csfFile2.stories[storyMeta.id] = storyMeta;\n        getStoryChildren(story).forEach((child) => {\n          const name = child.input.name;\n          const childId = toTestId(storyMeta.id, name);\n          child.input.parameters ??= {};\n          child.input.parameters.__id = childId;\n          csfFile2.stories[childId] = normalizeStory(name, child.input, meta2);\n        });\n      }\n    });\n    csfFile2.projectAnnotations = firstStory.meta.preview.composed;\n    return csfFile2;\n  }\n  const meta = normalizeComponentAnnotations(\n    defaultExport,\n    title,\n    importPath\n  );\n  checkDisallowedParameters(meta.parameters);\n  const csfFile = { meta, stories: {}, moduleExports };\n  Object.keys(namedExports).forEach((key) => {\n    if (isExportStory(key, meta)) {\n      const storyMeta = normalizeStory(key, namedExports[key], meta);\n      checkDisallowedParameters(storyMeta.parameters);\n      csfFile.stories[storyMeta.id] = storyMeta;\n    }\n  });\n  return csfFile;\n}\n__name(processCSFFile, \"processCSFFile\");\n\n// src/preview-api/modules/store/csf/prepareStory.ts\nimport { combineTags, includeConditionalArg } from \"storybook/internal/csf\";\nimport { NoRenderFunctionError } from \"storybook/internal/preview-errors\";\nimport { global as global3 } from \"@storybook/global\";\nimport { global as globalThis2 } from \"@storybook/global\";\n\n// src/preview-api/modules/preview-web/render/mount-utils.ts\nfunction mountDestructured(playFunction) {\n  return playFunction != null && getUsedProps(playFunction).includes(\"mount\");\n}\n__name(mountDestructured, \"mountDestructured\");\nfunction getUsedProps(fn) {\n  const match = fn.toString().match(/[^(]*\\(([^)]*)/);\n  if (!match) {\n    return [];\n  }\n  const args = splitByComma(match[1]);\n  if (!args.length) {\n    return [];\n  }\n  const first = args[0];\n  if (!(first.startsWith(\"{\") && first.endsWith(\"}\"))) {\n    return [];\n  }\n  const props = splitByComma(first.slice(1, -1).replace(/\\s/g, \"\")).map((prop) => {\n    return prop.replace(/:.*|=.*/g, \"\");\n  });\n  return props;\n}\n__name(getUsedProps, \"getUsedProps\");\nfunction splitByComma(s) {\n  const result = [];\n  const stack = [];\n  let start = 0;\n  for (let i = 0; i < s.length; i++) {\n    if (s[i] === \"{\" || s[i] === \"[\") {\n      stack.push(s[i] === \"{\" ? \"}\" : \"]\");\n    } else if (s[i] === stack[stack.length - 1]) {\n      stack.pop();\n    } else if (!stack.length && s[i] === \",\") {\n      const token = s.substring(start, i).trim();\n      if (token) {\n        result.push(token);\n      }\n      start = i + 1;\n    }\n  }\n  const lastToken = s.substring(start).trim();\n  if (lastToken) {\n    result.push(lastToken);\n  }\n  return result;\n}\n__name(splitByComma, \"splitByComma\");\n\n// src/preview-api/modules/store/decorators.ts\nfunction decorateStory(storyFn, decorator, bindWithContext) {\n  const boundStoryFunction = bindWithContext(storyFn);\n  return (context) => decorator(boundStoryFunction, context);\n}\n__name(decorateStory, \"decorateStory\");\nfunction sanitizeStoryContextUpdate({\n  componentId,\n  title,\n  kind,\n  id,\n  name,\n  story,\n  parameters,\n  initialArgs,\n  argTypes,\n  ...update\n} = {}) {\n  return update;\n}\n__name(sanitizeStoryContextUpdate, \"sanitizeStoryContextUpdate\");\nfunction defaultDecorateStory(storyFn, decorators) {\n  const contextStore = {};\n  const bindWithContext = /* @__PURE__ */ __name((decoratedStoryFn) => (update) => {\n    if (!contextStore.value) {\n      throw new Error(\"Decorated function called without init\");\n    }\n    contextStore.value = {\n      ...contextStore.value,\n      ...sanitizeStoryContextUpdate(update)\n    };\n    return decoratedStoryFn(contextStore.value);\n  }, \"bindWithContext\");\n  const decoratedWithContextStore = decorators.reduce(\n    (story, decorator) => decorateStory(story, decorator, bindWithContext),\n    storyFn\n  );\n  return (context) => {\n    contextStore.value = context;\n    return decoratedWithContextStore(context);\n  };\n}\n__name(defaultDecorateStory, \"defaultDecorateStory\");\n\n// src/preview-api/modules/store/csf/prepareStory.ts\nfunction prepareStory(storyAnnotations, componentAnnotations, projectAnnotations) {\n  const { moduleExport, id, name } = storyAnnotations || {};\n  const partialAnnotations = preparePartialAnnotations(\n    storyAnnotations,\n    componentAnnotations,\n    projectAnnotations\n  );\n  const applyLoaders = /* @__PURE__ */ __name(async (context) => {\n    const loaded = {};\n    for (const loaders of [\n      normalizeArrays(projectAnnotations.loaders),\n      normalizeArrays(componentAnnotations.loaders),\n      normalizeArrays(storyAnnotations.loaders)\n    ]) {\n      if (context.abortSignal.aborted) {\n        return loaded;\n      }\n      const loadResults = await Promise.all(loaders.map((loader) => loader(context)));\n      Object.assign(loaded, ...loadResults);\n    }\n    return loaded;\n  }, \"applyLoaders\");\n  const applyBeforeEach = /* @__PURE__ */ __name(async (context) => {\n    const cleanupCallbacks = new Array();\n    for (const beforeEach of [\n      ...normalizeArrays(projectAnnotations.beforeEach),\n      ...normalizeArrays(componentAnnotations.beforeEach),\n      ...normalizeArrays(storyAnnotations.beforeEach)\n    ]) {\n      if (context.abortSignal.aborted) {\n        return cleanupCallbacks;\n      }\n      const cleanup = await beforeEach(context);\n      if (cleanup) {\n        cleanupCallbacks.push(cleanup);\n      }\n    }\n    return cleanupCallbacks;\n  }, \"applyBeforeEach\");\n  const applyAfterEach = /* @__PURE__ */ __name(async (context) => {\n    const reversedFinalizers = [\n      ...normalizeArrays(projectAnnotations.afterEach),\n      ...normalizeArrays(componentAnnotations.afterEach),\n      ...normalizeArrays(storyAnnotations.afterEach)\n    ].reverse();\n    for (const finalizer of reversedFinalizers) {\n      if (context.abortSignal.aborted) {\n        return;\n      }\n      await finalizer(context);\n    }\n  }, \"applyAfterEach\");\n  const undecoratedStoryFn = /* @__PURE__ */ __name((context) => context.originalStoryFn(context.args, context), \"undecoratedStoryFn\");\n  const { applyDecorators = defaultDecorateStory, runStep } = projectAnnotations;\n  const decorators = [\n    ...normalizeArrays(storyAnnotations?.decorators),\n    ...normalizeArrays(componentAnnotations?.decorators),\n    ...normalizeArrays(projectAnnotations?.decorators)\n  ];\n  const render = storyAnnotations?.userStoryFn || storyAnnotations?.render || componentAnnotations.render || projectAnnotations.render;\n  const decoratedStoryFn = applyHooks(applyDecorators)(undecoratedStoryFn, decorators);\n  const unboundStoryFn = /* @__PURE__ */ __name((context) => decoratedStoryFn(context), \"unboundStoryFn\");\n  const playFunction = storyAnnotations?.play ?? componentAnnotations?.play;\n  const usesMount = mountDestructured(playFunction);\n  if (!render && !usesMount) {\n    throw new NoRenderFunctionError({ id });\n  }\n  const defaultMount = /* @__PURE__ */ __name((context) => {\n    return async () => {\n      await context.renderToCanvas();\n      return context.canvas;\n    };\n  }, \"defaultMount\");\n  const mount = storyAnnotations.mount ?? componentAnnotations.mount ?? projectAnnotations.mount ?? defaultMount;\n  const testingLibraryRender = projectAnnotations.testingLibraryRender;\n  return {\n    storyGlobals: {},\n    ...partialAnnotations,\n    moduleExport,\n    id,\n    name,\n    story: name,\n    originalStoryFn: render,\n    undecoratedStoryFn,\n    unboundStoryFn,\n    applyLoaders,\n    applyBeforeEach,\n    applyAfterEach,\n    playFunction,\n    runStep,\n    mount,\n    testingLibraryRender,\n    renderToCanvas: projectAnnotations.renderToCanvas,\n    usesMount\n  };\n}\n__name(prepareStory, \"prepareStory\");\nfunction prepareMeta(componentAnnotations, projectAnnotations, moduleExport) {\n  return {\n    ...preparePartialAnnotations(void 0, componentAnnotations, projectAnnotations),\n    moduleExport\n  };\n}\n__name(prepareMeta, \"prepareMeta\");\nfunction preparePartialAnnotations(storyAnnotations, componentAnnotations, projectAnnotations) {\n  const defaultTags = [\"dev\", \"test\"];\n  const extraTags = globalThis2.DOCS_OPTIONS?.autodocs === true ? [\"autodocs\"] : [];\n  const overrideTags = storyAnnotations?.tags?.includes(\"test-fn\") ? [\"!autodocs\"] : [];\n  const tags = combineTags(\n    ...defaultTags,\n    ...extraTags,\n    ...projectAnnotations.tags ?? [],\n    ...componentAnnotations.tags ?? [],\n    ...overrideTags,\n    ...storyAnnotations?.tags ?? []\n  );\n  const parameters = combineParameters(\n    projectAnnotations.parameters,\n    componentAnnotations.parameters,\n    storyAnnotations?.parameters\n  );\n  const { argTypesEnhancers = [], argsEnhancers = [] } = projectAnnotations;\n  const passedArgTypes = combineParameters(\n    projectAnnotations.argTypes,\n    componentAnnotations.argTypes,\n    storyAnnotations?.argTypes\n  );\n  if (storyAnnotations) {\n    const render = storyAnnotations?.userStoryFn || storyAnnotations?.render || componentAnnotations.render || projectAnnotations.render;\n    parameters.__isArgsStory = render && render.length > 0;\n  }\n  const passedArgs = {\n    ...projectAnnotations.args,\n    ...componentAnnotations.args,\n    ...storyAnnotations?.args\n  };\n  const storyGlobals = {\n    ...componentAnnotations.globals,\n    ...storyAnnotations?.globals\n  };\n  const contextForEnhancers = {\n    componentId: componentAnnotations.id,\n    title: componentAnnotations.title,\n    kind: componentAnnotations.title,\n    // Back compat\n    id: storyAnnotations?.id || componentAnnotations.id,\n    // if there's no story name, we create a fake one since enhancers expect a name\n    name: storyAnnotations?.name || \"__meta\",\n    story: storyAnnotations?.name || \"__meta\",\n    // Back compat\n    component: componentAnnotations.component,\n    subcomponents: componentAnnotations.subcomponents,\n    tags,\n    parameters,\n    initialArgs: passedArgs,\n    argTypes: passedArgTypes,\n    storyGlobals\n  };\n  contextForEnhancers.argTypes = argTypesEnhancers.reduce(\n    (accumulatedArgTypes, enhancer) => enhancer({ ...contextForEnhancers, argTypes: accumulatedArgTypes }),\n    contextForEnhancers.argTypes\n  );\n  const initialArgsBeforeEnhancers = { ...passedArgs };\n  contextForEnhancers.initialArgs = [...argsEnhancers].reduce(\n    (accumulatedArgs, enhancer) => ({\n      ...accumulatedArgs,\n      ...enhancer({\n        ...contextForEnhancers,\n        initialArgs: accumulatedArgs\n      })\n    }),\n    initialArgsBeforeEnhancers\n  );\n  const { name, story, ...withoutStoryIdentifiers } = contextForEnhancers;\n  return withoutStoryIdentifiers;\n}\n__name(preparePartialAnnotations, \"preparePartialAnnotations\");\nfunction prepareContext(context) {\n  const { args: unmappedArgs } = context;\n  let targetedContext = {\n    ...context,\n    allArgs: void 0,\n    argsByTarget: void 0\n  };\n  if (global3.FEATURES?.argTypeTargetsV7) {\n    const argsByTarget = groupArgsByTarget(context);\n    targetedContext = {\n      ...context,\n      allArgs: context.args,\n      argsByTarget,\n      args: argsByTarget[UNTARGETED] || {}\n    };\n  }\n  const mappedArgs = Object.entries(targetedContext.args).reduce((acc, [key, val]) => {\n    if (!targetedContext.argTypes[key]?.mapping) {\n      acc[key] = val;\n      return acc;\n    }\n    const mappingFn = /* @__PURE__ */ __name((originalValue) => {\n      const mapping = targetedContext.argTypes[key].mapping;\n      return mapping && originalValue in mapping ? mapping[originalValue] : originalValue;\n    }, \"mappingFn\");\n    acc[key] = Array.isArray(val) ? val.map(mappingFn) : mappingFn(val);\n    return acc;\n  }, {});\n  const includedArgs = Object.entries(mappedArgs).reduce((acc, [key, val]) => {\n    const argType = targetedContext.argTypes[key] || {};\n    if (includeConditionalArg(argType, mappedArgs, targetedContext.globals)) {\n      acc[key] = val;\n    }\n    return acc;\n  }, {});\n  return { ...targetedContext, unmappedArgs, args: includedArgs };\n}\n__name(prepareContext, \"prepareContext\");\n\n// src/preview-api/modules/store/inferArgTypes.ts\nimport { logger as logger5 } from \"storybook/internal/client-logger\";\nvar inferType = /* @__PURE__ */ __name((value, name, visited) => {\n  const type = typeof value;\n  switch (type) {\n    case \"boolean\":\n    case \"string\":\n    case \"number\":\n    case \"function\":\n    case \"symbol\":\n      return { name: type };\n    default:\n      break;\n  }\n  if (value) {\n    if (visited.has(value)) {\n      logger5.warn(dedent`\n        We've detected a cycle in arg '${name}'. Args should be JSON-serializable.\n\n        Consider using the mapping feature or fully custom args:\n        - Mapping: https://storybook.js.org/docs/writing-stories/args#mapping-to-complex-arg-values\n        - Custom args: https://storybook.js.org/docs/essentials/controls#fully-custom-args\n      `);\n      return { name: \"other\", value: \"cyclic object\" };\n    }\n    visited.add(value);\n    if (Array.isArray(value)) {\n      const childType = value.length > 0 ? inferType(value[0], name, new Set(visited)) : { name: \"other\", value: \"unknown\" };\n      return { name: \"array\", value: childType };\n    }\n    const fieldTypes = mapValues(value, (field) => inferType(field, name, new Set(visited)));\n    return { name: \"object\", value: fieldTypes };\n  }\n  return { name: \"object\", value: {} };\n}, \"inferType\");\nvar inferArgTypes = /* @__PURE__ */ __name((context) => {\n  const { id, argTypes: userArgTypes = {}, initialArgs = {} } = context;\n  const argTypes = mapValues(initialArgs, (arg, key) => ({\n    name: key,\n    type: inferType(arg, `${id}.${key}`, /* @__PURE__ */ new Set())\n  }));\n  const userArgTypesNames = mapValues(userArgTypes, (argType, key) => ({\n    name: key\n  }));\n  return combineParameters(argTypes, userArgTypesNames, userArgTypes);\n}, \"inferArgTypes\");\ninferArgTypes.secondPass = true;\n\n// src/preview-api/modules/store/inferControls.ts\nimport { logger as logger6 } from \"storybook/internal/client-logger\";\n\n// src/preview-api/modules/store/filterArgTypes.ts\nvar matches = /* @__PURE__ */ __name((name, descriptor) => Array.isArray(descriptor) ? descriptor.includes(name) : name.match(descriptor), \"matches\");\nvar filterArgTypes = /* @__PURE__ */ __name((argTypes, include, exclude) => {\n  if (!include && !exclude) {\n    return argTypes;\n  }\n  return argTypes && pickBy(argTypes, (argType, key) => {\n    const name = argType.name || key.toString();\n    return !!(!include || matches(name, include)) && (!exclude || !matches(name, exclude));\n  });\n}, \"filterArgTypes\");\n\n// src/preview-api/modules/store/inferControls.ts\nvar inferControl = /* @__PURE__ */ __name((argType, name, matchers) => {\n  const { type, options } = argType;\n  if (!type) {\n    return void 0;\n  }\n  if (matchers.color && matchers.color.test(name)) {\n    const controlType = type.name;\n    if (controlType === \"string\") {\n      return { control: { type: \"color\" } };\n    }\n    if (controlType !== \"enum\") {\n      logger6.warn(\n        `Addon controls: Control of type color only supports string, received \"${controlType}\" instead`\n      );\n    }\n  }\n  if (matchers.date && matchers.date.test(name)) {\n    return { control: { type: \"date\" } };\n  }\n  switch (type.name) {\n    case \"array\":\n      return { control: { type: \"object\" } };\n    case \"boolean\":\n      return { control: { type: \"boolean\" } };\n    case \"string\":\n      return { control: { type: \"text\" } };\n    case \"number\":\n      return { control: { type: \"number\" } };\n    case \"enum\": {\n      const { value } = type;\n      return { control: { type: value?.length <= 5 ? \"radio\" : \"select\" }, options: value };\n    }\n    case \"function\":\n    case \"symbol\":\n      return null;\n    default:\n      return { control: { type: options ? \"select\" : \"object\" } };\n  }\n}, \"inferControl\");\nvar inferControls = /* @__PURE__ */ __name((context) => {\n  const {\n    argTypes,\n    parameters: { __isArgsStory, controls: { include = null, exclude = null, matchers = {} } = {} }\n  } = context;\n  if (!__isArgsStory) {\n    return argTypes;\n  }\n  const filteredArgTypes = filterArgTypes(argTypes, include, exclude);\n  const withControls = mapValues(filteredArgTypes, (argType, name) => {\n    return argType?.type && inferControl(argType, name.toString(), matchers);\n  });\n  return combineParameters(withControls, filteredArgTypes);\n}, \"inferControls\");\ninferControls.secondPass = true;\n\n// src/preview-api/modules/store/csf/normalizeProjectAnnotations.ts\nfunction normalizeProjectAnnotations({\n  argTypes,\n  globalTypes,\n  argTypesEnhancers,\n  decorators,\n  loaders,\n  beforeEach,\n  afterEach,\n  initialGlobals,\n  ...annotations\n}) {\n  return {\n    ...argTypes && { argTypes: normalizeInputTypes(argTypes) },\n    ...globalTypes && { globalTypes: normalizeInputTypes(globalTypes) },\n    decorators: normalizeArrays(decorators),\n    loaders: normalizeArrays(loaders),\n    beforeEach: normalizeArrays(beforeEach),\n    afterEach: normalizeArrays(afterEach),\n    argTypesEnhancers: [\n      ...argTypesEnhancers || [],\n      inferArgTypes,\n      // There's an architectural decision to be made regarding embedded addons in core:\n      //\n      // Option 1: Keep embedded addons but ensure consistency by moving addon-specific code\n      // (like inferControls) to live alongside the addon code itself. This maintains the\n      // concept of core addons while improving code organization.\n      //\n      // Option 2: Fully integrate these addons into core, potentially moving UI components\n      // into the manager and treating them as core features rather than addons. This is a\n      // bigger architectural change requiring careful consideration.\n      //\n      // For now, we're keeping inferControls here as we need time to properly evaluate\n      // these options and their implications. Some features (like Angular's cleanArgsDecorator)\n      // currently rely on this behavior.\n      //\n      // TODO: Make an architectural decision on the handling of core addons\n      inferControls\n    ],\n    initialGlobals,\n    ...annotations\n  };\n}\n__name(normalizeProjectAnnotations, \"normalizeProjectAnnotations\");\n\n// src/preview-api/modules/store/csf/composeConfigs.ts\nimport { global as global4 } from \"@storybook/global\";\n\n// src/preview-api/modules/store/csf/beforeAll.ts\nvar composeBeforeAllHooks = /* @__PURE__ */ __name((hooks) => {\n  return async () => {\n    const cleanups2 = [];\n    for (const hook of hooks) {\n      const cleanup = await hook();\n      if (cleanup) {\n        cleanups2.unshift(cleanup);\n      }\n    }\n    return async () => {\n      for (const cleanup of cleanups2) {\n        await cleanup();\n      }\n    };\n  };\n}, \"composeBeforeAllHooks\");\n\n// src/preview-api/modules/store/csf/stepRunners.ts\nfunction composeStepRunners(stepRunners) {\n  return async (label, play, playContext) => {\n    const composedPlay = stepRunners.reduceRight(\n      (innerPlay, stepRunner) => async () => stepRunner(label, innerPlay, playContext),\n      async () => play(playContext)\n    );\n    await composedPlay();\n  };\n}\n__name(composeStepRunners, \"composeStepRunners\");\n\n// src/preview-api/modules/store/csf/composeConfigs.ts\nfunction getField(moduleExportList, field) {\n  return moduleExportList.map((xs) => xs.default?.[field] ?? xs[field]).filter(Boolean);\n}\n__name(getField, \"getField\");\nfunction getArrayField(moduleExportList, field, options = {}) {\n  return getField(moduleExportList, field).reduce((prev, cur) => {\n    const normalized = normalizeArrays(cur);\n    return options.reverseFileOrder ? [...normalized, ...prev] : [...prev, ...normalized];\n  }, []);\n}\n__name(getArrayField, \"getArrayField\");\nfunction getObjectField(moduleExportList, field) {\n  return Object.assign({}, ...getField(moduleExportList, field));\n}\n__name(getObjectField, \"getObjectField\");\nfunction getSingletonField(moduleExportList, field) {\n  return getField(moduleExportList, field).pop();\n}\n__name(getSingletonField, \"getSingletonField\");\nfunction composeConfigs(moduleExportList) {\n  const allArgTypeEnhancers = getArrayField(moduleExportList, \"argTypesEnhancers\");\n  const stepRunners = getField(moduleExportList, \"runStep\");\n  const beforeAllHooks = getArrayField(moduleExportList, \"beforeAll\");\n  return {\n    parameters: combineParameters(...getField(moduleExportList, \"parameters\")),\n    decorators: getArrayField(moduleExportList, \"decorators\", {\n      reverseFileOrder: !(global4.FEATURES?.legacyDecoratorFileOrder ?? false)\n    }),\n    args: getObjectField(moduleExportList, \"args\"),\n    argsEnhancers: getArrayField(moduleExportList, \"argsEnhancers\"),\n    argTypes: getObjectField(moduleExportList, \"argTypes\"),\n    argTypesEnhancers: [\n      ...allArgTypeEnhancers.filter((e) => !e.secondPass),\n      ...allArgTypeEnhancers.filter((e) => e.secondPass)\n    ],\n    initialGlobals: getObjectField(moduleExportList, \"initialGlobals\"),\n    globalTypes: getObjectField(moduleExportList, \"globalTypes\"),\n    loaders: getArrayField(moduleExportList, \"loaders\"),\n    beforeAll: composeBeforeAllHooks(beforeAllHooks),\n    beforeEach: getArrayField(moduleExportList, \"beforeEach\"),\n    afterEach: getArrayField(moduleExportList, \"afterEach\"),\n    render: getSingletonField(moduleExportList, \"render\"),\n    renderToCanvas: getSingletonField(moduleExportList, \"renderToCanvas\"),\n    applyDecorators: getSingletonField(moduleExportList, \"applyDecorators\"),\n    runStep: composeStepRunners(stepRunners),\n    tags: getArrayField(moduleExportList, \"tags\"),\n    mount: getSingletonField(moduleExportList, \"mount\"),\n    testingLibraryRender: getSingletonField(moduleExportList, \"testingLibraryRender\")\n  };\n}\n__name(composeConfigs, \"composeConfigs\");\n\n// src/preview-api/modules/store/csf/portable-stories.ts\nimport { isExportStory as isExportStory2 } from \"storybook/internal/csf\";\nimport { getCoreAnnotations } from \"storybook/internal/csf\";\nimport { MountMustBeDestructuredError } from \"storybook/internal/preview-errors\";\n\n// src/preview-api/modules/store/reporter-api.ts\nvar _ReporterAPI = class _ReporterAPI {\n  constructor() {\n    this.reports = [];\n  }\n  async addReport(report) {\n    this.reports.push(report);\n  }\n};\n__name(_ReporterAPI, \"ReporterAPI\");\nvar ReporterAPI = _ReporterAPI;\n\n// src/preview-api/modules/store/csf/csf-factory-utils.ts\nimport { isMeta, isStory as isStory2 } from \"storybook/internal/csf\";\nfunction getCsfFactoryAnnotations(story, meta, projectAnnotations) {\n  return isStory2(story) ? {\n    story: story.input,\n    meta: story.meta.input,\n    preview: story.meta.preview.composed\n  } : { story, meta: isMeta(meta) ? meta.input : meta, preview: projectAnnotations };\n}\n__name(getCsfFactoryAnnotations, \"getCsfFactoryAnnotations\");\n\n// src/preview-api/modules/store/csf/portable-stories.ts\nfunction setDefaultProjectAnnotations(_defaultProjectAnnotations) {\n  globalThis.defaultProjectAnnotations = _defaultProjectAnnotations;\n}\n__name(setDefaultProjectAnnotations, \"setDefaultProjectAnnotations\");\nvar DEFAULT_STORY_TITLE = \"ComposedStory\";\nvar DEFAULT_STORY_NAME = \"Unnamed Story\";\nfunction extractAnnotation(annotation) {\n  if (!annotation) {\n    return {};\n  }\n  return composeConfigs([annotation]);\n}\n__name(extractAnnotation, \"extractAnnotation\");\nfunction setProjectAnnotations(projectAnnotations) {\n  const annotations = Array.isArray(projectAnnotations) ? projectAnnotations : [projectAnnotations];\n  globalThis.globalProjectAnnotations = composeConfigs([\n    ...getCoreAnnotations(),\n    globalThis.defaultProjectAnnotations ?? {},\n    composeConfigs(annotations.map(extractAnnotation))\n  ]);\n  return globalThis.globalProjectAnnotations ?? {};\n}\n__name(setProjectAnnotations, \"setProjectAnnotations\");\nvar cleanups = [];\nfunction composeStory(storyAnnotations, componentAnnotations, projectAnnotations, defaultConfig, exportsName) {\n  if (storyAnnotations === void 0) {\n    throw new Error(\"Expected a story but received undefined.\");\n  }\n  componentAnnotations.title = componentAnnotations.title ?? DEFAULT_STORY_TITLE;\n  const normalizedComponentAnnotations = normalizeComponentAnnotations(componentAnnotations);\n  const storyName = exportsName || storyAnnotations.storyName || storyAnnotations.story?.name || storyAnnotations.name || DEFAULT_STORY_NAME;\n  const normalizedStory = normalizeStory(\n    storyName,\n    storyAnnotations,\n    normalizedComponentAnnotations\n  );\n  const normalizedProjectAnnotations = normalizeProjectAnnotations(\n    composeConfigs([\n      defaultConfig ?? globalThis.globalProjectAnnotations ?? {},\n      projectAnnotations ?? {}\n    ])\n  );\n  const story = prepareStory(\n    normalizedStory,\n    normalizedComponentAnnotations,\n    normalizedProjectAnnotations\n  );\n  const globalsFromGlobalTypes = getValuesFromArgTypes(normalizedProjectAnnotations.globalTypes);\n  const globals = {\n    ...globalsFromGlobalTypes,\n    ...normalizedProjectAnnotations.initialGlobals,\n    ...story.storyGlobals\n  };\n  const reporting = new ReporterAPI();\n  const initializeContext = /* @__PURE__ */ __name(() => {\n    const context = prepareContext({\n      hooks: new HooksContext(),\n      globals,\n      args: { ...story.initialArgs },\n      viewMode: \"story\",\n      reporting,\n      loaded: {},\n      abortSignal: new AbortController().signal,\n      step: /* @__PURE__ */ __name((label, play2) => story.runStep(label, play2, context), \"step\"),\n      canvasElement: null,\n      canvas: {},\n      userEvent: {},\n      globalTypes: normalizedProjectAnnotations.globalTypes,\n      ...story,\n      context: null,\n      mount: null\n    });\n    context.parameters.__isPortableStory = true;\n    context.context = context;\n    if (story.renderToCanvas) {\n      context.renderToCanvas = async () => {\n        const unmount = await story.renderToCanvas?.(\n          {\n            componentId: story.componentId,\n            title: story.title,\n            id: story.id,\n            name: story.name,\n            tags: story.tags,\n            showMain: /* @__PURE__ */ __name(() => {\n            }, \"showMain\"),\n            showError: /* @__PURE__ */ __name((error) => {\n              throw new Error(`${error.title}\n${error.description}`);\n            }, \"showError\"),\n            showException: /* @__PURE__ */ __name((error) => {\n              throw error;\n            }, \"showException\"),\n            forceRemount: true,\n            storyContext: context,\n            storyFn: /* @__PURE__ */ __name(() => story.unboundStoryFn(context), \"storyFn\"),\n            unboundStoryFn: story.unboundStoryFn\n          },\n          context.canvasElement\n        );\n        if (unmount) {\n          cleanups.push(unmount);\n        }\n      };\n    }\n    context.mount = story.mount(context);\n    return context;\n  }, \"initializeContext\");\n  let loadedContext;\n  const play = /* @__PURE__ */ __name(async (extraContext) => {\n    const context = initializeContext();\n    context.canvasElement ??= globalThis?.document?.body;\n    if (loadedContext) {\n      context.loaded = loadedContext.loaded;\n    }\n    Object.assign(context, extraContext);\n    return story.playFunction(context);\n  }, \"play\");\n  const run = /* @__PURE__ */ __name((extraContext) => {\n    const context = initializeContext();\n    Object.assign(context, extraContext);\n    return runStory(story, context);\n  }, \"run\");\n  const playFunction = story.playFunction ? play : void 0;\n  const composedStory = Object.assign(\n    /* @__PURE__ */ __name(function storyFn(extraArgs) {\n      const context = initializeContext();\n      if (loadedContext) {\n        context.loaded = loadedContext.loaded;\n      }\n      context.args = {\n        ...context.initialArgs,\n        ...extraArgs\n      };\n      return story.unboundStoryFn(context);\n    }, \"storyFn\"),\n    {\n      id: story.id,\n      storyName,\n      load: /* @__PURE__ */ __name(async () => {\n        for (const callback of [...cleanups].reverse()) {\n          await callback();\n        }\n        cleanups.length = 0;\n        const context = initializeContext();\n        context.loaded = await story.applyLoaders(context);\n        cleanups.push(...(await story.applyBeforeEach(context)).filter(Boolean));\n        loadedContext = context;\n      }, \"load\"),\n      globals,\n      args: story.initialArgs,\n      parameters: story.parameters,\n      argTypes: story.argTypes,\n      play: playFunction,\n      run,\n      reporting,\n      tags: story.tags\n    }\n  );\n  return composedStory;\n}\n__name(composeStory, \"composeStory\");\nvar defaultComposeStory = /* @__PURE__ */ __name((story, component, project, exportsName) => composeStory(story, component, project, {}, exportsName), \"defaultComposeStory\");\nfunction composeStories(storiesImport, globalConfig, composeStoryFn = defaultComposeStory) {\n  const { default: metaExport, __esModule, __namedExportsOrder, ...stories } = storiesImport;\n  let meta = metaExport;\n  const composedStories = Object.entries(stories).reduce(\n    (storiesMap, [exportsName, story]) => {\n      const { story: storyAnnotations, meta: componentAnnotations } = getCsfFactoryAnnotations(story);\n      if (!meta && componentAnnotations) {\n        meta = componentAnnotations;\n      }\n      if (!isExportStory2(exportsName, meta)) {\n        return storiesMap;\n      }\n      const result = Object.assign(storiesMap, {\n        [exportsName]: composeStoryFn(storyAnnotations, meta, globalConfig, exportsName)\n      });\n      return result;\n    },\n    {}\n  );\n  return composedStories;\n}\n__name(composeStories, \"composeStories\");\nfunction createPlaywrightTest(baseTest) {\n  return baseTest.extend({\n    mount: /* @__PURE__ */ __name(async ({ mount, page }, use) => {\n      await use(async (storyRef, ...restArgs) => {\n        if (!(\"__pw_type\" in storyRef) || \"__pw_type\" in storyRef && storyRef.__pw_type !== \"jsx\") {\n          throw new Error(dedent`\n              Portable stories in Playwright CT only work when referencing JSX elements.\n              Please use JSX format for your components such as:\n\n              instead of:\n              await mount(MyComponent, { props: { foo: 'bar' } })\n\n              do:\n              await mount(<MyComponent foo=\"bar\"/>)\n\n              More info: https://storybook.js.org/docs/api/portable-stories/portable-stories-playwright?ref=error\n            `);\n        }\n        const { props, ...storyRefWithoutProps } = storyRef;\n        await page.evaluate(async (wrappedStoryRef) => {\n          const unwrappedStoryRef = await globalThis.__pwUnwrapObject?.(wrappedStoryRef);\n          const story = \"__pw_type\" in unwrappedStoryRef ? unwrappedStoryRef.type : unwrappedStoryRef;\n          return story?.load?.();\n        }, storyRefWithoutProps);\n        const mountResult = await mount(storyRef, ...restArgs);\n        await page.evaluate(async (wrappedStoryRef) => {\n          const unwrappedStoryRef = await globalThis.__pwUnwrapObject?.(wrappedStoryRef);\n          const story = \"__pw_type\" in unwrappedStoryRef ? unwrappedStoryRef.type : unwrappedStoryRef;\n          const canvasElement = document.querySelector(\"#root\");\n          return story?.play?.({ canvasElement });\n        }, storyRefWithoutProps);\n        return mountResult;\n      });\n    }, \"mount\")\n  });\n}\n__name(createPlaywrightTest, \"createPlaywrightTest\");\nasync function runStory(story, context) {\n  for (const callback of [...cleanups].reverse()) {\n    await callback();\n  }\n  cleanups.length = 0;\n  if (!context.canvasElement) {\n    const container = document.createElement(\"div\");\n    globalThis?.document?.body?.appendChild(container);\n    context.canvasElement = container;\n    cleanups.push(() => {\n      if (globalThis?.document?.body?.contains(container)) {\n        globalThis?.document?.body?.removeChild(container);\n      }\n    });\n  }\n  context.loaded = await story.applyLoaders(context);\n  if (context.abortSignal.aborted) {\n    return;\n  }\n  cleanups.push(...(await story.applyBeforeEach(context)).filter(Boolean));\n  const playFunction = story.playFunction;\n  const isMountDestructured = story.usesMount;\n  if (!isMountDestructured) {\n    await context.mount();\n  }\n  if (context.abortSignal.aborted) {\n    return;\n  }\n  if (playFunction) {\n    if (!isMountDestructured) {\n      context.mount = async () => {\n        throw new MountMustBeDestructuredError({ playFunction: playFunction.toString() });\n      };\n    }\n    await playFunction(context);\n  }\n  let cleanUp;\n  if (isTestEnvironment()) {\n    cleanUp = pauseAnimations();\n  } else {\n    await waitForAnimations(context.abortSignal);\n  }\n  await story.applyAfterEach(context);\n  await cleanUp?.();\n}\n__name(runStory, \"runStory\");\n\n// src/preview-api/modules/store/StoryStore.ts\nvar CSF_CACHE_SIZE = 1e3;\nvar STORY_CACHE_SIZE = 1e4;\nvar _StoryStore = class _StoryStore {\n  constructor(storyIndex, importFn, projectAnnotations) {\n    this.importFn = importFn;\n    this.storyIndex = new StoryIndexStore(storyIndex);\n    this.projectAnnotations = normalizeProjectAnnotations(\n      composeConfigs([...getCoreAnnotations2(), projectAnnotations])\n    );\n    const { initialGlobals, globalTypes } = this.projectAnnotations;\n    this.args = new ArgsStore();\n    this.userGlobals = new GlobalsStore({ globals: initialGlobals, globalTypes });\n    this.hooks = {};\n    this.cleanupCallbacks = {};\n    this.processCSFFileWithCache = (0, import_memoizerific2.default)(CSF_CACHE_SIZE)(processCSFFile);\n    this.prepareMetaWithCache = (0, import_memoizerific2.default)(CSF_CACHE_SIZE)(prepareMeta);\n    this.prepareStoryWithCache = (0, import_memoizerific2.default)(STORY_CACHE_SIZE)(prepareStory);\n  }\n  setProjectAnnotations(projectAnnotations) {\n    this.projectAnnotations = normalizeProjectAnnotations(projectAnnotations);\n    const { initialGlobals, globalTypes } = projectAnnotations;\n    this.userGlobals.set({ globals: initialGlobals, globalTypes });\n  }\n  // This means that one of the CSF files has changed.\n  // If the `importFn` has changed, we will invalidate both caches.\n  // If the `storyIndex` data has changed, we may or may not invalidate the caches, depending\n  // on whether we've loaded the relevant files yet.\n  async onStoriesChanged({\n    importFn,\n    storyIndex\n  }) {\n    if (importFn) {\n      this.importFn = importFn;\n    }\n    if (storyIndex) {\n      this.storyIndex.entries = storyIndex.entries;\n    }\n    if (this.cachedCSFFiles) {\n      await this.cacheAllCSFFiles();\n    }\n  }\n  // Get an entry from the index, waiting on initialization if necessary\n  async storyIdToEntry(storyId) {\n    return this.storyIndex.storyIdToEntry(storyId);\n  }\n  // To load a single CSF file to service a story we need to look up the importPath in the index\n  async loadCSFFileByStoryId(storyId) {\n    const { importPath, title } = this.storyIndex.storyIdToEntry(storyId);\n    const moduleExports = await this.importFn(importPath);\n    return this.processCSFFileWithCache(moduleExports, importPath, title);\n  }\n  async loadAllCSFFiles() {\n    const importPaths = {};\n    Object.entries(this.storyIndex.entries).forEach(([storyId, { importPath }]) => {\n      importPaths[importPath] = storyId;\n    });\n    const list = await Promise.all(\n      Object.entries(importPaths).map(async ([importPath, storyId]) => ({\n        importPath,\n        csfFile: await this.loadCSFFileByStoryId(storyId)\n      }))\n    );\n    return list.reduce(\n      (acc, { importPath, csfFile }) => {\n        acc[importPath] = csfFile;\n        return acc;\n      },\n      {}\n    );\n  }\n  async cacheAllCSFFiles() {\n    this.cachedCSFFiles = await this.loadAllCSFFiles();\n  }\n  preparedMetaFromCSFFile({ csfFile }) {\n    const componentAnnotations = csfFile.meta;\n    return this.prepareMetaWithCache(\n      componentAnnotations,\n      this.projectAnnotations,\n      csfFile.moduleExports.default\n    );\n  }\n  // Load the CSF file for a story and prepare the story from it and the project annotations.\n  async loadStory({ storyId }) {\n    const csfFile = await this.loadCSFFileByStoryId(storyId);\n    return this.storyFromCSFFile({ storyId, csfFile });\n  }\n  // This function is synchronous for convenience -- often times if you have a CSF file already\n  // it is easier not to have to await `loadStory`.\n  storyFromCSFFile({\n    storyId,\n    csfFile\n  }) {\n    const storyAnnotations = csfFile.stories[storyId];\n    if (!storyAnnotations) {\n      throw new MissingStoryFromCsfFileError({ storyId });\n    }\n    const componentAnnotations = csfFile.meta;\n    const story = this.prepareStoryWithCache(\n      storyAnnotations,\n      componentAnnotations,\n      csfFile.projectAnnotations ?? this.projectAnnotations\n    );\n    this.args.setInitial(story);\n    this.hooks[story.id] = this.hooks[story.id] || new HooksContext();\n    return story;\n  }\n  // If we have a CSF file we can get all the stories from it synchronously\n  componentStoriesFromCSFFile({\n    csfFile\n  }) {\n    return Object.keys(this.storyIndex.entries).filter((storyId) => !!csfFile.stories[storyId]).map((storyId) => this.storyFromCSFFile({ storyId, csfFile }));\n  }\n  async loadEntry(id) {\n    const entry = await this.storyIdToEntry(id);\n    const storyImports = entry.type === \"docs\" ? entry.storiesImports : [];\n    const [entryExports, ...csfFiles] = await Promise.all([\n      this.importFn(entry.importPath),\n      ...storyImports.map((storyImportPath) => {\n        const firstStoryEntry = this.storyIndex.importPathToEntry(storyImportPath);\n        return this.loadCSFFileByStoryId(firstStoryEntry.id);\n      })\n    ]);\n    return { entryExports, csfFiles };\n  }\n  // A prepared story does not include args, globals or hooks. These are stored in the story store\n  // and updated separately to the (immutable) story.\n  getStoryContext(story, { forceInitialArgs = false } = {}) {\n    const userGlobals = this.userGlobals.get();\n    const { initialGlobals } = this.userGlobals;\n    const reporting = new ReporterAPI();\n    return prepareContext({\n      ...story,\n      args: forceInitialArgs ? story.initialArgs : this.args.get(story.id),\n      initialGlobals,\n      globalTypes: this.projectAnnotations.globalTypes,\n      userGlobals,\n      reporting,\n      globals: {\n        ...userGlobals,\n        ...story.storyGlobals\n      },\n      hooks: this.hooks[story.id]\n    });\n  }\n  addCleanupCallbacks(story, ...callbacks) {\n    this.cleanupCallbacks[story.id] = (this.cleanupCallbacks[story.id] || []).concat(callbacks);\n  }\n  async cleanupStory(story) {\n    this.hooks[story.id].clean();\n    const callbacks = this.cleanupCallbacks[story.id];\n    if (callbacks) {\n      for (const callback of [...callbacks].reverse()) {\n        await callback();\n      }\n    }\n    delete this.cleanupCallbacks[story.id];\n  }\n  extract(options = { includeDocsOnly: false }) {\n    const { cachedCSFFiles } = this;\n    console.log(\"extract: extracting stories\", cachedCSFFiles);\n    if (!cachedCSFFiles) {\n      throw new CalledExtractOnStoreError();\n    }\n    const stories = Object.entries(this.storyIndex.entries).reduce(\n      (acc, [storyId, entry]) => {\n        if (entry.type === \"docs\") {\n          return acc;\n        }\n        const csfFile = cachedCSFFiles[entry.importPath];\n        const story = this.storyFromCSFFile({ storyId, csfFile });\n        if (!options.includeDocsOnly && story.parameters.docsOnly) {\n          return acc;\n        }\n        acc[storyId] = Object.entries(story).reduce(\n          (storyAcc, [key, value]) => {\n            if (key === \"story\" && entry.subtype === \"test\") {\n              return { ...storyAcc, story: entry.parentName };\n            }\n            if (key === \"moduleExport\") {\n              return storyAcc;\n            }\n            if (typeof value === \"function\") {\n              return storyAcc;\n            }\n            if (Array.isArray(value)) {\n              return Object.assign(storyAcc, { [key]: value.slice().sort() });\n            }\n            return Object.assign(storyAcc, { [key]: value });\n          },\n          {\n            args: story.initialArgs,\n            globals: {\n              ...this.userGlobals.initialGlobals,\n              ...this.userGlobals.globals,\n              ...story.storyGlobals\n            },\n            storyId: entry.parent ? entry.parent : storyId\n          }\n        );\n        return acc;\n      },\n      {}\n    );\n    console.log(\"extract: stories\", stories);\n    return stories;\n  }\n};\n__name(_StoryStore, \"StoryStore\");\nvar StoryStore = _StoryStore;\n\n// src/preview-api/modules/store/autoTitle.ts\nimport { once as once2 } from \"storybook/internal/client-logger\";\n\n// ../node_modules/slash/index.js\nfunction slash(path) {\n  const isExtendedLengthPath = path.startsWith(\"\\\\\\\\?\\\\\");\n  if (isExtendedLengthPath) {\n    return path;\n  }\n  return path.replace(/\\\\/g, \"/\");\n}\n__name(slash, \"slash\");\n\n// src/preview-api/modules/store/autoTitle.ts\nvar sanitize2 = /* @__PURE__ */ __name((parts) => {\n  if (parts.length === 0) {\n    return parts;\n  }\n  const last = parts[parts.length - 1];\n  const lastStripped = last?.replace(/(?:[.](?:story|stories))?([.][^.]+)$/i, \"\");\n  if (parts.length === 1) {\n    return [lastStripped];\n  }\n  const nextToLast = parts[parts.length - 2];\n  if (lastStripped && nextToLast && lastStripped.toLowerCase() === nextToLast.toLowerCase()) {\n    return [...parts.slice(0, -2), lastStripped];\n  }\n  return lastStripped && (/^(story|stories)([.][^.]+)$/i.test(last) || /^index$/i.test(lastStripped)) ? parts.slice(0, -1) : [...parts.slice(0, -1), lastStripped];\n}, \"sanitize\");\nfunction pathJoin(paths) {\n  return paths.flatMap((p) => p.split(\"/\")).filter(Boolean).join(\"/\");\n}\n__name(pathJoin, \"pathJoin\");\nvar userOrAutoTitleFromSpecifier = /* @__PURE__ */ __name((fileName, entry, userTitle) => {\n  const { directory, importPathMatcher, titlePrefix = \"\" } = entry || {};\n  if (typeof fileName === \"number\") {\n    once2.warn(dedent`\n      CSF Auto-title received a numeric fileName. This typically happens when\n      webpack is mis-configured in production mode. To force webpack to produce\n      filenames, set optimization.moduleIds = \"named\" in your webpack config.\n    `);\n  }\n  const normalizedFileName = slash(String(fileName));\n  if (importPathMatcher.exec(normalizedFileName)) {\n    if (!userTitle) {\n      const suffix = normalizedFileName.replace(directory, \"\");\n      let parts = pathJoin([titlePrefix, suffix]).split(\"/\");\n      parts = sanitize2(parts);\n      return parts.join(\"/\");\n    }\n    if (!titlePrefix) {\n      return userTitle;\n    }\n    return pathJoin([titlePrefix, userTitle]);\n  }\n  return void 0;\n}, \"userOrAutoTitleFromSpecifier\");\nvar userOrAutoTitle = /* @__PURE__ */ __name((fileName, storiesEntries, userTitle) => {\n  for (let i = 0; i < storiesEntries.length; i += 1) {\n    const title = userOrAutoTitleFromSpecifier(fileName, storiesEntries[i], userTitle);\n    if (title) {\n      return title;\n    }\n  }\n  return userTitle || void 0;\n}, \"userOrAutoTitle\");\n\n// src/preview-api/modules/store/storySort.ts\nvar STORY_KIND_PATH_SEPARATOR = /\\s*\\/\\s*/;\nvar storySort = /* @__PURE__ */ __name((options = {}) => (a, b) => {\n  if (a.title === b.title && !options.includeNames) {\n    return 0;\n  }\n  const method = options.method || \"configure\";\n  let order = options.order || [];\n  const storyTitleA = a.title.trim().split(STORY_KIND_PATH_SEPARATOR);\n  const storyTitleB = b.title.trim().split(STORY_KIND_PATH_SEPARATOR);\n  if (options.includeNames) {\n    storyTitleA.push(a.name);\n    storyTitleB.push(b.name);\n  }\n  let depth = 0;\n  while (storyTitleA[depth] || storyTitleB[depth]) {\n    if (!storyTitleA[depth]) {\n      return -1;\n    }\n    if (!storyTitleB[depth]) {\n      return 1;\n    }\n    const nameA = storyTitleA[depth];\n    const nameB = storyTitleB[depth];\n    if (nameA !== nameB) {\n      let indexA = order.indexOf(nameA);\n      let indexB = order.indexOf(nameB);\n      const indexWildcard = order.indexOf(\"*\");\n      if (indexA !== -1 || indexB !== -1) {\n        if (indexA === -1) {\n          if (indexWildcard !== -1) {\n            indexA = indexWildcard;\n          } else {\n            indexA = order.length;\n          }\n        }\n        if (indexB === -1) {\n          if (indexWildcard !== -1) {\n            indexB = indexWildcard;\n          } else {\n            indexB = order.length;\n          }\n        }\n        return indexA - indexB;\n      }\n      if (method === \"configure\") {\n        return 0;\n      }\n      return nameA.localeCompare(nameB, options.locales ? options.locales : void 0, {\n        numeric: true,\n        sensitivity: \"accent\"\n      });\n    }\n    let index = order.indexOf(nameA);\n    if (index === -1) {\n      index = order.indexOf(\"*\");\n    }\n    order = index !== -1 && Array.isArray(order[index + 1]) ? order[index + 1] : [];\n    depth += 1;\n  }\n  return 0;\n}, \"storySort\");\n\n// src/preview-api/modules/store/sortStories.ts\nvar sortStoriesCommon = /* @__PURE__ */ __name((stories, storySortParameter, fileNameOrder) => {\n  if (storySortParameter) {\n    let sortFn;\n    if (typeof storySortParameter === \"function\") {\n      sortFn = storySortParameter;\n    } else {\n      sortFn = storySort(storySortParameter);\n    }\n    stories.sort(sortFn);\n  } else {\n    stories.sort(\n      (s1, s2) => fileNameOrder.indexOf(s1.importPath) - fileNameOrder.indexOf(s2.importPath)\n    );\n  }\n  return stories;\n}, \"sortStoriesCommon\");\nvar sortStoriesV7 = /* @__PURE__ */ __name((stories, storySortParameter, fileNameOrder) => {\n  try {\n    return sortStoriesCommon(stories, storySortParameter, fileNameOrder);\n  } catch (err) {\n    throw new Error(dedent`\n    Error sorting stories with sort parameter ${storySortParameter}:\n\n    > ${err.message}\n\n    Are you using a V6-style sort function in V7 mode?\n\n    More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#v7-style-story-sort\n  `);\n  }\n}, \"sortStoriesV7\");\n\n// src/preview-api/modules/preview-web/Preview.tsx\nimport { deprecate as deprecate2, logger as logger7 } from \"storybook/internal/client-logger\";\nimport {\n  ARGTYPES_INFO_REQUEST,\n  ARGTYPES_INFO_RESPONSE,\n  CONFIG_ERROR,\n  FORCE_REMOUNT,\n  FORCE_RE_RENDER as FORCE_RE_RENDER2,\n  GLOBALS_UPDATED,\n  PREVIEW_INITIALIZED,\n  RESET_STORY_ARGS as RESET_STORY_ARGS2,\n  SET_GLOBALS,\n  STORY_ARGS_UPDATED,\n  STORY_HOT_UPDATED,\n  STORY_INDEX_INVALIDATED,\n  UPDATE_GLOBALS as UPDATE_GLOBALS2,\n  UPDATE_STORY_ARGS as UPDATE_STORY_ARGS2\n} from \"storybook/internal/core-events\";\nimport {\n  CalledPreviewMethodBeforeInitializationError,\n  MissingRenderToCanvasError,\n  StoryIndexFetchError,\n  StoryStoreAccessedBeforeInitializationError\n} from \"storybook/internal/preview-errors\";\nimport { global as global5 } from \"@storybook/global\";\n\n// src/preview-api/modules/preview-web/render/StoryRender.ts\nimport {\n  PLAY_FUNCTION_THREW_EXCEPTION,\n  STORY_FINISHED,\n  STORY_RENDERED as STORY_RENDERED2,\n  STORY_RENDER_PHASE_CHANGED,\n  UNHANDLED_ERRORS_WHILE_PLAYING\n} from \"storybook/internal/core-events\";\nimport {\n  MountMustBeDestructuredError as MountMustBeDestructuredError2,\n  NoStoryMountedError\n} from \"storybook/internal/preview-errors\";\n\n// src/preview-api/modules/preview-web/render/Render.ts\nvar PREPARE_ABORTED = new Error(\"prepareAborted\");\n\n// src/preview-api/modules/preview-web/render/StoryRender.ts\nvar { AbortController: AbortController2 } = globalThis;\nfunction serializeError(error) {\n  try {\n    const { name = \"Error\", message = String(error), stack } = error;\n    return { name, message, stack };\n  } catch (e) {\n    return { name: \"Error\", message: String(error) };\n  }\n}\n__name(serializeError, \"serializeError\");\nvar _StoryRender = class _StoryRender {\n  constructor(channel, store, renderToScreen, callbacks, id, viewMode, renderOptions = { autoplay: true, forceInitialArgs: false }, story) {\n    this.channel = channel;\n    this.store = store;\n    this.renderToScreen = renderToScreen;\n    this.callbacks = callbacks;\n    this.id = id;\n    this.viewMode = viewMode;\n    this.renderOptions = renderOptions;\n    this.type = \"story\";\n    this.notYetRendered = true;\n    this.rerenderEnqueued = false;\n    this.disableKeyListeners = false;\n    this.teardownRender = /* @__PURE__ */ __name(() => {\n    }, \"teardownRender\");\n    this.torndown = false;\n    this.abortController = new AbortController2();\n    this.renderId = Date.now();\n    if (story) {\n      this.story = story;\n      this.phase = \"preparing\";\n    }\n  }\n  async runPhase(signal, phase, phaseFn) {\n    this.phase = phase;\n    this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n      newPhase: this.phase,\n      renderId: this.renderId,\n      storyId: this.id\n    });\n    if (phaseFn) {\n      await phaseFn();\n      this.checkIfAborted(signal);\n    }\n  }\n  checkIfAborted(signal) {\n    if (signal.aborted && ![\"finished\", \"aborted\", \"errored\"].includes(this.phase)) {\n      this.phase = \"aborted\";\n      this.channel.emit(STORY_RENDER_PHASE_CHANGED, {\n        newPhase: this.phase,\n        renderId: this.renderId,\n        storyId: this.id\n      });\n    }\n    return signal.aborted;\n  }\n  async prepare() {\n    await this.runPhase(this.abortController.signal, \"preparing\", async () => {\n      this.story = await this.store.loadStory({ storyId: this.id });\n    });\n    if (this.abortController.signal.aborted) {\n      await this.store.cleanupStory(this.story);\n      throw PREPARE_ABORTED;\n    }\n  }\n  // The two story \"renders\" are equal and have both loaded the same story\n  isEqual(other) {\n    return !!(this.id === other.id && this.story && this.story === other.story);\n  }\n  isPreparing() {\n    return [\"preparing\"].includes(this.phase);\n  }\n  isPending() {\n    return [\"loading\", \"beforeEach\", \"rendering\", \"playing\", \"afterEach\"].includes(\n      this.phase\n    );\n  }\n  async renderToElement(canvasElement) {\n    this.canvasElement = canvasElement;\n    return this.render({ initial: true, forceRemount: true });\n  }\n  storyContext() {\n    if (!this.story) {\n      throw new Error(`Cannot call storyContext before preparing`);\n    }\n    const { forceInitialArgs } = this.renderOptions;\n    return this.store.getStoryContext(this.story, { forceInitialArgs });\n  }\n  async render({\n    initial = false,\n    forceRemount = false\n  } = {}) {\n    const { canvasElement } = this;\n    if (!this.story) {\n      throw new Error(\"cannot render when not prepared\");\n    }\n    const story = this.story;\n    if (!canvasElement) {\n      throw new Error(\"cannot render when canvasElement is unset\");\n    }\n    const {\n      id,\n      componentId,\n      title,\n      name,\n      tags,\n      applyLoaders,\n      applyBeforeEach,\n      applyAfterEach,\n      unboundStoryFn,\n      playFunction,\n      runStep\n    } = story;\n    if (forceRemount && !initial) {\n      this.cancelRender();\n      this.abortController = new AbortController2();\n    }\n    const abortSignal = this.abortController.signal;\n    let mounted = false;\n    const isMountDestructured = story.usesMount;\n    try {\n      const context = {\n        ...this.storyContext(),\n        viewMode: this.viewMode,\n        abortSignal,\n        canvasElement,\n        loaded: {},\n        step: /* @__PURE__ */ __name((label, play) => runStep(label, play, context), \"step\"),\n        context: null,\n        canvas: {},\n        userEvent: {},\n        renderToCanvas: /* @__PURE__ */ __name(async () => {\n          const teardown = await this.renderToScreen(renderContext, canvasElement);\n          this.teardownRender = teardown || (() => {\n          });\n          mounted = true;\n        }, \"renderToCanvas\"),\n        // The story provides (set in a renderer) a mount function that is a higher order function\n        // (context) => (...args) => Canvas\n        //\n        // Before assigning it to the context, we resolve the context dependency,\n        // so that a user can just call it as await mount(...args) in their play function.\n        mount: /* @__PURE__ */ __name(async (...args) => {\n          this.callbacks.showStoryDuringRender?.();\n          let mountReturn = null;\n          await this.runPhase(abortSignal, \"rendering\", async () => {\n            mountReturn = await story.mount(context)(...args);\n          });\n          if (isMountDestructured) {\n            await this.runPhase(abortSignal, \"playing\");\n          }\n          return mountReturn;\n        }, \"mount\")\n      };\n      context.context = context;\n      const renderContext = {\n        componentId,\n        title,\n        kind: title,\n        id,\n        name,\n        story: name,\n        tags,\n        ...this.callbacks,\n        showError: /* @__PURE__ */ __name((error) => {\n          this.phase = \"errored\";\n          return this.callbacks.showError(error);\n        }, \"showError\"),\n        showException: /* @__PURE__ */ __name((error) => {\n          this.phase = \"errored\";\n          return this.callbacks.showException(error);\n        }, \"showException\"),\n        forceRemount: forceRemount || this.notYetRendered,\n        storyContext: context,\n        storyFn: /* @__PURE__ */ __name(() => unboundStoryFn(context), \"storyFn\"),\n        unboundStoryFn\n      };\n      await this.runPhase(abortSignal, \"loading\", async () => {\n        context.loaded = await applyLoaders(context);\n      });\n      if (abortSignal.aborted) {\n        return;\n      }\n      const cleanupCallbacks = await applyBeforeEach(context);\n      this.store.addCleanupCallbacks(story, ...cleanupCallbacks);\n      if (this.checkIfAborted(abortSignal)) {\n        return;\n      }\n      if (!mounted && !isMountDestructured) {\n        await context.mount();\n      }\n      this.notYetRendered = false;\n      if (abortSignal.aborted) {\n        return;\n      }\n      const ignoreUnhandledErrors = this.story.parameters?.test?.dangerouslyIgnoreUnhandledErrors === true;\n      const unhandledErrors = /* @__PURE__ */ new Set();\n      const onError = /* @__PURE__ */ __name((event) => {\n        if (event.error) {\n          unhandledErrors.add(event.error);\n        }\n      }, \"onError\");\n      const onUnhandledRejection = /* @__PURE__ */ __name((event) => {\n        if (event.reason) {\n          unhandledErrors.add(event.reason);\n        }\n      }, \"onUnhandledRejection\");\n      if (this.renderOptions.autoplay && forceRemount && playFunction && this.phase !== \"errored\") {\n        window?.addEventListener?.(\"error\", onError);\n        window?.addEventListener?.(\"unhandledrejection\", onUnhandledRejection);\n        this.disableKeyListeners = true;\n        try {\n          if (!isMountDestructured) {\n            context.mount = async () => {\n              throw new MountMustBeDestructuredError2({ playFunction: playFunction.toString() });\n            };\n            await this.runPhase(abortSignal, \"playing\", async () => playFunction(context));\n          } else {\n            await playFunction(context);\n          }\n          if (!mounted) {\n            throw new NoStoryMountedError();\n          }\n          this.checkIfAborted(abortSignal);\n          if (!ignoreUnhandledErrors && unhandledErrors.size > 0) {\n            await this.runPhase(abortSignal, \"errored\");\n          } else {\n            await this.runPhase(abortSignal, \"played\");\n          }\n        } catch (error) {\n          this.callbacks.showStoryDuringRender?.();\n          await this.runPhase(abortSignal, \"errored\", async () => {\n            this.channel.emit(PLAY_FUNCTION_THREW_EXCEPTION, serializeError(error));\n          });\n          if (this.story.parameters.throwPlayFunctionExceptions !== false) {\n            throw error;\n          }\n          console.error(error);\n        }\n        if (!ignoreUnhandledErrors && unhandledErrors.size > 0) {\n          this.channel.emit(\n            UNHANDLED_ERRORS_WHILE_PLAYING,\n            Array.from(unhandledErrors).map(serializeError)\n          );\n        }\n        this.disableKeyListeners = false;\n        window?.removeEventListener?.(\"unhandledrejection\", onUnhandledRejection);\n        window?.removeEventListener?.(\"error\", onError);\n        if (abortSignal.aborted) {\n          return;\n        }\n      }\n      await this.runPhase(abortSignal, \"completing\", async () => {\n        if (isTestEnvironment()) {\n          this.store.addCleanupCallbacks(story, pauseAnimations());\n        } else {\n          await waitForAnimations(abortSignal);\n        }\n      });\n      await this.runPhase(abortSignal, \"completed\", async () => {\n        this.channel.emit(STORY_RENDERED2, id);\n      });\n      if (this.phase !== \"errored\") {\n        await this.runPhase(abortSignal, \"afterEach\", async () => {\n          await applyAfterEach(context);\n        });\n      }\n      const hasUnhandledErrors = !ignoreUnhandledErrors && unhandledErrors.size > 0;\n      const hasSomeReportsFailed = context.reporting.reports.some(\n        (report) => report.status === \"failed\"\n      );\n      const hasStoryErrored = hasUnhandledErrors || hasSomeReportsFailed;\n      await this.runPhase(\n        abortSignal,\n        \"finished\",\n        async () => this.channel.emit(STORY_FINISHED, {\n          storyId: id,\n          status: hasStoryErrored ? \"error\" : \"success\",\n          reporters: context.reporting.reports\n        })\n      );\n    } catch (err) {\n      this.phase = \"errored\";\n      this.callbacks.showException(err);\n      await this.runPhase(\n        abortSignal,\n        \"finished\",\n        async () => this.channel.emit(STORY_FINISHED, {\n          storyId: id,\n          status: \"error\",\n          reporters: []\n        })\n      );\n    }\n    if (this.rerenderEnqueued) {\n      this.rerenderEnqueued = false;\n      this.render();\n    }\n  }\n  /**\n   * Rerender the story. If the story is currently pending (loading/rendering), the rerender will be\n   * enqueued, and will be executed after the current render is completed. Rerendering while playing\n   * will not be enqueued, and will be executed immediately, to support rendering args changes while\n   * playing.\n   */\n  async rerender() {\n    if (this.isPending() && this.phase !== \"playing\") {\n      this.rerenderEnqueued = true;\n    } else {\n      return this.render();\n    }\n  }\n  async remount() {\n    await this.teardown();\n    return this.render({ forceRemount: true });\n  }\n  // If the story is torn down (either a new story is rendered or the docs page removes it)\n  // we need to consider the fact that the initial render may not be finished\n  // (possibly the loaders or the play function are still running). We use the controller\n  // as a method to abort them, ASAP, but this is not foolproof as we cannot control what\n  // happens inside the user's code.\n  cancelRender() {\n    this.abortController.abort();\n  }\n  cancelPlayFunction() {\n    if (this.phase === \"playing\") {\n      this.abortController.abort();\n      this.runPhase(this.abortController.signal, \"aborted\");\n    }\n  }\n  async teardown() {\n    this.torndown = true;\n    this.cancelRender();\n    if (this.story) {\n      await this.store.cleanupStory(this.story);\n    }\n    for (let i = 0; i < 3; i += 1) {\n      if (!this.isPending()) {\n        await this.teardownRender();\n        return;\n      }\n      await new Promise((resolve) => setTimeout(resolve, 0));\n    }\n    window?.location?.reload?.();\n    await new Promise(() => {\n    });\n  }\n};\n__name(_StoryRender, \"StoryRender\");\nvar StoryRender = _StoryRender;\n\n// src/preview-api/modules/preview-web/Preview.tsx\nvar { fetch } = global5;\nvar STORY_INDEX_PATH = \"./index.json\";\nvar _Preview = class _Preview {\n  constructor(importFn, getProjectAnnotations, channel = addons.getChannel(), shouldInitialize = true) {\n    this.importFn = importFn;\n    this.getProjectAnnotations = getProjectAnnotations;\n    this.channel = channel;\n    this.storyRenders = [];\n    this.storeInitializationPromise = new Promise((resolve, reject) => {\n      this.resolveStoreInitializationPromise = resolve;\n      this.rejectStoreInitializationPromise = reject;\n    });\n    if (shouldInitialize) {\n      this.initialize();\n    }\n  }\n  // Create a proxy object for `__STORYBOOK_STORY_STORE__` and `__STORYBOOK_PREVIEW__.storyStore`\n  // That proxies through to the store once ready, and errors beforehand. This means we can set\n  // `__STORYBOOK_STORY_STORE__ = __STORYBOOK_PREVIEW__.storyStore` without having to wait, and\n  // similarly integrators can access the `storyStore` on the preview at any time, although\n  // it is considered deprecated and we will no longer allow access in 9.0\n  get storyStore() {\n    return new Proxy(\n      {},\n      {\n        get: /* @__PURE__ */ __name((_, method) => {\n          if (this.storyStoreValue) {\n            deprecate2(\"Accessing the Story Store is deprecated and will be removed in 9.0\");\n            return this.storyStoreValue[method];\n          }\n          throw new StoryStoreAccessedBeforeInitializationError();\n        }, \"get\")\n      }\n    );\n  }\n  // INITIALIZATION\n  async initialize() {\n    this.setupListeners();\n    try {\n      const projectAnnotations = await this.getProjectAnnotationsOrRenderError();\n      await this.runBeforeAllHook(projectAnnotations);\n      await this.initializeWithProjectAnnotations(projectAnnotations);\n      const userAgent = globalThis?.navigator?.userAgent;\n      await this.channel.emit(PREVIEW_INITIALIZED, { userAgent });\n    } catch (err) {\n      this.rejectStoreInitializationPromise(err);\n    }\n  }\n  ready() {\n    return this.storeInitializationPromise;\n  }\n  setupListeners() {\n    this.channel.on(STORY_INDEX_INVALIDATED, this.onStoryIndexChanged.bind(this));\n    this.channel.on(UPDATE_GLOBALS2, this.onUpdateGlobals.bind(this));\n    this.channel.on(UPDATE_STORY_ARGS2, this.onUpdateArgs.bind(this));\n    this.channel.on(ARGTYPES_INFO_REQUEST, this.onRequestArgTypesInfo.bind(this));\n    this.channel.on(RESET_STORY_ARGS2, this.onResetArgs.bind(this));\n    this.channel.on(FORCE_RE_RENDER2, this.onForceReRender.bind(this));\n    this.channel.on(FORCE_REMOUNT, this.onForceRemount.bind(this));\n    this.channel.on(STORY_HOT_UPDATED, this.onStoryHotUpdated.bind(this));\n  }\n  async getProjectAnnotationsOrRenderError() {\n    try {\n      const projectAnnotations = await this.getProjectAnnotations();\n      this.renderToCanvas = projectAnnotations.renderToCanvas;\n      if (!this.renderToCanvas) {\n        throw new MissingRenderToCanvasError();\n      }\n      return projectAnnotations;\n    } catch (err) {\n      this.renderPreviewEntryError(\"Error reading preview.js:\", err);\n      throw err;\n    }\n  }\n  // If initialization gets as far as project annotations, this function runs.\n  async initializeWithProjectAnnotations(projectAnnotations) {\n    this.projectAnnotationsBeforeInitialization = projectAnnotations;\n    try {\n      const storyIndex = await this.getStoryIndexFromServer();\n      return this.initializeWithStoryIndex(storyIndex);\n    } catch (err) {\n      this.renderPreviewEntryError(\"Error loading story index:\", err);\n      throw err;\n    }\n  }\n  async runBeforeAllHook(projectAnnotations) {\n    try {\n      await this.beforeAllCleanup?.();\n      this.beforeAllCleanup = await projectAnnotations.beforeAll?.();\n    } catch (err) {\n      this.renderPreviewEntryError(\"Error in beforeAll hook:\", err);\n      throw err;\n    }\n  }\n  async getStoryIndexFromServer() {\n    const result = await fetch(STORY_INDEX_PATH);\n    if (result.status === 200) {\n      return result.json();\n    }\n    throw new StoryIndexFetchError({ text: await result.text() });\n  }\n  // If initialization gets as far as the story index, this function runs.\n  initializeWithStoryIndex(storyIndex) {\n    if (!this.projectAnnotationsBeforeInitialization) {\n      throw new Error(\"Cannot call initializeWithStoryIndex until project annotations resolve\");\n    }\n    this.storyStoreValue = new StoryStore(\n      storyIndex,\n      this.importFn,\n      this.projectAnnotationsBeforeInitialization\n    );\n    delete this.projectAnnotationsBeforeInitialization;\n    this.setInitialGlobals();\n    this.resolveStoreInitializationPromise();\n  }\n  async setInitialGlobals() {\n    this.emitGlobals();\n  }\n  emitGlobals() {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({ methodName: \"emitGlobals\" });\n    }\n    const payload = {\n      globals: this.storyStoreValue.userGlobals.get() || {},\n      globalTypes: this.storyStoreValue.projectAnnotations.globalTypes || {}\n    };\n    this.channel.emit(SET_GLOBALS, payload);\n  }\n  // EVENT HANDLERS\n  // This happens when a config file gets reloaded\n  async onGetProjectAnnotationsChanged({\n    getProjectAnnotations\n  }) {\n    delete this.previewEntryError;\n    this.getProjectAnnotations = getProjectAnnotations;\n    const projectAnnotations = await this.getProjectAnnotationsOrRenderError();\n    await this.runBeforeAllHook(projectAnnotations);\n    if (!this.storyStoreValue) {\n      await this.initializeWithProjectAnnotations(projectAnnotations);\n      return;\n    }\n    this.storyStoreValue.setProjectAnnotations(projectAnnotations);\n    this.emitGlobals();\n  }\n  async onStoryIndexChanged() {\n    delete this.previewEntryError;\n    if (!this.storyStoreValue && !this.projectAnnotationsBeforeInitialization) {\n      return;\n    }\n    try {\n      const storyIndex = await this.getStoryIndexFromServer();\n      if (this.projectAnnotationsBeforeInitialization) {\n        this.initializeWithStoryIndex(storyIndex);\n        return;\n      }\n      await this.onStoriesChanged({ storyIndex });\n    } catch (err) {\n      this.renderPreviewEntryError(\"Error loading story index:\", err);\n      throw err;\n    }\n  }\n  // This happens when a glob gets HMR-ed\n  async onStoriesChanged({\n    importFn,\n    storyIndex\n  }) {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({ methodName: \"onStoriesChanged\" });\n    }\n    await this.storyStoreValue.onStoriesChanged({ importFn, storyIndex });\n  }\n  async onUpdateGlobals({\n    globals: updatedGlobals,\n    currentStory\n  }) {\n    if (!this.storyStoreValue) {\n      await this.storeInitializationPromise;\n    }\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({ methodName: \"onUpdateGlobals\" });\n    }\n    this.storyStoreValue.userGlobals.update(updatedGlobals);\n    if (currentStory) {\n      const { initialGlobals, storyGlobals, userGlobals, globals } = this.storyStoreValue.getStoryContext(currentStory);\n      this.channel.emit(GLOBALS_UPDATED, {\n        initialGlobals,\n        userGlobals,\n        storyGlobals,\n        globals\n      });\n    } else {\n      const { initialGlobals, globals } = this.storyStoreValue.userGlobals;\n      this.channel.emit(GLOBALS_UPDATED, {\n        initialGlobals,\n        userGlobals: globals,\n        storyGlobals: {},\n        globals\n      });\n    }\n    await Promise.all(this.storyRenders.map((r) => r.rerender()));\n  }\n  async onUpdateArgs({ storyId, updatedArgs }) {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({ methodName: \"onUpdateArgs\" });\n    }\n    this.storyStoreValue.args.update(storyId, updatedArgs);\n    await Promise.all(\n      this.storyRenders.filter((r) => r.id === storyId && !r.renderOptions.forceInitialArgs).map(\n        (r) => (\n          // We only run the play function, with in a force remount.\n          // But when mount is destructured, the rendering happens inside of the play function.\n          r.story && r.story.usesMount ? r.remount() : r.rerender()\n        )\n      )\n    );\n    this.channel.emit(STORY_ARGS_UPDATED, {\n      storyId,\n      args: this.storyStoreValue.args.get(storyId)\n    });\n  }\n  async onRequestArgTypesInfo({ id, payload }) {\n    try {\n      await this.storeInitializationPromise;\n      const story = await this.storyStoreValue?.loadStory(payload);\n      this.channel.emit(ARGTYPES_INFO_RESPONSE, {\n        id,\n        success: true,\n        payload: { argTypes: story?.argTypes || {} },\n        error: null\n      });\n    } catch (e) {\n      this.channel.emit(ARGTYPES_INFO_RESPONSE, {\n        id,\n        success: false,\n        error: e?.message\n      });\n    }\n  }\n  async onResetArgs({ storyId, argNames }) {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({ methodName: \"onResetArgs\" });\n    }\n    const render = this.storyRenders.find((r) => r.id === storyId);\n    const story = render?.story || await this.storyStoreValue.loadStory({ storyId });\n    const argNamesToReset = argNames || [\n      .../* @__PURE__ */ new Set([\n        ...Object.keys(story.initialArgs),\n        ...Object.keys(this.storyStoreValue.args.get(storyId))\n      ])\n    ];\n    const updatedArgs = argNamesToReset.reduce((acc, argName) => {\n      acc[argName] = story.initialArgs[argName];\n      return acc;\n    }, {});\n    await this.onUpdateArgs({ storyId, updatedArgs });\n  }\n  // ForceReRender does not include a story id, so we simply must\n  // re-render all stories in case they are relevant\n  async onForceReRender() {\n    await Promise.all(this.storyRenders.map((r) => r.rerender()));\n  }\n  async onForceRemount({ storyId }) {\n    await Promise.all(this.storyRenders.filter((r) => r.id === storyId).map((r) => r.remount()));\n  }\n  async onStoryHotUpdated() {\n    await Promise.all(this.storyRenders.map((r) => r.cancelPlayFunction()));\n  }\n  // Used by docs to render a story to a given element\n  // Note this short-circuits the `prepare()` phase of the StoryRender,\n  // main to be consistent with the previous behaviour. In the future,\n  // we will change it to go ahead and load the story, which will end up being\n  // \"instant\", although async.\n  renderStoryToElement(story, element, callbacks, options) {\n    if (!this.renderToCanvas || !this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({\n        methodName: \"renderStoryToElement\"\n      });\n    }\n    const render = new StoryRender(\n      this.channel,\n      this.storyStoreValue,\n      this.renderToCanvas,\n      callbacks,\n      story.id,\n      \"docs\",\n      options,\n      story\n    );\n    render.renderToElement(element);\n    this.storyRenders.push(render);\n    return async () => {\n      await this.teardownRender(render);\n    };\n  }\n  async teardownRender(render, { viewModeChanged } = {}) {\n    this.storyRenders = this.storyRenders.filter((r) => r !== render);\n    await render?.teardown?.({ viewModeChanged });\n  }\n  // API\n  async loadStory({ storyId }) {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({ methodName: \"loadStory\" });\n    }\n    return this.storyStoreValue.loadStory({ storyId });\n  }\n  getStoryContext(story, { forceInitialArgs = false } = {}) {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({ methodName: \"getStoryContext\" });\n    }\n    return this.storyStoreValue.getStoryContext(story, { forceInitialArgs });\n  }\n  async extract(options) {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError({ methodName: \"extract\" });\n    }\n    if (this.previewEntryError) {\n      throw this.previewEntryError;\n    }\n    await this.storyStoreValue.cacheAllCSFFiles();\n    return this.storyStoreValue.extract(options);\n  }\n  // UTILITIES\n  renderPreviewEntryError(reason, err) {\n    this.previewEntryError = err;\n    logger7.error(reason);\n    logger7.error(err);\n    this.channel.emit(CONFIG_ERROR, err);\n  }\n};\n__name(_Preview, \"Preview\");\nvar Preview = _Preview;\n\n// src/preview-api/modules/preview-web/PreviewWeb.tsx\nimport { global as global8 } from \"@storybook/global\";\n\n// src/preview-api/modules/preview-web/PreviewWithSelection.tsx\nimport { logger as logger8 } from \"storybook/internal/client-logger\";\nimport {\n  CURRENT_STORY_WAS_SET,\n  DOCS_PREPARED,\n  GLOBALS_UPDATED as GLOBALS_UPDATED2,\n  PRELOAD_ENTRIES,\n  PREVIEW_KEYDOWN,\n  SET_CURRENT_STORY,\n  STORY_CHANGED,\n  STORY_ERRORED,\n  STORY_MISSING,\n  STORY_PREPARED,\n  STORY_RENDER_PHASE_CHANGED as STORY_RENDER_PHASE_CHANGED2,\n  STORY_SPECIFIED,\n  STORY_THREW_EXCEPTION,\n  STORY_UNCHANGED,\n  UPDATE_QUERY_PARAMS\n} from \"storybook/internal/core-events\";\nimport {\n  CalledPreviewMethodBeforeInitializationError as CalledPreviewMethodBeforeInitializationError2,\n  EmptyIndexError,\n  MdxFileWithNoCsfReferencesError,\n  NoStoryMatchError\n} from \"storybook/internal/preview-errors\";\n\n// src/preview-api/modules/preview-web/render/CsfDocsRender.ts\nimport { DOCS_RENDERED } from \"storybook/internal/core-events\";\n\n// src/preview-api/modules/preview-web/docs-context/DocsContext.ts\nimport { isStory as isStory3 } from \"storybook/internal/csf\";\nvar _DocsContext = class _DocsContext {\n  constructor(channel, store, renderStoryToElement, csfFiles) {\n    this.channel = channel;\n    this.store = store;\n    this.renderStoryToElement = renderStoryToElement;\n    this.storyIdByName = /* @__PURE__ */ __name((storyName) => {\n      const storyId = this.nameToStoryId.get(storyName);\n      if (storyId) {\n        return storyId;\n      }\n      throw new Error(`No story found with that name: ${storyName}`);\n    }, \"storyIdByName\");\n    this.componentStories = /* @__PURE__ */ __name(() => {\n      return this.componentStoriesValue;\n    }, \"componentStories\");\n    this.componentStoriesFromCSFFile = /* @__PURE__ */ __name((csfFile) => {\n      return this.store.componentStoriesFromCSFFile({ csfFile });\n    }, \"componentStoriesFromCSFFile\");\n    this.storyById = /* @__PURE__ */ __name((storyId) => {\n      if (!storyId) {\n        if (!this.primaryStory) {\n          throw new Error(\n            `No primary story defined for docs entry. Did you forget to use \\`<Meta>\\`?`\n          );\n        }\n        return this.primaryStory;\n      }\n      const csfFile = this.storyIdToCSFFile.get(storyId);\n      if (!csfFile) {\n        throw new Error(`Called \\`storyById\\` for story that was never loaded: ${storyId}`);\n      }\n      return this.store.storyFromCSFFile({ storyId, csfFile });\n    }, \"storyById\");\n    this.getStoryContext = /* @__PURE__ */ __name((story) => {\n      return {\n        ...this.store.getStoryContext(story),\n        loaded: {},\n        viewMode: \"docs\"\n      };\n    }, \"getStoryContext\");\n    this.loadStory = /* @__PURE__ */ __name((id) => {\n      return this.store.loadStory({ storyId: id });\n    }, \"loadStory\");\n    this.componentStoriesValue = [];\n    this.storyIdToCSFFile = /* @__PURE__ */ new Map();\n    this.exportToStory = /* @__PURE__ */ new Map();\n    this.exportsToCSFFile = /* @__PURE__ */ new Map();\n    this.nameToStoryId = /* @__PURE__ */ new Map();\n    this.attachedCSFFiles = /* @__PURE__ */ new Set();\n    csfFiles.forEach((csfFile, index) => {\n      this.referenceCSFFile(csfFile);\n    });\n  }\n  // This docs entry references this CSF file and can synchronously load the stories, as well\n  // as reference them by module export. If the CSF is part of the \"component\" stories, they\n  // can also be referenced by name and are in the componentStories list.\n  referenceCSFFile(csfFile) {\n    this.exportsToCSFFile.set(csfFile.moduleExports, csfFile);\n    this.exportsToCSFFile.set(csfFile.moduleExports.default, csfFile);\n    const stories = this.store.componentStoriesFromCSFFile({ csfFile });\n    stories.forEach((story) => {\n      const annotation = csfFile.stories[story.id];\n      this.storyIdToCSFFile.set(annotation.id, csfFile);\n      this.exportToStory.set(annotation.moduleExport, story);\n    });\n  }\n  attachCSFFile(csfFile) {\n    if (!this.exportsToCSFFile.has(csfFile.moduleExports)) {\n      throw new Error(\"Cannot attach a CSF file that has not been referenced\");\n    }\n    if (this.attachedCSFFiles.has(csfFile)) {\n      return;\n    }\n    this.attachedCSFFiles.add(csfFile);\n    const stories = this.store.componentStoriesFromCSFFile({ csfFile });\n    stories.forEach((story) => {\n      this.nameToStoryId.set(story.name, story.id);\n      this.componentStoriesValue.push(story);\n      if (!this.primaryStory) {\n        this.primaryStory = story;\n      }\n    });\n  }\n  referenceMeta(metaExports, attach) {\n    const resolved = this.resolveModuleExport(metaExports);\n    if (resolved.type !== \"meta\") {\n      throw new Error(\n        \"<Meta of={} /> must reference a CSF file module export or meta export. Did you mistakenly reference your component instead of your CSF file?\"\n      );\n    }\n    if (attach) {\n      this.attachCSFFile(resolved.csfFile);\n    }\n  }\n  get projectAnnotations() {\n    const { projectAnnotations } = this.store;\n    if (!projectAnnotations) {\n      throw new Error(\"Can't get projectAnnotations from DocsContext before they are initialized\");\n    }\n    return projectAnnotations;\n  }\n  resolveAttachedModuleExportType(moduleExportType) {\n    if (moduleExportType === \"story\") {\n      if (!this.primaryStory) {\n        throw new Error(\n          `No primary story attached to this docs file, did you forget to use <Meta of={} />?`\n        );\n      }\n      return { type: \"story\", story: this.primaryStory };\n    }\n    if (this.attachedCSFFiles.size === 0) {\n      throw new Error(\n        `No CSF file attached to this docs file, did you forget to use <Meta of={} />?`\n      );\n    }\n    const firstAttachedCSFFile = Array.from(this.attachedCSFFiles)[0];\n    if (moduleExportType === \"meta\") {\n      return { type: \"meta\", csfFile: firstAttachedCSFFile };\n    }\n    const { component } = firstAttachedCSFFile.meta;\n    if (!component) {\n      throw new Error(\n        `Attached CSF file does not defined a component, did you forget to export one?`\n      );\n    }\n    return { type: \"component\", component };\n  }\n  resolveModuleExport(moduleExportOrType) {\n    const csfFile = this.exportsToCSFFile.get(moduleExportOrType);\n    if (csfFile) {\n      return { type: \"meta\", csfFile };\n    }\n    const story = this.exportToStory.get(\n      isStory3(moduleExportOrType) ? moduleExportOrType.input : moduleExportOrType\n    );\n    if (story) {\n      return { type: \"story\", story };\n    }\n    return { type: \"component\", component: moduleExportOrType };\n  }\n  resolveOf(moduleExportOrType, validTypes = []) {\n    let resolved;\n    if ([\"component\", \"meta\", \"story\"].includes(moduleExportOrType)) {\n      const type = moduleExportOrType;\n      resolved = this.resolveAttachedModuleExportType(type);\n    } else {\n      resolved = this.resolveModuleExport(moduleExportOrType);\n    }\n    if (validTypes.length && !validTypes.includes(resolved.type)) {\n      const prettyType = resolved.type === \"component\" ? \"component or unknown\" : resolved.type;\n      throw new Error(dedent`Invalid value passed to the 'of' prop. The value was resolved to a '${prettyType}' type but the only types for this block are: ${validTypes.join(\n        \", \"\n      )}.\n        - Did you pass a component to the 'of' prop when the block only supports a story or a meta?\n        - ... or vice versa?\n        - Did you pass a story, CSF file or meta to the 'of' prop that is not indexed, ie. is not targeted by the 'stories' globs in the main configuration?`);\n    }\n    switch (resolved.type) {\n      case \"component\": {\n        return {\n          ...resolved,\n          projectAnnotations: this.projectAnnotations\n        };\n      }\n      case \"meta\": {\n        return {\n          ...resolved,\n          preparedMeta: this.store.preparedMetaFromCSFFile({ csfFile: resolved.csfFile })\n        };\n      }\n      case \"story\":\n      default: {\n        return resolved;\n      }\n    }\n  }\n};\n__name(_DocsContext, \"DocsContext\");\nvar DocsContext = _DocsContext;\n\n// src/preview-api/modules/preview-web/render/CsfDocsRender.ts\nvar _CsfDocsRender = class _CsfDocsRender {\n  constructor(channel, store, entry, callbacks) {\n    this.channel = channel;\n    this.store = store;\n    this.entry = entry;\n    this.callbacks = callbacks;\n    this.type = \"docs\";\n    this.subtype = \"csf\";\n    this.torndown = false;\n    this.disableKeyListeners = false;\n    this.preparing = false;\n    this.id = entry.id;\n    this.renderId = Date.now();\n  }\n  isPreparing() {\n    return this.preparing;\n  }\n  async prepare() {\n    this.preparing = true;\n    const { entryExports, csfFiles = [] } = await this.store.loadEntry(this.id);\n    if (this.torndown) {\n      throw PREPARE_ABORTED;\n    }\n    const { importPath, title } = this.entry;\n    const primaryCsfFile = this.store.processCSFFileWithCache(\n      entryExports,\n      importPath,\n      title\n    );\n    const primaryStoryId = Object.keys(primaryCsfFile.stories)[0];\n    this.story = this.store.storyFromCSFFile({ storyId: primaryStoryId, csfFile: primaryCsfFile });\n    this.csfFiles = [primaryCsfFile, ...csfFiles];\n    this.preparing = false;\n  }\n  isEqual(other) {\n    return !!(this.id === other.id && this.story && this.story === other.story);\n  }\n  docsContext(renderStoryToElement) {\n    if (!this.csfFiles) {\n      throw new Error(\"Cannot render docs before preparing\");\n    }\n    const docsContext = new DocsContext(\n      this.channel,\n      this.store,\n      renderStoryToElement,\n      this.csfFiles\n    );\n    this.csfFiles.forEach((csfFile) => docsContext.attachCSFFile(csfFile));\n    return docsContext;\n  }\n  async renderToElement(canvasElement, renderStoryToElement) {\n    if (!this.story || !this.csfFiles) {\n      throw new Error(\"Cannot render docs before preparing\");\n    }\n    const docsContext = this.docsContext(renderStoryToElement);\n    const { docs: docsParameter } = this.story.parameters || {};\n    if (!docsParameter) {\n      throw new Error(\n        `Cannot render a story in viewMode=docs if \\`@storybook/addon-docs\\` is not installed`\n      );\n    }\n    const renderer = await docsParameter.renderer();\n    const { render } = renderer;\n    const renderDocs = /* @__PURE__ */ __name(async () => {\n      try {\n        await render(docsContext, docsParameter, canvasElement);\n        this.channel.emit(DOCS_RENDERED, this.id);\n      } catch (err) {\n        this.callbacks.showException(err);\n      }\n    }, \"renderDocs\");\n    this.rerender = async () => renderDocs();\n    this.teardownRender = async ({ viewModeChanged }) => {\n      if (!viewModeChanged || !canvasElement) {\n        return;\n      }\n      renderer.unmount(canvasElement);\n    };\n    return renderDocs();\n  }\n  async teardown({ viewModeChanged } = {}) {\n    this.teardownRender?.({ viewModeChanged });\n    this.torndown = true;\n  }\n};\n__name(_CsfDocsRender, \"CsfDocsRender\");\nvar CsfDocsRender = _CsfDocsRender;\n\n// src/preview-api/modules/preview-web/render/MdxDocsRender.ts\nimport { DOCS_RENDERED as DOCS_RENDERED2 } from \"storybook/internal/core-events\";\nvar _MdxDocsRender = class _MdxDocsRender {\n  constructor(channel, store, entry, callbacks) {\n    this.channel = channel;\n    this.store = store;\n    this.entry = entry;\n    this.callbacks = callbacks;\n    this.type = \"docs\";\n    this.subtype = \"mdx\";\n    this.torndown = false;\n    this.disableKeyListeners = false;\n    this.preparing = false;\n    this.id = entry.id;\n    this.renderId = Date.now();\n  }\n  isPreparing() {\n    return this.preparing;\n  }\n  async prepare() {\n    this.preparing = true;\n    const { entryExports, csfFiles = [] } = await this.store.loadEntry(this.id);\n    if (this.torndown) {\n      throw PREPARE_ABORTED;\n    }\n    this.csfFiles = csfFiles;\n    this.exports = entryExports;\n    this.preparing = false;\n  }\n  isEqual(other) {\n    return !!(this.id === other.id && this.exports && this.exports === other.exports);\n  }\n  docsContext(renderStoryToElement) {\n    if (!this.csfFiles) {\n      throw new Error(\"Cannot render docs before preparing\");\n    }\n    return new DocsContext(\n      this.channel,\n      this.store,\n      renderStoryToElement,\n      this.csfFiles\n    );\n  }\n  async renderToElement(canvasElement, renderStoryToElement) {\n    if (!this.exports || !this.csfFiles || !this.store.projectAnnotations) {\n      throw new Error(\"Cannot render docs before preparing\");\n    }\n    const docsContext = this.docsContext(renderStoryToElement);\n    const { docs } = this.store.projectAnnotations.parameters ?? {};\n    if (!docs) {\n      throw new Error(\n        `Cannot render a story in viewMode=docs if \\`@storybook/addon-docs\\` is not installed`\n      );\n    }\n    const docsParameter = { ...docs, page: this.exports.default };\n    const renderer = await docs.renderer();\n    const { render } = renderer;\n    const renderDocs = /* @__PURE__ */ __name(async () => {\n      try {\n        await render(docsContext, docsParameter, canvasElement);\n        this.channel.emit(DOCS_RENDERED2, this.id);\n      } catch (err) {\n        this.callbacks.showException(err);\n      }\n    }, \"renderDocs\");\n    this.rerender = async () => renderDocs();\n    this.teardownRender = async ({ viewModeChanged } = {}) => {\n      if (!viewModeChanged || !canvasElement) {\n        return;\n      }\n      renderer.unmount(canvasElement);\n      this.torndown = true;\n    };\n    return renderDocs();\n  }\n  async teardown({ viewModeChanged } = {}) {\n    this.teardownRender?.({ viewModeChanged });\n    this.torndown = true;\n  }\n};\n__name(_MdxDocsRender, \"MdxDocsRender\");\nvar MdxDocsRender = _MdxDocsRender;\n\n// src/preview-api/modules/preview-web/PreviewWithSelection.tsx\nvar globalWindow = globalThis;\nfunction focusInInput(event) {\n  const target = event.composedPath && event.composedPath()[0] || event.target;\n  return /input|textarea/i.test(target.tagName) || target.getAttribute(\"contenteditable\") !== null;\n}\n__name(focusInInput, \"focusInInput\");\nvar ATTACHED_MDX_TAG = \"attached-mdx\";\nvar UNATTACHED_MDX_TAG = \"unattached-mdx\";\nfunction isMdxEntry({ tags }) {\n  return tags?.includes(UNATTACHED_MDX_TAG) || tags?.includes(ATTACHED_MDX_TAG);\n}\n__name(isMdxEntry, \"isMdxEntry\");\nfunction isStoryRender(r) {\n  return r.type === \"story\";\n}\n__name(isStoryRender, \"isStoryRender\");\nfunction isDocsRender(r) {\n  return r.type === \"docs\";\n}\n__name(isDocsRender, \"isDocsRender\");\nfunction isCsfDocsRender(r) {\n  return isDocsRender(r) && r.subtype === \"csf\";\n}\n__name(isCsfDocsRender, \"isCsfDocsRender\");\nvar _PreviewWithSelection = class _PreviewWithSelection extends Preview {\n  constructor(importFn, getProjectAnnotations, selectionStore, view) {\n    super(importFn, getProjectAnnotations, void 0, false);\n    this.importFn = importFn;\n    this.getProjectAnnotations = getProjectAnnotations;\n    this.selectionStore = selectionStore;\n    this.view = view;\n    this.initialize();\n  }\n  setupListeners() {\n    super.setupListeners();\n    globalWindow.onkeydown = this.onKeydown.bind(this);\n    this.channel.on(SET_CURRENT_STORY, this.onSetCurrentStory.bind(this));\n    this.channel.on(UPDATE_QUERY_PARAMS, this.onUpdateQueryParams.bind(this));\n    this.channel.on(PRELOAD_ENTRIES, this.onPreloadStories.bind(this));\n  }\n  async setInitialGlobals() {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError2({ methodName: \"setInitialGlobals\" });\n    }\n    const { globals } = this.selectionStore.selectionSpecifier || {};\n    if (globals) {\n      this.storyStoreValue.userGlobals.updateFromPersisted(globals);\n    }\n    this.emitGlobals();\n  }\n  // If initialization gets as far as the story index, this function runs.\n  async initializeWithStoryIndex(storyIndex) {\n    await super.initializeWithStoryIndex(storyIndex);\n    return this.selectSpecifiedStory();\n  }\n  // Use the selection specifier to choose a story, then render it\n  async selectSpecifiedStory() {\n    if (!this.storyStoreValue) {\n      throw new CalledPreviewMethodBeforeInitializationError2({\n        methodName: \"selectSpecifiedStory\"\n      });\n    }\n    if (this.selectionStore.selection) {\n      await this.renderSelection();\n      return;\n    }\n    if (!this.selectionStore.selectionSpecifier) {\n      this.renderMissingStory();\n      return;\n    }\n    const { storySpecifier, args } = this.selectionStore.selectionSpecifier;\n    const entry = this.storyStoreValue.storyIndex.entryFromSpecifier(storySpecifier);\n    if (!entry) {\n      if (storySpecifier === \"*\") {\n        this.renderStoryLoadingException(storySpecifier, new EmptyIndexError());\n      } else {\n        this.renderStoryLoadingException(\n          storySpecifier,\n          new NoStoryMatchError({ storySpecifier: storySpecifier.toString() })\n        );\n      }\n      return;\n    }\n    const { id: storyId, type: viewMode } = entry;\n    this.selectionStore.setSelection({ storyId, viewMode });\n    this.channel.emit(STORY_SPECIFIED, this.selectionStore.selection);\n    this.channel.emit(CURRENT_STORY_WAS_SET, this.selectionStore.selection);\n    await this.renderSelection({ persistedArgs: args });\n  }\n  // EVENT HANDLERS\n  // This happens when a config file gets reloaded\n  async onGetProjectAnnotationsChanged({\n    getProjectAnnotations\n  }) {\n    await super.onGetProjectAnnotationsChanged({ getProjectAnnotations });\n    if (this.selectionStore.selection) {\n      this.renderSelection();\n    }\n  }\n  // This happens when a glob gets HMR-ed\n  async onStoriesChanged({\n    importFn,\n    storyIndex\n  }) {\n    await super.onStoriesChanged({ importFn, storyIndex });\n    if (this.selectionStore.selection) {\n      await this.renderSelection();\n    } else {\n      await this.selectSpecifiedStory();\n    }\n  }\n  onKeydown(event) {\n    if (!this.storyRenders.find((r) => r.disableKeyListeners) && !focusInInput(event)) {\n      const { altKey, ctrlKey, metaKey, shiftKey, key, code, keyCode } = event;\n      this.channel.emit(PREVIEW_KEYDOWN, {\n        event: { altKey, ctrlKey, metaKey, shiftKey, key, code, keyCode }\n      });\n    }\n  }\n  async onSetCurrentStory(selection) {\n    this.selectionStore.setSelection({ viewMode: \"story\", ...selection });\n    await this.storeInitializationPromise;\n    this.channel.emit(CURRENT_STORY_WAS_SET, this.selectionStore.selection);\n    this.renderSelection();\n  }\n  onUpdateQueryParams(queryParams) {\n    this.selectionStore.setQueryParams(queryParams);\n  }\n  async onUpdateGlobals({ globals }) {\n    const currentStory = this.currentRender instanceof StoryRender && this.currentRender.story || void 0;\n    super.onUpdateGlobals({ globals, currentStory });\n    if (this.currentRender instanceof MdxDocsRender || this.currentRender instanceof CsfDocsRender) {\n      await this.currentRender.rerender?.();\n    }\n  }\n  async onUpdateArgs({ storyId, updatedArgs }) {\n    super.onUpdateArgs({ storyId, updatedArgs });\n  }\n  async onPreloadStories({ ids }) {\n    await this.storeInitializationPromise;\n    if (this.storyStoreValue) {\n      await Promise.allSettled(ids.map((id) => this.storyStoreValue?.loadEntry(id)));\n    }\n  }\n  // RENDERING\n  // We can either have:\n  // - a story selected in \"story\" viewMode,\n  //     in which case we render it to the root element, OR\n  // - a story selected in \"docs\" viewMode,\n  //     in which case we render the docsPage for that story\n  async renderSelection({ persistedArgs } = {}) {\n    const { renderToCanvas } = this;\n    if (!this.storyStoreValue || !renderToCanvas) {\n      throw new CalledPreviewMethodBeforeInitializationError2({ methodName: \"renderSelection\" });\n    }\n    const { selection } = this.selectionStore;\n    if (!selection) {\n      throw new Error(\"Cannot call renderSelection as no selection was made\");\n    }\n    const { storyId } = selection;\n    let entry;\n    try {\n      entry = await this.storyStoreValue.storyIdToEntry(storyId);\n    } catch (err) {\n      if (this.currentRender) {\n        await this.teardownRender(this.currentRender);\n      }\n      this.renderStoryLoadingException(storyId, err);\n      return;\n    }\n    const storyIdChanged = this.currentSelection?.storyId !== storyId;\n    const viewModeChanged = this.currentRender?.type !== entry.type;\n    if (entry.type === \"story\") {\n      this.view.showPreparingStory({ immediate: viewModeChanged });\n    } else {\n      this.view.showPreparingDocs({ immediate: viewModeChanged });\n    }\n    if (this.currentRender?.isPreparing()) {\n      await this.teardownRender(this.currentRender);\n    }\n    let render;\n    if (entry.type === \"story\") {\n      render = new StoryRender(\n        this.channel,\n        this.storyStoreValue,\n        renderToCanvas,\n        this.mainStoryCallbacks(storyId),\n        storyId,\n        \"story\"\n      );\n    } else if (isMdxEntry(entry)) {\n      render = new MdxDocsRender(\n        this.channel,\n        this.storyStoreValue,\n        entry,\n        this.mainStoryCallbacks(storyId)\n      );\n    } else {\n      render = new CsfDocsRender(\n        this.channel,\n        this.storyStoreValue,\n        entry,\n        this.mainStoryCallbacks(storyId)\n      );\n    }\n    const lastSelection = this.currentSelection;\n    this.currentSelection = selection;\n    const lastRender = this.currentRender;\n    this.currentRender = render;\n    try {\n      await render.prepare();\n    } catch (err) {\n      if (lastRender) {\n        await this.teardownRender(lastRender);\n      }\n      if (err !== PREPARE_ABORTED) {\n        this.renderStoryLoadingException(storyId, err);\n      }\n      return;\n    }\n    const implementationChanged = !storyIdChanged && lastRender && !render.isEqual(lastRender);\n    if (persistedArgs && isStoryRender(render)) {\n      invariant(!!render.story);\n      this.storyStoreValue.args.updateFromPersisted(render.story, persistedArgs);\n    }\n    if (lastRender && !lastRender.torndown && !storyIdChanged && !implementationChanged && !viewModeChanged) {\n      this.currentRender = lastRender;\n      this.channel.emit(STORY_UNCHANGED, storyId);\n      this.view.showMain();\n      return;\n    }\n    if (lastRender) {\n      await this.teardownRender(lastRender, { viewModeChanged });\n    }\n    if (lastSelection && (storyIdChanged || viewModeChanged)) {\n      this.channel.emit(STORY_CHANGED, storyId);\n    }\n    if (isStoryRender(render)) {\n      invariant(!!render.story);\n      const {\n        parameters,\n        initialArgs,\n        argTypes,\n        unmappedArgs,\n        initialGlobals,\n        userGlobals,\n        storyGlobals,\n        globals\n      } = this.storyStoreValue.getStoryContext(render.story);\n      this.channel.emit(STORY_PREPARED, {\n        id: storyId,\n        parameters,\n        initialArgs,\n        argTypes,\n        args: unmappedArgs\n      });\n      this.channel.emit(GLOBALS_UPDATED2, { userGlobals, storyGlobals, globals, initialGlobals });\n    } else {\n      let { parameters } = this.storyStoreValue.projectAnnotations;\n      const { initialGlobals, globals } = this.storyStoreValue.userGlobals;\n      this.channel.emit(GLOBALS_UPDATED2, {\n        globals,\n        initialGlobals,\n        storyGlobals: {},\n        userGlobals: globals\n      });\n      if (isCsfDocsRender(render) || render.entry.tags?.includes(ATTACHED_MDX_TAG)) {\n        if (!render.csfFiles) {\n          throw new MdxFileWithNoCsfReferencesError({ storyId });\n        }\n        ({ parameters } = this.storyStoreValue.preparedMetaFromCSFFile({\n          csfFile: render.csfFiles[0]\n        }));\n      }\n      this.channel.emit(DOCS_PREPARED, {\n        id: storyId,\n        parameters\n      });\n    }\n    if (isStoryRender(render)) {\n      invariant(!!render.story);\n      this.storyRenders.push(render);\n      this.currentRender.renderToElement(\n        this.view.prepareForStory(render.story)\n      );\n    } else {\n      this.currentRender.renderToElement(\n        this.view.prepareForDocs(),\n        // This argument is used for docs, which is currently only compatible with HTMLElements\n        this.renderStoryToElement.bind(this)\n      );\n    }\n  }\n  async teardownRender(render, { viewModeChanged = false } = {}) {\n    this.storyRenders = this.storyRenders.filter((r) => r !== render);\n    await render?.teardown?.({ viewModeChanged });\n  }\n  // UTILITIES\n  mainStoryCallbacks(storyId) {\n    return {\n      showStoryDuringRender: /* @__PURE__ */ __name(() => this.view.showStoryDuringRender(), \"showStoryDuringRender\"),\n      showMain: /* @__PURE__ */ __name(() => this.view.showMain(), \"showMain\"),\n      showError: /* @__PURE__ */ __name((err) => this.renderError(storyId, err), \"showError\"),\n      showException: /* @__PURE__ */ __name((err) => this.renderException(storyId, err), \"showException\")\n    };\n  }\n  renderPreviewEntryError(reason, err) {\n    super.renderPreviewEntryError(reason, err);\n    this.view.showErrorDisplay(err);\n  }\n  renderMissingStory() {\n    this.view.showNoPreview();\n    this.channel.emit(STORY_MISSING);\n  }\n  renderStoryLoadingException(storySpecifier, err) {\n    logger8.error(err);\n    this.view.showErrorDisplay(err);\n    this.channel.emit(STORY_MISSING, storySpecifier);\n  }\n  // renderException is used if we fail to render the story and it is uncaught by the app layer\n  renderException(storyId, error) {\n    const { name = \"Error\", message = String(error), stack } = error;\n    const renderId = this.currentRender?.renderId;\n    this.channel.emit(STORY_THREW_EXCEPTION, { name, message, stack });\n    this.channel.emit(STORY_RENDER_PHASE_CHANGED2, { newPhase: \"errored\", renderId, storyId });\n    this.view.showErrorDisplay(error);\n    logger8.error(`Error rendering story '${storyId}':`);\n    logger8.error(error);\n  }\n  // renderError is used by the various app layers to inform the user they have done something\n  // wrong -- for instance returned the wrong thing from a story\n  renderError(storyId, { title, description }) {\n    const renderId = this.currentRender?.renderId;\n    this.channel.emit(STORY_ERRORED, { title, description });\n    this.channel.emit(STORY_RENDER_PHASE_CHANGED2, { newPhase: \"errored\", renderId, storyId });\n    this.view.showErrorDisplay({ message: title, stack: description });\n    logger8.error(`Error rendering story ${title}: ${description}`);\n  }\n};\n__name(_PreviewWithSelection, \"PreviewWithSelection\");\nvar PreviewWithSelection = _PreviewWithSelection;\n\n// src/preview-api/modules/preview-web/UrlStore.ts\nvar import_picoquery2 = __toESM(require_main(), 1);\nimport { global as global6 } from \"@storybook/global\";\n\n// src/preview-api/modules/preview-web/parseArgsParam.ts\nimport { once as once3 } from \"storybook/internal/client-logger\";\nvar import_picoquery = __toESM(require_main(), 1);\nvar VALIDATION_REGEXP = /^[a-zA-Z0-9 _-]*$/;\nvar NUMBER_REGEXP = /^-?[0-9]+(\\.[0-9]+)?$/;\nvar HEX_REGEXP = /^#([a-f0-9]{3,4}|[a-f0-9]{6}|[a-f0-9]{8})$/i;\nvar COLOR_REGEXP = /^(rgba?|hsla?)\\(([0-9]{1,3}),\\s?([0-9]{1,3})%?,\\s?([0-9]{1,3})%?,?\\s?([0-9](\\.[0-9]{1,2})?)?\\)$/i;\nvar validateArgs = /* @__PURE__ */ __name((key = \"\", value) => {\n  if (key === null) {\n    return false;\n  }\n  if (key === \"\" || !VALIDATION_REGEXP.test(key)) {\n    return false;\n  }\n  if (value === null || value === void 0) {\n    return true;\n  }\n  if (value instanceof Date) {\n    return true;\n  }\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return true;\n  }\n  if (typeof value === \"string\") {\n    return VALIDATION_REGEXP.test(value) || NUMBER_REGEXP.test(value) || HEX_REGEXP.test(value) || COLOR_REGEXP.test(value);\n  }\n  if (Array.isArray(value)) {\n    return value.every((v) => validateArgs(key, v));\n  }\n  if (isPlainObject(value)) {\n    return Object.entries(value).every(([k, v]) => validateArgs(k, v));\n  }\n  return false;\n}, \"validateArgs\");\nvar QUERY_OPTIONS = {\n  delimiter: \";\",\n  // we're parsing a single query param\n  nesting: true,\n  arrayRepeat: true,\n  arrayRepeatSyntax: \"bracket\",\n  nestingSyntax: \"js\",\n  // objects are encoded using dot notation\n  valueDeserializer(str) {\n    if (str.startsWith(\"!\")) {\n      if (str === \"!undefined\") {\n        return void 0;\n      }\n      if (str === \"!null\") {\n        return null;\n      }\n      if (str === \"!true\") {\n        return true;\n      }\n      if (str === \"!false\") {\n        return false;\n      }\n      if (str.startsWith(\"!date(\") && str.endsWith(\")\")) {\n        return new Date(str.replaceAll(\" \", \"+\").slice(6, -1));\n      }\n      if (str.startsWith(\"!hex(\") && str.endsWith(\")\")) {\n        return `#${str.slice(5, -1)}`;\n      }\n      const color = str.slice(1).match(COLOR_REGEXP);\n      if (color) {\n        if (str.startsWith(\"!rgba\") || str.startsWith(\"!RGBA\")) {\n          return `${color[1]}(${color[2]}, ${color[3]}, ${color[4]}, ${color[5]})`;\n        }\n        if (str.startsWith(\"!hsla\") || str.startsWith(\"!HSLA\")) {\n          return `${color[1]}(${color[2]}, ${color[3]}%, ${color[4]}%, ${color[5]})`;\n        }\n        return str.startsWith(\"!rgb\") || str.startsWith(\"!RGB\") ? `${color[1]}(${color[2]}, ${color[3]}, ${color[4]})` : `${color[1]}(${color[2]}, ${color[3]}%, ${color[4]}%)`;\n      }\n    }\n    if (NUMBER_REGEXP.test(str)) {\n      return Number(str);\n    }\n    return str;\n  }\n};\nvar parseArgsParam = /* @__PURE__ */ __name((argsString) => {\n  const parts = argsString.split(\";\").map((part) => part.replace(\"=\", \"~\").replace(\":\", \"=\"));\n  return Object.entries((0, import_picoquery.parse)(parts.join(\";\"), QUERY_OPTIONS)).reduce((acc, [key, value]) => {\n    if (validateArgs(key, value)) {\n      return Object.assign(acc, { [key]: value });\n    }\n    once3.warn(dedent`\n      Omitted potentially unsafe URL args.\n\n      More info: https://storybook.js.org/docs/writing-stories/args#setting-args-through-the-url?ref=error\n    `);\n    return acc;\n  }, {});\n}, \"parseArgsParam\");\n\n// src/preview-api/modules/preview-web/UrlStore.ts\nvar { history, document: document2 } = global6;\nfunction pathToId(path) {\n  const match = (path || \"\").match(/^\\/story\\/(.+)/);\n  if (!match) {\n    throw new Error(`Invalid path '${path}',  must start with '/story/'`);\n  }\n  return match[1];\n}\n__name(pathToId, \"pathToId\");\nvar getQueryString = /* @__PURE__ */ __name(({\n  selection,\n  extraParams\n}) => {\n  const search = document2?.location.search.slice(1);\n  const { path, selectedKind, selectedStory, ...rest } = (0, import_picoquery2.parse)(search);\n  const queryStr = (0, import_picoquery2.stringify)({\n    ...rest,\n    ...extraParams,\n    ...selection && { id: selection.storyId, viewMode: selection.viewMode }\n  });\n  return `?${queryStr}`;\n}, \"getQueryString\");\nvar setPath = /* @__PURE__ */ __name((selection) => {\n  if (!selection) {\n    return;\n  }\n  const query = getQueryString({ selection });\n  const { hash = \"\" } = document2.location;\n  document2.title = selection.storyId;\n  history.replaceState({}, \"\", `${document2.location.pathname}${query}${hash}`);\n}, \"setPath\");\nvar isObject = /* @__PURE__ */ __name((val) => val != null && typeof val === \"object\" && Array.isArray(val) === false, \"isObject\");\nvar getFirstString = /* @__PURE__ */ __name((v) => {\n  if (v === void 0) {\n    return void 0;\n  }\n  if (typeof v === \"string\") {\n    return v;\n  }\n  if (Array.isArray(v)) {\n    return getFirstString(v[0]);\n  }\n  if (isObject(v)) {\n    return getFirstString(\n      Object.values(v).filter(Boolean)\n    );\n  }\n  return void 0;\n}, \"getFirstString\");\nvar getSelectionSpecifierFromPath = /* @__PURE__ */ __name(() => {\n  if (typeof document2 !== \"undefined\") {\n    const queryStr = document2.location.search.slice(1);\n    const query = (0, import_picoquery2.parse)(queryStr);\n    const args = typeof query.args === \"string\" ? parseArgsParam(query.args) : void 0;\n    const globals = typeof query.globals === \"string\" ? parseArgsParam(query.globals) : void 0;\n    let viewMode = getFirstString(query.viewMode);\n    if (typeof viewMode !== \"string\" || !viewMode.match(/docs|story/)) {\n      viewMode = \"story\";\n    }\n    const path = getFirstString(query.path);\n    const storyId = path ? pathToId(path) : getFirstString(query.id);\n    if (storyId) {\n      return { storySpecifier: storyId, args, globals, viewMode };\n    }\n  }\n  return null;\n}, \"getSelectionSpecifierFromPath\");\nvar _UrlStore = class _UrlStore {\n  constructor() {\n    this.selectionSpecifier = getSelectionSpecifierFromPath();\n  }\n  setSelection(selection) {\n    this.selection = selection;\n    setPath(this.selection);\n  }\n  setQueryParams(queryParams) {\n    const query = getQueryString({ extraParams: queryParams });\n    const { hash = \"\" } = document2.location;\n    history.replaceState({}, \"\", `${document2.location.pathname}${query}${hash}`);\n  }\n};\n__name(_UrlStore, \"UrlStore\");\nvar UrlStore = _UrlStore;\n\n// src/preview-api/modules/preview-web/WebView.ts\nvar import_ansi_to_html = __toESM(require_ansi_to_html(), 1);\nvar import_picoquery3 = __toESM(require_main(), 1);\nimport { logger as logger9 } from \"storybook/internal/client-logger\";\nimport { global as global7 } from \"@storybook/global\";\nvar { document: document3 } = global7;\nvar PREPARING_DELAY = 100;\nvar Mode = /* @__PURE__ */ ((Mode2) => {\n  Mode2[\"MAIN\"] = \"MAIN\";\n  Mode2[\"NOPREVIEW\"] = \"NOPREVIEW\";\n  Mode2[\"PREPARING_STORY\"] = \"PREPARING_STORY\";\n  Mode2[\"PREPARING_DOCS\"] = \"PREPARING_DOCS\";\n  Mode2[\"ERROR\"] = \"ERROR\";\n  return Mode2;\n})(Mode || {});\nvar classes = {\n  PREPARING_STORY: \"sb-show-preparing-story\",\n  PREPARING_DOCS: \"sb-show-preparing-docs\",\n  MAIN: \"sb-show-main\",\n  NOPREVIEW: \"sb-show-nopreview\",\n  ERROR: \"sb-show-errordisplay\"\n};\nvar layoutClassMap = {\n  centered: \"sb-main-centered\",\n  fullscreen: \"sb-main-fullscreen\",\n  padded: \"sb-main-padded\"\n};\nvar ansiConverter = new import_ansi_to_html.default({\n  escapeXML: true\n});\nvar _WebView = class _WebView {\n  constructor() {\n    this.testing = false;\n    if (typeof document3 !== \"undefined\") {\n      const { __SPECIAL_TEST_PARAMETER__ } = (0, import_picoquery3.parse)(document3.location.search.slice(1));\n      switch (__SPECIAL_TEST_PARAMETER__) {\n        case \"preparing-story\": {\n          this.showPreparingStory();\n          this.testing = true;\n          break;\n        }\n        case \"preparing-docs\": {\n          this.showPreparingDocs();\n          this.testing = true;\n          break;\n        }\n        default:\n      }\n    }\n  }\n  // Get ready to render a story, returning the element to render to\n  prepareForStory(story) {\n    this.showStory();\n    this.applyLayout(story.parameters.layout);\n    document3.documentElement.scrollTop = 0;\n    document3.documentElement.scrollLeft = 0;\n    return this.storyRoot();\n  }\n  storyRoot() {\n    return document3.getElementById(\"storybook-root\");\n  }\n  prepareForDocs() {\n    this.showMain();\n    this.showDocs();\n    this.applyLayout(\"fullscreen\");\n    document3.documentElement.scrollTop = 0;\n    document3.documentElement.scrollLeft = 0;\n    return this.docsRoot();\n  }\n  docsRoot() {\n    return document3.getElementById(\"storybook-docs\");\n  }\n  applyLayout(layout = \"padded\") {\n    if (layout === \"none\") {\n      document3.body.classList.remove(this.currentLayoutClass);\n      this.currentLayoutClass = null;\n      return;\n    }\n    this.checkIfLayoutExists(layout);\n    const layoutClass = layoutClassMap[layout];\n    document3.body.classList.remove(this.currentLayoutClass);\n    document3.body.classList.add(layoutClass);\n    this.currentLayoutClass = layoutClass;\n  }\n  checkIfLayoutExists(layout) {\n    if (!layoutClassMap[layout]) {\n      logger9.warn(\n        dedent`\n          The desired layout: ${layout} is not a valid option.\n          The possible options are: ${Object.keys(layoutClassMap).join(\", \")}, none.\n        `\n      );\n    }\n  }\n  showMode(mode) {\n    clearTimeout(this.preparingTimeout);\n    Object.keys(Mode).forEach((otherMode) => {\n      if (otherMode === mode) {\n        document3.body.classList.add(classes[otherMode]);\n      } else {\n        document3.body.classList.remove(classes[otherMode]);\n      }\n    });\n  }\n  showErrorDisplay({ message = \"\", stack = \"\" }) {\n    let header = message;\n    let detail = stack;\n    const parts = message.split(\"\\n\");\n    if (parts.length > 1) {\n      [header] = parts;\n      detail = parts.slice(1).join(\"\\n\").replace(/^\\n/, \"\");\n    }\n    document3.getElementById(\"error-message\").innerHTML = ansiConverter.toHtml(header);\n    document3.getElementById(\"error-stack\").innerHTML = ansiConverter.toHtml(detail);\n    this.showMode(\"ERROR\" /* ERROR */);\n  }\n  showNoPreview() {\n    if (this.testing) {\n      return;\n    }\n    this.showMode(\"NOPREVIEW\" /* NOPREVIEW */);\n    this.storyRoot()?.setAttribute(\"hidden\", \"true\");\n    this.docsRoot()?.setAttribute(\"hidden\", \"true\");\n  }\n  showPreparingStory({ immediate = false } = {}) {\n    clearTimeout(this.preparingTimeout);\n    if (immediate) {\n      this.showMode(\"PREPARING_STORY\" /* PREPARING_STORY */);\n    } else {\n      this.preparingTimeout = setTimeout(\n        () => this.showMode(\"PREPARING_STORY\" /* PREPARING_STORY */),\n        PREPARING_DELAY\n      );\n    }\n  }\n  showPreparingDocs({ immediate = false } = {}) {\n    clearTimeout(this.preparingTimeout);\n    if (immediate) {\n      this.showMode(\"PREPARING_DOCS\" /* PREPARING_DOCS */);\n    } else {\n      this.preparingTimeout = setTimeout(() => this.showMode(\"PREPARING_DOCS\" /* PREPARING_DOCS */), PREPARING_DELAY);\n    }\n  }\n  showMain() {\n    this.showMode(\"MAIN\" /* MAIN */);\n  }\n  showDocs() {\n    this.storyRoot().setAttribute(\"hidden\", \"true\");\n    this.docsRoot().removeAttribute(\"hidden\");\n  }\n  showStory() {\n    this.docsRoot().setAttribute(\"hidden\", \"true\");\n    this.storyRoot().removeAttribute(\"hidden\");\n  }\n  showStoryDuringRender() {\n    document3.body.classList.add(classes.MAIN);\n  }\n};\n__name(_WebView, \"WebView\");\nvar WebView = _WebView;\n\n// src/preview-api/modules/preview-web/PreviewWeb.tsx\nvar _PreviewWeb = class _PreviewWeb extends PreviewWithSelection {\n  constructor(importFn, getProjectAnnotations) {\n    super(importFn, getProjectAnnotations, new UrlStore(), new WebView());\n    this.importFn = importFn;\n    this.getProjectAnnotations = getProjectAnnotations;\n    global8.__STORYBOOK_PREVIEW__ = this;\n  }\n};\n__name(_PreviewWeb, \"PreviewWeb\");\nvar PreviewWeb = _PreviewWeb;\n\n// src/preview-api/modules/preview-web/simulate-pageload.ts\nimport { global as global9 } from \"@storybook/global\";\nvar { document: document4 } = global9;\nvar runScriptTypes = [\n  \"application/javascript\",\n  \"application/ecmascript\",\n  \"application/x-ecmascript\",\n  \"application/x-javascript\",\n  \"text/ecmascript\",\n  \"text/javascript\",\n  \"text/javascript1.0\",\n  \"text/javascript1.1\",\n  \"text/javascript1.2\",\n  \"text/javascript1.3\",\n  \"text/javascript1.4\",\n  \"text/javascript1.5\",\n  \"text/jscript\",\n  \"text/livescript\",\n  \"text/x-ecmascript\",\n  \"text/x-javascript\",\n  // Support modern javascript\n  \"module\"\n];\nvar SCRIPT = \"script\";\nvar SCRIPTS_ROOT_ID = \"scripts-root\";\nfunction simulateDOMContentLoaded() {\n  const DOMContentLoadedEvent = document4.createEvent(\"Event\");\n  DOMContentLoadedEvent.initEvent(\"DOMContentLoaded\", true, true);\n  document4.dispatchEvent(DOMContentLoadedEvent);\n}\n__name(simulateDOMContentLoaded, \"simulateDOMContentLoaded\");\nfunction insertScript($script, callback, $scriptRoot) {\n  const scriptEl = document4.createElement(\"script\");\n  scriptEl.type = $script.type === \"module\" ? \"module\" : \"text/javascript\";\n  if ($script.src) {\n    scriptEl.onload = callback;\n    scriptEl.onerror = callback;\n    scriptEl.src = $script.src;\n  } else {\n    scriptEl.textContent = $script.innerText;\n  }\n  if ($scriptRoot) {\n    $scriptRoot.appendChild(scriptEl);\n  } else {\n    document4.head.appendChild(scriptEl);\n  }\n  $script.parentNode.removeChild($script);\n  if (!$script.src) {\n    callback();\n  }\n}\n__name(insertScript, \"insertScript\");\nfunction insertScriptsSequentially(scriptsToExecute, callback, index = 0) {\n  scriptsToExecute[index](() => {\n    index++;\n    if (index === scriptsToExecute.length) {\n      callback();\n    } else {\n      insertScriptsSequentially(scriptsToExecute, callback, index);\n    }\n  });\n}\n__name(insertScriptsSequentially, \"insertScriptsSequentially\");\nfunction simulatePageLoad($container) {\n  let $scriptsRoot = document4.getElementById(SCRIPTS_ROOT_ID);\n  if (!$scriptsRoot) {\n    $scriptsRoot = document4.createElement(\"div\");\n    $scriptsRoot.id = SCRIPTS_ROOT_ID;\n    document4.body.appendChild($scriptsRoot);\n  } else {\n    $scriptsRoot.innerHTML = \"\";\n  }\n  const $scripts = Array.from($container.querySelectorAll(SCRIPT));\n  if ($scripts.length) {\n    const scriptsToExecute = [];\n    $scripts.forEach(($script) => {\n      const typeAttr = $script.getAttribute(\"type\");\n      if (!typeAttr || runScriptTypes.includes(typeAttr)) {\n        scriptsToExecute.push((callback) => insertScript($script, callback, $scriptsRoot));\n      }\n    });\n    if (scriptsToExecute.length) {\n      insertScriptsSequentially(scriptsToExecute, simulateDOMContentLoaded, void 0);\n    }\n  } else {\n    simulateDOMContentLoaded();\n  }\n}\n__name(simulatePageLoad, \"simulatePageLoad\");\n\n// src/preview-api/modules/preview-web/emitTransformCode.ts\nasync function emitTransformCode(source, context) {\n  const transform = context.parameters?.docs?.source?.transform;\n  const { id, unmappedArgs } = context;\n  const transformed = transform && source ? transform?.(source, context) : source;\n  const result = transformed ? await transformed : void 0;\n  addons.getChannel().emit(SNIPPET_RENDERED, {\n    id,\n    source: result,\n    args: unmappedArgs\n  });\n}\n__name(emitTransformCode, \"emitTransformCode\");\n\nexport {\n  mockChannel,\n  addons,\n  HooksContext,\n  applyHooks,\n  useMemo,\n  useCallback,\n  useRef,\n  useState,\n  useReducer,\n  useEffect,\n  useChannel,\n  useStoryContext,\n  useParameter,\n  useArgs,\n  useGlobals,\n  makeDecorator,\n  combineArgs,\n  normalizeArrays,\n  normalizeStory,\n  mountDestructured,\n  decorateStory,\n  sanitizeStoryContextUpdate,\n  defaultDecorateStory,\n  prepareStory,\n  prepareMeta,\n  filterArgTypes,\n  inferControls,\n  normalizeProjectAnnotations,\n  composeStepRunners,\n  composeConfigs,\n  ReporterAPI,\n  getCsfFactoryAnnotations,\n  setDefaultProjectAnnotations,\n  setProjectAnnotations,\n  composeStory,\n  composeStories,\n  createPlaywrightTest,\n  StoryStore,\n  userOrAutoTitleFromSpecifier,\n  userOrAutoTitle,\n  sortStoriesV7,\n  Preview,\n  DocsContext,\n  PreviewWithSelection,\n  UrlStore,\n  WebView,\n  PreviewWeb,\n  simulateDOMContentLoaded,\n  simulatePageLoad,\n  emitTransformCode\n};\n"],"mappings":";AAAA,SACEA,iBAAiB,EACjBC,eAAe,EACfC,iBAAiB,QACZ,qBAAqB;AAC5B,SACEC,YAAY,QACP,qBAAqB;AAC5B,SACEC,gBAAgB,EAChBC,iBAAiB,QACZ,qBAAqB;AAC5B,SACEC,OAAO,QACF,qBAAqB;AAC5B,SACEC,SAAS,QACJ,qBAAqB;AAC5B,SACEC,oBAAoB,QACf,qBAAqB;AAC5B,SACEC,SAAS,EACTC,MAAM,QACD,qBAAqB;AAC5B,SACEC,aAAa,QACR,qBAAqB;AAC5B,SACEC,oBAAoB,QACf,qBAAqB;AAC5B,SACEC,MAAM,QACD,qBAAqB;AAC5B,SACEC,MAAM,EACNC,OAAO,QACF,qBAAqB;;AAE5B;AACA,SAASC,MAAM,QAAQ,mBAAmB;;AAE1C;AACA,SAASC,OAAO,QAAQ,6BAA6B;AACrD,SAASC,WAAWA,CAAA,EAAG;EACrB,MAAMC,SAAS,GAAG;IAChBC,UAAU,EAAE,eAAgBN,MAAM,CAAC,MAAM,CACzC,CAAC,EAAE,YAAY,CAAC;IAChBO,IAAI,EAAE,eAAgBP,MAAM,CAAC,MAAM,CACnC,CAAC,EAAE,MAAM;EACX,CAAC;EACD,OAAO,IAAIG,OAAO,CAAC;IAAEE;EAAU,CAAC,CAAC;AACnC;AACAL,MAAM,CAACI,WAAW,EAAE,aAAa,CAAC;;AAElC;AACA,IAAII,WAAW,GAAG,MAAMA,WAAW,CAAC;EAClCC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACC,UAAU,GAAG,eAAgBV,MAAM,CAAC,MAAM;MAC7C,IAAI,CAAC,IAAI,CAACW,OAAO,EAAE;QACjB,MAAMA,OAAO,GAAGP,WAAW,CAAC,CAAC;QAC7B,IAAI,CAACQ,UAAU,CAACD,OAAO,CAAC;QACxB,OAAOA,OAAO;MAChB;MACA,OAAO,IAAI,CAACA,OAAO;IACrB,CAAC,EAAE,YAAY,CAAC;IAChB,IAAI,CAACE,KAAK,GAAG,eAAgBb,MAAM,CAAC,MAAM,IAAI,CAACc,OAAO,EAAE,OAAO,CAAC;IAChE,IAAI,CAACC,UAAU,GAAG,eAAgBf,MAAM,CAAC,MAAM,CAAC,CAAC,IAAI,CAACW,OAAO,EAAE,YAAY,CAAC;IAC5E,IAAI,CAACC,UAAU,GAAG,eAAgBZ,MAAM,CAAEW,OAAO,IAAK;MACpD,IAAI,CAACA,OAAO,GAAGA,OAAO;MACtB,IAAI,CAACK,OAAO,CAAC,CAAC;IAChB,CAAC,EAAE,YAAY,CAAC;IAChB,IAAI,CAACF,OAAO,GAAG,IAAIG,OAAO,CAAEC,GAAG,IAAK;MAClC,IAAI,CAACF,OAAO,GAAG,MAAME,GAAG,CAAC,IAAI,CAACR,UAAU,CAAC,CAAC,CAAC;IAC7C,CAAC,CAAC;EACJ;AACF,CAAC;AACDV,MAAM,CAACQ,WAAW,EAAE,YAAY,CAAC;AACjC,IAAIW,UAAU,GAAGX,WAAW;AAC5B,IAAIY,GAAG,GAAG,4BAA4B;AACtC,SAASC,cAAcA,CAAA,EAAG;EACxB,IAAI,CAACnB,MAAM,CAACkB,GAAG,CAAC,EAAE;IAChBlB,MAAM,CAACkB,GAAG,CAAC,GAAG,IAAID,UAAU,CAAC,CAAC;EAChC;EACA,OAAOjB,MAAM,CAACkB,GAAG,CAAC;AACpB;AACApB,MAAM,CAACqB,cAAc,EAAE,gBAAgB,CAAC;AACxC,IAAIC,MAAM,GAAGD,cAAc,CAAC,CAAC;;AAE7B;AACA,SAASE,MAAM,QAAQ,kCAAkC;AACzD,SACEC,eAAe,EACfC,gBAAgB,EAChBC,cAAc,EACdC,cAAc,EACdC,iBAAiB,QACZ,gCAAgC;AACvC,SAAS1B,MAAM,IAAI2B,OAAO,QAAQ,mBAAmB;AACrD,IAAIC,aAAa,GAAG,MAAMA,aAAa,CAAC;EACtCrB,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACsB,YAAY,GAAG,KAAK,CAAC;IAC1B,IAAI,CAACC,iBAAiB,GAAG,KAAK,CAAC;IAC/B,IAAI,CAACC,qBAAqB,GAAG,KAAK,CAAC;IACnC,IAAI,CAACC,YAAY,GAAG,KAAK,CAAC;IAC1B,IAAI,CAACC,aAAa,GAAG,KAAK,CAAC;IAC3B,IAAI,CAACC,YAAY,GAAG,KAAK,CAAC;IAC1B,IAAI,CAACC,cAAc,GAAG,KAAK,CAAC;IAC5B,IAAI,CAACC,WAAW,GAAG,KAAK,CAAC;IACzB,IAAI,CAACC,oBAAoB,GAAG,KAAK,CAAC;IAClC,IAAI,CAACC,UAAU,GAAG,KAAK,CAAC;IACxB,IAAI,CAACC,cAAc,GAAG,KAAK,CAAC;IAC5B,IAAI,CAACC,cAAc,GAAG,eAAgB1C,MAAM,CAAE2C,OAAO,IAAK;MACxD,IAAIA,OAAO,KAAK,IAAI,CAACF,cAAc,EAAEG,EAAE,EAAE;QACvC;MACF;MACA,IAAI,CAACC,cAAc,CAAC,CAAC;MACrB,IAAI,CAACJ,cAAc,GAAG,IAAI;MAC1B,IAAI,CAACK,qBAAqB,CAAC,CAAC;IAC9B,CAAC,EAAE,gBAAgB,CAAC;IACpB,IAAI,CAACC,IAAI,CAAC,CAAC;EACb;EACAA,IAAIA,CAAA,EAAG;IACL,IAAI,CAAChB,YAAY,GAAG,eAAgB,IAAIiB,OAAO,CAAC,CAAC;IACjD,IAAI,CAAChB,iBAAiB,GAAG,eAAgB,IAAIiB,GAAG,CAAC,CAAC;IAClD,IAAI,CAAChB,qBAAqB,GAAG,eAAgB,IAAIgB,GAAG,CAAC,CAAC;IACtD,IAAI,CAACf,YAAY,GAAG,EAAE;IACtB,IAAI,CAACC,aAAa,GAAG,CAAC;IACtB,IAAI,CAACC,YAAY,GAAG,MAAM;IAC1B,IAAI,CAACC,cAAc,GAAG,EAAE;IACxB,IAAI,CAACC,WAAW,GAAG,EAAE;IACrB,IAAI,CAACC,oBAAoB,GAAG,IAAI;IAChC,IAAI,CAACC,UAAU,GAAG,KAAK;IACvB,IAAI,CAACC,cAAc,GAAG,IAAI;EAC5B;EACAS,KAAKA,CAAA,EAAG;IACN,IAAI,CAACZ,WAAW,CAACa,OAAO,CAAEC,MAAM,IAAK;MACnC,IAAIA,MAAM,CAACC,OAAO,EAAE;QAClBD,MAAM,CAACC,OAAO,CAAC,CAAC;MAClB;IACF,CAAC,CAAC;IACF,IAAI,CAACN,IAAI,CAAC,CAAC;IACX,IAAI,CAACD,qBAAqB,CAAC,CAAC;EAC9B;EACAQ,WAAWA,CAAA,EAAG;IACZ,MAAMC,IAAI,GAAG,IAAI,CAACrB,YAAY,CAAC,IAAI,CAACC,aAAa,CAAC;IAClD,IAAI,CAACA,aAAa,IAAI,CAAC;IACvB,OAAOoB,IAAI;EACb;EACAV,cAAcA,CAAA,EAAG;IACf,IAAI,CAACP,WAAW,CAACa,OAAO,CAAEC,MAAM,IAAK;MACnC,IAAI,CAAC,IAAI,CAACf,cAAc,CAACmB,QAAQ,CAACJ,MAAM,CAAC,IAAIA,MAAM,CAACC,OAAO,EAAE;QAC3DD,MAAM,CAACC,OAAO,CAAC,CAAC;MAClB;IACF,CAAC,CAAC;IACF,IAAI,CAAChB,cAAc,CAACc,OAAO,CAAEC,MAAM,IAAK;MACtC,IAAI,CAAC,IAAI,CAACd,WAAW,CAACkB,QAAQ,CAACJ,MAAM,CAAC,EAAE;QACtCA,MAAM,CAACC,OAAO,GAAGD,MAAM,CAACK,MAAM,CAAC,CAAC;MAClC;IACF,CAAC,CAAC;IACF,IAAI,CAACnB,WAAW,GAAG,IAAI,CAACD,cAAc;IACtC,IAAI,CAACA,cAAc,GAAG,EAAE;EAC1B;EACAqB,kBAAkBA,CAAA,EAAG;IACnB,IAAI,CAACZ,qBAAqB,CAAC,CAAC;IAC5B,MAAMnC,OAAO,GAAGW,MAAM,CAACZ,UAAU,CAAC,CAAC;IACnCC,OAAO,CAACgD,EAAE,CAACjC,cAAc,EAAE,IAAI,CAACgB,cAAc,CAAC;EACjD;EACAI,qBAAqBA,CAAA,EAAG;IACtB,MAAMnC,OAAO,GAAGW,MAAM,CAACZ,UAAU,CAAC,CAAC;IACnCC,OAAO,CAACiD,cAAc,CAAClC,cAAc,EAAE,IAAI,CAACgB,cAAc,CAAC;EAC7D;AACF,CAAC;AACD1C,MAAM,CAAC8B,aAAa,EAAE,cAAc,CAAC;AACrC,IAAI+B,YAAY,GAAG/B,aAAa;AAChC,SAASgC,OAAOA,CAACC,EAAE,EAAE;EACnB,MAAMC,SAAS,GAAG,eAAgBhE,MAAM,CAAC,CAAC,GAAGiE,IAAI,KAAK;IACpD,MAAM;MAAEC;IAAM,CAAC,GAAG,OAAOD,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,GAAGA,IAAI,CAAC,CAAC,CAAC,GAAGA,IAAI,CAAC,CAAC,CAAC;IACnE,MAAME,SAAS,GAAGD,KAAK,CAAC9B,YAAY;IACpC,MAAMgC,SAAS,GAAGF,KAAK,CAAChC,YAAY;IACpC,MAAMmC,iBAAiB,GAAGH,KAAK,CAAC/B,aAAa;IAC7C,MAAMmC,iBAAiB,GAAGJ,KAAK,CAAC3B,oBAAoB;IACpD2B,KAAK,CAAC3B,oBAAoB,GAAGwB,EAAE,CAACQ,IAAI;IACpC,IAAIL,KAAK,CAACjC,qBAAqB,CAACuC,GAAG,CAACT,EAAE,CAAC,EAAE;MACvCG,KAAK,CAAC9B,YAAY,GAAG,QAAQ;MAC7B8B,KAAK,CAAChC,YAAY,GAAGgC,KAAK,CAACnC,YAAY,CAAC0C,GAAG,CAACV,EAAE,CAAC,IAAI,EAAE;IACvD,CAAC,MAAM;MACLG,KAAK,CAAC9B,YAAY,GAAG,OAAO;MAC5B8B,KAAK,CAAChC,YAAY,GAAG,EAAE;MACvBgC,KAAK,CAACnC,YAAY,CAAC2C,GAAG,CAACX,EAAE,EAAEG,KAAK,CAAChC,YAAY,CAAC;MAC9CgC,KAAK,CAACjC,qBAAqB,CAAC0C,GAAG,CAACZ,EAAE,CAAC;IACrC;IACAG,KAAK,CAAC/B,aAAa,GAAG,CAAC;IACvB,MAAMyC,WAAW,GAAG/C,OAAO,CAACgD,uBAAuB;IACnDhD,OAAO,CAACgD,uBAAuB,GAAGX,KAAK;IACvC,MAAMY,MAAM,GAAGf,EAAE,CAAC,GAAGE,IAAI,CAAC;IAC1BpC,OAAO,CAACgD,uBAAuB,GAAGD,WAAW;IAC7C,IAAIV,KAAK,CAAC9B,YAAY,KAAK,QAAQ,IAAI8B,KAAK,CAACZ,WAAW,CAAC,CAAC,IAAI,IAAI,EAAE;MAClE,MAAM,IAAIyB,KAAK,CACb,iGACF,CAAC;IACH;IACAb,KAAK,CAAC9B,YAAY,GAAG+B,SAAS;IAC9BD,KAAK,CAAChC,YAAY,GAAGkC,SAAS;IAC9BF,KAAK,CAAC/B,aAAa,GAAGkC,iBAAiB;IACvCH,KAAK,CAAC3B,oBAAoB,GAAG+B,iBAAiB;IAC9C,OAAOQ,MAAM;EACf,CAAC,EAAE,WAAW,CAAC;EACfd,SAAS,CAACgB,UAAU,GAAGjB,EAAE;EACzB,OAAOC,SAAS;AAClB;AACAhE,MAAM,CAAC8D,OAAO,EAAE,SAAS,CAAC;AAC1B,IAAImB,eAAe,GAAG,CAAC;AACvB,IAAIC,YAAY,GAAG,EAAE;AACrB,IAAIC,UAAU,GAAG,eAAgBnF,MAAM,CAAEoF,eAAe,IAAK,CAACC,OAAO,EAAEC,UAAU,KAAK;EACpF,MAAMC,SAAS,GAAGH,eAAe,CAC/BtB,OAAO,CAACuB,OAAO,CAAC,EAChBC,UAAU,CAACE,GAAG,CAAEC,SAAS,IAAK3B,OAAO,CAAC2B,SAAS,CAAC,CAClD,CAAC;EACD,OAAQC,OAAO,IAAK;IAClB,MAAM;MAAExB;IAAM,CAAC,GAAGwB,OAAO;IACzBxB,KAAK,CAACjC,qBAAqB,KAAK,eAAgB,IAAIgB,GAAG,CAAC,CAAC;IACzDiB,KAAK,CAAClC,iBAAiB,GAAG,eAAgB,IAAIiB,GAAG,CAAC,CAACoC,OAAO,EAAE,GAAGC,UAAU,CAAC,CAAC;IAC3EpB,KAAK,CAACzB,cAAc,GAAGiD,OAAO;IAC9BxB,KAAK,CAAC1B,UAAU,GAAG,KAAK;IACxB,IAAIsC,MAAM,GAAGS,SAAS,CAACG,OAAO,CAAC;IAC/BT,eAAe,GAAG,CAAC;IACnB,OAAOf,KAAK,CAAC1B,UAAU,EAAE;MACvB0B,KAAK,CAAC1B,UAAU,GAAG,KAAK;MACxB0B,KAAK,CAAC7B,cAAc,GAAG,EAAE;MACzByC,MAAM,GAAGS,SAAS,CAACG,OAAO,CAAC;MAC3BT,eAAe,IAAI,CAAC;MACpB,IAAIA,eAAe,GAAGC,YAAY,EAAE;QAClC,MAAM,IAAIH,KAAK,CACb,0FACF,CAAC;MACH;IACF;IACAb,KAAK,CAACR,kBAAkB,CAAC,CAAC;IAC1B,OAAOoB,MAAM;EACf,CAAC;AACH,CAAC,EAAE,YAAY,CAAC;AAChB,IAAIa,YAAY,GAAG,eAAgB3F,MAAM,CAAC,CAAC4F,IAAI,EAAEC,QAAQ,KAAKD,IAAI,CAACE,MAAM,KAAKD,QAAQ,CAACC,MAAM,IAAIF,IAAI,CAACG,KAAK,CAAC,CAACC,GAAG,EAAEC,CAAC,KAAKD,GAAG,KAAKH,QAAQ,CAACI,CAAC,CAAC,CAAC,EAAE,cAAc,CAAC;AAC7J,IAAIC,iBAAiB,GAAG,eAAgBlG,MAAM,CAAC,MAAM,IAAI+E,KAAK,CAAC,mFAAmF,CAAC,EAAE,mBAAmB,CAAC;AACzK,SAASoB,qBAAqBA,CAAA,EAAG;EAC/B,OAAOtE,OAAO,CAACgD,uBAAuB,IAAI,IAAI;AAChD;AACA7E,MAAM,CAACmG,qBAAqB,EAAE,uBAAuB,CAAC;AACtD,SAASC,sBAAsBA,CAAA,EAAG;EAChC,MAAMlC,KAAK,GAAGiC,qBAAqB,CAAC,CAAC;EACrC,IAAIjC,KAAK,IAAI,IAAI,EAAE;IACjB,MAAMgC,iBAAiB,CAAC,CAAC;EAC3B;EACA,OAAOhC,KAAK;AACd;AACAlE,MAAM,CAACoG,sBAAsB,EAAE,wBAAwB,CAAC;AACxD,SAASC,OAAOA,CAAC9B,IAAI,EAAE+B,QAAQ,EAAEV,IAAI,EAAE;EACrC,MAAM1B,KAAK,GAAGkC,sBAAsB,CAAC,CAAC;EACtC,IAAIlC,KAAK,CAAC9B,YAAY,KAAK,OAAO,EAAE;IAClC,IAAIwD,IAAI,IAAI,IAAI,IAAI,CAACW,KAAK,CAACC,OAAO,CAACZ,IAAI,CAAC,EAAE;MACxCrE,MAAM,CAACkF,IAAI,CACT,GAAGlC,IAAI,sEAAsEqB,IAAI,yDACnF,CAAC;IACH;IACA,MAAMrC,IAAI,GAAG;MAAEgB,IAAI;MAAEqB;IAAK,CAAC;IAC3B1B,KAAK,CAAChC,YAAY,CAACwE,IAAI,CAACnD,IAAI,CAAC;IAC7B+C,QAAQ,CAAC/C,IAAI,CAAC;IACd,OAAOA,IAAI;EACb;EACA,IAAIW,KAAK,CAAC9B,YAAY,KAAK,QAAQ,EAAE;IACnC,MAAMmB,IAAI,GAAGW,KAAK,CAACZ,WAAW,CAAC,CAAC;IAChC,IAAIC,IAAI,IAAI,IAAI,EAAE;MAChB,MAAM,IAAIwB,KAAK,CAAC,sDAAsD,CAAC;IACzE;IACA,IAAIxB,IAAI,CAACgB,IAAI,KAAKA,IAAI,EAAE;MACtBhD,MAAM,CAACkF,IAAI,CACT,wDAAwDvC,KAAK,CAAC3B,oBAAoB,GAAG,cAAc2B,KAAK,CAAC3B,oBAAoB,EAAE,GAAG,EAAE,mDACtI,CAAC;IACH;IACA,IAAIqD,IAAI,IAAI,IAAI,IAAIrC,IAAI,CAACqC,IAAI,IAAI,IAAI,EAAE;MACrCrE,MAAM,CAACkF,IAAI,CACT,GAAGlC,IAAI,wKACT,CAAC;IACH;IACA,IAAIqB,IAAI,IAAI,IAAI,IAAIrC,IAAI,CAACqC,IAAI,IAAI,IAAI,IAAIA,IAAI,CAACE,MAAM,KAAKvC,IAAI,CAACqC,IAAI,CAACE,MAAM,EAAE;MACzEvE,MAAM,CAACkF,IAAI,CAAC,gCAAgClC,IAAI;AACtD,YAAYhB,IAAI,CAACqC,IAAI;AACrB,YAAYA,IAAI,EAAE,CAAC;IACf;IACA,IAAIA,IAAI,IAAI,IAAI,IAAIrC,IAAI,CAACqC,IAAI,IAAI,IAAI,IAAI,CAACD,YAAY,CAACC,IAAI,EAAErC,IAAI,CAACqC,IAAI,CAAC,EAAE;MACvEU,QAAQ,CAAC/C,IAAI,CAAC;MACdA,IAAI,CAACqC,IAAI,GAAGA,IAAI;IAClB;IACA,OAAOrC,IAAI;EACb;EACA,MAAM2C,iBAAiB,CAAC,CAAC;AAC3B;AACAlG,MAAM,CAACqG,OAAO,EAAE,SAAS,CAAC;AAC1B,SAASM,WAAWA,CAACpC,IAAI,EAAEqC,UAAU,EAAEhB,IAAI,EAAE;EAC3C,MAAM;IAAEiB;EAAc,CAAC,GAAGR,OAAO,CAC/B9B,IAAI,EACHhB,IAAI,IAAK;IACRA,IAAI,CAACsD,aAAa,GAAGD,UAAU,CAAC,CAAC;EACnC,CAAC,EACDhB,IACF,CAAC;EACD,OAAOiB,aAAa;AACtB;AACA7G,MAAM,CAAC2G,WAAW,EAAE,aAAa,CAAC;AAClC,SAASG,OAAOA,CAACF,UAAU,EAAEhB,IAAI,EAAE;EACjC,OAAOe,WAAW,CAAC,SAAS,EAAEC,UAAU,EAAEhB,IAAI,CAAC;AACjD;AACA5F,MAAM,CAAC8G,OAAO,EAAE,SAAS,CAAC;AAC1B,SAASC,WAAWA,CAACT,QAAQ,EAAEV,IAAI,EAAE;EACnC,OAAOe,WAAW,CAAC,aAAa,EAAE,MAAML,QAAQ,EAAEV,IAAI,CAAC;AACzD;AACA5F,MAAM,CAAC+G,WAAW,EAAE,aAAa,CAAC;AAClC,SAASC,UAAUA,CAACzC,IAAI,EAAE0C,YAAY,EAAE;EACtC,OAAON,WAAW,CAACpC,IAAI,EAAE,OAAO;IAAE2C,OAAO,EAAED;EAAa,CAAC,CAAC,EAAE,EAAE,CAAC;AACjE;AACAjH,MAAM,CAACgH,UAAU,EAAE,YAAY,CAAC;AAChC,SAASG,MAAMA,CAACF,YAAY,EAAE;EAC5B,OAAOD,UAAU,CAAC,QAAQ,EAAEC,YAAY,CAAC;AAC3C;AACAjH,MAAM,CAACmH,MAAM,EAAE,QAAQ,CAAC;AACxB,SAASC,aAAaA,CAAA,EAAG;EACvB,MAAMlD,KAAK,GAAGiC,qBAAqB,CAAC,CAAC;EACrC,IAAIjC,KAAK,IAAI,IAAI,IAAIA,KAAK,CAAC9B,YAAY,KAAK,MAAM,EAAE;IAClD8B,KAAK,CAAC1B,UAAU,GAAG,IAAI;EACzB,CAAC,MAAM;IACL,IAAI;MACFlB,MAAM,CAACZ,UAAU,CAAC,CAAC,CAAC2G,IAAI,CAAC7F,eAAe,CAAC;IAC3C,CAAC,CAAC,OAAO8F,CAAC,EAAE;MACV/F,MAAM,CAACkF,IAAI,CAAC,+DAA+D,CAAC;IAC9E;EACF;AACF;AACAzG,MAAM,CAACoH,aAAa,EAAE,eAAe,CAAC;AACtC,SAASG,YAAYA,CAAChD,IAAI,EAAEiD,YAAY,EAAE;EACxC,MAAMC,QAAQ,GAAGT,UAAU,CACzBzC,IAAI;EACJ;EACA,OAAOiD,YAAY,KAAK,UAAU,GAAGA,YAAY,CAAC,CAAC,GAAGA,YACxD,CAAC;EACD,MAAME,QAAQ,GAAG,eAAgB1H,MAAM,CAAE2H,MAAM,IAAK;IAClDF,QAAQ,CAACP,OAAO,GAAG,OAAOS,MAAM,KAAK,UAAU,GAAGA,MAAM,CAACF,QAAQ,CAACP,OAAO,CAAC,GAAGS,MAAM;IACnFP,aAAa,CAAC,CAAC;EACjB,CAAC,EAAE,UAAU,CAAC;EACd,OAAO,CAACK,QAAQ,CAACP,OAAO,EAAEQ,QAAQ,CAAC;AACrC;AACA1H,MAAM,CAACuH,YAAY,EAAE,cAAc,CAAC;AACpC,SAASK,QAAQA,CAACJ,YAAY,EAAE;EAC9B,OAAOD,YAAY,CAAC,UAAU,EAAEC,YAAY,CAAC;AAC/C;AACAxH,MAAM,CAAC4H,QAAQ,EAAE,UAAU,CAAC;AAC5B,SAASC,UAAUA,CAACC,OAAO,EAAEC,UAAU,EAAEhF,IAAI,EAAE;EAC7C,MAAMyE,YAAY,GAAGzE,IAAI,IAAI,IAAI,GAAG,MAAMA,IAAI,CAACgF,UAAU,CAAC,GAAGA,UAAU;EACvE,MAAM,CAACC,KAAK,EAAEN,QAAQ,CAAC,GAAGH,YAAY,CAAC,YAAY,EAAEC,YAAY,CAAC;EAClE,MAAMS,QAAQ,GAAG,eAAgBjI,MAAM,CAAEkI,MAAM,IAAKR,QAAQ,CAAES,SAAS,IAAKL,OAAO,CAACK,SAAS,EAAED,MAAM,CAAC,CAAC,EAAE,UAAU,CAAC;EACpH,OAAO,CAACF,KAAK,EAAEC,QAAQ,CAAC;AAC1B;AACAjI,MAAM,CAAC6H,UAAU,EAAE,YAAY,CAAC;AAChC,SAASO,SAASA,CAAC3E,MAAM,EAAEmC,IAAI,EAAE;EAC/B,MAAM1B,KAAK,GAAGkC,sBAAsB,CAAC,CAAC;EACtC,MAAMhD,MAAM,GAAGuD,WAAW,CAAC,WAAW,EAAE,OAAO;IAAElD;EAAO,CAAC,CAAC,EAAEmC,IAAI,CAAC;EACjE,IAAI,CAAC1B,KAAK,CAAC7B,cAAc,CAACmB,QAAQ,CAACJ,MAAM,CAAC,EAAE;IAC1Cc,KAAK,CAAC7B,cAAc,CAACqE,IAAI,CAACtD,MAAM,CAAC;EACnC;AACF;AACApD,MAAM,CAACoI,SAAS,EAAE,WAAW,CAAC;AAC9B,SAASC,UAAUA,CAACC,QAAQ,EAAE1C,IAAI,GAAG,EAAE,EAAE;EACvC,MAAMjF,OAAO,GAAGW,MAAM,CAACZ,UAAU,CAAC,CAAC;EACnC0H,SAAS,CAAC,MAAM;IACdG,MAAM,CAACC,OAAO,CAACF,QAAQ,CAAC,CAACnF,OAAO,CAAC,CAAC,CAACsF,IAAI,EAAEC,QAAQ,CAAC,KAAK/H,OAAO,CAACgD,EAAE,CAAC8E,IAAI,EAAEC,QAAQ,CAAC,CAAC;IAClF,OAAO,MAAM;MACXH,MAAM,CAACC,OAAO,CAACF,QAAQ,CAAC,CAACnF,OAAO,CAC9B,CAAC,CAACsF,IAAI,EAAEC,QAAQ,CAAC,KAAK/H,OAAO,CAACiD,cAAc,CAAC6E,IAAI,EAAEC,QAAQ,CAC7D,CAAC;IACH,CAAC;EACH,CAAC,EAAE,CAAC,GAAGH,MAAM,CAACI,IAAI,CAACL,QAAQ,CAAC,EAAE,GAAG1C,IAAI,CAAC,CAAC;EACvC,OAAOmB,WAAW,CAACpG,OAAO,CAAC0G,IAAI,CAACuB,IAAI,CAACjI,OAAO,CAAC,EAAE,CAACA,OAAO,CAAC,CAAC;AAC3D;AACAX,MAAM,CAACqI,UAAU,EAAE,YAAY,CAAC;AAChC,SAASQ,eAAeA,CAAA,EAAG;EACzB,MAAM;IAAEpG;EAAe,CAAC,GAAG2D,sBAAsB,CAAC,CAAC;EACnD,IAAI3D,cAAc,IAAI,IAAI,EAAE;IAC1B,MAAMyD,iBAAiB,CAAC,CAAC;EAC3B;EACA,OAAOzD,cAAc;AACvB;AACAzC,MAAM,CAAC6I,eAAe,EAAE,iBAAiB,CAAC;AAC1C,SAASC,YAAYA,CAACC,YAAY,EAAEC,YAAY,EAAE;EAChD,MAAM;IAAEC;EAAW,CAAC,GAAGJ,eAAe,CAAC,CAAC;EACxC,IAAIE,YAAY,EAAE;IAChB,OAAOE,UAAU,CAACF,YAAY,CAAC,IAAIC,YAAY;EACjD;EACA,OAAO,KAAK,CAAC;AACf;AACAhJ,MAAM,CAAC8I,YAAY,EAAE,cAAc,CAAC;AACpC,SAASI,OAAOA,CAAA,EAAG;EACjB,MAAMvI,OAAO,GAAGW,MAAM,CAACZ,UAAU,CAAC,CAAC;EACnC,MAAM;IAAEkC,EAAE,EAAED,OAAO;IAAEsB;EAAK,CAAC,GAAG4E,eAAe,CAAC,CAAC;EAC/C,MAAMM,UAAU,GAAGpC,WAAW,CAC3BqC,WAAW,IAAKzI,OAAO,CAAC0G,IAAI,CAACzF,iBAAiB,EAAE;IAAEe,OAAO;IAAEyG;EAAY,CAAC,CAAC,EAC1E,CAACzI,OAAO,EAAEgC,OAAO,CACnB,CAAC;EACD,MAAM0G,SAAS,GAAGtC,WAAW,CAC1BuC,QAAQ,IAAK3I,OAAO,CAAC0G,IAAI,CAAC5F,gBAAgB,EAAE;IAAEkB,OAAO;IAAE2G;EAAS,CAAC,CAAC,EACnE,CAAC3I,OAAO,EAAEgC,OAAO,CACnB,CAAC;EACD,OAAO,CAACsB,IAAI,EAAEkF,UAAU,EAAEE,SAAS,CAAC;AACtC;AACArJ,MAAM,CAACkJ,OAAO,EAAE,SAAS,CAAC;AAC1B,SAASK,UAAUA,CAAA,EAAG;EACpB,MAAM5I,OAAO,GAAGW,MAAM,CAACZ,UAAU,CAAC,CAAC;EACnC,MAAM;IAAE8I;EAAQ,CAAC,GAAGX,eAAe,CAAC,CAAC;EACrC,MAAMY,aAAa,GAAG1C,WAAW,CAC9B2C,UAAU,IAAK/I,OAAO,CAAC0G,IAAI,CAAC1F,cAAc,EAAE;IAAE6H,OAAO,EAAEE;EAAW,CAAC,CAAC,EACrE,CAAC/I,OAAO,CACV,CAAC;EACD,OAAO,CAAC6I,OAAO,EAAEC,aAAa,CAAC;AACjC;AACAzJ,MAAM,CAACuJ,UAAU,EAAE,YAAY,CAAC;;AAEhC;AACA,IAAII,aAAa,GAAG,eAAgB3J,MAAM,CAAC,CAAC;EAC1CuE,IAAI;EACJqF,aAAa;EACbC,OAAO;EACPC,2BAA2B,GAAG;AAChC,CAAC,KAAK;EACJ,MAAMrE,SAAS,GAAG,eAAgBzF,MAAM,CAAE+J,OAAO,IAAK,CAAC1E,OAAO,EAAEK,OAAO,KAAK;IAC1E,MAAMuD,UAAU,GAAGvD,OAAO,CAACuD,UAAU,IAAIvD,OAAO,CAACuD,UAAU,CAACW,aAAa,CAAC;IAC1E,IAAIX,UAAU,IAAIA,UAAU,CAACe,OAAO,EAAE;MACpC,OAAO3E,OAAO,CAACK,OAAO,CAAC;IACzB;IACA,IAAIoE,2BAA2B,IAAI,CAACC,OAAO,IAAI,CAACd,UAAU,EAAE;MAC1D,OAAO5D,OAAO,CAACK,OAAO,CAAC;IACzB;IACA,OAAOmE,OAAO,CAACxE,OAAO,EAAEK,OAAO,EAAE;MAC/BqE,OAAO;MACPd;IACF,CAAC,CAAC;EACJ,CAAC,EAAE,WAAW,CAAC;EACf,OAAO,CAAC,GAAGhF,IAAI,KAAK;IAClB,IAAI,OAAOA,IAAI,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;MACjC,OAAOwB,SAAS,CAAC,CAAC,CAAC,GAAGxB,IAAI,CAAC;IAC7B;IACA,OAAO,CAAC,GAAGgG,SAAS,KAAK;MACvB,IAAIA,SAAS,CAACnE,MAAM,GAAG,CAAC,EAAE;QACxB,IAAI7B,IAAI,CAAC6B,MAAM,GAAG,CAAC,EAAE;UACnB,OAAOL,SAAS,CAACxB,IAAI,CAAC,CAAC,GAAGgG,SAAS,CAAC;QACtC;QACA,OAAOxE,SAAS,CAAC,GAAGxB,IAAI,CAAC,CAAC,GAAGgG,SAAS,CAAC;MACzC;MACA,MAAM,IAAIlF,KAAK,CACb,iCAAiCR,IAAI;AAC7C,mCAAmCA,IAAI,gCAAgCqF,aAAa,aAC9E,CAAC;IACH,CAAC;EACH,CAAC;AACH,CAAC,EAAE,eAAe,CAAC;;AAEnB;AACA,SAASM,kBAAkB,IAAIC,mBAAmB,QAAQ,wBAAwB;AAClF,SACEC,yBAAyB,EACzBC,4BAA4B,QACvB,mCAAmC;AAC1C,IAAIC,oBAAoB,GAAGrK,OAAO,CAACH,oBAAoB,CAAC,CAAC,EAAE,CAAC,CAAC;;AAE7D;AACA,SAASyK,IAAI,QAAQ,kCAAkC;AACvD,IAAIC,YAAY,GAAGC,MAAM,CAAC,cAAc,CAAC;AACzC,IAAIjF,GAAG,GAAG,eAAgBxF,MAAM,CAAC,CAAC0K,GAAG,EAAEC,OAAO,KAAK;EACjD,MAAMlC,IAAI,GAAGkC,OAAO,CAAClC,IAAI;EACzB,IAAIiC,GAAG,KAAK,KAAK,CAAC,IAAIA,GAAG,KAAK,IAAI,IAAI,CAACjC,IAAI,EAAE;IAC3C,OAAOiC,GAAG;EACZ;EACA,IAAIC,OAAO,CAACC,OAAO,EAAE;IACnB,OAAOF,GAAG;EACZ;EACA,QAAQjC,IAAI,CAAClE,IAAI;IACf,KAAK,QAAQ;MACX,OAAOsG,MAAM,CAACH,GAAG,CAAC;IACpB,KAAK,MAAM;MACT,OAAOA,GAAG;IACZ,KAAK,QAAQ;MACX,OAAOI,MAAM,CAACJ,GAAG,CAAC;IACpB,KAAK,SAAS;MACZ,OAAOG,MAAM,CAACH,GAAG,CAAC,KAAK,MAAM;IAC/B,KAAK,OAAO;MACV,IAAI,CAACjC,IAAI,CAACsC,KAAK,IAAI,CAACxE,KAAK,CAACC,OAAO,CAACkE,GAAG,CAAC,EAAE;QACtC,OAAOF,YAAY;MACrB;MACA,OAAOE,GAAG,CAACM,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,EAAEC,KAAK,KAAK;QACtC,MAAMC,MAAM,GAAG5F,GAAG,CAAC0F,IAAI,EAAE;UAAEzC,IAAI,EAAEA,IAAI,CAACsC;QAAM,CAAC,CAAC;QAC9C,IAAIK,MAAM,KAAKZ,YAAY,EAAE;UAC3BS,GAAG,CAACE,KAAK,CAAC,GAAGC,MAAM;QACrB;QACA,OAAOH,GAAG;MACZ,CAAC,EAAE,IAAI1E,KAAK,CAACmE,GAAG,CAAC5E,MAAM,CAAC,CAAC;IAC3B,KAAK,QAAQ;MACX,IAAI,OAAO4E,GAAG,KAAK,QAAQ,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;QACtD,OAAOA,GAAG;MACZ;MACA,IAAI,CAACjC,IAAI,CAACsC,KAAK,IAAI,OAAOL,GAAG,KAAK,QAAQ,EAAE;QAC1C,OAAOF,YAAY;MACrB;MACA,OAAOjC,MAAM,CAACC,OAAO,CAACkC,GAAG,CAAC,CAACM,MAAM,CAAC,CAACC,GAAG,EAAE,CAACI,GAAG,EAAEC,GAAG,CAAC,KAAK;QACrD,MAAMF,MAAM,GAAG5F,GAAG,CAAC8F,GAAG,EAAE;UAAE7C,IAAI,EAAEA,IAAI,CAACsC,KAAK,CAACM,GAAG;QAAE,CAAC,CAAC;QAClD,OAAOD,MAAM,KAAKZ,YAAY,GAAGS,GAAG,GAAG1C,MAAM,CAACgD,MAAM,CAACN,GAAG,EAAE;UAAE,CAACI,GAAG,GAAGD;QAAO,CAAC,CAAC;MAC9E,CAAC,EAAE,CAAC,CAAC,CAAC;IACR,KAAK,OAAO;MAAE;QACZ,MAAMI,cAAc,GAAG,OAAOd,GAAG,KAAK,QAAQ,IAAI,OAAOA,GAAG,KAAK,QAAQ,IAAI,OAAOA,GAAG,KAAK,SAAS;QACrG,IAAIjC,IAAI,CAACsC,KAAK,KAAK,WAAW,IAAIS,cAAc,EAAE;UAChD,OAAOd,GAAG;QACZ;QACA,OAAOF,YAAY;MACrB;IACA;MACE,OAAOA,YAAY;EACvB;AACF,CAAC,EAAE,KAAK,CAAC;AACT,IAAIiB,cAAc,GAAG,eAAgBzL,MAAM,CAAC,CAACiE,IAAI,EAAEyH,QAAQ,KAAK;EAC9D,OAAOnD,MAAM,CAACC,OAAO,CAACvE,IAAI,CAAC,CAAC+G,MAAM,CAAC,CAACC,GAAG,EAAE,CAACI,GAAG,EAAEN,KAAK,CAAC,KAAK;IACxD,IAAI,CAACW,QAAQ,CAACL,GAAG,CAAC,EAAE;MAClB,OAAOJ,GAAG;IACZ;IACA,MAAMG,MAAM,GAAG5F,GAAG,CAACuF,KAAK,EAAEW,QAAQ,CAACL,GAAG,CAAC,CAAC;IACxC,OAAOD,MAAM,KAAKZ,YAAY,GAAGS,GAAG,GAAG1C,MAAM,CAACgD,MAAM,CAACN,GAAG,EAAE;MAAE,CAACI,GAAG,GAAGD;IAAO,CAAC,CAAC;EAC9E,CAAC,EAAE,CAAC,CAAC,CAAC;AACR,CAAC,EAAE,gBAAgB,CAAC;AACpB,IAAIO,WAAW,GAAG,eAAgB3L,MAAM,CAAC,CAAC+K,KAAK,EAAEpD,MAAM,KAAK;EAC1D,IAAIpB,KAAK,CAACC,OAAO,CAACuE,KAAK,CAAC,IAAIxE,KAAK,CAACC,OAAO,CAACmB,MAAM,CAAC,EAAE;IACjD,OAAOA,MAAM,CAACqD,MAAM,CAClB,CAACC,GAAG,EAAEW,GAAG,EAAET,KAAK,KAAK;MACnBF,GAAG,CAACE,KAAK,CAAC,GAAGQ,WAAW,CAACZ,KAAK,CAACI,KAAK,CAAC,EAAExD,MAAM,CAACwD,KAAK,CAAC,CAAC;MACrD,OAAOF,GAAG;IACZ,CAAC,EACD,CAAC,GAAGF,KAAK,CACX,CAAC,CAACc,MAAM,CAAEC,CAAC,IAAKA,CAAC,KAAK,KAAK,CAAC,CAAC;EAC/B;EACA,IAAI,CAACjM,aAAa,CAACkL,KAAK,CAAC,IAAI,CAAClL,aAAa,CAAC8H,MAAM,CAAC,EAAE;IACnD,OAAOA,MAAM;EACf;EACA,OAAOY,MAAM,CAACI,IAAI,CAAC;IAAE,GAAGoC,KAAK;IAAE,GAAGpD;EAAO,CAAC,CAAC,CAACqD,MAAM,CAAC,CAACC,GAAG,EAAEI,GAAG,KAAK;IAC/D,IAAIA,GAAG,IAAI1D,MAAM,EAAE;MACjB,MAAMoE,QAAQ,GAAGJ,WAAW,CAACZ,KAAK,CAACM,GAAG,CAAC,EAAE1D,MAAM,CAAC0D,GAAG,CAAC,CAAC;MACrD,IAAIU,QAAQ,KAAK,KAAK,CAAC,EAAE;QACvBd,GAAG,CAACI,GAAG,CAAC,GAAGU,QAAQ;MACrB;IACF,CAAC,MAAM;MACLd,GAAG,CAACI,GAAG,CAAC,GAAGN,KAAK,CAACM,GAAG,CAAC;IACvB;IACA,OAAOJ,GAAG;EACZ,CAAC,EAAE,CAAC,CAAC,CAAC;AACR,CAAC,EAAE,aAAa,CAAC;AACjB,IAAIe,eAAe,GAAG,eAAgBhM,MAAM,CAAC,CAACiE,IAAI,EAAEyH,QAAQ,KAAK;EAC/D,OAAOnD,MAAM,CAACC,OAAO,CAACkD,QAAQ,CAAC,CAACV,MAAM,CAAC,CAACC,GAAG,EAAE,CAACI,GAAG,EAAE;IAAEtB;EAAQ,CAAC,CAAC,KAAK;IAClE,SAASkC,QAAQA,CAAA,EAAG;MAClB,IAAIZ,GAAG,IAAIpH,IAAI,EAAE;QACfgH,GAAG,CAACI,GAAG,CAAC,GAAGpH,IAAI,CAACoH,GAAG,CAAC;MACtB;MACA,OAAOJ,GAAG;IACZ;IACAjL,MAAM,CAACiM,QAAQ,EAAE,UAAU,CAAC;IAC5B,IAAI,CAAClC,OAAO,EAAE;MACZ,OAAOkC,QAAQ,CAAC,CAAC;IACnB;IACA,IAAI,CAAC1F,KAAK,CAACC,OAAO,CAACuD,OAAO,CAAC,EAAE;MAC3BQ,IAAI,CAAC2B,KAAK,CAACnM,MAAM;AACvB,4BAA4BsL,GAAG;AAC/B;AACA;AACA,OAAO,CAAC;MACF,OAAOY,QAAQ,CAAC,CAAC;IACnB;IACA,IAAIlC,OAAO,CAACoC,IAAI,CAAEC,GAAG,IAAKA,GAAG,IAAI,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC5I,QAAQ,CAAC,OAAO4I,GAAG,CAAC,CAAC,EAAE;MAC7E7B,IAAI,CAAC2B,KAAK,CAACnM,MAAM;AACvB,4BAA4BsL,GAAG;AAC/B;AACA;AACA,OAAO,CAAC;MACF,OAAOY,QAAQ,CAAC,CAAC;IACnB;IACA,MAAMzF,OAAO,GAAGD,KAAK,CAACC,OAAO,CAACvC,IAAI,CAACoH,GAAG,CAAC,CAAC;IACxC,MAAMgB,YAAY,GAAG7F,OAAO,IAAIvC,IAAI,CAACoH,GAAG,CAAC,CAACiB,SAAS,CAAEhB,GAAG,IAAK,CAACvB,OAAO,CAACvG,QAAQ,CAAC8H,GAAG,CAAC,CAAC;IACpF,MAAMiB,YAAY,GAAG/F,OAAO,IAAI6F,YAAY,KAAK,CAAC,CAAC;IACnD,IAAIpI,IAAI,CAACoH,GAAG,CAAC,KAAK,KAAK,CAAC,IAAItB,OAAO,CAACvG,QAAQ,CAACS,IAAI,CAACoH,GAAG,CAAC,CAAC,IAAIkB,YAAY,EAAE;MACvE,OAAON,QAAQ,CAAC,CAAC;IACnB;IACA,MAAMO,KAAK,GAAGhG,OAAO,GAAG,GAAG6E,GAAG,IAAIgB,YAAY,GAAG,GAAGhB,GAAG;IACvD,MAAMoB,gBAAgB,GAAG1C,OAAO,CAACvE,GAAG,CAAE4G,GAAG,IAAK,OAAOA,GAAG,KAAK,QAAQ,GAAG,IAAIA,GAAG,GAAG,GAAGvB,MAAM,CAACuB,GAAG,CAAC,CAAC,CAACM,IAAI,CAAC,IAAI,CAAC;IAC5GnC,IAAI,CAAC9D,IAAI,CAAC,+BAA+B+F,KAAK,yBAAyBC,gBAAgB,EAAE,CAAC;IAC1F,OAAOxB,GAAG;EACZ,CAAC,EAAE,CAAC,CAAC,CAAC;AACR,CAAC,EAAE,iBAAiB,CAAC;AACrB,IAAI0B,YAAY,GAAGlC,MAAM,CAAC,cAAc,CAAC;AACzC,IAAImC,QAAQ,GAAG,eAAgB5M,MAAM,CAAC,CAAC+K,KAAK,EAAEpD,MAAM,KAAK;EACvD,IAAI,OAAOoD,KAAK,KAAK,OAAOpD,MAAM,EAAE;IAClC,OAAOA,MAAM;EACf;EACA,IAAInI,OAAO,CAACuL,KAAK,EAAEpD,MAAM,CAAC,EAAE;IAC1B,OAAOgF,YAAY;EACrB;EACA,IAAIpG,KAAK,CAACC,OAAO,CAACuE,KAAK,CAAC,IAAIxE,KAAK,CAACC,OAAO,CAACmB,MAAM,CAAC,EAAE;IACjD,MAAMzG,GAAG,GAAGyG,MAAM,CAACqD,MAAM,CAAC,CAACC,GAAG,EAAEW,GAAG,EAAET,KAAK,KAAK;MAC7C,MAAM0B,IAAI,GAAGD,QAAQ,CAAC7B,KAAK,CAACI,KAAK,CAAC,EAAES,GAAG,CAAC;MACxC,IAAIiB,IAAI,KAAKF,YAAY,EAAE;QACzB1B,GAAG,CAACE,KAAK,CAAC,GAAG0B,IAAI;MACnB;MACA,OAAO5B,GAAG;IACZ,CAAC,EAAE,IAAI1E,KAAK,CAACoB,MAAM,CAAC7B,MAAM,CAAC,CAAC;IAC5B,IAAI6B,MAAM,CAAC7B,MAAM,IAAIiF,KAAK,CAACjF,MAAM,EAAE;MACjC,OAAO5E,GAAG;IACZ;IACA,OAAOA,GAAG,CAAC4L,MAAM,CAAC,IAAIvG,KAAK,CAACwE,KAAK,CAACjF,MAAM,GAAG6B,MAAM,CAAC7B,MAAM,CAAC,CAACiH,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;EACzE;EACA,IAAIlN,aAAa,CAACkL,KAAK,CAAC,IAAIlL,aAAa,CAAC8H,MAAM,CAAC,EAAE;IACjD,OAAOY,MAAM,CAACI,IAAI,CAAC;MAAE,GAAGoC,KAAK;MAAE,GAAGpD;IAAO,CAAC,CAAC,CAACqD,MAAM,CAAC,CAACC,GAAG,EAAEI,GAAG,KAAK;MAC/D,MAAMwB,IAAI,GAAGD,QAAQ,CAAC7B,KAAK,GAAGM,GAAG,CAAC,EAAE1D,MAAM,GAAG0D,GAAG,CAAC,CAAC;MAClD,OAAOwB,IAAI,KAAKF,YAAY,GAAG1B,GAAG,GAAG1C,MAAM,CAACgD,MAAM,CAACN,GAAG,EAAE;QAAE,CAACI,GAAG,GAAGwB;MAAK,CAAC,CAAC;IAC1E,CAAC,EAAE,CAAC,CAAC,CAAC;EACR;EACA,OAAOlF,MAAM;AACf,CAAC,EAAE,UAAU,CAAC;AACd,IAAIqF,UAAU,GAAG,YAAY;AAC7B,SAASC,iBAAiBA,CAAC;EACzBhJ,IAAI;EACJyH;AACF,CAAC,EAAE;EACD,MAAMwB,WAAW,GAAG,CAAC,CAAC;EACtB3E,MAAM,CAACC,OAAO,CAACvE,IAAI,CAAC,CAACd,OAAO,CAAC,CAAC,CAACoB,IAAI,EAAEwG,KAAK,CAAC,KAAK;IAC9C,MAAM;MAAEoC,MAAM,GAAGH;IAAW,CAAC,GAAGtB,QAAQ,CAACnH,IAAI,CAAC,IAAI,CAAC,CAAC;IACpD2I,WAAW,CAACC,MAAM,CAAC,GAAGD,WAAW,CAACC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC/CD,WAAW,CAACC,MAAM,CAAC,CAAC5I,IAAI,CAAC,GAAGwG,KAAK;EACnC,CAAC,CAAC;EACF,OAAOmC,WAAW;AACpB;AACAlN,MAAM,CAACiN,iBAAiB,EAAE,mBAAmB,CAAC;;AAE9C;AACA,SAASG,eAAeA,CAACC,GAAG,EAAE;EAC5B9E,MAAM,CAACI,IAAI,CAAC0E,GAAG,CAAC,CAAClK,OAAO,CAAEkI,GAAG,IAAKgC,GAAG,CAAChC,GAAG,CAAC,KAAK,KAAK,CAAC,IAAI,OAAOgC,GAAG,CAAChC,GAAG,CAAC,CAAC;EACzE,OAAOgC,GAAG;AACZ;AACArN,MAAM,CAACoN,eAAe,EAAE,iBAAiB,CAAC;AAC1C,IAAIE,UAAU,GAAG,MAAMA,UAAU,CAAC;EAChC7M,WAAWA,CAAA,EAAG;IACZ,IAAI,CAAC8M,oBAAoB,GAAG,CAAC,CAAC;IAC9B,IAAI,CAACC,aAAa,GAAG,CAAC,CAAC;EACzB;EACA/I,GAAGA,CAAC9B,OAAO,EAAE;IACX,IAAI,EAAEA,OAAO,IAAI,IAAI,CAAC6K,aAAa,CAAC,EAAE;MACpC,MAAM,IAAIzI,KAAK,CAAC,qBAAqBpC,OAAO,+BAA+B,CAAC;IAC9E;IACA,OAAO,IAAI,CAAC6K,aAAa,CAAC7K,OAAO,CAAC;EACpC;EACA8K,UAAUA,CAACC,KAAK,EAAE;IAChB,IAAI,CAAC,IAAI,CAACH,oBAAoB,CAACG,KAAK,CAAC9K,EAAE,CAAC,EAAE;MACxC,IAAI,CAAC2K,oBAAoB,CAACG,KAAK,CAAC9K,EAAE,CAAC,GAAG8K,KAAK,CAACC,WAAW;MACvD,IAAI,CAACH,aAAa,CAACE,KAAK,CAAC9K,EAAE,CAAC,GAAG8K,KAAK,CAACC,WAAW;IAClD,CAAC,MAAM,IAAI,IAAI,CAACJ,oBAAoB,CAACG,KAAK,CAAC9K,EAAE,CAAC,KAAK8K,KAAK,CAACC,WAAW,EAAE;MACpE,MAAMC,KAAK,GAAGhB,QAAQ,CAAC,IAAI,CAACW,oBAAoB,CAACG,KAAK,CAAC9K,EAAE,CAAC,EAAE,IAAI,CAAC4K,aAAa,CAACE,KAAK,CAAC9K,EAAE,CAAC,CAAC;MACzF,IAAI,CAAC2K,oBAAoB,CAACG,KAAK,CAAC9K,EAAE,CAAC,GAAG8K,KAAK,CAACC,WAAW;MACvD,IAAI,CAACH,aAAa,CAACE,KAAK,CAAC9K,EAAE,CAAC,GAAG8K,KAAK,CAACC,WAAW;MAChD,IAAIC,KAAK,KAAKjB,YAAY,EAAE;QAC1B,IAAI,CAACkB,eAAe,CAACH,KAAK,EAAEE,KAAK,CAAC;MACpC;IACF;EACF;EACAC,eAAeA,CAACH,KAAK,EAAEE,KAAK,EAAE;IAC5B,MAAME,cAAc,GAAG9B,eAAe,CAAC4B,KAAK,EAAEF,KAAK,CAAChC,QAAQ,CAAC;IAC7D,IAAI,CAAC8B,aAAa,CAACE,KAAK,CAAC9K,EAAE,CAAC,GAAG+I,WAAW,CAAC,IAAI,CAAC6B,aAAa,CAACE,KAAK,CAAC9K,EAAE,CAAC,EAAEkL,cAAc,CAAC;EAC1F;EACAC,mBAAmBA,CAACL,KAAK,EAAEM,SAAS,EAAE;IACpC,MAAMC,eAAe,GAAGxC,cAAc,CAACuC,SAAS,EAAEN,KAAK,CAAChC,QAAQ,CAAC;IACjE,OAAO,IAAI,CAACmC,eAAe,CAACH,KAAK,EAAEO,eAAe,CAAC;EACrD;EACAtG,MAAMA,CAAChF,OAAO,EAAEuL,UAAU,EAAE;IAC1B,IAAI,EAAEvL,OAAO,IAAI,IAAI,CAAC6K,aAAa,CAAC,EAAE;MACpC,MAAM,IAAIzI,KAAK,CAAC,qBAAqBpC,OAAO,+BAA+B,CAAC;IAC9E;IACA,IAAI,CAAC6K,aAAa,CAAC7K,OAAO,CAAC,GAAGyK,eAAe,CAAC;MAC5C,GAAG,IAAI,CAACI,aAAa,CAAC7K,OAAO,CAAC;MAC9B,GAAGuL;IACL,CAAC,CAAC;EACJ;AACF,CAAC;AACDlO,MAAM,CAACsN,UAAU,EAAE,WAAW,CAAC;AAC/B,IAAIa,SAAS,GAAGb,UAAU;;AAE1B;AACA,SAAS/L,MAAM,IAAI6M,OAAO,QAAQ,kCAAkC;;AAEpE;AACA,IAAIC,qBAAqB,GAAG,eAAgBrO,MAAM,CAAC,CAAC0L,QAAQ,GAAG,CAAC,CAAC,KAAKnD,MAAM,CAACC,OAAO,CAACkD,QAAQ,CAAC,CAACV,MAAM,CAAC,CAACC,GAAG,EAAE,CAACP,GAAG,EAAE;EAAE1B;AAAa,CAAC,CAAC,KAAK;EACtI,IAAI,OAAOA,YAAY,KAAK,WAAW,EAAE;IACvCiC,GAAG,CAACP,GAAG,CAAC,GAAG1B,YAAY;EACzB;EACA,OAAOiC,GAAG;AACZ,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,uBAAuB,CAAC;;AAEhC;AACA,IAAIqD,aAAa,GAAG,MAAMA,aAAa,CAAC;EACtC7N,WAAWA,CAAC;IACV+I,OAAO,GAAG,CAAC,CAAC;IACZ+E,WAAW,GAAG,CAAC;EACjB,CAAC,EAAE;IACD,IAAI,CAAC7J,GAAG,CAAC;MAAE8E,OAAO;MAAE+E;IAAY,CAAC,CAAC;EACpC;EACA7J,GAAGA,CAAC;IAAE8E,OAAO,GAAG,CAAC,CAAC;IAAE+E,WAAW,GAAG,CAAC;EAAE,CAAC,EAAE;IACtC,MAAMX,KAAK,GAAG,IAAI,CAACY,cAAc,IAAI5B,QAAQ,CAAC,IAAI,CAAC4B,cAAc,EAAE,IAAI,CAAChF,OAAO,CAAC;IAChF,IAAI,CAACiF,kBAAkB,GAAG,eAAgB,IAAIxL,GAAG,CAAC,CAAC,GAAGsF,MAAM,CAACI,IAAI,CAACa,OAAO,CAAC,EAAE,GAAGjB,MAAM,CAACI,IAAI,CAAC4F,WAAW,CAAC,CAAC,CAAC;IACzG,MAAMG,cAAc,GAAGL,qBAAqB,CAACE,WAAW,CAAC;IACzD,IAAI,CAACC,cAAc,GAAG;MAAE,GAAGE,cAAc;MAAE,GAAGlF;IAAQ,CAAC;IACvD,IAAI,CAACA,OAAO,GAAG,IAAI,CAACgF,cAAc;IAClC,IAAIZ,KAAK,IAAIA,KAAK,KAAKjB,YAAY,EAAE;MACnC,IAAI,CAACoB,mBAAmB,CAACH,KAAK,CAAC;IACjC;EACF;EACAe,oBAAoBA,CAACnF,OAAO,EAAE;IAC5B,OAAOjB,MAAM,CAACC,OAAO,CAACgB,OAAO,CAAC,CAACwB,MAAM,CAAC,CAACC,GAAG,EAAE,CAACI,GAAG,EAAEN,KAAK,CAAC,KAAK;MAC3D,IAAI,IAAI,CAAC0D,kBAAkB,CAACjK,GAAG,CAAC6G,GAAG,CAAC,EAAE;QACpCJ,GAAG,CAACI,GAAG,CAAC,GAAGN,KAAK;MAClB,CAAC,MAAM;QACLqD,OAAO,CAAC3H,IAAI,CACV,8BAA8B4E,GAAG,yDACnC,CAAC;MACH;MACA,OAAOJ,GAAG;IACZ,CAAC,EAAE,CAAC,CAAC,CAAC;EACR;EACA8C,mBAAmBA,CAACC,SAAS,EAAE;IAC7B,MAAMY,iBAAiB,GAAG,IAAI,CAACD,oBAAoB,CAACX,SAAS,CAAC;IAC9D,IAAI,CAACxE,OAAO,GAAG;MAAE,GAAG,IAAI,CAACA,OAAO;MAAE,GAAGoF;IAAkB,CAAC;EAC1D;EACAnK,GAAGA,CAAA,EAAG;IACJ,OAAO,IAAI,CAAC+E,OAAO;EACrB;EACA7B,MAAMA,CAAC+B,UAAU,EAAE;IACjB,IAAI,CAACF,OAAO,GAAG;MAAE,GAAG,IAAI,CAACA,OAAO;MAAE,GAAG,IAAI,CAACmF,oBAAoB,CAACjF,UAAU;IAAE,CAAC;IAC5E,KAAK,MAAM2B,GAAG,IAAI3B,UAAU,EAAE;MAC5B,IAAIA,UAAU,CAAC2B,GAAG,CAAC,KAAK,KAAK,CAAC,EAAE;QAC9B,IAAI,CAAC7B,OAAO,CAAC6B,GAAG,CAAC,GAAG,IAAI,CAACmD,cAAc,CAACnD,GAAG,CAAC;MAC9C;IACF;EACF;AACF,CAAC;AACDrL,MAAM,CAACsO,aAAa,EAAE,cAAc,CAAC;AACrC,IAAIO,YAAY,GAAGP,aAAa;;AAEhC;AACA,IAAIQ,mBAAmB,GAAG7O,OAAO,CAACH,oBAAoB,CAAC,CAAC,EAAE,CAAC,CAAC;AAC5D,SAASiP,yBAAyB,QAAQ,mCAAmC;AAC7E,IAAIC,gBAAgB,GAAG,CAAC,CAAC,EAAEF,mBAAmB,CAACG,OAAO,EAAE,CAAC,CAAC,CACvDzG,OAAO,IAAKD,MAAM,CAAC2G,MAAM,CAAC1G,OAAO,CAAC,CAACwC,MAAM,CACxC,CAACC,GAAG,EAAEkE,KAAK,KAAK;EACdlE,GAAG,CAACkE,KAAK,CAACC,UAAU,CAAC,GAAGnE,GAAG,CAACkE,KAAK,CAACC,UAAU,CAAC,IAAID,KAAK;EACtD,OAAOlE,GAAG;AACZ,CAAC,EACD,CAAC,CACH,CACF,CAAC;AACD,IAAIoE,gBAAgB,GAAG,MAAMA,gBAAgB,CAAC;EAC5C5O,WAAWA,CAAC;IAAE+H;EAAQ,CAAC,GAAG;IAAEsD,CAAC,EAAE,CAAC;IAAEtD,OAAO,EAAE,CAAC;EAAE,CAAC,EAAE;IAC/C,IAAI,CAACA,OAAO,GAAGA,OAAO;EACxB;EACA8G,kBAAkBA,CAACC,SAAS,EAAE;IAC5B,MAAM/G,OAAO,GAAGD,MAAM,CAAC2G,MAAM,CAAC,IAAI,CAAC1G,OAAO,CAAC;IAC3C,IAAI+G,SAAS,KAAK,GAAG,EAAE;MACrB,OAAO/G,OAAO,CAAC,CAAC,CAAC;IACnB;IACA,IAAI,OAAO+G,SAAS,KAAK,QAAQ,EAAE;MACjC,IAAI,IAAI,CAAC/G,OAAO,CAAC+G,SAAS,CAAC,EAAE;QAC3B,OAAO,IAAI,CAAC/G,OAAO,CAAC+G,SAAS,CAAC;MAChC;MACA,OAAO/G,OAAO,CAACgH,IAAI,CAAEL,KAAK,IAAKA,KAAK,CAACvM,EAAE,CAAC6M,UAAU,CAACF,SAAS,CAAC,CAAC;IAChE;IACA,MAAM;MAAEhL,IAAI;MAAEmL;IAAM,CAAC,GAAGH,SAAS;IACjC,OAAO/G,OAAO,CAACgH,IAAI,CAAEL,KAAK,IAAKA,KAAK,CAAC5K,IAAI,KAAKA,IAAI,IAAI4K,KAAK,CAACO,KAAK,KAAKA,KAAK,CAAC;EAC9E;EACAC,cAAcA,CAAChN,OAAO,EAAE;IACtB,MAAMiN,UAAU,GAAG,IAAI,CAACpH,OAAO,CAAC7F,OAAO,CAAC;IACxC,IAAI,CAACiN,UAAU,EAAE;MACf,MAAM,IAAIb,yBAAyB,CAAC;QAAEpM;MAAQ,CAAC,CAAC;IAClD;IACA,OAAOiN,UAAU;EACnB;EACAC,iBAAiBA,CAACT,UAAU,EAAE;IAC5B,OAAOJ,gBAAgB,CAAC,IAAI,CAACxG,OAAO,CAAC,CAAC4G,UAAU,CAAC;EACnD;AACF,CAAC;AACDpP,MAAM,CAACqP,gBAAgB,EAAE,iBAAiB,CAAC;AAC3C,IAAIS,eAAe,GAAGT,gBAAgB;;AAEtC;AACA,IAAIU,aAAa,GAAG,eAAgB/P,MAAM,CAAEyI,IAAI,IAAK;EACnD,OAAO,OAAOA,IAAI,KAAK,QAAQ,GAAG;IAAElE,IAAI,EAAEkE;EAAK,CAAC,GAAGA,IAAI;AACzD,CAAC,EAAE,eAAe,CAAC;AACnB,IAAIuH,gBAAgB,GAAG,eAAgBhQ,MAAM,CAAEiQ,OAAO,IAAK,OAAOA,OAAO,KAAK,QAAQ,GAAG;EAAExH,IAAI,EAAEwH;AAAQ,CAAC,GAAGA,OAAO,EAAE,kBAAkB,CAAC;AACzI,IAAIC,kBAAkB,GAAG,eAAgBlQ,MAAM,CAAC,CAACmQ,SAAS,EAAE9E,GAAG,KAAK;EAClE,MAAM;IAAE5C,IAAI;IAAEwH,OAAO;IAAE,GAAGG;EAAK,CAAC,GAAGD,SAAS;EAC5C,MAAME,UAAU,GAAG;IACjB9L,IAAI,EAAE8G,GAAG;IACT,GAAG+E;EACL,CAAC;EACD,IAAI3H,IAAI,EAAE;IACR4H,UAAU,CAAC5H,IAAI,GAAGsH,aAAa,CAACtH,IAAI,CAAC;EACvC;EACA,IAAIwH,OAAO,EAAE;IACXI,UAAU,CAACJ,OAAO,GAAGD,gBAAgB,CAACC,OAAO,CAAC;EAChD,CAAC,MAAM,IAAIA,OAAO,KAAK,KAAK,EAAE;IAC5BI,UAAU,CAACJ,OAAO,GAAG;MAAEjG,OAAO,EAAE;IAAK,CAAC;EACxC;EACA,OAAOqG,UAAU;AACnB,CAAC,EAAE,oBAAoB,CAAC;AACxB,IAAIC,mBAAmB,GAAG,eAAgBtQ,MAAM,CAAEuQ,UAAU,IAAK5Q,SAAS,CAAC4Q,UAAU,EAAEL,kBAAkB,CAAC,EAAE,qBAAqB,CAAC;;AAElI;AACA,SAASM,SAAS,EAAEjP,MAAM,IAAIkP,OAAO,QAAQ,kCAAkC;AAC/E,SAASC,mBAAmB,EAAEC,IAAI,QAAQ,wBAAwB;;AAElE;AACA,IAAIC,eAAe,GAAG,eAAgB5Q,MAAM,CAAE6Q,KAAK,IAAK;EACtD,IAAItK,KAAK,CAACC,OAAO,CAACqK,KAAK,CAAC,EAAE;IACxB,OAAOA,KAAK;EACd;EACA,OAAOA,KAAK,GAAG,CAACA,KAAK,CAAC,GAAG,EAAE;AAC7B,CAAC,EAAE,iBAAiB,CAAC;;AAErB;AACA,IAAIC,yBAAyB,GAAG/Q,MAAM;AACtC;AACA;AACA;AACA;AACA,CAAC;AACD,SAASgR,cAAcA,CAAC1F,GAAG,EAAE2F,gBAAgB,EAAEC,IAAI,EAAE;EACnD,MAAMC,WAAW,GAAGF,gBAAgB;EACpC,MAAMG,WAAW,GAAG,OAAOH,gBAAgB,KAAK,UAAU,GAAGA,gBAAgB,GAAG,IAAI;EACpF,MAAM;IAAEtD;EAAM,CAAC,GAAGwD,WAAW;EAC7B,IAAIxD,KAAK,EAAE;IACT+C,OAAO,CAACW,KAAK,CAAC,kBAAkB,EAAE1D,KAAK,CAAC;IACxC8C,SAAS,CAACM,yBAAyB,CAAC;EACtC;EACA,MAAMO,UAAU,GAAGX,mBAAmB,CAACrF,GAAG,CAAC;EAC3C,MAAM9G,IAAI,GAAG,OAAO2M,WAAW,KAAK,UAAU,IAAIA,WAAW,CAAC3M,IAAI,IAAI2M,WAAW,CAACI,SAAS,IAAI5D,KAAK,EAAEnJ,IAAI,IAAI8M,UAAU;EACxH,MAAM/L,UAAU,GAAG,CACjB,GAAGsL,eAAe,CAACM,WAAW,CAAC5L,UAAU,CAAC,EAC1C,GAAGsL,eAAe,CAAClD,KAAK,EAAEpI,UAAU,CAAC,CACtC;EACD,MAAM2D,UAAU,GAAG;IAAE,GAAGyE,KAAK,EAAEzE,UAAU;IAAE,GAAGiI,WAAW,CAACjI;EAAW,CAAC;EACtE,MAAMhF,IAAI,GAAG;IAAE,GAAGyJ,KAAK,EAAEzJ,IAAI;IAAE,GAAGiN,WAAW,CAACjN;EAAK,CAAC;EACpD,MAAMyH,QAAQ,GAAG;IAAE,GAAGgC,KAAK,EAAEhC,QAAQ;IAAE,GAAGwF,WAAW,CAACxF;EAAS,CAAC;EAChE,MAAM6F,OAAO,GAAG,CAAC,GAAGX,eAAe,CAACM,WAAW,CAACK,OAAO,CAAC,EAAE,GAAGX,eAAe,CAAClD,KAAK,EAAE6D,OAAO,CAAC,CAAC;EAC7F,MAAMC,UAAU,GAAG,CACjB,GAAGZ,eAAe,CAACM,WAAW,CAACM,UAAU,CAAC,EAC1C,GAAGZ,eAAe,CAAClD,KAAK,EAAE8D,UAAU,CAAC,CACtC;EACD,MAAMC,SAAS,GAAG,CAChB,GAAGb,eAAe,CAACM,WAAW,CAACO,SAAS,CAAC,EACzC,GAAGb,eAAe,CAAClD,KAAK,EAAE+D,SAAS,CAAC,CACrC;EACD,MAAM;IAAEC,MAAM;IAAEC,IAAI;IAAEC,IAAI,GAAG,EAAE;IAAEpI,OAAO,GAAG,CAAC;EAAE,CAAC,GAAG0H,WAAW;EAC7D,MAAMtO,EAAE,GAAGqG,UAAU,CAAC4I,IAAI,IAAIlB,IAAI,CAACM,IAAI,CAACrO,EAAE,EAAEyO,UAAU,CAAC;EACvD,OAAO;IACLS,YAAY,EAAEd,gBAAgB;IAC9BpO,EAAE;IACF2B,IAAI;IACJqN,IAAI;IACJtM,UAAU;IACV2D,UAAU;IACVhF,IAAI;IACJyH,QAAQ,EAAE4E,mBAAmB,CAAC5E,QAAQ,CAAC;IACvC6F,OAAO;IACPC,UAAU;IACVC,SAAS;IACTjI,OAAO;IACP,IAAGkI,MAAM,IAAI;MAAEA;IAAO,CAAC;IACvB,IAAGP,WAAW,IAAI;MAAEA;IAAY,CAAC;IACjC,IAAGQ,IAAI,IAAI;MAAEA;IAAK,CAAC;EACrB,CAAC;AACH;AACA3R,MAAM,CAAC+Q,cAAc,EAAE,gBAAgB,CAAC;;AAExC;AACA,SAASxP,MAAM,IAAIwQ,OAAO,QAAQ,kCAAkC;AACpE,SAASC,gBAAgB,EAAEC,aAAa,EAAEC,OAAO,EAAEC,QAAQ,QAAQ,wBAAwB;;AAE3F;AACA,SAASC,QAAQ,QAAQ,wBAAwB;AACjD,SAASC,6BAA6BA,CAACC,aAAa,EAAE5C,KAAK,GAAG4C,aAAa,CAAC5C,KAAK,EAAEN,UAAU,EAAE;EAC7F,MAAM;IAAExM,EAAE;IAAE8I;EAAS,CAAC,GAAG4G,aAAa;EACtC,OAAO;IACL1P,EAAE,EAAEwP,QAAQ,CAACxP,EAAE,IAAI8M,KAAK,CAAC;IACzB,GAAG4C,aAAa;IAChB5C,KAAK;IACL,IAAGhE,QAAQ,IAAI;MAAEA,QAAQ,EAAE4E,mBAAmB,CAAC5E,QAAQ;IAAE,CAAC;IAC1DzC,UAAU,EAAE;MACVsJ,QAAQ,EAAEnD,UAAU;MACpB,GAAGkD,aAAa,CAACrJ;IACnB;EACF,CAAC;AACH;AACAjJ,MAAM,CAACqS,6BAA6B,EAAE,+BAA+B,CAAC;;AAEtE;AACA,IAAIG,YAAY,GAAG,eAAgBxS,MAAM,CAAEiJ,UAAU,IAAK;EACxD,MAAM;IAAEO,OAAO;IAAE+E;EAAY,CAAC,GAAGtF,UAAU;EAC3C,IAAIO,OAAO,IAAI+E,WAAW,EAAE;IAC1BwD,OAAO,CAAC7F,KAAK,CACX,+CAA+C,EAC/CuG,IAAI,CAACC,SAAS,CAAC;MACblJ,OAAO;MACP+E;IACF,CAAC,CACH,CAAC;EACH;AACF,CAAC,EAAE,cAAc,CAAC;AAClB,IAAIoE,cAAc,GAAG,eAAgB3S,MAAM,CAAEiJ,UAAU,IAAK;EAC1D,MAAM;IAAEc;EAAQ,CAAC,GAAGd,UAAU;EAC9B,IAAIc,OAAO,EAAE6I,SAAS,EAAE;IACtBb,OAAO,CAAC7F,KAAK,CAAC,yDAAyD,CAAC;EAC1E;AACF,CAAC,EAAE,gBAAgB,CAAC;AACpB,IAAI2G,yBAAyB,GAAG,eAAgB7S,MAAM,CAAEiJ,UAAU,IAAK;EACrE,IAAI,CAACA,UAAU,EAAE;IACf;EACF;EACAuJ,YAAY,CAACvJ,UAAU,CAAC;EACxB0J,cAAc,CAAC1J,UAAU,CAAC;AAC5B,CAAC,EAAE,2BAA2B,CAAC;AAC/B,SAAS6J,cAAcA,CAACC,aAAa,EAAE3D,UAAU,EAAEM,KAAK,EAAE;EACxD,MAAM;IAAET,OAAO,EAAEqD,aAAa;IAAEU,mBAAmB;IAAE,GAAGC;EAAa,CAAC,GAAGF,aAAa;EACtF,MAAMG,UAAU,GAAG3K,MAAM,CAAC2G,MAAM,CAAC+D,YAAY,CAAC,CAAC,CAAC,CAAC;EACjD,IAAIf,OAAO,CAACgB,UAAU,CAAC,EAAE;IACvB,MAAMC,KAAK,GAAGd,6BAA6B,CAACa,UAAU,CAACjC,IAAI,CAACmC,KAAK,EAAE1D,KAAK,EAAEN,UAAU,CAAC;IACrFyD,yBAAyB,CAACM,KAAK,CAAClK,UAAU,CAAC;IAC3C,MAAMoK,QAAQ,GAAG;MAAEpC,IAAI,EAAEkC,KAAK;MAAEG,OAAO,EAAE,CAAC,CAAC;MAAEP;IAAc,CAAC;IAC5DxK,MAAM,CAACI,IAAI,CAACsK,YAAY,CAAC,CAAC9P,OAAO,CAAEkI,GAAG,IAAK;MACzC,IAAI4G,aAAa,CAAC5G,GAAG,EAAE8H,KAAK,CAAC,EAAE;QAC7B,MAAMzF,KAAK,GAAGuF,YAAY,CAAC5H,GAAG,CAAC;QAC/B,MAAMkI,SAAS,GAAGxC,cAAc,CAAC1F,GAAG,EAAEqC,KAAK,CAAC0F,KAAK,EAAED,KAAK,CAAC;QACzDN,yBAAyB,CAACU,SAAS,CAACtK,UAAU,CAAC;QAC/CoK,QAAQ,CAACC,OAAO,CAACC,SAAS,CAAC3Q,EAAE,CAAC,GAAG2Q,SAAS;QAC1CvB,gBAAgB,CAACtE,KAAK,CAAC,CAACvK,OAAO,CAAEqQ,KAAK,IAAK;UACzC,MAAMjP,IAAI,GAAGiP,KAAK,CAACJ,KAAK,CAAC7O,IAAI;UAC7B,MAAMkP,OAAO,GAAGtB,QAAQ,CAACoB,SAAS,CAAC3Q,EAAE,EAAE2B,IAAI,CAAC;UAC5CiP,KAAK,CAACJ,KAAK,CAACnK,UAAU,KAAK,CAAC,CAAC;UAC7BuK,KAAK,CAACJ,KAAK,CAACnK,UAAU,CAAC4I,IAAI,GAAG4B,OAAO;UACrCJ,QAAQ,CAACC,OAAO,CAACG,OAAO,CAAC,GAAG1C,cAAc,CAACxM,IAAI,EAAEiP,KAAK,CAACJ,KAAK,EAAED,KAAK,CAAC;QACtE,CAAC,CAAC;MACJ;IACF,CAAC,CAAC;IACFE,QAAQ,CAACK,kBAAkB,GAAGR,UAAU,CAACjC,IAAI,CAAC0C,OAAO,CAACC,QAAQ;IAC9D,OAAOP,QAAQ;EACjB;EACA,MAAMpC,IAAI,GAAGoB,6BAA6B,CACxCC,aAAa,EACb5C,KAAK,EACLN,UACF,CAAC;EACDyD,yBAAyB,CAAC5B,IAAI,CAAChI,UAAU,CAAC;EAC1C,MAAM4K,OAAO,GAAG;IAAE5C,IAAI;IAAEqC,OAAO,EAAE,CAAC,CAAC;IAAEP;EAAc,CAAC;EACpDxK,MAAM,CAACI,IAAI,CAACsK,YAAY,CAAC,CAAC9P,OAAO,CAAEkI,GAAG,IAAK;IACzC,IAAI4G,aAAa,CAAC5G,GAAG,EAAE4F,IAAI,CAAC,EAAE;MAC5B,MAAMsC,SAAS,GAAGxC,cAAc,CAAC1F,GAAG,EAAE4H,YAAY,CAAC5H,GAAG,CAAC,EAAE4F,IAAI,CAAC;MAC9D4B,yBAAyB,CAACU,SAAS,CAACtK,UAAU,CAAC;MAC/C4K,OAAO,CAACP,OAAO,CAACC,SAAS,CAAC3Q,EAAE,CAAC,GAAG2Q,SAAS;IAC3C;EACF,CAAC,CAAC;EACF,OAAOM,OAAO;AAChB;AACA7T,MAAM,CAAC8S,cAAc,EAAE,gBAAgB,CAAC;;AAExC;AACA,SAASgB,WAAW,EAAEC,qBAAqB,QAAQ,wBAAwB;AAC3E,SAASC,qBAAqB,QAAQ,mCAAmC;AACzE,SAAS9T,MAAM,IAAI+T,OAAO,QAAQ,mBAAmB;AACrD,SAAS/T,MAAM,IAAIgU,WAAW,QAAQ,mBAAmB;;AAEzD;AACA,SAASC,iBAAiBA,CAACC,YAAY,EAAE;EACvC,OAAOA,YAAY,IAAI,IAAI,IAAIC,YAAY,CAACD,YAAY,CAAC,CAAC5Q,QAAQ,CAAC,OAAO,CAAC;AAC7E;AACAxD,MAAM,CAACmU,iBAAiB,EAAE,mBAAmB,CAAC;AAC9C,SAASE,YAAYA,CAACtQ,EAAE,EAAE;EACxB,MAAMuQ,KAAK,GAAGvQ,EAAE,CAACwQ,QAAQ,CAAC,CAAC,CAACD,KAAK,CAAC,gBAAgB,CAAC;EACnD,IAAI,CAACA,KAAK,EAAE;IACV,OAAO,EAAE;EACX;EACA,MAAMrQ,IAAI,GAAGuQ,YAAY,CAACF,KAAK,CAAC,CAAC,CAAC,CAAC;EACnC,IAAI,CAACrQ,IAAI,CAAC6B,MAAM,EAAE;IAChB,OAAO,EAAE;EACX;EACA,MAAM2O,KAAK,GAAGxQ,IAAI,CAAC,CAAC,CAAC;EACrB,IAAI,EAAEwQ,KAAK,CAAChF,UAAU,CAAC,GAAG,CAAC,IAAIgF,KAAK,CAACC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE;IACnD,OAAO,EAAE;EACX;EACA,MAAMC,KAAK,GAAGH,YAAY,CAACC,KAAK,CAACG,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,CAACrP,GAAG,CAAEsP,IAAI,IAAK;IAC9E,OAAOA,IAAI,CAACD,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;EACrC,CAAC,CAAC;EACF,OAAOF,KAAK;AACd;AACA3U,MAAM,CAACqU,YAAY,EAAE,cAAc,CAAC;AACpC,SAASG,YAAYA,CAACO,CAAC,EAAE;EACvB,MAAMjQ,MAAM,GAAG,EAAE;EACjB,MAAMkQ,KAAK,GAAG,EAAE;EAChB,IAAIC,KAAK,GAAG,CAAC;EACb,KAAK,IAAIhP,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG8O,CAAC,CAACjP,MAAM,EAAEG,CAAC,EAAE,EAAE;IACjC,IAAI8O,CAAC,CAAC9O,CAAC,CAAC,KAAK,GAAG,IAAI8O,CAAC,CAAC9O,CAAC,CAAC,KAAK,GAAG,EAAE;MAChC+O,KAAK,CAACtO,IAAI,CAACqO,CAAC,CAAC9O,CAAC,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;IACtC,CAAC,MAAM,IAAI8O,CAAC,CAAC9O,CAAC,CAAC,KAAK+O,KAAK,CAACA,KAAK,CAAClP,MAAM,GAAG,CAAC,CAAC,EAAE;MAC3CkP,KAAK,CAACE,GAAG,CAAC,CAAC;IACb,CAAC,MAAM,IAAI,CAACF,KAAK,CAAClP,MAAM,IAAIiP,CAAC,CAAC9O,CAAC,CAAC,KAAK,GAAG,EAAE;MACxC,MAAMkP,KAAK,GAAGJ,CAAC,CAACK,SAAS,CAACH,KAAK,EAAEhP,CAAC,CAAC,CAACoP,IAAI,CAAC,CAAC;MAC1C,IAAIF,KAAK,EAAE;QACTrQ,MAAM,CAAC4B,IAAI,CAACyO,KAAK,CAAC;MACpB;MACAF,KAAK,GAAGhP,CAAC,GAAG,CAAC;IACf;EACF;EACA,MAAMqP,SAAS,GAAGP,CAAC,CAACK,SAAS,CAACH,KAAK,CAAC,CAACI,IAAI,CAAC,CAAC;EAC3C,IAAIC,SAAS,EAAE;IACbxQ,MAAM,CAAC4B,IAAI,CAAC4O,SAAS,CAAC;EACxB;EACA,OAAOxQ,MAAM;AACf;AACA9E,MAAM,CAACwU,YAAY,EAAE,cAAc,CAAC;;AAEpC;AACA,SAASe,aAAaA,CAAClQ,OAAO,EAAEI,SAAS,EAAE+P,eAAe,EAAE;EAC1D,MAAMC,kBAAkB,GAAGD,eAAe,CAACnQ,OAAO,CAAC;EACnD,OAAQK,OAAO,IAAKD,SAAS,CAACgQ,kBAAkB,EAAE/P,OAAO,CAAC;AAC5D;AACA1F,MAAM,CAACuV,aAAa,EAAE,eAAe,CAAC;AACtC,SAASG,0BAA0BA,CAAC;EAClCC,WAAW;EACXjG,KAAK;EACLkG,IAAI;EACJhT,EAAE;EACF2B,IAAI;EACJmJ,KAAK;EACLzE,UAAU;EACV0E,WAAW;EACXjC,QAAQ;EACR,GAAG/D;AACL,CAAC,GAAG,CAAC,CAAC,EAAE;EACN,OAAOA,MAAM;AACf;AACA3H,MAAM,CAAC0V,0BAA0B,EAAE,4BAA4B,CAAC;AAChE,SAASG,oBAAoBA,CAACxQ,OAAO,EAAEC,UAAU,EAAE;EACjD,MAAMwQ,YAAY,GAAG,CAAC,CAAC;EACvB,MAAMN,eAAe,GAAG,eAAgBxV,MAAM,CAAE+V,gBAAgB,IAAMpO,MAAM,IAAK;IAC/E,IAAI,CAACmO,YAAY,CAAC/K,KAAK,EAAE;MACvB,MAAM,IAAIhG,KAAK,CAAC,wCAAwC,CAAC;IAC3D;IACA+Q,YAAY,CAAC/K,KAAK,GAAG;MACnB,GAAG+K,YAAY,CAAC/K,KAAK;MACrB,GAAG2K,0BAA0B,CAAC/N,MAAM;IACtC,CAAC;IACD,OAAOoO,gBAAgB,CAACD,YAAY,CAAC/K,KAAK,CAAC;EAC7C,CAAC,EAAE,iBAAiB,CAAC;EACrB,MAAMiL,yBAAyB,GAAG1Q,UAAU,CAAC0F,MAAM,CACjD,CAAC0C,KAAK,EAAEjI,SAAS,KAAK8P,aAAa,CAAC7H,KAAK,EAAEjI,SAAS,EAAE+P,eAAe,CAAC,EACtEnQ,OACF,CAAC;EACD,OAAQK,OAAO,IAAK;IAClBoQ,YAAY,CAAC/K,KAAK,GAAGrF,OAAO;IAC5B,OAAOsQ,yBAAyB,CAACtQ,OAAO,CAAC;EAC3C,CAAC;AACH;AACA1F,MAAM,CAAC6V,oBAAoB,EAAE,sBAAsB,CAAC;;AAEpD;AACA,SAASI,YAAYA,CAACjF,gBAAgB,EAAEkF,oBAAoB,EAAExC,kBAAkB,EAAE;EAChF,MAAM;IAAE5B,YAAY;IAAElP,EAAE;IAAE2B;EAAK,CAAC,GAAGyM,gBAAgB,IAAI,CAAC,CAAC;EACzD,MAAMmF,kBAAkB,GAAGC,yBAAyB,CAClDpF,gBAAgB,EAChBkF,oBAAoB,EACpBxC,kBACF,CAAC;EACD,MAAM2C,YAAY,GAAG,eAAgBrW,MAAM;IAAA,IAAAsW,IAAA,GAAAC,iBAAA,CAAC,WAAO7Q,OAAO,EAAK;MAC7D,MAAM8Q,MAAM,GAAG,CAAC,CAAC;MACjB,KAAK,MAAMjF,OAAO,IAAI,CACpBX,eAAe,CAAC8C,kBAAkB,CAACnC,OAAO,CAAC,EAC3CX,eAAe,CAACsF,oBAAoB,CAAC3E,OAAO,CAAC,EAC7CX,eAAe,CAACI,gBAAgB,CAACO,OAAO,CAAC,CAC1C,EAAE;QACD,IAAI7L,OAAO,CAAC+Q,WAAW,CAACC,OAAO,EAAE;UAC/B,OAAOF,MAAM;QACf;QACA,MAAMG,WAAW,SAAS1V,OAAO,CAAC2V,GAAG,CAACrF,OAAO,CAAC/L,GAAG,CAAEqR,MAAM,IAAKA,MAAM,CAACnR,OAAO,CAAC,CAAC,CAAC;QAC/E6C,MAAM,CAACgD,MAAM,CAACiL,MAAM,EAAE,GAAGG,WAAW,CAAC;MACvC;MACA,OAAOH,MAAM;IACf,CAAC;IAAA,iBAAAM,EAAA;MAAA,OAAAR,IAAA,CAAAS,KAAA,OAAAC,SAAA;IAAA;EAAA,KAAE,cAAc,CAAC;EAClB,MAAMC,eAAe,GAAG,eAAgBjX,MAAM;IAAA,IAAAkX,KAAA,GAAAX,iBAAA,CAAC,WAAO7Q,OAAO,EAAK;MAChE,MAAMyR,gBAAgB,GAAG,IAAI5Q,KAAK,CAAC,CAAC;MACpC,KAAK,MAAMiL,UAAU,IAAI,CACvB,GAAGZ,eAAe,CAAC8C,kBAAkB,CAAClC,UAAU,CAAC,EACjD,GAAGZ,eAAe,CAACsF,oBAAoB,CAAC1E,UAAU,CAAC,EACnD,GAAGZ,eAAe,CAACI,gBAAgB,CAACQ,UAAU,CAAC,CAChD,EAAE;QACD,IAAI9L,OAAO,CAAC+Q,WAAW,CAACC,OAAO,EAAE;UAC/B,OAAOS,gBAAgB;QACzB;QACA,MAAMC,OAAO,SAAS5F,UAAU,CAAC9L,OAAO,CAAC;QACzC,IAAI0R,OAAO,EAAE;UACXD,gBAAgB,CAACzQ,IAAI,CAAC0Q,OAAO,CAAC;QAChC;MACF;MACA,OAAOD,gBAAgB;IACzB,CAAC;IAAA,iBAAAE,GAAA;MAAA,OAAAH,KAAA,CAAAH,KAAA,OAAAC,SAAA;IAAA;EAAA,KAAE,iBAAiB,CAAC;EACrB,MAAMM,cAAc,GAAG,eAAgBtX,MAAM;IAAA,IAAAuX,KAAA,GAAAhB,iBAAA,CAAC,WAAO7Q,OAAO,EAAK;MAC/D,MAAM8R,kBAAkB,GAAG,CACzB,GAAG5G,eAAe,CAAC8C,kBAAkB,CAACjC,SAAS,CAAC,EAChD,GAAGb,eAAe,CAACsF,oBAAoB,CAACzE,SAAS,CAAC,EAClD,GAAGb,eAAe,CAACI,gBAAgB,CAACS,SAAS,CAAC,CAC/C,CAACgG,OAAO,CAAC,CAAC;MACX,KAAK,MAAMC,SAAS,IAAIF,kBAAkB,EAAE;QAC1C,IAAI9R,OAAO,CAAC+Q,WAAW,CAACC,OAAO,EAAE;UAC/B;QACF;QACA,MAAMgB,SAAS,CAAChS,OAAO,CAAC;MAC1B;IACF,CAAC;IAAA,iBAAAiS,GAAA;MAAA,OAAAJ,KAAA,CAAAR,KAAA,OAAAC,SAAA;IAAA;EAAA,KAAE,gBAAgB,CAAC;EACpB,MAAMY,kBAAkB,GAAG,eAAgB5X,MAAM,CAAE0F,OAAO,IAAKA,OAAO,CAACmS,eAAe,CAACnS,OAAO,CAACzB,IAAI,EAAEyB,OAAO,CAAC,EAAE,oBAAoB,CAAC;EACpI,MAAM;IAAEN,eAAe,GAAGyQ,oBAAoB;IAAEiC;EAAQ,CAAC,GAAGpE,kBAAkB;EAC9E,MAAMpO,UAAU,GAAG,CACjB,GAAGsL,eAAe,CAACI,gBAAgB,EAAE1L,UAAU,CAAC,EAChD,GAAGsL,eAAe,CAACsF,oBAAoB,EAAE5Q,UAAU,CAAC,EACpD,GAAGsL,eAAe,CAAC8C,kBAAkB,EAAEpO,UAAU,CAAC,CACnD;EACD,MAAMoM,MAAM,GAAGV,gBAAgB,EAAEG,WAAW,IAAIH,gBAAgB,EAAEU,MAAM,IAAIwE,oBAAoB,CAACxE,MAAM,IAAIgC,kBAAkB,CAAChC,MAAM;EACpI,MAAMqE,gBAAgB,GAAG5Q,UAAU,CAACC,eAAe,CAAC,CAACwS,kBAAkB,EAAEtS,UAAU,CAAC;EACpF,MAAMyS,cAAc,GAAG,eAAgB/X,MAAM,CAAE0F,OAAO,IAAKqQ,gBAAgB,CAACrQ,OAAO,CAAC,EAAE,gBAAgB,CAAC;EACvG,MAAM0O,YAAY,GAAGpD,gBAAgB,EAAEW,IAAI,IAAIuE,oBAAoB,EAAEvE,IAAI;EACzE,MAAMqG,SAAS,GAAG7D,iBAAiB,CAACC,YAAY,CAAC;EACjD,IAAI,CAAC1C,MAAM,IAAI,CAACsG,SAAS,EAAE;IACzB,MAAM,IAAIhE,qBAAqB,CAAC;MAAEpR;IAAG,CAAC,CAAC;EACzC;EACA,MAAMqV,YAAY,GAAG,eAAgBjY,MAAM,CAAE0F,OAAO,IAAK;IACvD,oBAAA6Q,iBAAA,CAAO,aAAY;MACjB,MAAM7Q,OAAO,CAACwS,cAAc,CAAC,CAAC;MAC9B,OAAOxS,OAAO,CAACyS,MAAM;IACvB,CAAC;EACH,CAAC,EAAE,cAAc,CAAC;EAClB,MAAMC,KAAK,GAAGpH,gBAAgB,CAACoH,KAAK,IAAIlC,oBAAoB,CAACkC,KAAK,IAAI1E,kBAAkB,CAAC0E,KAAK,IAAIH,YAAY;EAC9G,MAAMI,oBAAoB,GAAG3E,kBAAkB,CAAC2E,oBAAoB;EACpE,OAAO;IACLC,YAAY,EAAE,CAAC,CAAC;IAChB,GAAGnC,kBAAkB;IACrBrE,YAAY;IACZlP,EAAE;IACF2B,IAAI;IACJmJ,KAAK,EAAEnJ,IAAI;IACXsT,eAAe,EAAEnG,MAAM;IACvBkG,kBAAkB;IAClBG,cAAc;IACd1B,YAAY;IACZY,eAAe;IACfK,cAAc;IACdlD,YAAY;IACZ0D,OAAO;IACPM,KAAK;IACLC,oBAAoB;IACpBH,cAAc,EAAExE,kBAAkB,CAACwE,cAAc;IACjDF;EACF,CAAC;AACH;AACAhY,MAAM,CAACiW,YAAY,EAAE,cAAc,CAAC;AACpC,SAASsC,WAAWA,CAACrC,oBAAoB,EAAExC,kBAAkB,EAAE5B,YAAY,EAAE;EAC3E,OAAO;IACL,GAAGsE,yBAAyB,CAAC,KAAK,CAAC,EAAEF,oBAAoB,EAAExC,kBAAkB,CAAC;IAC9E5B;EACF,CAAC;AACH;AACA9R,MAAM,CAACuY,WAAW,EAAE,aAAa,CAAC;AAClC,SAASnC,yBAAyBA,CAACpF,gBAAgB,EAAEkF,oBAAoB,EAAExC,kBAAkB,EAAE;EAC7F,MAAM8E,WAAW,GAAG,CAAC,KAAK,EAAE,MAAM,CAAC;EACnC,MAAMC,SAAS,GAAGvE,WAAW,CAACwE,YAAY,EAAEC,QAAQ,KAAK,IAAI,GAAG,CAAC,UAAU,CAAC,GAAG,EAAE;EACjF,MAAMC,YAAY,GAAG5H,gBAAgB,EAAEY,IAAI,EAAEpO,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,EAAE;EACrF,MAAMoO,IAAI,GAAGkC,WAAW,CACtB,GAAG0E,WAAW,EACd,GAAGC,SAAS,EACZ,IAAG/E,kBAAkB,CAAC9B,IAAI,IAAI,EAAE,GAChC,IAAGsE,oBAAoB,CAACtE,IAAI,IAAI,EAAE,GAClC,GAAGgH,YAAY,EACf,IAAG5H,gBAAgB,EAAEY,IAAI,IAAI,EAAE,CACjC,CAAC;EACD,MAAM3I,UAAU,GAAG1J,iBAAiB,CAClCmU,kBAAkB,CAACzK,UAAU,EAC7BiN,oBAAoB,CAACjN,UAAU,EAC/B+H,gBAAgB,EAAE/H,UACpB,CAAC;EACD,MAAM;IAAE4P,iBAAiB,GAAG,EAAE;IAAEC,aAAa,GAAG;EAAG,CAAC,GAAGpF,kBAAkB;EACzE,MAAMqF,cAAc,GAAGxZ,iBAAiB,CACtCmU,kBAAkB,CAAChI,QAAQ,EAC3BwK,oBAAoB,CAACxK,QAAQ,EAC7BsF,gBAAgB,EAAEtF,QACpB,CAAC;EACD,IAAIsF,gBAAgB,EAAE;IACpB,MAAMU,MAAM,GAAGV,gBAAgB,EAAEG,WAAW,IAAIH,gBAAgB,EAAEU,MAAM,IAAIwE,oBAAoB,CAACxE,MAAM,IAAIgC,kBAAkB,CAAChC,MAAM;IACpIzI,UAAU,CAAC+P,aAAa,GAAGtH,MAAM,IAAIA,MAAM,CAAC5L,MAAM,GAAG,CAAC;EACxD;EACA,MAAMmT,UAAU,GAAG;IACjB,GAAGvF,kBAAkB,CAACzP,IAAI;IAC1B,GAAGiS,oBAAoB,CAACjS,IAAI;IAC5B,GAAG+M,gBAAgB,EAAE/M;EACvB,CAAC;EACD,MAAMqU,YAAY,GAAG;IACnB,GAAGpC,oBAAoB,CAAC1M,OAAO;IAC/B,GAAGwH,gBAAgB,EAAExH;EACvB,CAAC;EACD,MAAM0P,mBAAmB,GAAG;IAC1BvD,WAAW,EAAEO,oBAAoB,CAACtT,EAAE;IACpC8M,KAAK,EAAEwG,oBAAoB,CAACxG,KAAK;IACjCkG,IAAI,EAAEM,oBAAoB,CAACxG,KAAK;IAChC;IACA9M,EAAE,EAAEoO,gBAAgB,EAAEpO,EAAE,IAAIsT,oBAAoB,CAACtT,EAAE;IACnD;IACA2B,IAAI,EAAEyM,gBAAgB,EAAEzM,IAAI,IAAI,QAAQ;IACxCmJ,KAAK,EAAEsD,gBAAgB,EAAEzM,IAAI,IAAI,QAAQ;IACzC;IACA4U,SAAS,EAAEjD,oBAAoB,CAACiD,SAAS;IACzCC,aAAa,EAAElD,oBAAoB,CAACkD,aAAa;IACjDxH,IAAI;IACJ3I,UAAU;IACV0E,WAAW,EAAEsL,UAAU;IACvBvN,QAAQ,EAAEqN,cAAc;IACxBT;EACF,CAAC;EACDY,mBAAmB,CAACxN,QAAQ,GAAGmN,iBAAiB,CAAC7N,MAAM,CACrD,CAACqO,mBAAmB,EAAEC,QAAQ,KAAKA,QAAQ,CAAC;IAAE,GAAGJ,mBAAmB;IAAExN,QAAQ,EAAE2N;EAAoB,CAAC,CAAC,EACtGH,mBAAmB,CAACxN,QACtB,CAAC;EACD,MAAM6N,0BAA0B,GAAG;IAAE,GAAGN;EAAW,CAAC;EACpDC,mBAAmB,CAACvL,WAAW,GAAG,CAAC,GAAGmL,aAAa,CAAC,CAAC9N,MAAM,CACzD,CAACwO,eAAe,EAAEF,QAAQ,MAAM;IAC9B,GAAGE,eAAe;IAClB,GAAGF,QAAQ,CAAC;MACV,GAAGJ,mBAAmB;MACtBvL,WAAW,EAAE6L;IACf,CAAC;EACH,CAAC,CAAC,EACFD,0BACF,CAAC;EACD,MAAM;IAAEhV,IAAI;IAAEmJ,KAAK;IAAE,GAAG+L;EAAwB,CAAC,GAAGP,mBAAmB;EACvE,OAAOO,uBAAuB;AAChC;AACAzZ,MAAM,CAACoW,yBAAyB,EAAE,2BAA2B,CAAC;AAC9D,SAASsD,cAAcA,CAAChU,OAAO,EAAE;EAC/B,MAAM;IAAEzB,IAAI,EAAE0V;EAAa,CAAC,GAAGjU,OAAO;EACtC,IAAIkU,eAAe,GAAG;IACpB,GAAGlU,OAAO;IACVmU,OAAO,EAAE,KAAK,CAAC;IACfC,YAAY,EAAE,KAAK;EACrB,CAAC;EACD,IAAI7F,OAAO,CAAC8F,QAAQ,EAAEC,gBAAgB,EAAE;IACtC,MAAMF,YAAY,GAAG7M,iBAAiB,CAACvH,OAAO,CAAC;IAC/CkU,eAAe,GAAG;MAChB,GAAGlU,OAAO;MACVmU,OAAO,EAAEnU,OAAO,CAACzB,IAAI;MACrB6V,YAAY;MACZ7V,IAAI,EAAE6V,YAAY,CAAC9M,UAAU,CAAC,IAAI,CAAC;IACrC,CAAC;EACH;EACA,MAAMiN,UAAU,GAAG1R,MAAM,CAACC,OAAO,CAACoR,eAAe,CAAC3V,IAAI,CAAC,CAAC+G,MAAM,CAAC,CAACC,GAAG,EAAE,CAACI,GAAG,EAAEC,GAAG,CAAC,KAAK;IAClF,IAAI,CAACsO,eAAe,CAAClO,QAAQ,CAACL,GAAG,CAAC,EAAET,OAAO,EAAE;MAC3CK,GAAG,CAACI,GAAG,CAAC,GAAGC,GAAG;MACd,OAAOL,GAAG;IACZ;IACA,MAAMiP,SAAS,GAAG,eAAgBla,MAAM,CAAEma,aAAa,IAAK;MAC1D,MAAMvP,OAAO,GAAGgP,eAAe,CAAClO,QAAQ,CAACL,GAAG,CAAC,CAACT,OAAO;MACrD,OAAOA,OAAO,IAAIuP,aAAa,IAAIvP,OAAO,GAAGA,OAAO,CAACuP,aAAa,CAAC,GAAGA,aAAa;IACrF,CAAC,EAAE,WAAW,CAAC;IACflP,GAAG,CAACI,GAAG,CAAC,GAAG9E,KAAK,CAACC,OAAO,CAAC8E,GAAG,CAAC,GAAGA,GAAG,CAAC9F,GAAG,CAAC0U,SAAS,CAAC,GAAGA,SAAS,CAAC5O,GAAG,CAAC;IACnE,OAAOL,GAAG;EACZ,CAAC,EAAE,CAAC,CAAC,CAAC;EACN,MAAMmP,YAAY,GAAG7R,MAAM,CAACC,OAAO,CAACyR,UAAU,CAAC,CAACjP,MAAM,CAAC,CAACC,GAAG,EAAE,CAACI,GAAG,EAAEC,GAAG,CAAC,KAAK;IAC1E,MAAMX,OAAO,GAAGiP,eAAe,CAAClO,QAAQ,CAACL,GAAG,CAAC,IAAI,CAAC,CAAC;IACnD,IAAI0I,qBAAqB,CAACpJ,OAAO,EAAEsP,UAAU,EAAEL,eAAe,CAACpQ,OAAO,CAAC,EAAE;MACvEyB,GAAG,CAACI,GAAG,CAAC,GAAGC,GAAG;IAChB;IACA,OAAOL,GAAG;EACZ,CAAC,EAAE,CAAC,CAAC,CAAC;EACN,OAAO;IAAE,GAAG2O,eAAe;IAAED,YAAY;IAAE1V,IAAI,EAAEmW;EAAa,CAAC;AACjE;AACApa,MAAM,CAAC0Z,cAAc,EAAE,gBAAgB,CAAC;;AAExC;AACA,SAASnY,MAAM,IAAI8Y,OAAO,QAAQ,kCAAkC;AACpE,IAAIC,SAAS,GAAG,eAAgBta,MAAM,CAAC,CAAC+K,KAAK,EAAExG,IAAI,EAAEgW,OAAO,KAAK;EAC/D,MAAM9R,IAAI,GAAG,OAAOsC,KAAK;EACzB,QAAQtC,IAAI;IACV,KAAK,SAAS;IACd,KAAK,QAAQ;IACb,KAAK,QAAQ;IACb,KAAK,UAAU;IACf,KAAK,QAAQ;MACX,OAAO;QAAElE,IAAI,EAAEkE;MAAK,CAAC;IACvB;MACE;EACJ;EACA,IAAIsC,KAAK,EAAE;IACT,IAAIwP,OAAO,CAAC/V,GAAG,CAACuG,KAAK,CAAC,EAAE;MACtBsP,OAAO,CAAC5T,IAAI,CAAC1G,MAAM;AACzB,yCAAyCwE,IAAI;AAC7C;AACA;AACA;AACA;AACA,OAAO,CAAC;MACF,OAAO;QAAEA,IAAI,EAAE,OAAO;QAAEwG,KAAK,EAAE;MAAgB,CAAC;IAClD;IACAwP,OAAO,CAAC5V,GAAG,CAACoG,KAAK,CAAC;IAClB,IAAIxE,KAAK,CAACC,OAAO,CAACuE,KAAK,CAAC,EAAE;MACxB,MAAMyP,SAAS,GAAGzP,KAAK,CAACjF,MAAM,GAAG,CAAC,GAAGwU,SAAS,CAACvP,KAAK,CAAC,CAAC,CAAC,EAAExG,IAAI,EAAE,IAAItB,GAAG,CAACsX,OAAO,CAAC,CAAC,GAAG;QAAEhW,IAAI,EAAE,OAAO;QAAEwG,KAAK,EAAE;MAAU,CAAC;MACtH,OAAO;QAAExG,IAAI,EAAE,OAAO;QAAEwG,KAAK,EAAEyP;MAAU,CAAC;IAC5C;IACA,MAAMC,UAAU,GAAG9a,SAAS,CAACoL,KAAK,EAAGyB,KAAK,IAAK8N,SAAS,CAAC9N,KAAK,EAAEjI,IAAI,EAAE,IAAItB,GAAG,CAACsX,OAAO,CAAC,CAAC,CAAC;IACxF,OAAO;MAAEhW,IAAI,EAAE,QAAQ;MAAEwG,KAAK,EAAE0P;IAAW,CAAC;EAC9C;EACA,OAAO;IAAElW,IAAI,EAAE,QAAQ;IAAEwG,KAAK,EAAE,CAAC;EAAE,CAAC;AACtC,CAAC,EAAE,WAAW,CAAC;AACf,IAAI2P,aAAa,GAAG,eAAgB1a,MAAM,CAAE0F,OAAO,IAAK;EACtD,MAAM;IAAE9C,EAAE;IAAE8I,QAAQ,EAAEiP,YAAY,GAAG,CAAC,CAAC;IAAEhN,WAAW,GAAG,CAAC;EAAE,CAAC,GAAGjI,OAAO;EACrE,MAAMgG,QAAQ,GAAG/L,SAAS,CAACgO,WAAW,EAAE,CAACjD,GAAG,EAAEW,GAAG,MAAM;IACrD9G,IAAI,EAAE8G,GAAG;IACT5C,IAAI,EAAE6R,SAAS,CAAC5P,GAAG,EAAE,GAAG9H,EAAE,IAAIyI,GAAG,EAAE,EAAE,eAAgB,IAAIpI,GAAG,CAAC,CAAC;EAChE,CAAC,CAAC,CAAC;EACH,MAAM2X,iBAAiB,GAAGjb,SAAS,CAACgb,YAAY,EAAE,CAAChQ,OAAO,EAAEU,GAAG,MAAM;IACnE9G,IAAI,EAAE8G;EACR,CAAC,CAAC,CAAC;EACH,OAAO9L,iBAAiB,CAACmM,QAAQ,EAAEkP,iBAAiB,EAAED,YAAY,CAAC;AACrE,CAAC,EAAE,eAAe,CAAC;AACnBD,aAAa,CAACG,UAAU,GAAG,IAAI;;AAE/B;AACA,SAAStZ,MAAM,IAAIuZ,OAAO,QAAQ,kCAAkC;;AAEpE;AACA,IAAIC,OAAO,GAAG,eAAgB/a,MAAM,CAAC,CAACuE,IAAI,EAAEyW,UAAU,KAAKzU,KAAK,CAACC,OAAO,CAACwU,UAAU,CAAC,GAAGA,UAAU,CAACxX,QAAQ,CAACe,IAAI,CAAC,GAAGA,IAAI,CAAC+P,KAAK,CAAC0G,UAAU,CAAC,EAAE,SAAS,CAAC;AACrJ,IAAIC,cAAc,GAAG,eAAgBjb,MAAM,CAAC,CAAC0L,QAAQ,EAAEwP,OAAO,EAAEC,OAAO,KAAK;EAC1E,IAAI,CAACD,OAAO,IAAI,CAACC,OAAO,EAAE;IACxB,OAAOzP,QAAQ;EACjB;EACA,OAAOA,QAAQ,IAAI9L,MAAM,CAAC8L,QAAQ,EAAE,CAACf,OAAO,EAAEU,GAAG,KAAK;IACpD,MAAM9G,IAAI,GAAGoG,OAAO,CAACpG,IAAI,IAAI8G,GAAG,CAACkJ,QAAQ,CAAC,CAAC;IAC3C,OAAO,CAAC,EAAE,CAAC2G,OAAO,IAAIH,OAAO,CAACxW,IAAI,EAAE2W,OAAO,CAAC,CAAC,KAAK,CAACC,OAAO,IAAI,CAACJ,OAAO,CAACxW,IAAI,EAAE4W,OAAO,CAAC,CAAC;EACxF,CAAC,CAAC;AACJ,CAAC,EAAE,gBAAgB,CAAC;;AAEpB;AACA,IAAIC,YAAY,GAAG,eAAgBpb,MAAM,CAAC,CAAC2K,OAAO,EAAEpG,IAAI,EAAE8W,QAAQ,KAAK;EACrE,MAAM;IAAE5S,IAAI;IAAEsB;EAAQ,CAAC,GAAGY,OAAO;EACjC,IAAI,CAAClC,IAAI,EAAE;IACT,OAAO,KAAK,CAAC;EACf;EACA,IAAI4S,QAAQ,CAACC,KAAK,IAAID,QAAQ,CAACC,KAAK,CAACC,IAAI,CAAChX,IAAI,CAAC,EAAE;IAC/C,MAAMiX,WAAW,GAAG/S,IAAI,CAAClE,IAAI;IAC7B,IAAIiX,WAAW,KAAK,QAAQ,EAAE;MAC5B,OAAO;QAAEvL,OAAO,EAAE;UAAExH,IAAI,EAAE;QAAQ;MAAE,CAAC;IACvC;IACA,IAAI+S,WAAW,KAAK,MAAM,EAAE;MAC1BV,OAAO,CAACrU,IAAI,CACV,yEAAyE+U,WAAW,WACtF,CAAC;IACH;EACF;EACA,IAAIH,QAAQ,CAACI,IAAI,IAAIJ,QAAQ,CAACI,IAAI,CAACF,IAAI,CAAChX,IAAI,CAAC,EAAE;IAC7C,OAAO;MAAE0L,OAAO,EAAE;QAAExH,IAAI,EAAE;MAAO;IAAE,CAAC;EACtC;EACA,QAAQA,IAAI,CAAClE,IAAI;IACf,KAAK,OAAO;MACV,OAAO;QAAE0L,OAAO,EAAE;UAAExH,IAAI,EAAE;QAAS;MAAE,CAAC;IACxC,KAAK,SAAS;MACZ,OAAO;QAAEwH,OAAO,EAAE;UAAExH,IAAI,EAAE;QAAU;MAAE,CAAC;IACzC,KAAK,QAAQ;MACX,OAAO;QAAEwH,OAAO,EAAE;UAAExH,IAAI,EAAE;QAAO;MAAE,CAAC;IACtC,KAAK,QAAQ;MACX,OAAO;QAAEwH,OAAO,EAAE;UAAExH,IAAI,EAAE;QAAS;MAAE,CAAC;IACxC,KAAK,MAAM;MAAE;QACX,MAAM;UAAEsC;QAAM,CAAC,GAAGtC,IAAI;QACtB,OAAO;UAAEwH,OAAO,EAAE;YAAExH,IAAI,EAAEsC,KAAK,EAAEjF,MAAM,IAAI,CAAC,GAAG,OAAO,GAAG;UAAS,CAAC;UAAEiE,OAAO,EAAEgB;QAAM,CAAC;MACvF;IACA,KAAK,UAAU;IACf,KAAK,QAAQ;MACX,OAAO,IAAI;IACb;MACE,OAAO;QAAEkF,OAAO,EAAE;UAAExH,IAAI,EAAEsB,OAAO,GAAG,QAAQ,GAAG;QAAS;MAAE,CAAC;EAC/D;AACF,CAAC,EAAE,cAAc,CAAC;AAClB,IAAI2R,aAAa,GAAG,eAAgB1b,MAAM,CAAE0F,OAAO,IAAK;EACtD,MAAM;IACJgG,QAAQ;IACRzC,UAAU,EAAE;MAAE+P,aAAa;MAAE2C,QAAQ,EAAE;QAAET,OAAO,GAAG,IAAI;QAAEC,OAAO,GAAG,IAAI;QAAEE,QAAQ,GAAG,CAAC;MAAE,CAAC,GAAG,CAAC;IAAE;EAChG,CAAC,GAAG3V,OAAO;EACX,IAAI,CAACsT,aAAa,EAAE;IAClB,OAAOtN,QAAQ;EACjB;EACA,MAAMkQ,gBAAgB,GAAGX,cAAc,CAACvP,QAAQ,EAAEwP,OAAO,EAAEC,OAAO,CAAC;EACnE,MAAMU,YAAY,GAAGlc,SAAS,CAACic,gBAAgB,EAAE,CAACjR,OAAO,EAAEpG,IAAI,KAAK;IAClE,OAAOoG,OAAO,EAAElC,IAAI,IAAI2S,YAAY,CAACzQ,OAAO,EAAEpG,IAAI,CAACgQ,QAAQ,CAAC,CAAC,EAAE8G,QAAQ,CAAC;EAC1E,CAAC,CAAC;EACF,OAAO9b,iBAAiB,CAACsc,YAAY,EAAED,gBAAgB,CAAC;AAC1D,CAAC,EAAE,eAAe,CAAC;AACnBF,aAAa,CAACb,UAAU,GAAG,IAAI;;AAE/B;AACA,SAASiB,2BAA2BA,CAAC;EACnCpQ,QAAQ;EACR6C,WAAW;EACXsK,iBAAiB;EACjBvT,UAAU;EACViM,OAAO;EACPC,UAAU;EACVC,SAAS;EACTjD,cAAc;EACd,GAAGuN;AACL,CAAC,EAAE;EACD,OAAO;IACL,IAAGrQ,QAAQ,IAAI;MAAEA,QAAQ,EAAE4E,mBAAmB,CAAC5E,QAAQ;IAAE,CAAC;IAC1D,IAAG6C,WAAW,IAAI;MAAEA,WAAW,EAAE+B,mBAAmB,CAAC/B,WAAW;IAAE,CAAC;IACnEjJ,UAAU,EAAEsL,eAAe,CAACtL,UAAU,CAAC;IACvCiM,OAAO,EAAEX,eAAe,CAACW,OAAO,CAAC;IACjCC,UAAU,EAAEZ,eAAe,CAACY,UAAU,CAAC;IACvCC,SAAS,EAAEb,eAAe,CAACa,SAAS,CAAC;IACrCoH,iBAAiB,EAAE,CACjB,IAAGA,iBAAiB,IAAI,EAAE,GAC1B6B,aAAa;IACb;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAgB,aAAa,CACd;IACDlN,cAAc;IACd,GAAGuN;EACL,CAAC;AACH;AACA/b,MAAM,CAAC8b,2BAA2B,EAAE,6BAA6B,CAAC;;AAElE;AACA,SAAS5b,MAAM,IAAI8b,OAAO,QAAQ,mBAAmB;;AAErD;AACA,IAAIC,qBAAqB,GAAG,eAAgBjc,MAAM,CAAEkE,KAAK,IAAK;EAC5D,oBAAAqS,iBAAA,CAAO,aAAY;IACjB,MAAM2F,SAAS,GAAG,EAAE;IACpB,KAAK,MAAM3Y,IAAI,IAAIW,KAAK,EAAE;MACxB,MAAMkT,OAAO,SAAS7T,IAAI,CAAC,CAAC;MAC5B,IAAI6T,OAAO,EAAE;QACX8E,SAAS,CAACC,OAAO,CAAC/E,OAAO,CAAC;MAC5B;IACF;IACA,oBAAAb,iBAAA,CAAO,aAAY;MACjB,KAAK,MAAMa,OAAO,IAAI8E,SAAS,EAAE;QAC/B,MAAM9E,OAAO,CAAC,CAAC;MACjB;IACF,CAAC;EACH,CAAC;AACH,CAAC,EAAE,uBAAuB,CAAC;;AAE3B;AACA,SAASgF,kBAAkBA,CAACC,WAAW,EAAE;EACvC;IAAA,IAAAC,KAAA,GAAA/F,iBAAA,CAAO,WAAOgG,KAAK,EAAE5K,IAAI,EAAE6K,WAAW,EAAK;MACzC,MAAMC,YAAY,GAAGJ,WAAW,CAACK,WAAW,CAC1C,CAACC,SAAS,EAAEC,UAAU,kBAAArG,iBAAA,CAAK;QAAA,OAAYqG,UAAU,CAACL,KAAK,EAAEI,SAAS,EAAEH,WAAW,CAAC;MAAA,iBAAAjG,iBAAA,CAChF;QAAA,OAAY5E,IAAI,CAAC6K,WAAW,CAAC;MAAA,EAC/B,CAAC;MACD,MAAMC,YAAY,CAAC,CAAC;IACtB,CAAC;IAAA,iBAAAI,GAAA,EAAAC,GAAA,EAAAC,GAAA;MAAA,OAAAT,KAAA,CAAAvF,KAAA,OAAAC,SAAA;IAAA;EAAA;AACH;AACAhX,MAAM,CAACoc,kBAAkB,EAAE,oBAAoB,CAAC;;AAEhD;AACA,SAASY,QAAQA,CAACC,gBAAgB,EAAEzQ,KAAK,EAAE;EACzC,OAAOyQ,gBAAgB,CAACzX,GAAG,CAAE0X,EAAE,IAAKA,EAAE,CAACjO,OAAO,GAAGzC,KAAK,CAAC,IAAI0Q,EAAE,CAAC1Q,KAAK,CAAC,CAAC,CAACX,MAAM,CAACsR,OAAO,CAAC;AACvF;AACAnd,MAAM,CAACgd,QAAQ,EAAE,UAAU,CAAC;AAC5B,SAASI,aAAaA,CAACH,gBAAgB,EAAEzQ,KAAK,EAAEzC,OAAO,GAAG,CAAC,CAAC,EAAE;EAC5D,OAAOiT,QAAQ,CAACC,gBAAgB,EAAEzQ,KAAK,CAAC,CAACxB,MAAM,CAAC,CAACqS,IAAI,EAAEC,GAAG,KAAK;IAC7D,MAAMjN,UAAU,GAAGO,eAAe,CAAC0M,GAAG,CAAC;IACvC,OAAOvT,OAAO,CAACwT,gBAAgB,GAAG,CAAC,GAAGlN,UAAU,EAAE,GAAGgN,IAAI,CAAC,GAAG,CAAC,GAAGA,IAAI,EAAE,GAAGhN,UAAU,CAAC;EACvF,CAAC,EAAE,EAAE,CAAC;AACR;AACArQ,MAAM,CAACod,aAAa,EAAE,eAAe,CAAC;AACtC,SAASI,cAAcA,CAACP,gBAAgB,EAAEzQ,KAAK,EAAE;EAC/C,OAAOjE,MAAM,CAACgD,MAAM,CAAC,CAAC,CAAC,EAAE,GAAGyR,QAAQ,CAACC,gBAAgB,EAAEzQ,KAAK,CAAC,CAAC;AAChE;AACAxM,MAAM,CAACwd,cAAc,EAAE,gBAAgB,CAAC;AACxC,SAASC,iBAAiBA,CAACR,gBAAgB,EAAEzQ,KAAK,EAAE;EAClD,OAAOwQ,QAAQ,CAACC,gBAAgB,EAAEzQ,KAAK,CAAC,CAAC0I,GAAG,CAAC,CAAC;AAChD;AACAlV,MAAM,CAACyd,iBAAiB,EAAE,mBAAmB,CAAC;AAC9C,SAASC,cAAcA,CAACT,gBAAgB,EAAE;EACxC,MAAMU,mBAAmB,GAAGP,aAAa,CAACH,gBAAgB,EAAE,mBAAmB,CAAC;EAChF,MAAMZ,WAAW,GAAGW,QAAQ,CAACC,gBAAgB,EAAE,SAAS,CAAC;EACzD,MAAMW,cAAc,GAAGR,aAAa,CAACH,gBAAgB,EAAE,WAAW,CAAC;EACnE,OAAO;IACLhU,UAAU,EAAE1J,iBAAiB,CAAC,GAAGyd,QAAQ,CAACC,gBAAgB,EAAE,YAAY,CAAC,CAAC;IAC1E3X,UAAU,EAAE8X,aAAa,CAACH,gBAAgB,EAAE,YAAY,EAAE;MACxDM,gBAAgB,EAAE,EAAEvB,OAAO,CAACjC,QAAQ,EAAE8D,wBAAwB,IAAI,KAAK;IACzE,CAAC,CAAC;IACF5Z,IAAI,EAAEuZ,cAAc,CAACP,gBAAgB,EAAE,MAAM,CAAC;IAC9CnE,aAAa,EAAEsE,aAAa,CAACH,gBAAgB,EAAE,eAAe,CAAC;IAC/DvR,QAAQ,EAAE8R,cAAc,CAACP,gBAAgB,EAAE,UAAU,CAAC;IACtDpE,iBAAiB,EAAE,CACjB,GAAG8E,mBAAmB,CAAC9R,MAAM,CAAEvE,CAAC,IAAK,CAACA,CAAC,CAACuT,UAAU,CAAC,EACnD,GAAG8C,mBAAmB,CAAC9R,MAAM,CAAEvE,CAAC,IAAKA,CAAC,CAACuT,UAAU,CAAC,CACnD;IACDrM,cAAc,EAAEgP,cAAc,CAACP,gBAAgB,EAAE,gBAAgB,CAAC;IAClE1O,WAAW,EAAEiP,cAAc,CAACP,gBAAgB,EAAE,aAAa,CAAC;IAC5D1L,OAAO,EAAE6L,aAAa,CAACH,gBAAgB,EAAE,SAAS,CAAC;IACnDa,SAAS,EAAE7B,qBAAqB,CAAC2B,cAAc,CAAC;IAChDpM,UAAU,EAAE4L,aAAa,CAACH,gBAAgB,EAAE,YAAY,CAAC;IACzDxL,SAAS,EAAE2L,aAAa,CAACH,gBAAgB,EAAE,WAAW,CAAC;IACvDvL,MAAM,EAAE+L,iBAAiB,CAACR,gBAAgB,EAAE,QAAQ,CAAC;IACrD/E,cAAc,EAAEuF,iBAAiB,CAACR,gBAAgB,EAAE,gBAAgB,CAAC;IACrE7X,eAAe,EAAEqY,iBAAiB,CAACR,gBAAgB,EAAE,iBAAiB,CAAC;IACvEnF,OAAO,EAAEsE,kBAAkB,CAACC,WAAW,CAAC;IACxCzK,IAAI,EAAEwL,aAAa,CAACH,gBAAgB,EAAE,MAAM,CAAC;IAC7C7E,KAAK,EAAEqF,iBAAiB,CAACR,gBAAgB,EAAE,OAAO,CAAC;IACnD5E,oBAAoB,EAAEoF,iBAAiB,CAACR,gBAAgB,EAAE,sBAAsB;EAClF,CAAC;AACH;AACAjd,MAAM,CAAC0d,cAAc,EAAE,gBAAgB,CAAC;;AAExC;AACA,SAASzL,aAAa,IAAI8L,cAAc,QAAQ,wBAAwB;AACxE,SAAS7T,kBAAkB,QAAQ,wBAAwB;AAC3D,SAAS8T,4BAA4B,QAAQ,mCAAmC;;AAEhF;AACA,IAAIC,YAAY,GAAG,MAAMA,YAAY,CAAC;EACpCxd,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACyd,OAAO,GAAG,EAAE;EACnB;EACMC,SAASA,CAACC,MAAM,EAAE;IAAA,IAAAC,KAAA;IAAA,OAAA9H,iBAAA;MACtB8H,KAAI,CAACH,OAAO,CAACxX,IAAI,CAAC0X,MAAM,CAAC;IAAC;EAC5B;AACF,CAAC;AACDpe,MAAM,CAACie,YAAY,EAAE,aAAa,CAAC;AACnC,IAAIK,WAAW,GAAGL,YAAY;;AAE9B;AACA,SAASM,MAAM,EAAErM,OAAO,IAAIsM,QAAQ,QAAQ,wBAAwB;AACpE,SAASC,wBAAwBA,CAAC/Q,KAAK,EAAEuD,IAAI,EAAEyC,kBAAkB,EAAE;EACjE,OAAO8K,QAAQ,CAAC9Q,KAAK,CAAC,GAAG;IACvBA,KAAK,EAAEA,KAAK,CAAC0F,KAAK;IAClBnC,IAAI,EAAEvD,KAAK,CAACuD,IAAI,CAACmC,KAAK;IACtBO,OAAO,EAAEjG,KAAK,CAACuD,IAAI,CAAC0C,OAAO,CAACC;EAC9B,CAAC,GAAG;IAAElG,KAAK;IAAEuD,IAAI,EAAEsN,MAAM,CAACtN,IAAI,CAAC,GAAGA,IAAI,CAACmC,KAAK,GAAGnC,IAAI;IAAE0C,OAAO,EAAED;EAAmB,CAAC;AACpF;AACA1T,MAAM,CAACye,wBAAwB,EAAE,0BAA0B,CAAC;;AAE5D;AACA,SAASC,4BAA4BA,CAACC,0BAA0B,EAAE;EAChEC,UAAU,CAACC,yBAAyB,GAAGF,0BAA0B;AACnE;AACA3e,MAAM,CAAC0e,4BAA4B,EAAE,8BAA8B,CAAC;AACpE,IAAII,mBAAmB,GAAG,eAAe;AACzC,IAAIC,kBAAkB,GAAG,eAAe;AACxC,SAASC,iBAAiBA,CAACC,UAAU,EAAE;EACrC,IAAI,CAACA,UAAU,EAAE;IACf,OAAO,CAAC,CAAC;EACX;EACA,OAAOvB,cAAc,CAAC,CAACuB,UAAU,CAAC,CAAC;AACrC;AACAjf,MAAM,CAACgf,iBAAiB,EAAE,mBAAmB,CAAC;AAC9C,SAASE,qBAAqBA,CAACxL,kBAAkB,EAAE;EACjD,MAAMqI,WAAW,GAAGxV,KAAK,CAACC,OAAO,CAACkN,kBAAkB,CAAC,GAAGA,kBAAkB,GAAG,CAACA,kBAAkB,CAAC;EACjGkL,UAAU,CAACO,wBAAwB,GAAGzB,cAAc,CAAC,CACnD,GAAGxT,kBAAkB,CAAC,CAAC,EACvB0U,UAAU,CAACC,yBAAyB,IAAI,CAAC,CAAC,EAC1CnB,cAAc,CAAC3B,WAAW,CAACvW,GAAG,CAACwZ,iBAAiB,CAAC,CAAC,CACnD,CAAC;EACF,OAAOJ,UAAU,CAACO,wBAAwB,IAAI,CAAC,CAAC;AAClD;AACAnf,MAAM,CAACkf,qBAAqB,EAAE,uBAAuB,CAAC;AACtD,IAAIE,QAAQ,GAAG,EAAE;AACjB,SAASC,YAAYA,CAACrO,gBAAgB,EAAEkF,oBAAoB,EAAExC,kBAAkB,EAAE4L,aAAa,EAAEC,WAAW,EAAE;EAC5G,IAAIvO,gBAAgB,KAAK,KAAK,CAAC,EAAE;IAC/B,MAAM,IAAIjM,KAAK,CAAC,0CAA0C,CAAC;EAC7D;EACAmR,oBAAoB,CAACxG,KAAK,GAAGwG,oBAAoB,CAACxG,KAAK,IAAIoP,mBAAmB;EAC9E,MAAMU,8BAA8B,GAAGnN,6BAA6B,CAAC6D,oBAAoB,CAAC;EAC1F,MAAM5E,SAAS,GAAGiO,WAAW,IAAIvO,gBAAgB,CAACM,SAAS,IAAIN,gBAAgB,CAACtD,KAAK,EAAEnJ,IAAI,IAAIyM,gBAAgB,CAACzM,IAAI,IAAIwa,kBAAkB;EAC1I,MAAMU,eAAe,GAAG1O,cAAc,CACpCO,SAAS,EACTN,gBAAgB,EAChBwO,8BACF,CAAC;EACD,MAAME,4BAA4B,GAAG5D,2BAA2B,CAC9D4B,cAAc,CAAC,CACb4B,aAAa,IAAIV,UAAU,CAACO,wBAAwB,IAAI,CAAC,CAAC,EAC1DzL,kBAAkB,IAAI,CAAC,CAAC,CACzB,CACH,CAAC;EACD,MAAMhG,KAAK,GAAGuI,YAAY,CACxBwJ,eAAe,EACfD,8BAA8B,EAC9BE,4BACF,CAAC;EACD,MAAMC,sBAAsB,GAAGtR,qBAAqB,CAACqR,4BAA4B,CAACnR,WAAW,CAAC;EAC9F,MAAM/E,OAAO,GAAG;IACd,GAAGmW,sBAAsB;IACzB,GAAGD,4BAA4B,CAAClR,cAAc;IAC9C,GAAGd,KAAK,CAAC4K;EACX,CAAC;EACD,MAAMsH,SAAS,GAAG,IAAItB,WAAW,CAAC,CAAC;EACnC,MAAMuB,iBAAiB,GAAG,eAAgB7f,MAAM,CAAC,MAAM;IACrD,MAAM0F,OAAO,GAAGgU,cAAc,CAAC;MAC7BxV,KAAK,EAAE,IAAIL,YAAY,CAAC,CAAC;MACzB2F,OAAO;MACPvF,IAAI,EAAE;QAAE,GAAGyJ,KAAK,CAACC;MAAY,CAAC;MAC9BmS,QAAQ,EAAE,OAAO;MACjBF,SAAS;MACTpJ,MAAM,EAAE,CAAC,CAAC;MACVC,WAAW,EAAE,IAAIsJ,eAAe,CAAC,CAAC,CAACC,MAAM;MACzCC,IAAI,EAAE,eAAgBjgB,MAAM,CAAC,CAACuc,KAAK,EAAE2D,KAAK,KAAKxS,KAAK,CAACoK,OAAO,CAACyE,KAAK,EAAE2D,KAAK,EAAExa,OAAO,CAAC,EAAE,MAAM,CAAC;MAC5Fya,aAAa,EAAE,IAAI;MACnBhI,MAAM,EAAE,CAAC,CAAC;MACViI,SAAS,EAAE,CAAC,CAAC;MACb7R,WAAW,EAAEmR,4BAA4B,CAACnR,WAAW;MACrD,GAAGb,KAAK;MACRhI,OAAO,EAAE,IAAI;MACb0S,KAAK,EAAE;IACT,CAAC,CAAC;IACF1S,OAAO,CAACuD,UAAU,CAACoX,iBAAiB,GAAG,IAAI;IAC3C3a,OAAO,CAACA,OAAO,GAAGA,OAAO;IACzB,IAAIgI,KAAK,CAACwK,cAAc,EAAE;MACxBxS,OAAO,CAACwS,cAAc,gBAAA3B,iBAAA,CAAG,aAAY;QACnC,MAAM+J,OAAO,SAAS5S,KAAK,CAACwK,cAAc,GACxC;UACEvC,WAAW,EAAEjI,KAAK,CAACiI,WAAW;UAC9BjG,KAAK,EAAEhC,KAAK,CAACgC,KAAK;UAClB9M,EAAE,EAAE8K,KAAK,CAAC9K,EAAE;UACZ2B,IAAI,EAAEmJ,KAAK,CAACnJ,IAAI;UAChBqN,IAAI,EAAElE,KAAK,CAACkE,IAAI;UAChB2O,QAAQ,EAAE,eAAgBvgB,MAAM,CAAC,MAAM,CACvC,CAAC,EAAE,UAAU,CAAC;UACdwgB,SAAS,EAAE,eAAgBxgB,MAAM,CAAEkM,KAAK,IAAK;YAC3C,MAAM,IAAInH,KAAK,CAAC,GAAGmH,KAAK,CAACwD,KAAK;AAC5C,EAAExD,KAAK,CAACuU,WAAW,EAAE,CAAC;UACV,CAAC,EAAE,WAAW,CAAC;UACfC,aAAa,EAAE,eAAgB1gB,MAAM,CAAEkM,KAAK,IAAK;YAC/C,MAAMA,KAAK;UACb,CAAC,EAAE,eAAe,CAAC;UACnByU,YAAY,EAAE,IAAI;UAClBC,YAAY,EAAElb,OAAO;UACrBL,OAAO,EAAE,eAAgBrF,MAAM,CAAC,MAAM0N,KAAK,CAACqK,cAAc,CAACrS,OAAO,CAAC,EAAE,SAAS,CAAC;UAC/EqS,cAAc,EAAErK,KAAK,CAACqK;QACxB,CAAC,EACDrS,OAAO,CAACya,aACV,CAAC;QACD,IAAIG,OAAO,EAAE;UACXlB,QAAQ,CAAC1Y,IAAI,CAAC4Z,OAAO,CAAC;QACxB;MACF,CAAC;IACH;IACA5a,OAAO,CAAC0S,KAAK,GAAG1K,KAAK,CAAC0K,KAAK,CAAC1S,OAAO,CAAC;IACpC,OAAOA,OAAO;EAChB,CAAC,EAAE,mBAAmB,CAAC;EACvB,IAAImb,aAAa;EACjB,MAAMlP,IAAI,GAAG,eAAgB3R,MAAM;IAAA,IAAA8gB,KAAA,GAAAvK,iBAAA,CAAC,WAAOwK,YAAY,EAAK;MAC1D,MAAMrb,OAAO,GAAGma,iBAAiB,CAAC,CAAC;MACnCna,OAAO,CAACya,aAAa,KAAKvB,UAAU,EAAEoC,QAAQ,EAAEC,IAAI;MACpD,IAAIJ,aAAa,EAAE;QACjBnb,OAAO,CAAC8Q,MAAM,GAAGqK,aAAa,CAACrK,MAAM;MACvC;MACAjO,MAAM,CAACgD,MAAM,CAAC7F,OAAO,EAAEqb,YAAY,CAAC;MACpC,OAAOrT,KAAK,CAAC0G,YAAY,CAAC1O,OAAO,CAAC;IACpC,CAAC;IAAA,iBAAAwb,GAAA;MAAA,OAAAJ,KAAA,CAAA/J,KAAA,OAAAC,SAAA;IAAA;EAAA,KAAE,MAAM,CAAC;EACV,MAAMmK,GAAG,GAAG,eAAgBnhB,MAAM,CAAE+gB,YAAY,IAAK;IACnD,MAAMrb,OAAO,GAAGma,iBAAiB,CAAC,CAAC;IACnCtX,MAAM,CAACgD,MAAM,CAAC7F,OAAO,EAAEqb,YAAY,CAAC;IACpC,OAAOK,QAAQ,CAAC1T,KAAK,EAAEhI,OAAO,CAAC;EACjC,CAAC,EAAE,KAAK,CAAC;EACT,MAAM0O,YAAY,GAAG1G,KAAK,CAAC0G,YAAY,GAAGzC,IAAI,GAAG,KAAK,CAAC;EACvD,MAAM0P,aAAa,GAAG9Y,MAAM,CAACgD,MAAM,CACjC,eAAgBvL,MAAM,CAAC,SAASqF,OAAOA,CAACic,SAAS,EAAE;IACjD,MAAM5b,OAAO,GAAGma,iBAAiB,CAAC,CAAC;IACnC,IAAIgB,aAAa,EAAE;MACjBnb,OAAO,CAAC8Q,MAAM,GAAGqK,aAAa,CAACrK,MAAM;IACvC;IACA9Q,OAAO,CAACzB,IAAI,GAAG;MACb,GAAGyB,OAAO,CAACiI,WAAW;MACtB,GAAG2T;IACL,CAAC;IACD,OAAO5T,KAAK,CAACqK,cAAc,CAACrS,OAAO,CAAC;EACtC,CAAC,EAAE,SAAS,CAAC,EACb;IACE9C,EAAE,EAAE8K,KAAK,CAAC9K,EAAE;IACZ0O,SAAS;IACTiQ,IAAI,EAAE,eAAgBvhB,MAAM,cAAAuW,iBAAA,CAAC,aAAY;MACvC,KAAK,MAAMjQ,QAAQ,IAAI,CAAC,GAAG8Y,QAAQ,CAAC,CAAC3H,OAAO,CAAC,CAAC,EAAE;QAC9C,MAAMnR,QAAQ,CAAC,CAAC;MAClB;MACA8Y,QAAQ,CAACtZ,MAAM,GAAG,CAAC;MACnB,MAAMJ,OAAO,GAAGma,iBAAiB,CAAC,CAAC;MACnCna,OAAO,CAAC8Q,MAAM,SAAS9I,KAAK,CAAC2I,YAAY,CAAC3Q,OAAO,CAAC;MAClD0Z,QAAQ,CAAC1Y,IAAI,CAAC,GAAG,OAAOgH,KAAK,CAACuJ,eAAe,CAACvR,OAAO,CAAC,EAAEmG,MAAM,CAACsR,OAAO,CAAC,CAAC;MACxE0D,aAAa,GAAGnb,OAAO;IACzB,CAAC,GAAE,MAAM,CAAC;IACV8D,OAAO;IACPvF,IAAI,EAAEyJ,KAAK,CAACC,WAAW;IACvB1E,UAAU,EAAEyE,KAAK,CAACzE,UAAU;IAC5ByC,QAAQ,EAAEgC,KAAK,CAAChC,QAAQ;IACxBiG,IAAI,EAAEyC,YAAY;IAClB+M,GAAG;IACHvB,SAAS;IACThO,IAAI,EAAElE,KAAK,CAACkE;EACd,CACF,CAAC;EACD,OAAOyP,aAAa;AACtB;AACArhB,MAAM,CAACqf,YAAY,EAAE,cAAc,CAAC;AACpC,IAAImC,mBAAmB,GAAG,eAAgBxhB,MAAM,CAAC,CAAC0N,KAAK,EAAEyL,SAAS,EAAEsI,OAAO,EAAElC,WAAW,KAAKF,YAAY,CAAC3R,KAAK,EAAEyL,SAAS,EAAEsI,OAAO,EAAE,CAAC,CAAC,EAAElC,WAAW,CAAC,EAAE,qBAAqB,CAAC;AAC7K,SAASmC,cAAcA,CAACC,aAAa,EAAEC,YAAY,EAAEC,cAAc,GAAGL,mBAAmB,EAAE;EACzF,MAAM;IAAEvS,OAAO,EAAE6S,UAAU;IAAEC,UAAU;IAAE/O,mBAAmB;IAAE,GAAGM;EAAQ,CAAC,GAAGqO,aAAa;EAC1F,IAAI1Q,IAAI,GAAG6Q,UAAU;EACrB,MAAME,eAAe,GAAGzZ,MAAM,CAACC,OAAO,CAAC8K,OAAO,CAAC,CAACtI,MAAM,CACpD,CAACiX,UAAU,EAAE,CAAC1C,WAAW,EAAE7R,KAAK,CAAC,KAAK;IACpC,MAAM;MAAEA,KAAK,EAAEsD,gBAAgB;MAAEC,IAAI,EAAEiF;IAAqB,CAAC,GAAGuI,wBAAwB,CAAC/Q,KAAK,CAAC;IAC/F,IAAI,CAACuD,IAAI,IAAIiF,oBAAoB,EAAE;MACjCjF,IAAI,GAAGiF,oBAAoB;IAC7B;IACA,IAAI,CAAC6H,cAAc,CAACwB,WAAW,EAAEtO,IAAI,CAAC,EAAE;MACtC,OAAOgR,UAAU;IACnB;IACA,MAAMnd,MAAM,GAAGyD,MAAM,CAACgD,MAAM,CAAC0W,UAAU,EAAE;MACvC,CAAC1C,WAAW,GAAGsC,cAAc,CAAC7Q,gBAAgB,EAAEC,IAAI,EAAE2Q,YAAY,EAAErC,WAAW;IACjF,CAAC,CAAC;IACF,OAAOza,MAAM;EACf,CAAC,EACD,CAAC,CACH,CAAC;EACD,OAAOkd,eAAe;AACxB;AACAhiB,MAAM,CAAC0hB,cAAc,EAAE,gBAAgB,CAAC;AACxC,SAASQ,oBAAoBA,CAACC,QAAQ,EAAE;EACtC,OAAOA,QAAQ,CAACC,MAAM,CAAC;IACrBhK,KAAK,EAAE,eAAgBpY,MAAM;MAAA,IAAAqiB,MAAA,GAAA9L,iBAAA,CAAC,WAAO;QAAE6B,KAAK;QAAEkK;MAAK,CAAC,EAAEC,GAAG,EAAK;QAC5D,MAAMA,GAAG;UAAA,IAAAC,MAAA,GAAAjM,iBAAA,CAAC,WAAOkM,QAAQ,EAAE,GAAGC,QAAQ,EAAK;YACzC,IAAI,EAAE,WAAW,IAAID,QAAQ,CAAC,IAAI,WAAW,IAAIA,QAAQ,IAAIA,QAAQ,CAACE,SAAS,KAAK,KAAK,EAAE;cACzF,MAAM,IAAI5d,KAAK,CAAChF,MAAM;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,CAAC;YACN;YACA,MAAM;cAAE4U,KAAK;cAAE,GAAGiO;YAAqB,CAAC,GAAGH,QAAQ;YACnD,MAAMH,IAAI,CAACO,QAAQ;cAAA,IAAAC,MAAA,GAAAvM,iBAAA,CAAC,WAAOwM,eAAe,EAAK;gBAC7C,MAAMC,iBAAiB,SAASpE,UAAU,CAACqE,gBAAgB,GAAGF,eAAe,CAAC;gBAC9E,MAAMrV,KAAK,GAAG,WAAW,IAAIsV,iBAAiB,GAAGA,iBAAiB,CAACva,IAAI,GAAGua,iBAAiB;gBAC3F,OAAOtV,KAAK,EAAE6T,IAAI,GAAG,CAAC;cACxB,CAAC;cAAA,iBAAA2B,GAAA;gBAAA,OAAAJ,MAAA,CAAA/L,KAAA,OAAAC,SAAA;cAAA;YAAA,KAAE4L,oBAAoB,CAAC;YACxB,MAAMO,WAAW,SAAS/K,KAAK,CAACqK,QAAQ,EAAE,GAAGC,QAAQ,CAAC;YACtD,MAAMJ,IAAI,CAACO,QAAQ;cAAA,IAAAO,MAAA,GAAA7M,iBAAA,CAAC,WAAOwM,eAAe,EAAK;gBAC7C,MAAMC,iBAAiB,SAASpE,UAAU,CAACqE,gBAAgB,GAAGF,eAAe,CAAC;gBAC9E,MAAMrV,KAAK,GAAG,WAAW,IAAIsV,iBAAiB,GAAGA,iBAAiB,CAACva,IAAI,GAAGua,iBAAiB;gBAC3F,MAAM7C,aAAa,GAAGa,QAAQ,CAACqC,aAAa,CAAC,OAAO,CAAC;gBACrD,OAAO3V,KAAK,EAAEiE,IAAI,GAAG;kBAAEwO;gBAAc,CAAC,CAAC;cACzC,CAAC;cAAA,iBAAAmD,IAAA;gBAAA,OAAAF,MAAA,CAAArM,KAAA,OAAAC,SAAA;cAAA;YAAA,KAAE4L,oBAAoB,CAAC;YACxB,OAAOO,WAAW;UACpB,CAAC;UAAA,iBAAAI,GAAA;YAAA,OAAAf,MAAA,CAAAzL,KAAA,OAAAC,SAAA;UAAA;QAAA,IAAC;MACJ,CAAC;MAAA,iBAAAwM,GAAA,EAAAC,GAAA;QAAA,OAAApB,MAAA,CAAAtL,KAAA,OAAAC,SAAA;MAAA;IAAA,KAAE,OAAO;EACZ,CAAC,CAAC;AACJ;AACAhX,MAAM,CAACkiB,oBAAoB,EAAE,sBAAsB,CAAC;AAAC,SACtCd,QAAQA,CAAAsC,IAAA,EAAAC,IAAA;EAAA,OAAAC,SAAA,CAAA7M,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAA4M,UAAA;EAAAA,SAAA,GAAArN,iBAAA,CAAvB,WAAwB7I,KAAK,EAAEhI,OAAO,EAAE;IACtC,KAAK,MAAMY,QAAQ,IAAI,CAAC,GAAG8Y,QAAQ,CAAC,CAAC3H,OAAO,CAAC,CAAC,EAAE;MAC9C,MAAMnR,QAAQ,CAAC,CAAC;IAClB;IACA8Y,QAAQ,CAACtZ,MAAM,GAAG,CAAC;IACnB,IAAI,CAACJ,OAAO,CAACya,aAAa,EAAE;MAC1B,MAAM0D,SAAS,GAAG7C,QAAQ,CAAC8C,aAAa,CAAC,KAAK,CAAC;MAC/ClF,UAAU,EAAEoC,QAAQ,EAAEC,IAAI,EAAE8C,WAAW,CAACF,SAAS,CAAC;MAClDne,OAAO,CAACya,aAAa,GAAG0D,SAAS;MACjCzE,QAAQ,CAAC1Y,IAAI,CAAC,MAAM;QAClB,IAAIkY,UAAU,EAAEoC,QAAQ,EAAEC,IAAI,EAAE+C,QAAQ,CAACH,SAAS,CAAC,EAAE;UACnDjF,UAAU,EAAEoC,QAAQ,EAAEC,IAAI,EAAEgD,WAAW,CAACJ,SAAS,CAAC;QACpD;MACF,CAAC,CAAC;IACJ;IACAne,OAAO,CAAC8Q,MAAM,SAAS9I,KAAK,CAAC2I,YAAY,CAAC3Q,OAAO,CAAC;IAClD,IAAIA,OAAO,CAAC+Q,WAAW,CAACC,OAAO,EAAE;MAC/B;IACF;IACA0I,QAAQ,CAAC1Y,IAAI,CAAC,GAAG,OAAOgH,KAAK,CAACuJ,eAAe,CAACvR,OAAO,CAAC,EAAEmG,MAAM,CAACsR,OAAO,CAAC,CAAC;IACxE,MAAM/I,YAAY,GAAG1G,KAAK,CAAC0G,YAAY;IACvC,MAAM8P,mBAAmB,GAAGxW,KAAK,CAACsK,SAAS;IAC3C,IAAI,CAACkM,mBAAmB,EAAE;MACxB,MAAMxe,OAAO,CAAC0S,KAAK,CAAC,CAAC;IACvB;IACA,IAAI1S,OAAO,CAAC+Q,WAAW,CAACC,OAAO,EAAE;MAC/B;IACF;IACA,IAAItC,YAAY,EAAE;MAChB,IAAI,CAAC8P,mBAAmB,EAAE;QACxBxe,OAAO,CAAC0S,KAAK,gBAAA7B,iBAAA,CAAG,aAAY;UAC1B,MAAM,IAAIyH,4BAA4B,CAAC;YAAE5J,YAAY,EAAEA,YAAY,CAACG,QAAQ,CAAC;UAAE,CAAC,CAAC;QACnF,CAAC;MACH;MACA,MAAMH,YAAY,CAAC1O,OAAO,CAAC;IAC7B;IACA,IAAIye,OAAO;IACX,IAAIjlB,iBAAiB,CAAC,CAAC,EAAE;MACvBilB,OAAO,GAAGhlB,eAAe,CAAC,CAAC;IAC7B,CAAC,MAAM;MACL,MAAMC,iBAAiB,CAACsG,OAAO,CAAC+Q,WAAW,CAAC;IAC9C;IACA,MAAM/I,KAAK,CAAC4J,cAAc,CAAC5R,OAAO,CAAC;IACnC,MAAMye,OAAO,GAAG,CAAC;EACnB,CAAC;EAAA,OAAAP,SAAA,CAAA7M,KAAA,OAAAC,SAAA;AAAA;AACDhX,MAAM,CAACohB,QAAQ,EAAE,UAAU,CAAC;;AAE5B;AACA,IAAIgD,cAAc,GAAG,GAAG;AACxB,IAAIC,gBAAgB,GAAG,GAAG;AAC1B,IAAIC,WAAW,GAAG,MAAMA,WAAW,CAAC;EAClC7jB,WAAWA,CAAC8jB,UAAU,EAAEC,QAAQ,EAAE9Q,kBAAkB,EAAE;IACpD,IAAI,CAAC8Q,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACD,UAAU,GAAG,IAAIzU,eAAe,CAACyU,UAAU,CAAC;IACjD,IAAI,CAAC7Q,kBAAkB,GAAGoI,2BAA2B,CACnD4B,cAAc,CAAC,CAAC,GAAGvT,mBAAmB,CAAC,CAAC,EAAEuJ,kBAAkB,CAAC,CAC/D,CAAC;IACD,MAAM;MAAElF,cAAc;MAAED;IAAY,CAAC,GAAG,IAAI,CAACmF,kBAAkB;IAC/D,IAAI,CAACzP,IAAI,GAAG,IAAIkK,SAAS,CAAC,CAAC;IAC3B,IAAI,CAACsW,WAAW,GAAG,IAAI5V,YAAY,CAAC;MAAErF,OAAO,EAAEgF,cAAc;MAAED;IAAY,CAAC,CAAC;IAC7E,IAAI,CAACrK,KAAK,GAAG,CAAC,CAAC;IACf,IAAI,CAACiT,gBAAgB,GAAG,CAAC,CAAC;IAC1B,IAAI,CAACuN,uBAAuB,GAAG,CAAC,CAAC,EAAEpa,oBAAoB,CAAC2E,OAAO,EAAEmV,cAAc,CAAC,CAACtR,cAAc,CAAC;IAChG,IAAI,CAAC6R,oBAAoB,GAAG,CAAC,CAAC,EAAEra,oBAAoB,CAAC2E,OAAO,EAAEmV,cAAc,CAAC,CAAC7L,WAAW,CAAC;IAC1F,IAAI,CAACqM,qBAAqB,GAAG,CAAC,CAAC,EAAEta,oBAAoB,CAAC2E,OAAO,EAAEoV,gBAAgB,CAAC,CAACpO,YAAY,CAAC;EAChG;EACAiJ,qBAAqBA,CAACxL,kBAAkB,EAAE;IACxC,IAAI,CAACA,kBAAkB,GAAGoI,2BAA2B,CAACpI,kBAAkB,CAAC;IACzE,MAAM;MAAElF,cAAc;MAAED;IAAY,CAAC,GAAGmF,kBAAkB;IAC1D,IAAI,CAAC+Q,WAAW,CAAC/f,GAAG,CAAC;MAAE8E,OAAO,EAAEgF,cAAc;MAAED;IAAY,CAAC,CAAC;EAChE;EACA;EACA;EACA;EACA;EACMsW,gBAAgBA,CAAAC,IAAA,EAGnB;IAAA,IAAAC,MAAA;IAAA,OAAAxO,iBAAA,YAHoB;MACrBiO,QAAQ;MACRD;IACF,CAAC;MACC,IAAIC,QAAQ,EAAE;QACZO,MAAI,CAACP,QAAQ,GAAGA,QAAQ;MAC1B;MACA,IAAID,UAAU,EAAE;QACdQ,MAAI,CAACR,UAAU,CAAC/b,OAAO,GAAG+b,UAAU,CAAC/b,OAAO;MAC9C;MACA,IAAIuc,MAAI,CAACC,cAAc,EAAE;QACvB,MAAMD,MAAI,CAACE,gBAAgB,CAAC,CAAC;MAC/B;IAAC,GAAAlO,KAAA,OAAAC,SAAA;EACH;EACA;EACMrH,cAAcA,CAAChN,OAAO,EAAE;IAAA,IAAAuiB,MAAA;IAAA,OAAA3O,iBAAA;MAC5B,OAAO2O,MAAI,CAACX,UAAU,CAAC5U,cAAc,CAAChN,OAAO,CAAC;IAAC;EACjD;EACA;EACMwiB,oBAAoBA,CAACxiB,OAAO,EAAE;IAAA,IAAAyiB,MAAA;IAAA,OAAA7O,iBAAA;MAClC,MAAM;QAAEnH,UAAU;QAAEM;MAAM,CAAC,GAAG0V,MAAI,CAACb,UAAU,CAAC5U,cAAc,CAAChN,OAAO,CAAC;MACrE,MAAMoQ,aAAa,SAASqS,MAAI,CAACZ,QAAQ,CAACpV,UAAU,CAAC;MACrD,OAAOgW,MAAI,CAACV,uBAAuB,CAAC3R,aAAa,EAAE3D,UAAU,EAAEM,KAAK,CAAC;IAAC;EACxE;EACM2V,eAAeA,CAAA,EAAG;IAAA,IAAAC,MAAA;IAAA,OAAA/O,iBAAA;MACtB,MAAMgP,WAAW,GAAG,CAAC,CAAC;MACtBhd,MAAM,CAACC,OAAO,CAAC8c,MAAI,CAACf,UAAU,CAAC/b,OAAO,CAAC,CAACrF,OAAO,CAAC,CAAC,CAACR,OAAO,EAAE;QAAEyM;MAAW,CAAC,CAAC,KAAK;QAC7EmW,WAAW,CAACnW,UAAU,CAAC,GAAGzM,OAAO;MACnC,CAAC,CAAC;MACF,MAAM6iB,IAAI,SAASvkB,OAAO,CAAC2V,GAAG,CAC5BrO,MAAM,CAACC,OAAO,CAAC+c,WAAW,CAAC,CAAC/f,GAAG;QAAA,IAAAigB,MAAA,GAAAlP,iBAAA,CAAC,WAAO,CAACnH,UAAU,EAAEzM,OAAO,CAAC;UAAA,OAAM;YAChEyM,UAAU;YACVyE,OAAO,QAAQyR,MAAI,CAACH,oBAAoB,CAACxiB,OAAO;UAClD,CAAC;QAAA,CAAC;QAAA,iBAAA+iB,IAAA;UAAA,OAAAD,MAAA,CAAA1O,KAAA,OAAAC,SAAA;QAAA;MAAA,IACJ,CAAC;MACD,OAAOwO,IAAI,CAACxa,MAAM,CAChB,CAACC,GAAG,EAAE;QAAEmE,UAAU;QAAEyE;MAAQ,CAAC,KAAK;QAChC5I,GAAG,CAACmE,UAAU,CAAC,GAAGyE,OAAO;QACzB,OAAO5I,GAAG;MACZ,CAAC,EACD,CAAC,CACH,CAAC;IAAC;EACJ;EACMga,gBAAgBA,CAAA,EAAG;IAAA,IAAAU,MAAA;IAAA,OAAApP,iBAAA;MACvBoP,MAAI,CAACX,cAAc,SAASW,MAAI,CAACN,eAAe,CAAC,CAAC;IAAC;EACrD;EACAO,uBAAuBA,CAAC;IAAE/R;EAAQ,CAAC,EAAE;IACnC,MAAMqC,oBAAoB,GAAGrC,OAAO,CAAC5C,IAAI;IACzC,OAAO,IAAI,CAAC0T,oBAAoB,CAC9BzO,oBAAoB,EACpB,IAAI,CAACxC,kBAAkB,EACvBG,OAAO,CAACd,aAAa,CAAC9D,OACxB,CAAC;EACH;EACA;EACM4W,SAASA,CAAAC,IAAA,EAAc;IAAA,IAAAC,MAAA;IAAA,OAAAxP,iBAAA,YAAb;MAAE5T;IAAQ,CAAC;MACzB,MAAMkR,OAAO,SAASkS,MAAI,CAACZ,oBAAoB,CAACxiB,OAAO,CAAC;MACxD,OAAOojB,MAAI,CAACC,gBAAgB,CAAC;QAAErjB,OAAO;QAAEkR;MAAQ,CAAC,CAAC;IAAC,GAAAkD,KAAA,OAAAC,SAAA;EACrD;EACA;EACA;EACAgP,gBAAgBA,CAAC;IACfrjB,OAAO;IACPkR;EACF,CAAC,EAAE;IACD,MAAM7C,gBAAgB,GAAG6C,OAAO,CAACP,OAAO,CAAC3Q,OAAO,CAAC;IACjD,IAAI,CAACqO,gBAAgB,EAAE;MACrB,MAAM,IAAI3G,4BAA4B,CAAC;QAAE1H;MAAQ,CAAC,CAAC;IACrD;IACA,MAAMuT,oBAAoB,GAAGrC,OAAO,CAAC5C,IAAI;IACzC,MAAMvD,KAAK,GAAG,IAAI,CAACkX,qBAAqB,CACtC5T,gBAAgB,EAChBkF,oBAAoB,EACpBrC,OAAO,CAACH,kBAAkB,IAAI,IAAI,CAACA,kBACrC,CAAC;IACD,IAAI,CAACzP,IAAI,CAACwJ,UAAU,CAACC,KAAK,CAAC;IAC3B,IAAI,CAACxJ,KAAK,CAACwJ,KAAK,CAAC9K,EAAE,CAAC,GAAG,IAAI,CAACsB,KAAK,CAACwJ,KAAK,CAAC9K,EAAE,CAAC,IAAI,IAAIiB,YAAY,CAAC,CAAC;IACjE,OAAO6J,KAAK;EACd;EACA;EACAuY,2BAA2BA,CAAC;IAC1BpS;EACF,CAAC,EAAE;IACD,OAAOtL,MAAM,CAACI,IAAI,CAAC,IAAI,CAAC4b,UAAU,CAAC/b,OAAO,CAAC,CAACqD,MAAM,CAAElJ,OAAO,IAAK,CAAC,CAACkR,OAAO,CAACP,OAAO,CAAC3Q,OAAO,CAAC,CAAC,CAAC6C,GAAG,CAAE7C,OAAO,IAAK,IAAI,CAACqjB,gBAAgB,CAAC;MAAErjB,OAAO;MAAEkR;IAAQ,CAAC,CAAC,CAAC;EAC3J;EACMqS,SAASA,CAACtjB,EAAE,EAAE;IAAA,IAAAujB,MAAA;IAAA,OAAA5P,iBAAA;MAClB,MAAMpH,KAAK,SAASgX,MAAI,CAACxW,cAAc,CAAC/M,EAAE,CAAC;MAC3C,MAAMwjB,YAAY,GAAGjX,KAAK,CAAC1G,IAAI,KAAK,MAAM,GAAG0G,KAAK,CAACkX,cAAc,GAAG,EAAE;MACtE,MAAM,CAACC,YAAY,EAAE,GAAGC,QAAQ,CAAC,SAAStlB,OAAO,CAAC2V,GAAG,CAAC,CACpDuP,MAAI,CAAC3B,QAAQ,CAACrV,KAAK,CAACC,UAAU,CAAC,EAC/B,GAAGgX,YAAY,CAAC5gB,GAAG,CAAEghB,eAAe,IAAK;QACvC,MAAMC,eAAe,GAAGN,MAAI,CAAC5B,UAAU,CAAC1U,iBAAiB,CAAC2W,eAAe,CAAC;QAC1E,OAAOL,MAAI,CAAChB,oBAAoB,CAACsB,eAAe,CAAC7jB,EAAE,CAAC;MACtD,CAAC,CAAC,CACH,CAAC;MACF,OAAO;QAAE0jB,YAAY;QAAEC;MAAS,CAAC;IAAC;EACpC;EACA;EACA;EACAG,eAAeA,CAAChZ,KAAK,EAAE;IAAEiZ,gBAAgB,GAAG;EAAM,CAAC,GAAG,CAAC,CAAC,EAAE;IACxD,MAAMlC,WAAW,GAAG,IAAI,CAACA,WAAW,CAAChgB,GAAG,CAAC,CAAC;IAC1C,MAAM;MAAE+J;IAAe,CAAC,GAAG,IAAI,CAACiW,WAAW;IAC3C,MAAM7E,SAAS,GAAG,IAAItB,WAAW,CAAC,CAAC;IACnC,OAAO5E,cAAc,CAAC;MACpB,GAAGhM,KAAK;MACRzJ,IAAI,EAAE0iB,gBAAgB,GAAGjZ,KAAK,CAACC,WAAW,GAAG,IAAI,CAAC1J,IAAI,CAACQ,GAAG,CAACiJ,KAAK,CAAC9K,EAAE,CAAC;MACpE4L,cAAc;MACdD,WAAW,EAAE,IAAI,CAACmF,kBAAkB,CAACnF,WAAW;MAChDkW,WAAW;MACX7E,SAAS;MACTpW,OAAO,EAAE;QACP,GAAGib,WAAW;QACd,GAAG/W,KAAK,CAAC4K;MACX,CAAC;MACDpU,KAAK,EAAE,IAAI,CAACA,KAAK,CAACwJ,KAAK,CAAC9K,EAAE;IAC5B,CAAC,CAAC;EACJ;EACAgkB,mBAAmBA,CAAClZ,KAAK,EAAE,GAAGmZ,SAAS,EAAE;IACvC,IAAI,CAAC1P,gBAAgB,CAACzJ,KAAK,CAAC9K,EAAE,CAAC,GAAG,CAAC,IAAI,CAACuU,gBAAgB,CAACzJ,KAAK,CAAC9K,EAAE,CAAC,IAAI,EAAE,EAAEkK,MAAM,CAAC+Z,SAAS,CAAC;EAC7F;EACMC,YAAYA,CAACpZ,KAAK,EAAE;IAAA,IAAAqZ,MAAA;IAAA,OAAAxQ,iBAAA;MACxBwQ,MAAI,CAAC7iB,KAAK,CAACwJ,KAAK,CAAC9K,EAAE,CAAC,CAACM,KAAK,CAAC,CAAC;MAC5B,MAAM2jB,SAAS,GAAGE,MAAI,CAAC5P,gBAAgB,CAACzJ,KAAK,CAAC9K,EAAE,CAAC;MACjD,IAAIikB,SAAS,EAAE;QACb,KAAK,MAAMvgB,QAAQ,IAAI,CAAC,GAAGugB,SAAS,CAAC,CAACpP,OAAO,CAAC,CAAC,EAAE;UAC/C,MAAMnR,QAAQ,CAAC,CAAC;QAClB;MACF;MACA,OAAOygB,MAAI,CAAC5P,gBAAgB,CAACzJ,KAAK,CAAC9K,EAAE,CAAC;IAAC;EACzC;EACAokB,OAAOA,CAACjd,OAAO,GAAG;IAAEkd,eAAe,EAAE;EAAM,CAAC,EAAE;IAC5C,MAAM;MAAEjC;IAAe,CAAC,GAAG,IAAI;IAC/BkC,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEnC,cAAc,CAAC;IAC1D,IAAI,CAACA,cAAc,EAAE;MACnB,MAAM,IAAI5a,yBAAyB,CAAC,CAAC;IACvC;IACA,MAAMkJ,OAAO,GAAG/K,MAAM,CAACC,OAAO,CAAC,IAAI,CAAC+b,UAAU,CAAC/b,OAAO,CAAC,CAACwC,MAAM,CAC5D,CAACC,GAAG,EAAE,CAACtI,OAAO,EAAEwM,KAAK,CAAC,KAAK;MACzB,IAAIA,KAAK,CAAC1G,IAAI,KAAK,MAAM,EAAE;QACzB,OAAOwC,GAAG;MACZ;MACA,MAAM4I,OAAO,GAAGmR,cAAc,CAAC7V,KAAK,CAACC,UAAU,CAAC;MAChD,MAAM1B,KAAK,GAAG,IAAI,CAACsY,gBAAgB,CAAC;QAAErjB,OAAO;QAAEkR;MAAQ,CAAC,CAAC;MACzD,IAAI,CAAC9J,OAAO,CAACkd,eAAe,IAAIvZ,KAAK,CAACzE,UAAU,CAACme,QAAQ,EAAE;QACzD,OAAOnc,GAAG;MACZ;MACAA,GAAG,CAACtI,OAAO,CAAC,GAAG4F,MAAM,CAACC,OAAO,CAACkF,KAAK,CAAC,CAAC1C,MAAM,CACzC,CAACqc,QAAQ,EAAE,CAAChc,GAAG,EAAEN,KAAK,CAAC,KAAK;QAC1B,IAAIM,GAAG,KAAK,OAAO,IAAI8D,KAAK,CAACmY,OAAO,KAAK,MAAM,EAAE;UAC/C,OAAO;YAAE,GAAGD,QAAQ;YAAE3Z,KAAK,EAAEyB,KAAK,CAACoY;UAAW,CAAC;QACjD;QACA,IAAIlc,GAAG,KAAK,cAAc,EAAE;UAC1B,OAAOgc,QAAQ;QACjB;QACA,IAAI,OAAOtc,KAAK,KAAK,UAAU,EAAE;UAC/B,OAAOsc,QAAQ;QACjB;QACA,IAAI9gB,KAAK,CAACC,OAAO,CAACuE,KAAK,CAAC,EAAE;UACxB,OAAOxC,MAAM,CAACgD,MAAM,CAAC8b,QAAQ,EAAE;YAAE,CAAChc,GAAG,GAAGN,KAAK,CAAC6J,KAAK,CAAC,CAAC,CAAC4S,IAAI,CAAC;UAAE,CAAC,CAAC;QACjE;QACA,OAAOjf,MAAM,CAACgD,MAAM,CAAC8b,QAAQ,EAAE;UAAE,CAAChc,GAAG,GAAGN;QAAM,CAAC,CAAC;MAClD,CAAC,EACD;QACE9G,IAAI,EAAEyJ,KAAK,CAACC,WAAW;QACvBnE,OAAO,EAAE;UACP,GAAG,IAAI,CAACib,WAAW,CAACjW,cAAc;UAClC,GAAG,IAAI,CAACiW,WAAW,CAACjb,OAAO;UAC3B,GAAGkE,KAAK,CAAC4K;QACX,CAAC;QACD3V,OAAO,EAAEwM,KAAK,CAACsY,MAAM,GAAGtY,KAAK,CAACsY,MAAM,GAAG9kB;MACzC,CACF,CAAC;MACD,OAAOsI,GAAG;IACZ,CAAC,EACD,CAAC,CACH,CAAC;IACDic,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAE7T,OAAO,CAAC;IACxC,OAAOA,OAAO;EAChB;AACF,CAAC;AACDtT,MAAM,CAACskB,WAAW,EAAE,YAAY,CAAC;AACjC,IAAIoD,UAAU,GAAGpD,WAAW;;AAE5B;AACA,SAAS/Z,IAAI,IAAIod,KAAK,QAAQ,kCAAkC;;AAEhE;AACA,SAASC,KAAKA,CAACC,IAAI,EAAE;EACnB,MAAMC,oBAAoB,GAAGD,IAAI,CAACpY,UAAU,CAAC,SAAS,CAAC;EACvD,IAAIqY,oBAAoB,EAAE;IACxB,OAAOD,IAAI;EACb;EACA,OAAOA,IAAI,CAAChT,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;AACjC;AACA7U,MAAM,CAAC4nB,KAAK,EAAE,OAAO,CAAC;;AAEtB;AACA,IAAIG,SAAS,GAAG,eAAgB/nB,MAAM,CAAEgoB,KAAK,IAAK;EAChD,IAAIA,KAAK,CAACliB,MAAM,KAAK,CAAC,EAAE;IACtB,OAAOkiB,KAAK;EACd;EACA,MAAMC,IAAI,GAAGD,KAAK,CAACA,KAAK,CAACliB,MAAM,GAAG,CAAC,CAAC;EACpC,MAAMoiB,YAAY,GAAGD,IAAI,EAAEpT,OAAO,CAAC,uCAAuC,EAAE,EAAE,CAAC;EAC/E,IAAImT,KAAK,CAACliB,MAAM,KAAK,CAAC,EAAE;IACtB,OAAO,CAACoiB,YAAY,CAAC;EACvB;EACA,MAAMC,UAAU,GAAGH,KAAK,CAACA,KAAK,CAACliB,MAAM,GAAG,CAAC,CAAC;EAC1C,IAAIoiB,YAAY,IAAIC,UAAU,IAAID,YAAY,CAACE,WAAW,CAAC,CAAC,KAAKD,UAAU,CAACC,WAAW,CAAC,CAAC,EAAE;IACzF,OAAO,CAAC,GAAGJ,KAAK,CAACpT,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAEsT,YAAY,CAAC;EAC9C;EACA,OAAOA,YAAY,KAAK,8BAA8B,CAAC3M,IAAI,CAAC0M,IAAI,CAAC,IAAI,UAAU,CAAC1M,IAAI,CAAC2M,YAAY,CAAC,CAAC,GAAGF,KAAK,CAACpT,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGoT,KAAK,CAACpT,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAEsT,YAAY,CAAC;AAClK,CAAC,EAAE,UAAU,CAAC;AACd,SAASG,QAAQA,CAACC,KAAK,EAAE;EACvB,OAAOA,KAAK,CAACC,OAAO,CAAEC,CAAC,IAAKA,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC5c,MAAM,CAACsR,OAAO,CAAC,CAACzQ,IAAI,CAAC,GAAG,CAAC;AACrE;AACA1M,MAAM,CAACqoB,QAAQ,EAAE,UAAU,CAAC;AAC5B,IAAIK,4BAA4B,GAAG,eAAgB1oB,MAAM,CAAC,CAACuS,QAAQ,EAAEpD,KAAK,EAAEwZ,SAAS,KAAK;EACxF,MAAM;IAAEC,SAAS;IAAEC,iBAAiB;IAAEC,WAAW,GAAG;EAAG,CAAC,GAAG3Z,KAAK,IAAI,CAAC,CAAC;EACtE,IAAI,OAAOoD,QAAQ,KAAK,QAAQ,EAAE;IAChCoV,KAAK,CAAClhB,IAAI,CAAC1G,MAAM;AACrB;AACA;AACA;AACA,KAAK,CAAC;EACJ;EACA,MAAMgpB,kBAAkB,GAAGnB,KAAK,CAAC/c,MAAM,CAAC0H,QAAQ,CAAC,CAAC;EAClD,IAAIsW,iBAAiB,CAACG,IAAI,CAACD,kBAAkB,CAAC,EAAE;IAC9C,IAAI,CAACJ,SAAS,EAAE;MACd,MAAMM,MAAM,GAAGF,kBAAkB,CAAClU,OAAO,CAAC+T,SAAS,EAAE,EAAE,CAAC;MACxD,IAAIZ,KAAK,GAAGK,QAAQ,CAAC,CAACS,WAAW,EAAEG,MAAM,CAAC,CAAC,CAACR,KAAK,CAAC,GAAG,CAAC;MACtDT,KAAK,GAAGD,SAAS,CAACC,KAAK,CAAC;MACxB,OAAOA,KAAK,CAACtb,IAAI,CAAC,GAAG,CAAC;IACxB;IACA,IAAI,CAACoc,WAAW,EAAE;MAChB,OAAOH,SAAS;IAClB;IACA,OAAON,QAAQ,CAAC,CAACS,WAAW,EAAEH,SAAS,CAAC,CAAC;EAC3C;EACA,OAAO,KAAK,CAAC;AACf,CAAC,EAAE,8BAA8B,CAAC;AAClC,IAAIO,eAAe,GAAG,eAAgBlpB,MAAM,CAAC,CAACuS,QAAQ,EAAE4W,cAAc,EAAER,SAAS,KAAK;EACpF,KAAK,IAAI1iB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGkjB,cAAc,CAACrjB,MAAM,EAAEG,CAAC,IAAI,CAAC,EAAE;IACjD,MAAMyJ,KAAK,GAAGgZ,4BAA4B,CAACnW,QAAQ,EAAE4W,cAAc,CAACljB,CAAC,CAAC,EAAE0iB,SAAS,CAAC;IAClF,IAAIjZ,KAAK,EAAE;MACT,OAAOA,KAAK;IACd;EACF;EACA,OAAOiZ,SAAS,IAAI,KAAK,CAAC;AAC5B,CAAC,EAAE,iBAAiB,CAAC;;AAErB;AACA,IAAIS,yBAAyB,GAAG,UAAU;AAC1C,IAAIxW,SAAS,GAAG,eAAgB5S,MAAM,CAAC,CAAC+J,OAAO,GAAG,CAAC,CAAC,KAAK,CAACsf,CAAC,EAAEC,CAAC,KAAK;EACjE,IAAID,CAAC,CAAC3Z,KAAK,KAAK4Z,CAAC,CAAC5Z,KAAK,IAAI,CAAC3F,OAAO,CAACwf,YAAY,EAAE;IAChD,OAAO,CAAC;EACV;EACA,MAAMC,MAAM,GAAGzf,OAAO,CAACyf,MAAM,IAAI,WAAW;EAC5C,IAAIC,KAAK,GAAG1f,OAAO,CAAC0f,KAAK,IAAI,EAAE;EAC/B,MAAMC,WAAW,GAAGL,CAAC,CAAC3Z,KAAK,CAAC2F,IAAI,CAAC,CAAC,CAACoT,KAAK,CAACW,yBAAyB,CAAC;EACnE,MAAMO,WAAW,GAAGL,CAAC,CAAC5Z,KAAK,CAAC2F,IAAI,CAAC,CAAC,CAACoT,KAAK,CAACW,yBAAyB,CAAC;EACnE,IAAIrf,OAAO,CAACwf,YAAY,EAAE;IACxBG,WAAW,CAAChjB,IAAI,CAAC2iB,CAAC,CAAC9kB,IAAI,CAAC;IACxBolB,WAAW,CAACjjB,IAAI,CAAC4iB,CAAC,CAAC/kB,IAAI,CAAC;EAC1B;EACA,IAAIqlB,KAAK,GAAG,CAAC;EACb,OAAOF,WAAW,CAACE,KAAK,CAAC,IAAID,WAAW,CAACC,KAAK,CAAC,EAAE;IAC/C,IAAI,CAACF,WAAW,CAACE,KAAK,CAAC,EAAE;MACvB,OAAO,CAAC,CAAC;IACX;IACA,IAAI,CAACD,WAAW,CAACC,KAAK,CAAC,EAAE;MACvB,OAAO,CAAC;IACV;IACA,MAAMC,KAAK,GAAGH,WAAW,CAACE,KAAK,CAAC;IAChC,MAAME,KAAK,GAAGH,WAAW,CAACC,KAAK,CAAC;IAChC,IAAIC,KAAK,KAAKC,KAAK,EAAE;MACnB,IAAIC,MAAM,GAAGN,KAAK,CAACO,OAAO,CAACH,KAAK,CAAC;MACjC,IAAII,MAAM,GAAGR,KAAK,CAACO,OAAO,CAACF,KAAK,CAAC;MACjC,MAAMI,aAAa,GAAGT,KAAK,CAACO,OAAO,CAAC,GAAG,CAAC;MACxC,IAAID,MAAM,KAAK,CAAC,CAAC,IAAIE,MAAM,KAAK,CAAC,CAAC,EAAE;QAClC,IAAIF,MAAM,KAAK,CAAC,CAAC,EAAE;UACjB,IAAIG,aAAa,KAAK,CAAC,CAAC,EAAE;YACxBH,MAAM,GAAGG,aAAa;UACxB,CAAC,MAAM;YACLH,MAAM,GAAGN,KAAK,CAAC3jB,MAAM;UACvB;QACF;QACA,IAAImkB,MAAM,KAAK,CAAC,CAAC,EAAE;UACjB,IAAIC,aAAa,KAAK,CAAC,CAAC,EAAE;YACxBD,MAAM,GAAGC,aAAa;UACxB,CAAC,MAAM;YACLD,MAAM,GAAGR,KAAK,CAAC3jB,MAAM;UACvB;QACF;QACA,OAAOikB,MAAM,GAAGE,MAAM;MACxB;MACA,IAAIT,MAAM,KAAK,WAAW,EAAE;QAC1B,OAAO,CAAC;MACV;MACA,OAAOK,KAAK,CAACM,aAAa,CAACL,KAAK,EAAE/f,OAAO,CAACqgB,OAAO,GAAGrgB,OAAO,CAACqgB,OAAO,GAAG,KAAK,CAAC,EAAE;QAC5EC,OAAO,EAAE,IAAI;QACbC,WAAW,EAAE;MACf,CAAC,CAAC;IACJ;IACA,IAAInf,KAAK,GAAGse,KAAK,CAACO,OAAO,CAACH,KAAK,CAAC;IAChC,IAAI1e,KAAK,KAAK,CAAC,CAAC,EAAE;MAChBA,KAAK,GAAGse,KAAK,CAACO,OAAO,CAAC,GAAG,CAAC;IAC5B;IACAP,KAAK,GAAGte,KAAK,KAAK,CAAC,CAAC,IAAI5E,KAAK,CAACC,OAAO,CAACijB,KAAK,CAACte,KAAK,GAAG,CAAC,CAAC,CAAC,GAAGse,KAAK,CAACte,KAAK,GAAG,CAAC,CAAC,GAAG,EAAE;IAC/Eye,KAAK,IAAI,CAAC;EACZ;EACA,OAAO,CAAC;AACV,CAAC,EAAE,WAAW,CAAC;;AAEf;AACA,IAAIW,iBAAiB,GAAG,eAAgBvqB,MAAM,CAAC,CAACsT,OAAO,EAAEkX,kBAAkB,EAAEC,aAAa,KAAK;EAC7F,IAAID,kBAAkB,EAAE;IACtB,IAAIE,MAAM;IACV,IAAI,OAAOF,kBAAkB,KAAK,UAAU,EAAE;MAC5CE,MAAM,GAAGF,kBAAkB;IAC7B,CAAC,MAAM;MACLE,MAAM,GAAG9X,SAAS,CAAC4X,kBAAkB,CAAC;IACxC;IACAlX,OAAO,CAACkU,IAAI,CAACkD,MAAM,CAAC;EACtB,CAAC,MAAM;IACLpX,OAAO,CAACkU,IAAI,CACV,CAACmD,EAAE,EAAEC,EAAE,KAAKH,aAAa,CAACT,OAAO,CAACW,EAAE,CAACvb,UAAU,CAAC,GAAGqb,aAAa,CAACT,OAAO,CAACY,EAAE,CAACxb,UAAU,CACxF,CAAC;EACH;EACA,OAAOkE,OAAO;AAChB,CAAC,EAAE,mBAAmB,CAAC;AACvB,IAAIuX,aAAa,GAAG,eAAgB7qB,MAAM,CAAC,CAACsT,OAAO,EAAEkX,kBAAkB,EAAEC,aAAa,KAAK;EACzF,IAAI;IACF,OAAOF,iBAAiB,CAACjX,OAAO,EAAEkX,kBAAkB,EAAEC,aAAa,CAAC;EACtE,CAAC,CAAC,OAAOK,GAAG,EAAE;IACZ,MAAM,IAAI/lB,KAAK,CAAChF,MAAM;AAC1B,gDAAgDyqB,kBAAkB;AAClE;AACA,QAAQM,GAAG,CAACC,OAAO;AACnB;AACA;AACA;AACA;AACA,GAAG,CAAC;EACF;AACF,CAAC,EAAE,eAAe,CAAC;;AAEnB;AACA,SAASva,SAAS,IAAIwa,UAAU,EAAEzpB,MAAM,IAAI0pB,OAAO,QAAQ,kCAAkC;AAC7F,SACEC,qBAAqB,EACrBC,sBAAsB,EACtBC,YAAY,EACZC,aAAa,EACb7pB,eAAe,IAAI8pB,gBAAgB,EACnCC,eAAe,EACfC,mBAAmB,EACnB/pB,gBAAgB,IAAIgqB,iBAAiB,EACrCC,WAAW,EACXC,kBAAkB,EAClBC,iBAAiB,EACjBC,uBAAuB,EACvBlqB,cAAc,IAAImqB,eAAe,EACjClqB,iBAAiB,IAAImqB,kBAAkB,QAClC,gCAAgC;AACvC,SACEC,4CAA4C,EAC5CC,0BAA0B,EAC1BC,oBAAoB,EACpBC,2CAA2C,QACtC,mCAAmC;AAC1C,SAASjsB,MAAM,IAAIksB,OAAO,QAAQ,mBAAmB;;AAErD;AACA,SACEC,6BAA6B,EAC7BC,cAAc,EACd5qB,cAAc,IAAI6qB,eAAe,EACjCC,0BAA0B,EAC1BC,8BAA8B,QACzB,gCAAgC;AACvC,SACEzO,4BAA4B,IAAI0O,6BAA6B,EAC7DC,mBAAmB,QACd,mCAAmC;;AAE1C;AACA,IAAIC,eAAe,GAAG,IAAI7nB,KAAK,CAAC,gBAAgB,CAAC;;AAEjD;AACA,IAAI;EAAEgb,eAAe,EAAE8M;AAAiB,CAAC,GAAGjO,UAAU;AACtD,SAASkO,cAAcA,CAAC5gB,KAAK,EAAE;EAC7B,IAAI;IACF,MAAM;MAAE3H,IAAI,GAAG,OAAO;MAAEwmB,OAAO,GAAGlgB,MAAM,CAACqB,KAAK,CAAC;MAAE8I;IAAM,CAAC,GAAG9I,KAAK;IAChE,OAAO;MAAE3H,IAAI;MAAEwmB,OAAO;MAAE/V;IAAM,CAAC;EACjC,CAAC,CAAC,OAAO1N,CAAC,EAAE;IACV,OAAO;MAAE/C,IAAI,EAAE,OAAO;MAAEwmB,OAAO,EAAElgB,MAAM,CAACqB,KAAK;IAAE,CAAC;EAClD;AACF;AACAlM,MAAM,CAAC8sB,cAAc,EAAE,gBAAgB,CAAC;AACxC,IAAIC,YAAY,GAAG,MAAMA,YAAY,CAAC;EACpCtsB,WAAWA,CAACE,OAAO,EAAEqsB,KAAK,EAAEC,cAAc,EAAEpG,SAAS,EAAEjkB,EAAE,EAAEkd,QAAQ,EAAEoN,aAAa,GAAG;IAAEC,QAAQ,EAAE,IAAI;IAAExG,gBAAgB,EAAE;EAAM,CAAC,EAAEjZ,KAAK,EAAE;IACvI,IAAI,CAAC/M,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACqsB,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,cAAc,GAAGA,cAAc;IACpC,IAAI,CAACpG,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACjkB,EAAE,GAAGA,EAAE;IACZ,IAAI,CAACkd,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACoN,aAAa,GAAGA,aAAa;IAClC,IAAI,CAACzkB,IAAI,GAAG,OAAO;IACnB,IAAI,CAAC2kB,cAAc,GAAG,IAAI;IAC1B,IAAI,CAACC,gBAAgB,GAAG,KAAK;IAC7B,IAAI,CAACC,mBAAmB,GAAG,KAAK;IAChC,IAAI,CAACC,cAAc,GAAG,eAAgBvtB,MAAM,CAAC,MAAM,CACnD,CAAC,EAAE,gBAAgB,CAAC;IACpB,IAAI,CAACwtB,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACC,eAAe,GAAG,IAAIZ,gBAAgB,CAAC,CAAC;IAC7C,IAAI,CAACa,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;IAC1B,IAAIlgB,KAAK,EAAE;MACT,IAAI,CAACA,KAAK,GAAGA,KAAK;MAClB,IAAI,CAACmgB,KAAK,GAAG,WAAW;IAC1B;EACF;EACMC,QAAQA,CAAC9N,MAAM,EAAE6N,KAAK,EAAEE,OAAO,EAAE;IAAA,IAAAC,MAAA;IAAA,OAAAzX,iBAAA;MACrCyX,MAAI,CAACH,KAAK,GAAGA,KAAK;MAClBG,MAAI,CAACrtB,OAAO,CAAC0G,IAAI,CAACmlB,0BAA0B,EAAE;QAC5CyB,QAAQ,EAAED,MAAI,CAACH,KAAK;QACpBH,QAAQ,EAAEM,MAAI,CAACN,QAAQ;QACvB/qB,OAAO,EAAEqrB,MAAI,CAACprB;MAChB,CAAC,CAAC;MACF,IAAImrB,OAAO,EAAE;QACX,MAAMA,OAAO,CAAC,CAAC;QACfC,MAAI,CAACE,cAAc,CAAClO,MAAM,CAAC;MAC7B;IAAC;EACH;EACAkO,cAAcA,CAAClO,MAAM,EAAE;IACrB,IAAIA,MAAM,CAACtJ,OAAO,IAAI,CAAC,CAAC,UAAU,EAAE,SAAS,EAAE,SAAS,CAAC,CAAClT,QAAQ,CAAC,IAAI,CAACqqB,KAAK,CAAC,EAAE;MAC9E,IAAI,CAACA,KAAK,GAAG,SAAS;MACtB,IAAI,CAACltB,OAAO,CAAC0G,IAAI,CAACmlB,0BAA0B,EAAE;QAC5CyB,QAAQ,EAAE,IAAI,CAACJ,KAAK;QACpBH,QAAQ,EAAE,IAAI,CAACA,QAAQ;QACvB/qB,OAAO,EAAE,IAAI,CAACC;MAChB,CAAC,CAAC;IACJ;IACA,OAAOod,MAAM,CAACtJ,OAAO;EACvB;EACMyX,OAAOA,CAAA,EAAG;IAAA,IAAAC,MAAA;IAAA,OAAA7X,iBAAA;MACd,MAAM6X,MAAI,CAACN,QAAQ,CAACM,MAAI,CAACX,eAAe,CAACzN,MAAM,EAAE,WAAW,eAAAzJ,iBAAA,CAAE,aAAY;QACxE6X,MAAI,CAAC1gB,KAAK,SAAS0gB,MAAI,CAACpB,KAAK,CAACnH,SAAS,CAAC;UAAEljB,OAAO,EAAEyrB,MAAI,CAACxrB;QAAG,CAAC,CAAC;MAC/D,CAAC,EAAC;MACF,IAAIwrB,MAAI,CAACX,eAAe,CAACzN,MAAM,CAACtJ,OAAO,EAAE;QACvC,MAAM0X,MAAI,CAACpB,KAAK,CAAClG,YAAY,CAACsH,MAAI,CAAC1gB,KAAK,CAAC;QACzC,MAAMkf,eAAe;MACvB;IAAC;EACH;EACA;EACAptB,OAAOA,CAAC6uB,KAAK,EAAE;IACb,OAAO,CAAC,EAAE,IAAI,CAACzrB,EAAE,KAAKyrB,KAAK,CAACzrB,EAAE,IAAI,IAAI,CAAC8K,KAAK,IAAI,IAAI,CAACA,KAAK,KAAK2gB,KAAK,CAAC3gB,KAAK,CAAC;EAC7E;EACA4gB,WAAWA,CAAA,EAAG;IACZ,OAAO,CAAC,WAAW,CAAC,CAAC9qB,QAAQ,CAAC,IAAI,CAACqqB,KAAK,CAAC;EAC3C;EACAU,SAASA,CAAA,EAAG;IACV,OAAO,CAAC,SAAS,EAAE,YAAY,EAAE,WAAW,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC/qB,QAAQ,CAC5E,IAAI,CAACqqB,KACP,CAAC;EACH;EACMW,eAAeA,CAACrO,aAAa,EAAE;IAAA,IAAAsO,OAAA;IAAA,OAAAlY,iBAAA;MACnCkY,OAAI,CAACtO,aAAa,GAAGA,aAAa;MAClC,OAAOsO,OAAI,CAAC/c,MAAM,CAAC;QAAEgd,OAAO,EAAE,IAAI;QAAE/N,YAAY,EAAE;MAAK,CAAC,CAAC;IAAC;EAC5D;EACAC,YAAYA,CAAA,EAAG;IACb,IAAI,CAAC,IAAI,CAAClT,KAAK,EAAE;MACf,MAAM,IAAI3I,KAAK,CAAC,2CAA2C,CAAC;IAC9D;IACA,MAAM;MAAE4hB;IAAiB,CAAC,GAAG,IAAI,CAACuG,aAAa;IAC/C,OAAO,IAAI,CAACF,KAAK,CAACtG,eAAe,CAAC,IAAI,CAAChZ,KAAK,EAAE;MAAEiZ;IAAiB,CAAC,CAAC;EACrE;EACMjV,MAAMA,CAAA,EAGJ;IAAA,IAAAid,OAAA;IAAA,OAAApY,iBAAA,YAHK;MACXmY,OAAO,GAAG,KAAK;MACf/N,YAAY,GAAG;IACjB,CAAC,GAAG,CAAC,CAAC;MACJ,MAAM;QAAER;MAAc,CAAC,GAAGwO,OAAI;MAC9B,IAAI,CAACA,OAAI,CAACjhB,KAAK,EAAE;QACf,MAAM,IAAI3I,KAAK,CAAC,iCAAiC,CAAC;MACpD;MACA,MAAM2I,KAAK,GAAGihB,OAAI,CAACjhB,KAAK;MACxB,IAAI,CAACyS,aAAa,EAAE;QAClB,MAAM,IAAIpb,KAAK,CAAC,2CAA2C,CAAC;MAC9D;MACA,MAAM;QACJnC,EAAE;QACF+S,WAAW;QACXjG,KAAK;QACLnL,IAAI;QACJqN,IAAI;QACJyE,YAAY;QACZY,eAAe;QACfK,cAAc;QACdS,cAAc;QACd3D,YAAY;QACZ0D;MACF,CAAC,GAAGpK,KAAK;MACT,IAAIiT,YAAY,IAAI,CAAC+N,OAAO,EAAE;QAC5BC,OAAI,CAACC,YAAY,CAAC,CAAC;QACnBD,OAAI,CAAClB,eAAe,GAAG,IAAIZ,gBAAgB,CAAC,CAAC;MAC/C;MACA,MAAMpW,WAAW,GAAGkY,OAAI,CAAClB,eAAe,CAACzN,MAAM;MAC/C,IAAI6O,OAAO,GAAG,KAAK;MACnB,MAAM3K,mBAAmB,GAAGxW,KAAK,CAACsK,SAAS;MAC3C,IAAI;QACF,MAAMtS,OAAO,GAAG;UACd,GAAGipB,OAAI,CAAC/N,YAAY,CAAC,CAAC;UACtBd,QAAQ,EAAE6O,OAAI,CAAC7O,QAAQ;UACvBrJ,WAAW;UACX0J,aAAa;UACb3J,MAAM,EAAE,CAAC,CAAC;UACVyJ,IAAI,EAAE,eAAgBjgB,MAAM,CAAC,CAACuc,KAAK,EAAE5K,IAAI,KAAKmG,OAAO,CAACyE,KAAK,EAAE5K,IAAI,EAAEjM,OAAO,CAAC,EAAE,MAAM,CAAC;UACpFA,OAAO,EAAE,IAAI;UACbyS,MAAM,EAAE,CAAC,CAAC;UACViI,SAAS,EAAE,CAAC,CAAC;UACblI,cAAc,EAAE,eAAgBlY,MAAM,cAAAuW,iBAAA,CAAC,aAAY;YACjD,MAAMuY,QAAQ,SAASH,OAAI,CAAC1B,cAAc,CAAC8B,aAAa,EAAE5O,aAAa,CAAC;YACxEwO,OAAI,CAACpB,cAAc,GAAGuB,QAAQ,KAAK,MAAM,CACzC,CAAC,CAAC;YACFD,OAAO,GAAG,IAAI;UAChB,CAAC,GAAE,gBAAgB,CAAC;UACpB;UACA;UACA;UACA;UACA;UACAzW,KAAK,EAAE,eAAgBpY,MAAM,cAAAuW,iBAAA,CAAC,WAAO,GAAGtS,IAAI,EAAK;YAC/C0qB,OAAI,CAAC9H,SAAS,CAACmI,qBAAqB,GAAG,CAAC;YACxC,IAAIC,WAAW,GAAG,IAAI;YACtB,MAAMN,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,WAAW,eAAAF,iBAAA,CAAE,aAAY;cACxD0Y,WAAW,SAASvhB,KAAK,CAAC0K,KAAK,CAAC1S,OAAO,CAAC,CAAC,GAAGzB,IAAI,CAAC;YACnD,CAAC,EAAC;YACF,IAAIigB,mBAAmB,EAAE;cACvB,MAAMyK,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,SAAS,CAAC;YAC7C;YACA,OAAOwY,WAAW;UACpB,CAAC,GAAE,OAAO;QACZ,CAAC;QACDvpB,OAAO,CAACA,OAAO,GAAGA,OAAO;QACzB,MAAMqpB,aAAa,GAAG;UACpBpZ,WAAW;UACXjG,KAAK;UACLkG,IAAI,EAAElG,KAAK;UACX9M,EAAE;UACF2B,IAAI;UACJmJ,KAAK,EAAEnJ,IAAI;UACXqN,IAAI;UACJ,GAAG+c,OAAI,CAAC9H,SAAS;UACjBrG,SAAS,EAAE,eAAgBxgB,MAAM,CAAEkM,KAAK,IAAK;YAC3CyiB,OAAI,CAACd,KAAK,GAAG,SAAS;YACtB,OAAOc,OAAI,CAAC9H,SAAS,CAACrG,SAAS,CAACtU,KAAK,CAAC;UACxC,CAAC,EAAE,WAAW,CAAC;UACfwU,aAAa,EAAE,eAAgB1gB,MAAM,CAAEkM,KAAK,IAAK;YAC/CyiB,OAAI,CAACd,KAAK,GAAG,SAAS;YACtB,OAAOc,OAAI,CAAC9H,SAAS,CAACnG,aAAa,CAACxU,KAAK,CAAC;UAC5C,CAAC,EAAE,eAAe,CAAC;UACnByU,YAAY,EAAEA,YAAY,IAAIgO,OAAI,CAACvB,cAAc;UACjDxM,YAAY,EAAElb,OAAO;UACrBL,OAAO,EAAE,eAAgBrF,MAAM,CAAC,MAAM+X,cAAc,CAACrS,OAAO,CAAC,EAAE,SAAS,CAAC;UACzEqS;QACF,CAAC;QACD,MAAM4W,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,SAAS,eAAAF,iBAAA,CAAE,aAAY;UACtD7Q,OAAO,CAAC8Q,MAAM,SAASH,YAAY,CAAC3Q,OAAO,CAAC;QAC9C,CAAC,EAAC;QACF,IAAI+Q,WAAW,CAACC,OAAO,EAAE;UACvB;QACF;QACA,MAAMS,gBAAgB,SAASF,eAAe,CAACvR,OAAO,CAAC;QACvDipB,OAAI,CAAC3B,KAAK,CAACpG,mBAAmB,CAAClZ,KAAK,EAAE,GAAGyJ,gBAAgB,CAAC;QAC1D,IAAIwX,OAAI,CAACT,cAAc,CAACzX,WAAW,CAAC,EAAE;UACpC;QACF;QACA,IAAI,CAACoY,OAAO,IAAI,CAAC3K,mBAAmB,EAAE;UACpC,MAAMxe,OAAO,CAAC0S,KAAK,CAAC,CAAC;QACvB;QACAuW,OAAI,CAACvB,cAAc,GAAG,KAAK;QAC3B,IAAI3W,WAAW,CAACC,OAAO,EAAE;UACvB;QACF;QACA,MAAMwY,qBAAqB,GAAGP,OAAI,CAACjhB,KAAK,CAACzE,UAAU,EAAEsS,IAAI,EAAE4T,gCAAgC,KAAK,IAAI;QACpG,MAAMC,eAAe,GAAG,eAAgB,IAAInsB,GAAG,CAAC,CAAC;QACjD,MAAMosB,OAAO,GAAG,eAAgBrvB,MAAM,CAAEsvB,KAAK,IAAK;UAChD,IAAIA,KAAK,CAACpjB,KAAK,EAAE;YACfkjB,eAAe,CAACzqB,GAAG,CAAC2qB,KAAK,CAACpjB,KAAK,CAAC;UAClC;QACF,CAAC,EAAE,SAAS,CAAC;QACb,MAAMqjB,oBAAoB,GAAG,eAAgBvvB,MAAM,CAAEsvB,KAAK,IAAK;UAC7D,IAAIA,KAAK,CAACE,MAAM,EAAE;YAChBJ,eAAe,CAACzqB,GAAG,CAAC2qB,KAAK,CAACE,MAAM,CAAC;UACnC;QACF,CAAC,EAAE,sBAAsB,CAAC;QAC1B,IAAIb,OAAI,CAACzB,aAAa,CAACC,QAAQ,IAAIxM,YAAY,IAAIvM,YAAY,IAAIua,OAAI,CAACd,KAAK,KAAK,SAAS,EAAE;UAC3F4B,MAAM,EAAEC,gBAAgB,GAAG,OAAO,EAAEL,OAAO,CAAC;UAC5CI,MAAM,EAAEC,gBAAgB,GAAG,oBAAoB,EAAEH,oBAAoB,CAAC;UACtEZ,OAAI,CAACrB,mBAAmB,GAAG,IAAI;UAC/B,IAAI;YACF,IAAI,CAACpJ,mBAAmB,EAAE;cACxBxe,OAAO,CAAC0S,KAAK,gBAAA7B,iBAAA,CAAG,aAAY;gBAC1B,MAAM,IAAImW,6BAA6B,CAAC;kBAAEtY,YAAY,EAAEA,YAAY,CAACG,QAAQ,CAAC;gBAAE,CAAC,CAAC;cACpF,CAAC;cACD,MAAMoa,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,SAAS,eAAAF,iBAAA,CAAE;gBAAA,OAAYnC,YAAY,CAAC1O,OAAO,CAAC;cAAA,GAAC;YAChF,CAAC,MAAM;cACL,MAAM0O,YAAY,CAAC1O,OAAO,CAAC;YAC7B;YACA,IAAI,CAACmpB,OAAO,EAAE;cACZ,MAAM,IAAIlC,mBAAmB,CAAC,CAAC;YACjC;YACAgC,OAAI,CAACT,cAAc,CAACzX,WAAW,CAAC;YAChC,IAAI,CAACyY,qBAAqB,IAAIE,eAAe,CAACO,IAAI,GAAG,CAAC,EAAE;cACtD,MAAMhB,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,SAAS,CAAC;YAC7C,CAAC,MAAM;cACL,MAAMkY,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,QAAQ,CAAC;YAC5C;UACF,CAAC,CAAC,OAAOvK,KAAK,EAAE;YACdyiB,OAAI,CAAC9H,SAAS,CAACmI,qBAAqB,GAAG,CAAC;YACxC,MAAML,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,SAAS,eAAAF,iBAAA,CAAE,aAAY;cACtDoY,OAAI,CAAChuB,OAAO,CAAC0G,IAAI,CAACglB,6BAA6B,EAAES,cAAc,CAAC5gB,KAAK,CAAC,CAAC;YACzE,CAAC,EAAC;YACF,IAAIyiB,OAAI,CAACjhB,KAAK,CAACzE,UAAU,CAAC2mB,2BAA2B,KAAK,KAAK,EAAE;cAC/D,MAAM1jB,KAAK;YACb;YACAgb,OAAO,CAAChb,KAAK,CAACA,KAAK,CAAC;UACtB;UACA,IAAI,CAACgjB,qBAAqB,IAAIE,eAAe,CAACO,IAAI,GAAG,CAAC,EAAE;YACtDhB,OAAI,CAAChuB,OAAO,CAAC0G,IAAI,CACfolB,8BAA8B,EAC9BlmB,KAAK,CAACspB,IAAI,CAACT,eAAe,CAAC,CAAC5pB,GAAG,CAACsnB,cAAc,CAChD,CAAC;UACH;UACA6B,OAAI,CAACrB,mBAAmB,GAAG,KAAK;UAChCmC,MAAM,EAAEK,mBAAmB,GAAG,oBAAoB,EAAEP,oBAAoB,CAAC;UACzEE,MAAM,EAAEK,mBAAmB,GAAG,OAAO,EAAET,OAAO,CAAC;UAC/C,IAAI5Y,WAAW,CAACC,OAAO,EAAE;YACvB;UACF;QACF;QACA,MAAMiY,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,YAAY,eAAAF,iBAAA,CAAE,aAAY;UACzD,IAAIrX,iBAAiB,CAAC,CAAC,EAAE;YACvByvB,OAAI,CAAC3B,KAAK,CAACpG,mBAAmB,CAAClZ,KAAK,EAAEvO,eAAe,CAAC,CAAC,CAAC;UAC1D,CAAC,MAAM;YACL,MAAMC,iBAAiB,CAACqX,WAAW,CAAC;UACtC;QACF,CAAC,EAAC;QACF,MAAMkY,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,WAAW,eAAAF,iBAAA,CAAE,aAAY;UACxDoY,OAAI,CAAChuB,OAAO,CAAC0G,IAAI,CAACklB,eAAe,EAAE3pB,EAAE,CAAC;QACxC,CAAC,EAAC;QACF,IAAI+rB,OAAI,CAACd,KAAK,KAAK,SAAS,EAAE;UAC5B,MAAMc,OAAI,CAACb,QAAQ,CAACrX,WAAW,EAAE,WAAW,eAAAF,iBAAA,CAAE,aAAY;YACxD,MAAMe,cAAc,CAAC5R,OAAO,CAAC;UAC/B,CAAC,EAAC;QACJ;QACA,MAAMqqB,kBAAkB,GAAG,CAACb,qBAAqB,IAAIE,eAAe,CAACO,IAAI,GAAG,CAAC;QAC7E,MAAMK,oBAAoB,GAAGtqB,OAAO,CAACka,SAAS,CAAC1B,OAAO,CAAC/R,IAAI,CACxDiS,MAAM,IAAKA,MAAM,CAAC6R,MAAM,KAAK,QAChC,CAAC;QACD,MAAMC,eAAe,GAAGH,kBAAkB,IAAIC,oBAAoB;QAClE,MAAMrB,OAAI,CAACb,QAAQ,CACjBrX,WAAW,EACX,UAAU,eAAAF,iBAAA,CACV;UAAA,OAAYoY,OAAI,CAAChuB,OAAO,CAAC0G,IAAI,CAACilB,cAAc,EAAE;YAC5C3pB,OAAO,EAAEC,EAAE;YACXqtB,MAAM,EAAEC,eAAe,GAAG,OAAO,GAAG,SAAS;YAC7CC,SAAS,EAAEzqB,OAAO,CAACka,SAAS,CAAC1B;UAC/B,CAAC,CAAC;QAAA,EACJ,CAAC;MACH,CAAC,CAAC,OAAO4M,GAAG,EAAE;QACZ6D,OAAI,CAACd,KAAK,GAAG,SAAS;QACtBc,OAAI,CAAC9H,SAAS,CAACnG,aAAa,CAACoK,GAAG,CAAC;QACjC,MAAM6D,OAAI,CAACb,QAAQ,CACjBrX,WAAW,EACX,UAAU,eAAAF,iBAAA,CACV;UAAA,OAAYoY,OAAI,CAAChuB,OAAO,CAAC0G,IAAI,CAACilB,cAAc,EAAE;YAC5C3pB,OAAO,EAAEC,EAAE;YACXqtB,MAAM,EAAE,OAAO;YACfE,SAAS,EAAE;UACb,CAAC,CAAC;QAAA,EACJ,CAAC;MACH;MACA,IAAIxB,OAAI,CAACtB,gBAAgB,EAAE;QACzBsB,OAAI,CAACtB,gBAAgB,GAAG,KAAK;QAC7BsB,OAAI,CAACjd,MAAM,CAAC,CAAC;MACf;IAAC,GAAAqF,KAAA,OAAAC,SAAA;EACH;EACA;AACF;AACA;AACA;AACA;AACA;EACQoZ,QAAQA,CAAA,EAAG;IAAA,IAAAC,OAAA;IAAA,OAAA9Z,iBAAA;MACf,IAAI8Z,OAAI,CAAC9B,SAAS,CAAC,CAAC,IAAI8B,OAAI,CAACxC,KAAK,KAAK,SAAS,EAAE;QAChDwC,OAAI,CAAChD,gBAAgB,GAAG,IAAI;MAC9B,CAAC,MAAM;QACL,OAAOgD,OAAI,CAAC3e,MAAM,CAAC,CAAC;MACtB;IAAC;EACH;EACM4e,OAAOA,CAAA,EAAG;IAAA,IAAAC,OAAA;IAAA,OAAAha,iBAAA;MACd,MAAMga,OAAI,CAACzB,QAAQ,CAAC,CAAC;MACrB,OAAOyB,OAAI,CAAC7e,MAAM,CAAC;QAAEiP,YAAY,EAAE;MAAK,CAAC,CAAC;IAAC;EAC7C;EACA;EACA;EACA;EACA;EACA;EACAiO,YAAYA,CAAA,EAAG;IACb,IAAI,CAACnB,eAAe,CAAC+C,KAAK,CAAC,CAAC;EAC9B;EACAC,kBAAkBA,CAAA,EAAG;IACnB,IAAI,IAAI,CAAC5C,KAAK,KAAK,SAAS,EAAE;MAC5B,IAAI,CAACJ,eAAe,CAAC+C,KAAK,CAAC,CAAC;MAC5B,IAAI,CAAC1C,QAAQ,CAAC,IAAI,CAACL,eAAe,CAACzN,MAAM,EAAE,SAAS,CAAC;IACvD;EACF;EACM8O,QAAQA,CAAA,EAAG;IAAA,IAAA4B,OAAA;IAAA,OAAAna,iBAAA;MACfma,OAAI,CAAClD,QAAQ,GAAG,IAAI;MACpBkD,OAAI,CAAC9B,YAAY,CAAC,CAAC;MACnB,IAAI8B,OAAI,CAAChjB,KAAK,EAAE;QACd,MAAMgjB,OAAI,CAAC1D,KAAK,CAAClG,YAAY,CAAC4J,OAAI,CAAChjB,KAAK,CAAC;MAC3C;MACA,KAAK,IAAIzH,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAI,CAAC,EAAE;QAC7B,IAAI,CAACyqB,OAAI,CAACnC,SAAS,CAAC,CAAC,EAAE;UACrB,MAAMmC,OAAI,CAACnD,cAAc,CAAC,CAAC;UAC3B;QACF;QACA,MAAM,IAAItsB,OAAO,CAAED,OAAO,IAAK2vB,UAAU,CAAC3vB,OAAO,EAAE,CAAC,CAAC,CAAC;MACxD;MACAyuB,MAAM,EAAEmB,QAAQ,EAAEC,MAAM,GAAG,CAAC;MAC5B,MAAM,IAAI5vB,OAAO,CAAC,MAAM,CACxB,CAAC,CAAC;IAAC;EACL;AACF,CAAC;AACDjB,MAAM,CAAC+sB,YAAY,EAAE,aAAa,CAAC;AACnC,IAAI+D,WAAW,GAAG/D,YAAY;;AAE9B;AACA,IAAI;EAAEgE;AAAM,CAAC,GAAG3E,OAAO;AACvB,IAAI4E,gBAAgB,GAAG,cAAc;AACrC,IAAIC,QAAQ,GAAG,MAAMA,QAAQ,CAAC;EAC5BxwB,WAAWA,CAAC+jB,QAAQ,EAAE0M,qBAAqB,EAAEvwB,OAAO,GAAGW,MAAM,CAACZ,UAAU,CAAC,CAAC,EAAEywB,gBAAgB,GAAG,IAAI,EAAE;IACnG,IAAI,CAAC3M,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAAC0M,qBAAqB,GAAGA,qBAAqB;IAClD,IAAI,CAACvwB,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACywB,YAAY,GAAG,EAAE;IACtB,IAAI,CAACC,0BAA0B,GAAG,IAAIpwB,OAAO,CAAC,CAACD,OAAO,EAAEswB,MAAM,KAAK;MACjE,IAAI,CAACC,iCAAiC,GAAGvwB,OAAO;MAChD,IAAI,CAACwwB,gCAAgC,GAAGF,MAAM;IAChD,CAAC,CAAC;IACF,IAAIH,gBAAgB,EAAE;MACpB,IAAI,CAACM,UAAU,CAAC,CAAC;IACnB;EACF;EACA;EACA;EACA;EACA;EACA;EACA,IAAIC,UAAUA,CAAA,EAAG;IACf,OAAO,IAAIC,KAAK,CACd,CAAC,CAAC,EACF;MACEltB,GAAG,EAAE,eAAgBzE,MAAM,CAAC,CAAC4xB,CAAC,EAAEpI,MAAM,KAAK;QACzC,IAAI,IAAI,CAACqI,eAAe,EAAE;UACxB7G,UAAU,CAAC,oEAAoE,CAAC;UAChF,OAAO,IAAI,CAAC6G,eAAe,CAACrI,MAAM,CAAC;QACrC;QACA,MAAM,IAAI2C,2CAA2C,CAAC,CAAC;MACzD,CAAC,EAAE,KAAK;IACV,CACF,CAAC;EACH;EACA;EACMsF,UAAUA,CAAA,EAAG;IAAA,IAAAK,OAAA;IAAA,OAAAvb,iBAAA;MACjBub,OAAI,CAACC,cAAc,CAAC,CAAC;MACrB,IAAI;QACF,MAAMre,kBAAkB,SAASoe,OAAI,CAACE,kCAAkC,CAAC,CAAC;QAC1E,MAAMF,OAAI,CAACG,gBAAgB,CAACve,kBAAkB,CAAC;QAC/C,MAAMoe,OAAI,CAACI,gCAAgC,CAACxe,kBAAkB,CAAC;QAC/D,MAAMye,SAAS,GAAGvT,UAAU,EAAEwT,SAAS,EAAED,SAAS;QAClD,MAAML,OAAI,CAACnxB,OAAO,CAAC0G,IAAI,CAACmkB,mBAAmB,EAAE;UAAE2G;QAAU,CAAC,CAAC;MAC7D,CAAC,CAAC,OAAOrH,GAAG,EAAE;QACZgH,OAAI,CAACN,gCAAgC,CAAC1G,GAAG,CAAC;MAC5C;IAAC;EACH;EACAjqB,KAAKA,CAAA,EAAG;IACN,OAAO,IAAI,CAACwwB,0BAA0B;EACxC;EACAU,cAAcA,CAAA,EAAG;IACf,IAAI,CAACpxB,OAAO,CAACgD,EAAE,CAACkoB,uBAAuB,EAAE,IAAI,CAACwG,mBAAmB,CAACzpB,IAAI,CAAC,IAAI,CAAC,CAAC;IAC7E,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAACmoB,eAAe,EAAE,IAAI,CAACwG,eAAe,CAAC1pB,IAAI,CAAC,IAAI,CAAC,CAAC;IACjE,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAACooB,kBAAkB,EAAE,IAAI,CAACwG,YAAY,CAAC3pB,IAAI,CAAC,IAAI,CAAC,CAAC;IACjE,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAACunB,qBAAqB,EAAE,IAAI,CAACsH,qBAAqB,CAAC5pB,IAAI,CAAC,IAAI,CAAC,CAAC;IAC7E,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAAC8nB,iBAAiB,EAAE,IAAI,CAACgH,WAAW,CAAC7pB,IAAI,CAAC,IAAI,CAAC,CAAC;IAC/D,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAAC2nB,gBAAgB,EAAE,IAAI,CAACoH,eAAe,CAAC9pB,IAAI,CAAC,IAAI,CAAC,CAAC;IAClE,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAAC0nB,aAAa,EAAE,IAAI,CAACsH,cAAc,CAAC/pB,IAAI,CAAC,IAAI,CAAC,CAAC;IAC9D,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAACioB,iBAAiB,EAAE,IAAI,CAACgH,iBAAiB,CAAChqB,IAAI,CAAC,IAAI,CAAC,CAAC;EACvE;EACMopB,kCAAkCA,CAAA,EAAG;IAAA,IAAAa,OAAA;IAAA,OAAAtc,iBAAA;MACzC,IAAI;QACF,MAAM7C,kBAAkB,SAASmf,OAAI,CAAC3B,qBAAqB,CAAC,CAAC;QAC7D2B,OAAI,CAAC3a,cAAc,GAAGxE,kBAAkB,CAACwE,cAAc;QACvD,IAAI,CAAC2a,OAAI,CAAC3a,cAAc,EAAE;UACxB,MAAM,IAAI+T,0BAA0B,CAAC,CAAC;QACxC;QACA,OAAOvY,kBAAkB;MAC3B,CAAC,CAAC,OAAOoX,GAAG,EAAE;QACZ+H,OAAI,CAACC,uBAAuB,CAAC,2BAA2B,EAAEhI,GAAG,CAAC;QAC9D,MAAMA,GAAG;MACX;IAAC;EACH;EACA;EACMoH,gCAAgCA,CAACxe,kBAAkB,EAAE;IAAA,IAAAqf,OAAA;IAAA,OAAAxc,iBAAA;MACzDwc,OAAI,CAACC,sCAAsC,GAAGtf,kBAAkB;MAChE,IAAI;QACF,MAAM6Q,UAAU,SAASwO,OAAI,CAACE,uBAAuB,CAAC,CAAC;QACvD,OAAOF,OAAI,CAACG,wBAAwB,CAAC3O,UAAU,CAAC;MAClD,CAAC,CAAC,OAAOuG,GAAG,EAAE;QACZiI,OAAI,CAACD,uBAAuB,CAAC,4BAA4B,EAAEhI,GAAG,CAAC;QAC/D,MAAMA,GAAG;MACX;IAAC;EACH;EACMmH,gBAAgBA,CAACve,kBAAkB,EAAE;IAAA,IAAAyf,OAAA;IAAA,OAAA5c,iBAAA;MACzC,IAAI;QACF,MAAM4c,OAAI,CAACC,gBAAgB,GAAG,CAAC;QAC/BD,OAAI,CAACC,gBAAgB,SAAS1f,kBAAkB,CAACoK,SAAS,GAAG,CAAC;MAChE,CAAC,CAAC,OAAOgN,GAAG,EAAE;QACZqI,OAAI,CAACL,uBAAuB,CAAC,0BAA0B,EAAEhI,GAAG,CAAC;QAC7D,MAAMA,GAAG;MACX;IAAC;EACH;EACMmI,uBAAuBA,CAAA,EAAG;IAAA,OAAA1c,iBAAA;MAC9B,MAAMzR,MAAM,SAASisB,KAAK,CAACC,gBAAgB,CAAC;MAC5C,IAAIlsB,MAAM,CAACmrB,MAAM,KAAK,GAAG,EAAE;QACzB,OAAOnrB,MAAM,CAACuuB,IAAI,CAAC,CAAC;MACtB;MACA,MAAM,IAAInH,oBAAoB,CAAC;QAAEoH,IAAI,QAAQxuB,MAAM,CAACwuB,IAAI,CAAC;MAAE,CAAC,CAAC;IAAC;EAChE;EACA;EACAJ,wBAAwBA,CAAC3O,UAAU,EAAE;IACnC,IAAI,CAAC,IAAI,CAACyO,sCAAsC,EAAE;MAChD,MAAM,IAAIjuB,KAAK,CAAC,wEAAwE,CAAC;IAC3F;IACA,IAAI,CAAC8sB,eAAe,GAAG,IAAInK,UAAU,CACnCnD,UAAU,EACV,IAAI,CAACC,QAAQ,EACb,IAAI,CAACwO,sCACP,CAAC;IACD,OAAO,IAAI,CAACA,sCAAsC;IAClD,IAAI,CAACO,iBAAiB,CAAC,CAAC;IACxB,IAAI,CAAChC,iCAAiC,CAAC,CAAC;EAC1C;EACMgC,iBAAiBA,CAAA,EAAG;IAAA,IAAAC,OAAA;IAAA,OAAAjd,iBAAA;MACxBid,OAAI,CAACC,WAAW,CAAC,CAAC;IAAC;EACrB;EACAA,WAAWA,CAAA,EAAG;IACZ,IAAI,CAAC,IAAI,CAAC5B,eAAe,EAAE;MACzB,MAAM,IAAI7F,4CAA4C,CAAC;QAAE0H,UAAU,EAAE;MAAc,CAAC,CAAC;IACvF;IACA,MAAMC,OAAO,GAAG;MACdnqB,OAAO,EAAE,IAAI,CAACqoB,eAAe,CAACpN,WAAW,CAAChgB,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC;MACrD8J,WAAW,EAAE,IAAI,CAACsjB,eAAe,CAACne,kBAAkB,CAACnF,WAAW,IAAI,CAAC;IACvE,CAAC;IACD,IAAI,CAAC5N,OAAO,CAAC0G,IAAI,CAACqkB,WAAW,EAAEiI,OAAO,CAAC;EACzC;EACA;EACA;EACMC,8BAA8BA,CAAAC,IAAA,EAEjC;IAAA,IAAAC,OAAA;IAAA,OAAAvd,iBAAA,YAFkC;MACnC2a;IACF,CAAC;MACC,OAAO4C,OAAI,CAACC,iBAAiB;MAC7BD,OAAI,CAAC5C,qBAAqB,GAAGA,qBAAqB;MAClD,MAAMxd,kBAAkB,SAASogB,OAAI,CAAC9B,kCAAkC,CAAC,CAAC;MAC1E,MAAM8B,OAAI,CAAC7B,gBAAgB,CAACve,kBAAkB,CAAC;MAC/C,IAAI,CAACogB,OAAI,CAACjC,eAAe,EAAE;QACzB,MAAMiC,OAAI,CAAC5B,gCAAgC,CAACxe,kBAAkB,CAAC;QAC/D;MACF;MACAogB,OAAI,CAACjC,eAAe,CAAC3S,qBAAqB,CAACxL,kBAAkB,CAAC;MAC9DogB,OAAI,CAACL,WAAW,CAAC,CAAC;IAAC,GAAA1c,KAAA,OAAAC,SAAA;EACrB;EACMqb,mBAAmBA,CAAA,EAAG;IAAA,IAAA2B,OAAA;IAAA,OAAAzd,iBAAA;MAC1B,OAAOyd,OAAI,CAACD,iBAAiB;MAC7B,IAAI,CAACC,OAAI,CAACnC,eAAe,IAAI,CAACmC,OAAI,CAAChB,sCAAsC,EAAE;QACzE;MACF;MACA,IAAI;QACF,MAAMzO,UAAU,SAASyP,OAAI,CAACf,uBAAuB,CAAC,CAAC;QACvD,IAAIe,OAAI,CAAChB,sCAAsC,EAAE;UAC/CgB,OAAI,CAACd,wBAAwB,CAAC3O,UAAU,CAAC;UACzC;QACF;QACA,MAAMyP,OAAI,CAACnP,gBAAgB,CAAC;UAAEN;QAAW,CAAC,CAAC;MAC7C,CAAC,CAAC,OAAOuG,GAAG,EAAE;QACZkJ,OAAI,CAAClB,uBAAuB,CAAC,4BAA4B,EAAEhI,GAAG,CAAC;QAC/D,MAAMA,GAAG;MACX;IAAC;EACH;EACA;EACMjG,gBAAgBA,CAAAoP,IAAA,EAGnB;IAAA,IAAAC,OAAA;IAAA,OAAA3d,iBAAA,YAHoB;MACrBiO,QAAQ;MACRD;IACF,CAAC;MACC,IAAI,CAAC2P,OAAI,CAACrC,eAAe,EAAE;QACzB,MAAM,IAAI7F,4CAA4C,CAAC;UAAE0H,UAAU,EAAE;QAAmB,CAAC,CAAC;MAC5F;MACA,MAAMQ,OAAI,CAACrC,eAAe,CAAChN,gBAAgB,CAAC;QAAEL,QAAQ;QAAED;MAAW,CAAC,CAAC;IAAC,GAAAxN,KAAA,OAAAC,SAAA;EACxE;EACMsb,eAAeA,CAAA6B,IAAA,EAGlB;IAAA,IAAAC,OAAA;IAAA,OAAA7d,iBAAA,YAHmB;MACpB/M,OAAO,EAAE6qB,cAAc;MACvBC;IACF,CAAC;MACC,IAAI,CAACF,OAAI,CAACvC,eAAe,EAAE;QACzB,MAAMuC,OAAI,CAAC/C,0BAA0B;MACvC;MACA,IAAI,CAAC+C,OAAI,CAACvC,eAAe,EAAE;QACzB,MAAM,IAAI7F,4CAA4C,CAAC;UAAE0H,UAAU,EAAE;QAAkB,CAAC,CAAC;MAC3F;MACAU,OAAI,CAACvC,eAAe,CAACpN,WAAW,CAAC9c,MAAM,CAAC0sB,cAAc,CAAC;MACvD,IAAIC,YAAY,EAAE;QAChB,MAAM;UAAE9lB,cAAc;UAAE8J,YAAY;UAAEmM,WAAW;UAAEjb;QAAQ,CAAC,GAAG4qB,OAAI,CAACvC,eAAe,CAACnL,eAAe,CAAC4N,YAAY,CAAC;QACjHF,OAAI,CAACzzB,OAAO,CAAC0G,IAAI,CAACkkB,eAAe,EAAE;UACjC/c,cAAc;UACdiW,WAAW;UACXnM,YAAY;UACZ9O;QACF,CAAC,CAAC;MACJ,CAAC,MAAM;QACL,MAAM;UAAEgF,cAAc;UAAEhF;QAAQ,CAAC,GAAG4qB,OAAI,CAACvC,eAAe,CAACpN,WAAW;QACpE2P,OAAI,CAACzzB,OAAO,CAAC0G,IAAI,CAACkkB,eAAe,EAAE;UACjC/c,cAAc;UACdiW,WAAW,EAAEjb,OAAO;UACpB8O,YAAY,EAAE,CAAC,CAAC;UAChB9O;QACF,CAAC,CAAC;MACJ;MACA,MAAMvI,OAAO,CAAC2V,GAAG,CAACwd,OAAI,CAAChD,YAAY,CAAC5rB,GAAG,CAAE+uB,CAAC,IAAKA,CAAC,CAACnE,QAAQ,CAAC,CAAC,CAAC,CAAC;IAAC,GAAArZ,KAAA,OAAAC,SAAA;EAChE;EACMub,YAAYA,CAAAiC,IAAA,EAA2B;IAAA,IAAAC,OAAA;IAAA,OAAAle,iBAAA,YAA1B;MAAE5T,OAAO;MAAEyG;IAAY,CAAC;MACzC,IAAI,CAACqrB,OAAI,CAAC5C,eAAe,EAAE;QACzB,MAAM,IAAI7F,4CAA4C,CAAC;UAAE0H,UAAU,EAAE;QAAe,CAAC,CAAC;MACxF;MACAe,OAAI,CAAC5C,eAAe,CAAC5tB,IAAI,CAAC0D,MAAM,CAAChF,OAAO,EAAEyG,WAAW,CAAC;MACtD,MAAMnI,OAAO,CAAC2V,GAAG,CACf6d,OAAI,CAACrD,YAAY,CAACvlB,MAAM,CAAE0oB,CAAC,IAAKA,CAAC,CAAC3xB,EAAE,KAAKD,OAAO,IAAI,CAAC4xB,CAAC,CAACrH,aAAa,CAACvG,gBAAgB,CAAC,CAACnhB,GAAG,CACvF+uB,CAAC;MACA;MACA;MACAA,CAAC,CAAC7mB,KAAK,IAAI6mB,CAAC,CAAC7mB,KAAK,CAACsK,SAAS,GAAGuc,CAAC,CAACjE,OAAO,CAAC,CAAC,GAAGiE,CAAC,CAACnE,QAAQ,CAAC,CAE5D,CACF,CAAC;MACDqE,OAAI,CAAC9zB,OAAO,CAAC0G,IAAI,CAACskB,kBAAkB,EAAE;QACpChpB,OAAO;QACPsB,IAAI,EAAEwwB,OAAI,CAAC5C,eAAe,CAAC5tB,IAAI,CAACQ,GAAG,CAAC9B,OAAO;MAC7C,CAAC,CAAC;IAAC,GAAAoU,KAAA,OAAAC,SAAA;EACL;EACMwb,qBAAqBA,CAAAkC,IAAA,EAAkB;IAAA,IAAAC,OAAA;IAAA,OAAApe,iBAAA,YAAjB;MAAE3T,EAAE;MAAE+wB;IAAQ,CAAC;MACzC,IAAI;QACF,MAAMgB,OAAI,CAACtD,0BAA0B;QACrC,MAAM3jB,KAAK,SAASinB,OAAI,CAAC9C,eAAe,EAAEhM,SAAS,CAAC8N,OAAO,CAAC;QAC5DgB,OAAI,CAACh0B,OAAO,CAAC0G,IAAI,CAAC8jB,sBAAsB,EAAE;UACxCvoB,EAAE;UACFgyB,OAAO,EAAE,IAAI;UACbjB,OAAO,EAAE;YAAEjoB,QAAQ,EAAEgC,KAAK,EAAEhC,QAAQ,IAAI,CAAC;UAAE,CAAC;UAC5CQ,KAAK,EAAE;QACT,CAAC,CAAC;MACJ,CAAC,CAAC,OAAO5E,CAAC,EAAE;QACVqtB,OAAI,CAACh0B,OAAO,CAAC0G,IAAI,CAAC8jB,sBAAsB,EAAE;UACxCvoB,EAAE;UACFgyB,OAAO,EAAE,KAAK;UACd1oB,KAAK,EAAE5E,CAAC,EAAEyjB;QACZ,CAAC,CAAC;MACJ;IAAC,GAAAhU,KAAA,OAAAC,SAAA;EACH;EACMyb,WAAWA,CAAAoC,IAAA,EAAwB;IAAA,IAAAC,OAAA;IAAA,OAAAve,iBAAA,YAAvB;MAAE5T,OAAO;MAAE2G;IAAS,CAAC;MACrC,IAAI,CAACwrB,OAAI,CAACjD,eAAe,EAAE;QACzB,MAAM,IAAI7F,4CAA4C,CAAC;UAAE0H,UAAU,EAAE;QAAc,CAAC,CAAC;MACvF;MACA,MAAMhiB,MAAM,GAAGojB,OAAI,CAAC1D,YAAY,CAAC5hB,IAAI,CAAE+kB,CAAC,IAAKA,CAAC,CAAC3xB,EAAE,KAAKD,OAAO,CAAC;MAC9D,MAAM+K,KAAK,GAAGgE,MAAM,EAAEhE,KAAK,WAAUonB,OAAI,CAACjD,eAAe,CAAChM,SAAS,CAAC;QAAEljB;MAAQ,CAAC,CAAC;MAChF,MAAMoyB,eAAe,GAAGzrB,QAAQ,IAAI,CAClC,IAAG,eAAgB,IAAIrG,GAAG,CAAC,CACzB,GAAGsF,MAAM,CAACI,IAAI,CAAC+E,KAAK,CAACC,WAAW,CAAC,EACjC,GAAGpF,MAAM,CAACI,IAAI,CAACmsB,OAAI,CAACjD,eAAe,CAAC5tB,IAAI,CAACQ,GAAG,CAAC9B,OAAO,CAAC,CAAC,CACvD,CAAC,CACH;MACD,MAAMyG,WAAW,GAAG2rB,eAAe,CAAC/pB,MAAM,CAAC,CAACC,GAAG,EAAE+pB,OAAO,KAAK;QAC3D/pB,GAAG,CAAC+pB,OAAO,CAAC,GAAGtnB,KAAK,CAACC,WAAW,CAACqnB,OAAO,CAAC;QACzC,OAAO/pB,GAAG;MACZ,CAAC,EAAE,CAAC,CAAC,CAAC;MACN,MAAM6pB,OAAI,CAACvC,YAAY,CAAC;QAAE5vB,OAAO;QAAEyG;MAAY,CAAC,CAAC;IAAC,GAAA2N,KAAA,OAAAC,SAAA;EACpD;EACA;EACA;EACM0b,eAAeA,CAAA,EAAG;IAAA,IAAAuC,OAAA;IAAA,OAAA1e,iBAAA;MACtB,MAAMtV,OAAO,CAAC2V,GAAG,CAACqe,OAAI,CAAC7D,YAAY,CAAC5rB,GAAG,CAAE+uB,CAAC,IAAKA,CAAC,CAACnE,QAAQ,CAAC,CAAC,CAAC,CAAC;IAAC;EAChE;EACMuC,cAAcA,CAAAuC,IAAA,EAAc;IAAA,IAAAC,OAAA;IAAA,OAAA5e,iBAAA,YAAb;MAAE5T;IAAQ,CAAC;MAC9B,MAAM1B,OAAO,CAAC2V,GAAG,CAACue,OAAI,CAAC/D,YAAY,CAACvlB,MAAM,CAAE0oB,CAAC,IAAKA,CAAC,CAAC3xB,EAAE,KAAKD,OAAO,CAAC,CAAC6C,GAAG,CAAE+uB,CAAC,IAAKA,CAAC,CAACjE,OAAO,CAAC,CAAC,CAAC,CAAC;IAAC,GAAAvZ,KAAA,OAAAC,SAAA;EAC/F;EACM4b,iBAAiBA,CAAA,EAAG;IAAA,IAAAwC,OAAA;IAAA,OAAA7e,iBAAA;MACxB,MAAMtV,OAAO,CAAC2V,GAAG,CAACwe,OAAI,CAAChE,YAAY,CAAC5rB,GAAG,CAAE+uB,CAAC,IAAKA,CAAC,CAAC9D,kBAAkB,CAAC,CAAC,CAAC,CAAC;IAAC;EAC1E;EACA;EACA;EACA;EACA;EACA;EACA4E,oBAAoBA,CAAC3nB,KAAK,EAAE4nB,OAAO,EAAEzO,SAAS,EAAE9c,OAAO,EAAE;IAAA,IAAAwrB,OAAA;IACvD,IAAI,CAAC,IAAI,CAACrd,cAAc,IAAI,CAAC,IAAI,CAAC2Z,eAAe,EAAE;MACjD,MAAM,IAAI7F,4CAA4C,CAAC;QACrD0H,UAAU,EAAE;MACd,CAAC,CAAC;IACJ;IACA,MAAMhiB,MAAM,GAAG,IAAIof,WAAW,CAC5B,IAAI,CAACnwB,OAAO,EACZ,IAAI,CAACkxB,eAAe,EACpB,IAAI,CAAC3Z,cAAc,EACnB2O,SAAS,EACTnZ,KAAK,CAAC9K,EAAE,EACR,MAAM,EACNmH,OAAO,EACP2D,KACF,CAAC;IACDgE,MAAM,CAAC8c,eAAe,CAAC8G,OAAO,CAAC;IAC/B,IAAI,CAAClE,YAAY,CAAC1qB,IAAI,CAACgL,MAAM,CAAC;IAC9B,oBAAA6E,iBAAA,CAAO,aAAY;MACjB,MAAMgf,OAAI,CAAChI,cAAc,CAAC7b,MAAM,CAAC;IACnC,CAAC;EACH;EACM6b,cAAcA,CAAAiI,IAAA,EAAmC;IAAA,IAAAC,OAAA;IAAA,OAAAlf,iBAAA,YAAlC7E,MAAM,EAAE;MAAEgkB;IAAgB,CAAC,GAAG,CAAC,CAAC;MACnDD,OAAI,CAACrE,YAAY,GAAGqE,OAAI,CAACrE,YAAY,CAACvlB,MAAM,CAAE0oB,CAAC,IAAKA,CAAC,KAAK7iB,MAAM,CAAC;MACjE,MAAMA,MAAM,EAAEod,QAAQ,GAAG;QAAE4G;MAAgB,CAAC,CAAC;IAAC,GAAA3e,KAAA,OAAAC,SAAA;EAChD;EACA;EACM6O,SAASA,CAAA8P,IAAA,EAAc;IAAA,IAAAC,OAAA;IAAA,OAAArf,iBAAA,YAAb;MAAE5T;IAAQ,CAAC;MACzB,IAAI,CAACizB,OAAI,CAAC/D,eAAe,EAAE;QACzB,MAAM,IAAI7F,4CAA4C,CAAC;UAAE0H,UAAU,EAAE;QAAY,CAAC,CAAC;MACrF;MACA,OAAOkC,OAAI,CAAC/D,eAAe,CAAChM,SAAS,CAAC;QAAEljB;MAAQ,CAAC,CAAC;IAAC,GAAAoU,KAAA,OAAAC,SAAA;EACrD;EACA0P,eAAeA,CAAChZ,KAAK,EAAE;IAAEiZ,gBAAgB,GAAG;EAAM,CAAC,GAAG,CAAC,CAAC,EAAE;IACxD,IAAI,CAAC,IAAI,CAACkL,eAAe,EAAE;MACzB,MAAM,IAAI7F,4CAA4C,CAAC;QAAE0H,UAAU,EAAE;MAAkB,CAAC,CAAC;IAC3F;IACA,OAAO,IAAI,CAAC7B,eAAe,CAACnL,eAAe,CAAChZ,KAAK,EAAE;MAAEiZ;IAAiB,CAAC,CAAC;EAC1E;EACMK,OAAOA,CAACjd,OAAO,EAAE;IAAA,IAAA8rB,OAAA;IAAA,OAAAtf,iBAAA;MACrB,IAAI,CAACsf,OAAI,CAAChE,eAAe,EAAE;QACzB,MAAM,IAAI7F,4CAA4C,CAAC;UAAE0H,UAAU,EAAE;QAAU,CAAC,CAAC;MACnF;MACA,IAAImC,OAAI,CAAC9B,iBAAiB,EAAE;QAC1B,MAAM8B,OAAI,CAAC9B,iBAAiB;MAC9B;MACA,MAAM8B,OAAI,CAAChE,eAAe,CAAC5M,gBAAgB,CAAC,CAAC;MAC7C,OAAO4Q,OAAI,CAAChE,eAAe,CAAC7K,OAAO,CAACjd,OAAO,CAAC;IAAC;EAC/C;EACA;EACA+oB,uBAAuBA,CAACtD,MAAM,EAAE1E,GAAG,EAAE;IACnC,IAAI,CAACiJ,iBAAiB,GAAGjJ,GAAG;IAC5BG,OAAO,CAAC/e,KAAK,CAACsjB,MAAM,CAAC;IACrBvE,OAAO,CAAC/e,KAAK,CAAC4e,GAAG,CAAC;IAClB,IAAI,CAACnqB,OAAO,CAAC0G,IAAI,CAAC+jB,YAAY,EAAEN,GAAG,CAAC;EACtC;AACF,CAAC;AACD9qB,MAAM,CAACixB,QAAQ,EAAE,SAAS,CAAC;AAC3B,IAAI6E,OAAO,GAAG7E,QAAQ;;AAEtB;AACA,SAAS/wB,MAAM,IAAI61B,OAAO,QAAQ,mBAAmB;;AAErD;AACA,SAASx0B,MAAM,IAAIy0B,OAAO,QAAQ,kCAAkC;AACpE,SACEC,qBAAqB,EACrBC,aAAa,EACb3K,eAAe,IAAI4K,gBAAgB,EACnCC,eAAe,EACfC,eAAe,EACfC,iBAAiB,EACjBC,aAAa,EACbC,aAAa,EACbC,aAAa,EACbC,cAAc,EACdlK,0BAA0B,IAAImK,2BAA2B,EACzDC,eAAe,EACfC,qBAAqB,EACrBC,eAAe,EACfC,mBAAmB,QACd,gCAAgC;AACvC,SACE/K,4CAA4C,IAAIgL,6CAA6C,EAC7FC,eAAe,EACfC,+BAA+B,EAC/BC,iBAAiB,QACZ,mCAAmC;;AAE1C;AACA,SAASC,aAAa,QAAQ,gCAAgC;;AAE9D;AACA,SAASllB,OAAO,IAAImlB,QAAQ,QAAQ,wBAAwB;AAC5D,IAAIC,YAAY,GAAG,MAAMA,YAAY,CAAC;EACpC72B,WAAWA,CAACE,OAAO,EAAEqsB,KAAK,EAAEqI,oBAAoB,EAAE9O,QAAQ,EAAE;IAC1D,IAAI,CAAC5lB,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACqsB,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACqI,oBAAoB,GAAGA,oBAAoB;IAChD,IAAI,CAACkC,aAAa,GAAG,eAAgBv3B,MAAM,CAAEsR,SAAS,IAAK;MACzD,MAAM3O,OAAO,GAAG,IAAI,CAAC60B,aAAa,CAAC/yB,GAAG,CAAC6M,SAAS,CAAC;MACjD,IAAI3O,OAAO,EAAE;QACX,OAAOA,OAAO;MAChB;MACA,MAAM,IAAIoC,KAAK,CAAC,kCAAkCuM,SAAS,EAAE,CAAC;IAChE,CAAC,EAAE,eAAe,CAAC;IACnB,IAAI,CAACmmB,gBAAgB,GAAG,eAAgBz3B,MAAM,CAAC,MAAM;MACnD,OAAO,IAAI,CAAC03B,qBAAqB;IACnC,CAAC,EAAE,kBAAkB,CAAC;IACtB,IAAI,CAACzR,2BAA2B,GAAG,eAAgBjmB,MAAM,CAAE6T,OAAO,IAAK;MACrE,OAAO,IAAI,CAACmZ,KAAK,CAAC/G,2BAA2B,CAAC;QAAEpS;MAAQ,CAAC,CAAC;IAC5D,CAAC,EAAE,6BAA6B,CAAC;IACjC,IAAI,CAAC8jB,SAAS,GAAG,eAAgB33B,MAAM,CAAE2C,OAAO,IAAK;MACnD,IAAI,CAACA,OAAO,EAAE;QACZ,IAAI,CAAC,IAAI,CAACi1B,YAAY,EAAE;UACtB,MAAM,IAAI7yB,KAAK,CACb,4EACF,CAAC;QACH;QACA,OAAO,IAAI,CAAC6yB,YAAY;MAC1B;MACA,MAAM/jB,OAAO,GAAG,IAAI,CAACgkB,gBAAgB,CAACpzB,GAAG,CAAC9B,OAAO,CAAC;MAClD,IAAI,CAACkR,OAAO,EAAE;QACZ,MAAM,IAAI9O,KAAK,CAAC,yDAAyDpC,OAAO,EAAE,CAAC;MACrF;MACA,OAAO,IAAI,CAACqqB,KAAK,CAAChH,gBAAgB,CAAC;QAAErjB,OAAO;QAAEkR;MAAQ,CAAC,CAAC;IAC1D,CAAC,EAAE,WAAW,CAAC;IACf,IAAI,CAAC6S,eAAe,GAAG,eAAgB1mB,MAAM,CAAE0N,KAAK,IAAK;MACvD,OAAO;QACL,GAAG,IAAI,CAACsf,KAAK,CAACtG,eAAe,CAAChZ,KAAK,CAAC;QACpC8I,MAAM,EAAE,CAAC,CAAC;QACVsJ,QAAQ,EAAE;MACZ,CAAC;IACH,CAAC,EAAE,iBAAiB,CAAC;IACrB,IAAI,CAAC+F,SAAS,GAAG,eAAgB7lB,MAAM,CAAE4C,EAAE,IAAK;MAC9C,OAAO,IAAI,CAACoqB,KAAK,CAACnH,SAAS,CAAC;QAAEljB,OAAO,EAAEC;MAAG,CAAC,CAAC;IAC9C,CAAC,EAAE,WAAW,CAAC;IACf,IAAI,CAAC80B,qBAAqB,GAAG,EAAE;IAC/B,IAAI,CAACG,gBAAgB,GAAG,eAAgB,IAAIC,GAAG,CAAC,CAAC;IACjD,IAAI,CAACC,aAAa,GAAG,eAAgB,IAAID,GAAG,CAAC,CAAC;IAC9C,IAAI,CAACE,gBAAgB,GAAG,eAAgB,IAAIF,GAAG,CAAC,CAAC;IACjD,IAAI,CAACN,aAAa,GAAG,eAAgB,IAAIM,GAAG,CAAC,CAAC;IAC9C,IAAI,CAACG,gBAAgB,GAAG,eAAgB,IAAIh1B,GAAG,CAAC,CAAC;IACjDsjB,QAAQ,CAACpjB,OAAO,CAAC,CAAC0Q,OAAO,EAAE1I,KAAK,KAAK;MACnC,IAAI,CAAC+sB,gBAAgB,CAACrkB,OAAO,CAAC;IAChC,CAAC,CAAC;EACJ;EACA;EACA;EACA;EACAqkB,gBAAgBA,CAACrkB,OAAO,EAAE;IACxB,IAAI,CAACmkB,gBAAgB,CAACtzB,GAAG,CAACmP,OAAO,CAACd,aAAa,EAAEc,OAAO,CAAC;IACzD,IAAI,CAACmkB,gBAAgB,CAACtzB,GAAG,CAACmP,OAAO,CAACd,aAAa,CAAC9D,OAAO,EAAE4E,OAAO,CAAC;IACjE,MAAMP,OAAO,GAAG,IAAI,CAAC0Z,KAAK,CAAC/G,2BAA2B,CAAC;MAAEpS;IAAQ,CAAC,CAAC;IACnEP,OAAO,CAACnQ,OAAO,CAAEuK,KAAK,IAAK;MACzB,MAAMuR,UAAU,GAAGpL,OAAO,CAACP,OAAO,CAAC5F,KAAK,CAAC9K,EAAE,CAAC;MAC5C,IAAI,CAACi1B,gBAAgB,CAACnzB,GAAG,CAACua,UAAU,CAACrc,EAAE,EAAEiR,OAAO,CAAC;MACjD,IAAI,CAACkkB,aAAa,CAACrzB,GAAG,CAACua,UAAU,CAACnN,YAAY,EAAEpE,KAAK,CAAC;IACxD,CAAC,CAAC;EACJ;EACAyqB,aAAaA,CAACtkB,OAAO,EAAE;IACrB,IAAI,CAAC,IAAI,CAACmkB,gBAAgB,CAACxzB,GAAG,CAACqP,OAAO,CAACd,aAAa,CAAC,EAAE;MACrD,MAAM,IAAIhO,KAAK,CAAC,uDAAuD,CAAC;IAC1E;IACA,IAAI,IAAI,CAACkzB,gBAAgB,CAACzzB,GAAG,CAACqP,OAAO,CAAC,EAAE;MACtC;IACF;IACA,IAAI,CAACokB,gBAAgB,CAACtzB,GAAG,CAACkP,OAAO,CAAC;IAClC,MAAMP,OAAO,GAAG,IAAI,CAAC0Z,KAAK,CAAC/G,2BAA2B,CAAC;MAAEpS;IAAQ,CAAC,CAAC;IACnEP,OAAO,CAACnQ,OAAO,CAAEuK,KAAK,IAAK;MACzB,IAAI,CAAC8pB,aAAa,CAAC9yB,GAAG,CAACgJ,KAAK,CAACnJ,IAAI,EAAEmJ,KAAK,CAAC9K,EAAE,CAAC;MAC5C,IAAI,CAAC80B,qBAAqB,CAAChxB,IAAI,CAACgH,KAAK,CAAC;MACtC,IAAI,CAAC,IAAI,CAACkqB,YAAY,EAAE;QACtB,IAAI,CAACA,YAAY,GAAGlqB,KAAK;MAC3B;IACF,CAAC,CAAC;EACJ;EACA0qB,aAAaA,CAACC,WAAW,EAAEC,MAAM,EAAE;IACjC,MAAMC,QAAQ,GAAG,IAAI,CAACC,mBAAmB,CAACH,WAAW,CAAC;IACtD,IAAIE,QAAQ,CAAC9vB,IAAI,KAAK,MAAM,EAAE;MAC5B,MAAM,IAAI1D,KAAK,CACb,8IACF,CAAC;IACH;IACA,IAAIuzB,MAAM,EAAE;MACV,IAAI,CAACH,aAAa,CAACI,QAAQ,CAAC1kB,OAAO,CAAC;IACtC;EACF;EACA,IAAIH,kBAAkBA,CAAA,EAAG;IACvB,MAAM;MAAEA;IAAmB,CAAC,GAAG,IAAI,CAACsZ,KAAK;IACzC,IAAI,CAACtZ,kBAAkB,EAAE;MACvB,MAAM,IAAI3O,KAAK,CAAC,2EAA2E,CAAC;IAC9F;IACA,OAAO2O,kBAAkB;EAC3B;EACA+kB,+BAA+BA,CAACC,gBAAgB,EAAE;IAChD,IAAIA,gBAAgB,KAAK,OAAO,EAAE;MAChC,IAAI,CAAC,IAAI,CAACd,YAAY,EAAE;QACtB,MAAM,IAAI7yB,KAAK,CACb,oFACF,CAAC;MACH;MACA,OAAO;QAAE0D,IAAI,EAAE,OAAO;QAAEiF,KAAK,EAAE,IAAI,CAACkqB;MAAa,CAAC;IACpD;IACA,IAAI,IAAI,CAACK,gBAAgB,CAACtI,IAAI,KAAK,CAAC,EAAE;MACpC,MAAM,IAAI5qB,KAAK,CACb,+EACF,CAAC;IACH;IACA,MAAM4zB,oBAAoB,GAAGpyB,KAAK,CAACspB,IAAI,CAAC,IAAI,CAACoI,gBAAgB,CAAC,CAAC,CAAC,CAAC;IACjE,IAAIS,gBAAgB,KAAK,MAAM,EAAE;MAC/B,OAAO;QAAEjwB,IAAI,EAAE,MAAM;QAAEoL,OAAO,EAAE8kB;MAAqB,CAAC;IACxD;IACA,MAAM;MAAExf;IAAU,CAAC,GAAGwf,oBAAoB,CAAC1nB,IAAI;IAC/C,IAAI,CAACkI,SAAS,EAAE;MACd,MAAM,IAAIpU,KAAK,CACb,+EACF,CAAC;IACH;IACA,OAAO;MAAE0D,IAAI,EAAE,WAAW;MAAE0Q;IAAU,CAAC;EACzC;EACAqf,mBAAmBA,CAACI,kBAAkB,EAAE;IACtC,MAAM/kB,OAAO,GAAG,IAAI,CAACmkB,gBAAgB,CAACvzB,GAAG,CAACm0B,kBAAkB,CAAC;IAC7D,IAAI/kB,OAAO,EAAE;MACX,OAAO;QAAEpL,IAAI,EAAE,MAAM;QAAEoL;MAAQ,CAAC;IAClC;IACA,MAAMnG,KAAK,GAAG,IAAI,CAACqqB,aAAa,CAACtzB,GAAG,CAClC4yB,QAAQ,CAACuB,kBAAkB,CAAC,GAAGA,kBAAkB,CAACxlB,KAAK,GAAGwlB,kBAC5D,CAAC;IACD,IAAIlrB,KAAK,EAAE;MACT,OAAO;QAAEjF,IAAI,EAAE,OAAO;QAAEiF;MAAM,CAAC;IACjC;IACA,OAAO;MAAEjF,IAAI,EAAE,WAAW;MAAE0Q,SAAS,EAAEyf;IAAmB,CAAC;EAC7D;EACAC,SAASA,CAACD,kBAAkB,EAAEE,UAAU,GAAG,EAAE,EAAE;IAC7C,IAAIP,QAAQ;IACZ,IAAI,CAAC,WAAW,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC/0B,QAAQ,CAACo1B,kBAAkB,CAAC,EAAE;MAC/D,MAAMnwB,IAAI,GAAGmwB,kBAAkB;MAC/BL,QAAQ,GAAG,IAAI,CAACE,+BAA+B,CAAChwB,IAAI,CAAC;IACvD,CAAC,MAAM;MACL8vB,QAAQ,GAAG,IAAI,CAACC,mBAAmB,CAACI,kBAAkB,CAAC;IACzD;IACA,IAAIE,UAAU,CAAChzB,MAAM,IAAI,CAACgzB,UAAU,CAACt1B,QAAQ,CAAC+0B,QAAQ,CAAC9vB,IAAI,CAAC,EAAE;MAC5D,MAAMswB,UAAU,GAAGR,QAAQ,CAAC9vB,IAAI,KAAK,WAAW,GAAG,sBAAsB,GAAG8vB,QAAQ,CAAC9vB,IAAI;MACzF,MAAM,IAAI1D,KAAK,CAAChF,MAAM,uEAAuEg5B,UAAU,iDAAiDD,UAAU,CAACpsB,IAAI,CACrK,IACF,CAAC;AACP;AACA;AACA,6JAA6J,CAAC;IAC1J;IACA,QAAQ6rB,QAAQ,CAAC9vB,IAAI;MACnB,KAAK,WAAW;QAAE;UAChB,OAAO;YACL,GAAG8vB,QAAQ;YACX7kB,kBAAkB,EAAE,IAAI,CAACA;UAC3B,CAAC;QACH;MACA,KAAK,MAAM;QAAE;UACX,OAAO;YACL,GAAG6kB,QAAQ;YACXS,YAAY,EAAE,IAAI,CAAChM,KAAK,CAACpH,uBAAuB,CAAC;cAAE/R,OAAO,EAAE0kB,QAAQ,CAAC1kB;YAAQ,CAAC;UAChF,CAAC;QACH;MACA,KAAK,OAAO;MACZ;QAAS;UACP,OAAO0kB,QAAQ;QACjB;IACF;EACF;AACF,CAAC;AACDv4B,MAAM,CAACs3B,YAAY,EAAE,aAAa,CAAC;AACnC,IAAI2B,WAAW,GAAG3B,YAAY;;AAE9B;AACA,IAAI4B,cAAc,GAAG,MAAMA,cAAc,CAAC;EACxCz4B,WAAWA,CAACE,OAAO,EAAEqsB,KAAK,EAAE7d,KAAK,EAAE0X,SAAS,EAAE;IAC5C,IAAI,CAAClmB,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACqsB,KAAK,GAAGA,KAAK;IAClB,IAAI,CAAC7d,KAAK,GAAGA,KAAK;IAClB,IAAI,CAAC0X,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACpe,IAAI,GAAG,MAAM;IAClB,IAAI,CAAC6e,OAAO,GAAG,KAAK;IACpB,IAAI,CAACkG,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACF,mBAAmB,GAAG,KAAK;IAChC,IAAI,CAAC6L,SAAS,GAAG,KAAK;IACtB,IAAI,CAACv2B,EAAE,GAAGuM,KAAK,CAACvM,EAAE;IAClB,IAAI,CAAC8qB,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;EAC5B;EACAU,WAAWA,CAAA,EAAG;IACZ,OAAO,IAAI,CAAC6K,SAAS;EACvB;EACMhL,OAAOA,CAAA,EAAG;IAAA,IAAAiL,OAAA;IAAA,OAAA7iB,iBAAA;MACd6iB,OAAI,CAACD,SAAS,GAAG,IAAI;MACrB,MAAM;QAAE7S,YAAY;QAAEC,QAAQ,GAAG;MAAG,CAAC,SAAS6S,OAAI,CAACpM,KAAK,CAAC9G,SAAS,CAACkT,OAAI,CAACx2B,EAAE,CAAC;MAC3E,IAAIw2B,OAAI,CAAC5L,QAAQ,EAAE;QACjB,MAAMZ,eAAe;MACvB;MACA,MAAM;QAAExd,UAAU;QAAEM;MAAM,CAAC,GAAG0pB,OAAI,CAACjqB,KAAK;MACxC,MAAMkqB,cAAc,GAAGD,OAAI,CAACpM,KAAK,CAACtI,uBAAuB,CACvD4B,YAAY,EACZlX,UAAU,EACVM,KACF,CAAC;MACD,MAAM4pB,cAAc,GAAG/wB,MAAM,CAACI,IAAI,CAAC0wB,cAAc,CAAC/lB,OAAO,CAAC,CAAC,CAAC,CAAC;MAC7D8lB,OAAI,CAAC1rB,KAAK,GAAG0rB,OAAI,CAACpM,KAAK,CAAChH,gBAAgB,CAAC;QAAErjB,OAAO,EAAE22B,cAAc;QAAEzlB,OAAO,EAAEwlB;MAAe,CAAC,CAAC;MAC9FD,OAAI,CAAC7S,QAAQ,GAAG,CAAC8S,cAAc,EAAE,GAAG9S,QAAQ,CAAC;MAC7C6S,OAAI,CAACD,SAAS,GAAG,KAAK;IAAC;EACzB;EACA35B,OAAOA,CAAC6uB,KAAK,EAAE;IACb,OAAO,CAAC,EAAE,IAAI,CAACzrB,EAAE,KAAKyrB,KAAK,CAACzrB,EAAE,IAAI,IAAI,CAAC8K,KAAK,IAAI,IAAI,CAACA,KAAK,KAAK2gB,KAAK,CAAC3gB,KAAK,CAAC;EAC7E;EACA6rB,WAAWA,CAAClE,oBAAoB,EAAE;IAChC,IAAI,CAAC,IAAI,CAAC9O,QAAQ,EAAE;MAClB,MAAM,IAAIxhB,KAAK,CAAC,qCAAqC,CAAC;IACxD;IACA,MAAMw0B,WAAW,GAAG,IAAIN,WAAW,CACjC,IAAI,CAACt4B,OAAO,EACZ,IAAI,CAACqsB,KAAK,EACVqI,oBAAoB,EACpB,IAAI,CAAC9O,QACP,CAAC;IACD,IAAI,CAACA,QAAQ,CAACpjB,OAAO,CAAE0Q,OAAO,IAAK0lB,WAAW,CAACpB,aAAa,CAACtkB,OAAO,CAAC,CAAC;IACtE,OAAO0lB,WAAW;EACpB;EACM/K,eAAeA,CAACrO,aAAa,EAAEkV,oBAAoB,EAAE;IAAA,IAAAmE,OAAA;IAAA,OAAAjjB,iBAAA;MACzD,IAAI,CAACijB,OAAI,CAAC9rB,KAAK,IAAI,CAAC8rB,OAAI,CAACjT,QAAQ,EAAE;QACjC,MAAM,IAAIxhB,KAAK,CAAC,qCAAqC,CAAC;MACxD;MACA,MAAMw0B,WAAW,GAAGC,OAAI,CAACD,WAAW,CAAClE,oBAAoB,CAAC;MAC1D,MAAM;QAAEoE,IAAI,EAAEC;MAAc,CAAC,GAAGF,OAAI,CAAC9rB,KAAK,CAACzE,UAAU,IAAI,CAAC,CAAC;MAC3D,IAAI,CAACywB,aAAa,EAAE;QAClB,MAAM,IAAI30B,KAAK,CACb,sFACF,CAAC;MACH;MACA,MAAM40B,QAAQ,SAASD,aAAa,CAACC,QAAQ,CAAC,CAAC;MAC/C,MAAM;QAAEjoB;MAAO,CAAC,GAAGioB,QAAQ;MAC3B,MAAMC,UAAU,GAAG,eAAgB55B,MAAM,cAAAuW,iBAAA,CAAC,aAAY;QACpD,IAAI;UACF,MAAM7E,MAAM,CAAC6nB,WAAW,EAAEG,aAAa,EAAEvZ,aAAa,CAAC;UACvDqZ,OAAI,CAAC74B,OAAO,CAAC0G,IAAI,CAAC+vB,aAAa,EAAEoC,OAAI,CAAC52B,EAAE,CAAC;QAC3C,CAAC,CAAC,OAAOkoB,GAAG,EAAE;UACZ0O,OAAI,CAAC3S,SAAS,CAACnG,aAAa,CAACoK,GAAG,CAAC;QACnC;MACF,CAAC,GAAE,YAAY,CAAC;MAChB0O,OAAI,CAACpJ,QAAQ,gBAAA7Z,iBAAA,CAAG;QAAA,OAAYqjB,UAAU,CAAC,CAAC;MAAA;MACxCJ,OAAI,CAACjM,cAAc;QAAA,IAAAsM,MAAA,GAAAtjB,iBAAA,CAAG,WAAO;UAAEmf;QAAgB,CAAC,EAAK;UACnD,IAAI,CAACA,eAAe,IAAI,CAACvV,aAAa,EAAE;YACtC;UACF;UACAwZ,QAAQ,CAACrZ,OAAO,CAACH,aAAa,CAAC;QACjC,CAAC;QAAA,iBAAA2Z,IAAA;UAAA,OAAAD,MAAA,CAAA9iB,KAAA,OAAAC,SAAA;QAAA;MAAA;MACD,OAAO4iB,UAAU,CAAC,CAAC;IAAC;EACtB;EACM9K,QAAQA,CAAA,EAA2B;IAAA,IAAAiL,OAAA;IAAA,OAAAxjB,iBAAA,YAA1B;MAAEmf;IAAgB,CAAC,GAAG,CAAC,CAAC;MACrCqE,OAAI,CAACxM,cAAc,GAAG;QAAEmI;MAAgB,CAAC,CAAC;MAC1CqE,OAAI,CAACvM,QAAQ,GAAG,IAAI;IAAC,GAAAzW,KAAA,OAAAC,SAAA;EACvB;AACF,CAAC;AACDhX,MAAM,CAACk5B,cAAc,EAAE,eAAe,CAAC;AACvC,IAAIc,aAAa,GAAGd,cAAc;;AAElC;AACA,SAAS9B,aAAa,IAAI6C,cAAc,QAAQ,gCAAgC;AAChF,IAAIC,cAAc,GAAG,MAAMA,cAAc,CAAC;EACxCz5B,WAAWA,CAACE,OAAO,EAAEqsB,KAAK,EAAE7d,KAAK,EAAE0X,SAAS,EAAE;IAC5C,IAAI,CAAClmB,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACqsB,KAAK,GAAGA,KAAK;IAClB,IAAI,CAAC7d,KAAK,GAAGA,KAAK;IAClB,IAAI,CAAC0X,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACpe,IAAI,GAAG,MAAM;IAClB,IAAI,CAAC6e,OAAO,GAAG,KAAK;IACpB,IAAI,CAACkG,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACF,mBAAmB,GAAG,KAAK;IAChC,IAAI,CAAC6L,SAAS,GAAG,KAAK;IACtB,IAAI,CAACv2B,EAAE,GAAGuM,KAAK,CAACvM,EAAE;IAClB,IAAI,CAAC8qB,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC;EAC5B;EACAU,WAAWA,CAAA,EAAG;IACZ,OAAO,IAAI,CAAC6K,SAAS;EACvB;EACMhL,OAAOA,CAAA,EAAG;IAAA,IAAAgM,OAAA;IAAA,OAAA5jB,iBAAA;MACd4jB,OAAI,CAAChB,SAAS,GAAG,IAAI;MACrB,MAAM;QAAE7S,YAAY;QAAEC,QAAQ,GAAG;MAAG,CAAC,SAAS4T,OAAI,CAACnN,KAAK,CAAC9G,SAAS,CAACiU,OAAI,CAACv3B,EAAE,CAAC;MAC3E,IAAIu3B,OAAI,CAAC3M,QAAQ,EAAE;QACjB,MAAMZ,eAAe;MACvB;MACAuN,OAAI,CAAC5T,QAAQ,GAAGA,QAAQ;MACxB4T,OAAI,CAACC,OAAO,GAAG9T,YAAY;MAC3B6T,OAAI,CAAChB,SAAS,GAAG,KAAK;IAAC;EACzB;EACA35B,OAAOA,CAAC6uB,KAAK,EAAE;IACb,OAAO,CAAC,EAAE,IAAI,CAACzrB,EAAE,KAAKyrB,KAAK,CAACzrB,EAAE,IAAI,IAAI,CAACw3B,OAAO,IAAI,IAAI,CAACA,OAAO,KAAK/L,KAAK,CAAC+L,OAAO,CAAC;EACnF;EACAb,WAAWA,CAAClE,oBAAoB,EAAE;IAChC,IAAI,CAAC,IAAI,CAAC9O,QAAQ,EAAE;MAClB,MAAM,IAAIxhB,KAAK,CAAC,qCAAqC,CAAC;IACxD;IACA,OAAO,IAAIk0B,WAAW,CACpB,IAAI,CAACt4B,OAAO,EACZ,IAAI,CAACqsB,KAAK,EACVqI,oBAAoB,EACpB,IAAI,CAAC9O,QACP,CAAC;EACH;EACMiI,eAAeA,CAACrO,aAAa,EAAEkV,oBAAoB,EAAE;IAAA,IAAAgF,OAAA;IAAA,OAAA9jB,iBAAA;MACzD,IAAI,CAAC8jB,OAAI,CAACD,OAAO,IAAI,CAACC,OAAI,CAAC9T,QAAQ,IAAI,CAAC8T,OAAI,CAACrN,KAAK,CAACtZ,kBAAkB,EAAE;QACrE,MAAM,IAAI3O,KAAK,CAAC,qCAAqC,CAAC;MACxD;MACA,MAAMw0B,WAAW,GAAGc,OAAI,CAACd,WAAW,CAAClE,oBAAoB,CAAC;MAC1D,MAAM;QAAEoE;MAAK,CAAC,GAAGY,OAAI,CAACrN,KAAK,CAACtZ,kBAAkB,CAACzK,UAAU,IAAI,CAAC,CAAC;MAC/D,IAAI,CAACwwB,IAAI,EAAE;QACT,MAAM,IAAI10B,KAAK,CACb,sFACF,CAAC;MACH;MACA,MAAM20B,aAAa,GAAG;QAAE,GAAGD,IAAI;QAAEnX,IAAI,EAAE+X,OAAI,CAACD,OAAO,CAACnrB;MAAQ,CAAC;MAC7D,MAAM0qB,QAAQ,SAASF,IAAI,CAACE,QAAQ,CAAC,CAAC;MACtC,MAAM;QAAEjoB;MAAO,CAAC,GAAGioB,QAAQ;MAC3B,MAAMC,UAAU,GAAG,eAAgB55B,MAAM,cAAAuW,iBAAA,CAAC,aAAY;QACpD,IAAI;UACF,MAAM7E,MAAM,CAAC6nB,WAAW,EAAEG,aAAa,EAAEvZ,aAAa,CAAC;UACvDka,OAAI,CAAC15B,OAAO,CAAC0G,IAAI,CAAC4yB,cAAc,EAAEI,OAAI,CAACz3B,EAAE,CAAC;QAC5C,CAAC,CAAC,OAAOkoB,GAAG,EAAE;UACZuP,OAAI,CAACxT,SAAS,CAACnG,aAAa,CAACoK,GAAG,CAAC;QACnC;MACF,CAAC,GAAE,YAAY,CAAC;MAChBuP,OAAI,CAACjK,QAAQ,gBAAA7Z,iBAAA,CAAG;QAAA,OAAYqjB,UAAU,CAAC,CAAC;MAAA;MACxCS,OAAI,CAAC9M,cAAc,gBAAAhX,iBAAA,CAAG,WAAO;QAAEmf;MAAgB,CAAC,GAAG,CAAC,CAAC,EAAK;QACxD,IAAI,CAACA,eAAe,IAAI,CAACvV,aAAa,EAAE;UACtC;QACF;QACAwZ,QAAQ,CAACrZ,OAAO,CAACH,aAAa,CAAC;QAC/Bka,OAAI,CAAC7M,QAAQ,GAAG,IAAI;MACtB,CAAC;MACD,OAAOoM,UAAU,CAAC,CAAC;IAAC;EACtB;EACM9K,QAAQA,CAAA,EAA2B;IAAA,IAAAwL,OAAA;IAAA,OAAA/jB,iBAAA,YAA1B;MAAEmf;IAAgB,CAAC,GAAG,CAAC,CAAC;MACrC4E,OAAI,CAAC/M,cAAc,GAAG;QAAEmI;MAAgB,CAAC,CAAC;MAC1C4E,OAAI,CAAC9M,QAAQ,GAAG,IAAI;IAAC,GAAAzW,KAAA,OAAAC,SAAA;EACvB;AACF,CAAC;AACDhX,MAAM,CAACk6B,cAAc,EAAE,eAAe,CAAC;AACvC,IAAIK,aAAa,GAAGL,cAAc;;AAElC;AACA,IAAIM,YAAY,GAAG5b,UAAU;AAC7B,SAAS6b,YAAYA,CAACnL,KAAK,EAAE;EAC3B,MAAMniB,MAAM,GAAGmiB,KAAK,CAACoL,YAAY,IAAIpL,KAAK,CAACoL,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,IAAIpL,KAAK,CAACniB,MAAM;EAC5E,OAAO,iBAAiB,CAACoO,IAAI,CAACpO,MAAM,CAACwtB,OAAO,CAAC,IAAIxtB,MAAM,CAACytB,YAAY,CAAC,iBAAiB,CAAC,KAAK,IAAI;AAClG;AACA56B,MAAM,CAACy6B,YAAY,EAAE,cAAc,CAAC;AACpC,IAAII,gBAAgB,GAAG,cAAc;AACrC,IAAIC,kBAAkB,GAAG,gBAAgB;AACzC,SAASC,UAAUA,CAAC;EAAEnpB;AAAK,CAAC,EAAE;EAC5B,OAAOA,IAAI,EAAEpO,QAAQ,CAACs3B,kBAAkB,CAAC,IAAIlpB,IAAI,EAAEpO,QAAQ,CAACq3B,gBAAgB,CAAC;AAC/E;AACA76B,MAAM,CAAC+6B,UAAU,EAAE,YAAY,CAAC;AAChC,SAASC,aAAaA,CAACzG,CAAC,EAAE;EACxB,OAAOA,CAAC,CAAC9rB,IAAI,KAAK,OAAO;AAC3B;AACAzI,MAAM,CAACg7B,aAAa,EAAE,eAAe,CAAC;AACtC,SAASC,YAAYA,CAAC1G,CAAC,EAAE;EACvB,OAAOA,CAAC,CAAC9rB,IAAI,KAAK,MAAM;AAC1B;AACAzI,MAAM,CAACi7B,YAAY,EAAE,cAAc,CAAC;AACpC,SAASC,eAAeA,CAAC3G,CAAC,EAAE;EAC1B,OAAO0G,YAAY,CAAC1G,CAAC,CAAC,IAAIA,CAAC,CAACjN,OAAO,KAAK,KAAK;AAC/C;AACAtnB,MAAM,CAACk7B,eAAe,EAAE,iBAAiB,CAAC;AAC1C,IAAIC,qBAAqB,GAAG,MAAMA,qBAAqB,SAASrF,OAAO,CAAC;EACtEr1B,WAAWA,CAAC+jB,QAAQ,EAAE0M,qBAAqB,EAAEkK,cAAc,EAAEC,IAAI,EAAE;IACjE,KAAK,CAAC7W,QAAQ,EAAE0M,qBAAqB,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC;IACrD,IAAI,CAAC1M,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAAC0M,qBAAqB,GAAGA,qBAAqB;IAClD,IAAI,CAACkK,cAAc,GAAGA,cAAc;IACpC,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAAC5J,UAAU,CAAC,CAAC;EACnB;EACAM,cAAcA,CAAA,EAAG;IACf,KAAK,CAACA,cAAc,CAAC,CAAC;IACtByI,YAAY,CAACc,SAAS,GAAG,IAAI,CAACC,SAAS,CAAC3yB,IAAI,CAAC,IAAI,CAAC;IAClD,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAAC2yB,iBAAiB,EAAE,IAAI,CAACkF,iBAAiB,CAAC5yB,IAAI,CAAC,IAAI,CAAC,CAAC;IACrE,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAACozB,mBAAmB,EAAE,IAAI,CAAC0E,mBAAmB,CAAC7yB,IAAI,CAAC,IAAI,CAAC,CAAC;IACzE,IAAI,CAACjI,OAAO,CAACgD,EAAE,CAACyyB,eAAe,EAAE,IAAI,CAACsF,gBAAgB,CAAC9yB,IAAI,CAAC,IAAI,CAAC,CAAC;EACpE;EACM2qB,iBAAiBA,CAAA,EAAG;IAAA,IAAAoI,OAAA;IAAA,OAAAplB,iBAAA;MACxB,IAAI,CAAColB,OAAI,CAAC9J,eAAe,EAAE;QACzB,MAAM,IAAImF,6CAA6C,CAAC;UAAEtD,UAAU,EAAE;QAAoB,CAAC,CAAC;MAC9F;MACA,MAAM;QAAElqB;MAAQ,CAAC,GAAGmyB,OAAI,CAACP,cAAc,CAACQ,kBAAkB,IAAI,CAAC,CAAC;MAChE,IAAIpyB,OAAO,EAAE;QACXmyB,OAAI,CAAC9J,eAAe,CAACpN,WAAW,CAAC1W,mBAAmB,CAACvE,OAAO,CAAC;MAC/D;MACAmyB,OAAI,CAAClI,WAAW,CAAC,CAAC;IAAC;EACrB;EACA;EACMP,wBAAwBA,CAAC3O,UAAU,EAAE;IAAA,IAAAsX,sCAAA,GAAAA,CAAA,WAAA3I,wBAAA;MAAA4I,OAAA;IAAA,OAAAvlB,iBAAA;MACzC,MAAMslB,sCAAA,GAAAE,IAAA,CAAAD,OAAA,EAA+BvX,UAAU,CAAC;MAChD,OAAOuX,OAAI,CAACE,oBAAoB,CAAC,CAAC;IAAC;EACrC;EACA;EACMA,oBAAoBA,CAAA,EAAG;IAAA,IAAAC,OAAA;IAAA,OAAA1lB,iBAAA;MAC3B,IAAI,CAAC0lB,OAAI,CAACpK,eAAe,EAAE;QACzB,MAAM,IAAImF,6CAA6C,CAAC;UACtDtD,UAAU,EAAE;QACd,CAAC,CAAC;MACJ;MACA,IAAIuI,OAAI,CAACb,cAAc,CAACc,SAAS,EAAE;QACjC,MAAMD,OAAI,CAACE,eAAe,CAAC,CAAC;QAC5B;MACF;MACA,IAAI,CAACF,OAAI,CAACb,cAAc,CAACQ,kBAAkB,EAAE;QAC3CK,OAAI,CAACG,kBAAkB,CAAC,CAAC;QACzB;MACF;MACA,MAAM;QAAEC,cAAc;QAAEp4B;MAAK,CAAC,GAAGg4B,OAAI,CAACb,cAAc,CAACQ,kBAAkB;MACvE,MAAMzsB,KAAK,GAAG8sB,OAAI,CAACpK,eAAe,CAACtN,UAAU,CAACjV,kBAAkB,CAAC+sB,cAAc,CAAC;MAChF,IAAI,CAACltB,KAAK,EAAE;QACV,IAAIktB,cAAc,KAAK,GAAG,EAAE;UAC1BJ,OAAI,CAACK,2BAA2B,CAACD,cAAc,EAAE,IAAIpF,eAAe,CAAC,CAAC,CAAC;QACzE,CAAC,MAAM;UACLgF,OAAI,CAACK,2BAA2B,CAC9BD,cAAc,EACd,IAAIlF,iBAAiB,CAAC;YAAEkF,cAAc,EAAEA,cAAc,CAAC9nB,QAAQ,CAAC;UAAE,CAAC,CACrE,CAAC;QACH;QACA;MACF;MACA,MAAM;QAAE3R,EAAE,EAAED,OAAO;QAAE8F,IAAI,EAAEqX;MAAS,CAAC,GAAG3Q,KAAK;MAC7C8sB,OAAI,CAACb,cAAc,CAACmB,YAAY,CAAC;QAAE55B,OAAO;QAAEmd;MAAS,CAAC,CAAC;MACvDmc,OAAI,CAACt7B,OAAO,CAAC0G,IAAI,CAACuvB,eAAe,EAAEqF,OAAI,CAACb,cAAc,CAACc,SAAS,CAAC;MACjED,OAAI,CAACt7B,OAAO,CAAC0G,IAAI,CAAC4uB,qBAAqB,EAAEgG,OAAI,CAACb,cAAc,CAACc,SAAS,CAAC;MACvE,MAAMD,OAAI,CAACE,eAAe,CAAC;QAAEK,aAAa,EAAEv4B;MAAK,CAAC,CAAC;IAAC;EACtD;EACA;EACA;EACM2vB,8BAA8BA,CAAA6I,IAAA,EAEjC;IAAA,IAAAC,4CAAA,GAAAA,CAAA,WAAA9I,8BAAA;MAAA+I,OAAA;IAAA,OAAApmB,iBAAA,YAFkC;MACnC2a;IACF,CAAC;MACC,MAAMwL,4CAAA,GAAAX,IAAA,CAAAY,OAAA,EAAqC;QAAEzL;MAAsB,CAAC,CAAC;MACrE,IAAIyL,OAAI,CAACvB,cAAc,CAACc,SAAS,EAAE;QACjCS,OAAI,CAACR,eAAe,CAAC,CAAC;MACxB;IAAC,GAAAplB,KAAA,OAAAC,SAAA;EACH;EACA;EACM6N,gBAAgBA,CAAA+X,IAAA,EAGnB;IAAA,IAAAC,8BAAA,GAAAA,CAAA,WAAAhY,gBAAA;MAAAiY,OAAA;IAAA,OAAAvmB,iBAAA,YAHoB;MACrBiO,QAAQ;MACRD;IACF,CAAC;MACC,MAAMsY,8BAAA,GAAAd,IAAA,CAAAe,OAAA,EAAuB;QAAEtY,QAAQ;QAAED;MAAW,CAAC,CAAC;MACtD,IAAIuY,OAAI,CAAC1B,cAAc,CAACc,SAAS,EAAE;QACjC,MAAMY,OAAI,CAACX,eAAe,CAAC,CAAC;MAC9B,CAAC,MAAM;QACL,MAAMW,OAAI,CAACd,oBAAoB,CAAC,CAAC;MACnC;IAAC,GAAAjlB,KAAA,OAAAC,SAAA;EACH;EACAukB,SAASA,CAACjM,KAAK,EAAE;IACf,IAAI,CAAC,IAAI,CAAC8B,YAAY,CAAC5hB,IAAI,CAAE+kB,CAAC,IAAKA,CAAC,CAACjH,mBAAmB,CAAC,IAAI,CAACmN,YAAY,CAACnL,KAAK,CAAC,EAAE;MACjF,MAAM;QAAEyN,MAAM;QAAEC,OAAO;QAAEC,OAAO;QAAEC,QAAQ;QAAE7xB,GAAG;QAAE8xB,IAAI;QAAEC;MAAQ,CAAC,GAAG9N,KAAK;MACxE,IAAI,CAAC3uB,OAAO,CAAC0G,IAAI,CAACgvB,eAAe,EAAE;QACjC/G,KAAK,EAAE;UAAEyN,MAAM;UAAEC,OAAO;UAAEC,OAAO;UAAEC,QAAQ;UAAE7xB,GAAG;UAAE8xB,IAAI;UAAEC;QAAQ;MAClE,CAAC,CAAC;IACJ;EACF;EACM5B,iBAAiBA,CAACU,SAAS,EAAE;IAAA,IAAAmB,OAAA;IAAA,OAAA9mB,iBAAA;MACjC8mB,OAAI,CAACjC,cAAc,CAACmB,YAAY,CAAC;QAAEzc,QAAQ,EAAE,OAAO;QAAE,GAAGoc;MAAU,CAAC,CAAC;MACrE,MAAMmB,OAAI,CAAChM,0BAA0B;MACrCgM,OAAI,CAAC18B,OAAO,CAAC0G,IAAI,CAAC4uB,qBAAqB,EAAEoH,OAAI,CAACjC,cAAc,CAACc,SAAS,CAAC;MACvEmB,OAAI,CAAClB,eAAe,CAAC,CAAC;IAAC;EACzB;EACAV,mBAAmBA,CAAC6B,WAAW,EAAE;IAC/B,IAAI,CAAClC,cAAc,CAACmC,cAAc,CAACD,WAAW,CAAC;EACjD;EACMhL,eAAeA,CAAAkL,IAAA,EAAc;IAAA,IAAAC,6BAAA,GAAAA,CAAA,WAAAnL,eAAA;MAAAoL,OAAA;IAAA,OAAAnnB,iBAAA,YAAb;MAAE/M;IAAQ,CAAC;MAC/B,MAAM8qB,YAAY,GAAGoJ,OAAI,CAACC,aAAa,YAAY7M,WAAW,IAAI4M,OAAI,CAACC,aAAa,CAACjwB,KAAK,IAAI,KAAK,CAAC;MACpG+vB,6BAAA,GAAA1B,IAAA,CAAA2B,OAAA,EAAsB;QAAEl0B,OAAO;QAAE8qB;MAAa,CAAC,CAAC;MAChD,IAAIoJ,OAAI,CAACC,aAAa,YAAYpD,aAAa,IAAImD,OAAI,CAACC,aAAa,YAAY3D,aAAa,EAAE;QAC9F,MAAM0D,OAAI,CAACC,aAAa,CAACvN,QAAQ,GAAG,CAAC;MACvC;IAAC,GAAArZ,KAAA,OAAAC,SAAA;EACH;EACMub,YAAYA,CAAAqL,IAAA,EAA2B;IAAA,IAAAC,0BAAA,GAAAA,CAAA,WAAAtL,YAAA;MAAAuL,OAAA;IAAA,OAAAvnB,iBAAA,YAA1B;MAAE5T,OAAO;MAAEyG;IAAY,CAAC;MACzCy0B,0BAAA,GAAA9B,IAAA,CAAA+B,OAAA,EAAmB;QAAEn7B,OAAO;QAAEyG;MAAY,CAAC,CAAC;IAAC,GAAA2N,KAAA,OAAAC,SAAA;EAC/C;EACM0kB,gBAAgBA,CAAAqC,IAAA,EAAU;IAAA,IAAAC,OAAA;IAAA,OAAAznB,iBAAA,YAAT;MAAE0nB;IAAI,CAAC;MAC5B,MAAMD,OAAI,CAAC3M,0BAA0B;MACrC,IAAI2M,OAAI,CAACnM,eAAe,EAAE;QACxB,MAAM5wB,OAAO,CAACi9B,UAAU,CAACD,GAAG,CAACz4B,GAAG,CAAE5C,EAAE,IAAKo7B,OAAI,CAACnM,eAAe,EAAE3L,SAAS,CAACtjB,EAAE,CAAC,CAAC,CAAC;MAChF;IAAC,GAAAmU,KAAA,OAAAC,SAAA;EACH;EACA;EACA;EACA;EACA;EACA;EACA;EACMmlB,eAAeA,CAAA,EAAyB;IAAA,IAAAgC,OAAA;IAAA,OAAA5nB,iBAAA,YAAxB;MAAEimB;IAAc,CAAC,GAAG,CAAC,CAAC;MAC1C,MAAM;QAAEtkB;MAAe,CAAC,GAAGimB,OAAI;MAC/B,IAAI,CAACA,OAAI,CAACtM,eAAe,IAAI,CAAC3Z,cAAc,EAAE;QAC5C,MAAM,IAAI8e,6CAA6C,CAAC;UAAEtD,UAAU,EAAE;QAAkB,CAAC,CAAC;MAC5F;MACA,MAAM;QAAEwI;MAAU,CAAC,GAAGiC,OAAI,CAAC/C,cAAc;MACzC,IAAI,CAACc,SAAS,EAAE;QACd,MAAM,IAAIn3B,KAAK,CAAC,sDAAsD,CAAC;MACzE;MACA,MAAM;QAAEpC;MAAQ,CAAC,GAAGu5B,SAAS;MAC7B,IAAI/sB,KAAK;MACT,IAAI;QACFA,KAAK,SAASgvB,OAAI,CAACtM,eAAe,CAACliB,cAAc,CAAChN,OAAO,CAAC;MAC5D,CAAC,CAAC,OAAOmoB,GAAG,EAAE;QACZ,IAAIqT,OAAI,CAACR,aAAa,EAAE;UACtB,MAAMQ,OAAI,CAAC5Q,cAAc,CAAC4Q,OAAI,CAACR,aAAa,CAAC;QAC/C;QACAQ,OAAI,CAAC7B,2BAA2B,CAAC35B,OAAO,EAAEmoB,GAAG,CAAC;QAC9C;MACF;MACA,MAAMsT,cAAc,GAAGD,OAAI,CAACE,gBAAgB,EAAE17B,OAAO,KAAKA,OAAO;MACjE,MAAM+yB,eAAe,GAAGyI,OAAI,CAACR,aAAa,EAAEl1B,IAAI,KAAK0G,KAAK,CAAC1G,IAAI;MAC/D,IAAI0G,KAAK,CAAC1G,IAAI,KAAK,OAAO,EAAE;QAC1B01B,OAAI,CAAC9C,IAAI,CAACiD,kBAAkB,CAAC;UAAEC,SAAS,EAAE7I;QAAgB,CAAC,CAAC;MAC9D,CAAC,MAAM;QACLyI,OAAI,CAAC9C,IAAI,CAACmD,iBAAiB,CAAC;UAAED,SAAS,EAAE7I;QAAgB,CAAC,CAAC;MAC7D;MACA,IAAIyI,OAAI,CAACR,aAAa,EAAErP,WAAW,CAAC,CAAC,EAAE;QACrC,MAAM6P,OAAI,CAAC5Q,cAAc,CAAC4Q,OAAI,CAACR,aAAa,CAAC;MAC/C;MACA,IAAIjsB,MAAM;MACV,IAAIvC,KAAK,CAAC1G,IAAI,KAAK,OAAO,EAAE;QAC1BiJ,MAAM,GAAG,IAAIof,WAAW,CACtBqN,OAAI,CAACx9B,OAAO,EACZw9B,OAAI,CAACtM,eAAe,EACpB3Z,cAAc,EACdimB,OAAI,CAACM,kBAAkB,CAAC97B,OAAO,CAAC,EAChCA,OAAO,EACP,OACF,CAAC;MACH,CAAC,MAAM,IAAIo4B,UAAU,CAAC5rB,KAAK,CAAC,EAAE;QAC5BuC,MAAM,GAAG,IAAI6oB,aAAa,CACxB4D,OAAI,CAACx9B,OAAO,EACZw9B,OAAI,CAACtM,eAAe,EACpB1iB,KAAK,EACLgvB,OAAI,CAACM,kBAAkB,CAAC97B,OAAO,CACjC,CAAC;MACH,CAAC,MAAM;QACL+O,MAAM,GAAG,IAAIsoB,aAAa,CACxBmE,OAAI,CAACx9B,OAAO,EACZw9B,OAAI,CAACtM,eAAe,EACpB1iB,KAAK,EACLgvB,OAAI,CAACM,kBAAkB,CAAC97B,OAAO,CACjC,CAAC;MACH;MACA,MAAM+7B,aAAa,GAAGP,OAAI,CAACE,gBAAgB;MAC3CF,OAAI,CAACE,gBAAgB,GAAGnC,SAAS;MACjC,MAAMyC,UAAU,GAAGR,OAAI,CAACR,aAAa;MACrCQ,OAAI,CAACR,aAAa,GAAGjsB,MAAM;MAC3B,IAAI;QACF,MAAMA,MAAM,CAACyc,OAAO,CAAC,CAAC;MACxB,CAAC,CAAC,OAAOrD,GAAG,EAAE;QACZ,IAAI6T,UAAU,EAAE;UACd,MAAMR,OAAI,CAAC5Q,cAAc,CAACoR,UAAU,CAAC;QACvC;QACA,IAAI7T,GAAG,KAAK8B,eAAe,EAAE;UAC3BuR,OAAI,CAAC7B,2BAA2B,CAAC35B,OAAO,EAAEmoB,GAAG,CAAC;QAChD;QACA;MACF;MACA,MAAM8T,qBAAqB,GAAG,CAACR,cAAc,IAAIO,UAAU,IAAI,CAACjtB,MAAM,CAAClS,OAAO,CAACm/B,UAAU,CAAC;MAC1F,IAAInC,aAAa,IAAIxB,aAAa,CAACtpB,MAAM,CAAC,EAAE;QAC1CjS,SAAS,CAAC,CAAC,CAACiS,MAAM,CAAChE,KAAK,CAAC;QACzBywB,OAAI,CAACtM,eAAe,CAAC5tB,IAAI,CAAC8J,mBAAmB,CAAC2D,MAAM,CAAChE,KAAK,EAAE8uB,aAAa,CAAC;MAC5E;MACA,IAAImC,UAAU,IAAI,CAACA,UAAU,CAACnR,QAAQ,IAAI,CAAC4Q,cAAc,IAAI,CAACQ,qBAAqB,IAAI,CAAClJ,eAAe,EAAE;QACvGyI,OAAI,CAACR,aAAa,GAAGgB,UAAU;QAC/BR,OAAI,CAACx9B,OAAO,CAAC0G,IAAI,CAACyvB,eAAe,EAAEn0B,OAAO,CAAC;QAC3Cw7B,OAAI,CAAC9C,IAAI,CAAC9a,QAAQ,CAAC,CAAC;QACpB;MACF;MACA,IAAIoe,UAAU,EAAE;QACd,MAAMR,OAAI,CAAC5Q,cAAc,CAACoR,UAAU,EAAE;UAAEjJ;QAAgB,CAAC,CAAC;MAC5D;MACA,IAAIgJ,aAAa,KAAKN,cAAc,IAAI1I,eAAe,CAAC,EAAE;QACxDyI,OAAI,CAACx9B,OAAO,CAAC0G,IAAI,CAACkvB,aAAa,EAAE5zB,OAAO,CAAC;MAC3C;MACA,IAAIq4B,aAAa,CAACtpB,MAAM,CAAC,EAAE;QACzBjS,SAAS,CAAC,CAAC,CAACiS,MAAM,CAAChE,KAAK,CAAC;QACzB,MAAM;UACJzE,UAAU;UACV0E,WAAW;UACXjC,QAAQ;UACRiO,YAAY;UACZnL,cAAc;UACdiW,WAAW;UACXnM,YAAY;UACZ9O;QACF,CAAC,GAAG20B,OAAI,CAACtM,eAAe,CAACnL,eAAe,CAAChV,MAAM,CAAChE,KAAK,CAAC;QACtDywB,OAAI,CAACx9B,OAAO,CAAC0G,IAAI,CAACqvB,cAAc,EAAE;UAChC9zB,EAAE,EAAED,OAAO;UACXsG,UAAU;UACV0E,WAAW;UACXjC,QAAQ;UACRzH,IAAI,EAAE0V;QACR,CAAC,CAAC;QACFwkB,OAAI,CAACx9B,OAAO,CAAC0G,IAAI,CAAC8uB,gBAAgB,EAAE;UAAE1R,WAAW;UAAEnM,YAAY;UAAE9O,OAAO;UAAEgF;QAAe,CAAC,CAAC;MAC7F,CAAC,MAAM;QACL,IAAI;UAAEvF;QAAW,CAAC,GAAGk1B,OAAI,CAACtM,eAAe,CAACne,kBAAkB;QAC5D,MAAM;UAAElF,cAAc;UAAEhF;QAAQ,CAAC,GAAG20B,OAAI,CAACtM,eAAe,CAACpN,WAAW;QACpE0Z,OAAI,CAACx9B,OAAO,CAAC0G,IAAI,CAAC8uB,gBAAgB,EAAE;UAClC3sB,OAAO;UACPgF,cAAc;UACd8J,YAAY,EAAE,CAAC,CAAC;UAChBmM,WAAW,EAAEjb;QACf,CAAC,CAAC;QACF,IAAI0xB,eAAe,CAACxpB,MAAM,CAAC,IAAIA,MAAM,CAACvC,KAAK,CAACyC,IAAI,EAAEpO,QAAQ,CAACq3B,gBAAgB,CAAC,EAAE;UAC5E,IAAI,CAACnpB,MAAM,CAAC6U,QAAQ,EAAE;YACpB,MAAM,IAAI2Q,+BAA+B,CAAC;cAAEv0B;YAAQ,CAAC,CAAC;UACxD;UACA,CAAC;YAAEsG;UAAW,CAAC,GAAGk1B,OAAI,CAACtM,eAAe,CAACjM,uBAAuB,CAAC;YAC7D/R,OAAO,EAAEnC,MAAM,CAAC6U,QAAQ,CAAC,CAAC;UAC5B,CAAC,CAAC;QACJ;QACA4X,OAAI,CAACx9B,OAAO,CAAC0G,IAAI,CAAC6uB,aAAa,EAAE;UAC/BtzB,EAAE,EAAED,OAAO;UACXsG;QACF,CAAC,CAAC;MACJ;MACA,IAAI+xB,aAAa,CAACtpB,MAAM,CAAC,EAAE;QACzBjS,SAAS,CAAC,CAAC,CAACiS,MAAM,CAAChE,KAAK,CAAC;QACzBywB,OAAI,CAAC/M,YAAY,CAAC1qB,IAAI,CAACgL,MAAM,CAAC;QAC9BysB,OAAI,CAACR,aAAa,CAACnP,eAAe,CAChC2P,OAAI,CAAC9C,IAAI,CAACwD,eAAe,CAACntB,MAAM,CAAChE,KAAK,CACxC,CAAC;MACH,CAAC,MAAM;QACLywB,OAAI,CAACR,aAAa,CAACnP,eAAe,CAChC2P,OAAI,CAAC9C,IAAI,CAACyD,cAAc,CAAC,CAAC;QAC1B;QACAX,OAAI,CAAC9I,oBAAoB,CAACzsB,IAAI,CAACu1B,OAAI,CACrC,CAAC;MACH;IAAC,GAAApnB,KAAA,OAAAC,SAAA;EACH;EACMuW,cAAcA,CAAAwR,IAAA,EAA2C;IAAA,IAAAC,OAAA;IAAA,OAAAzoB,iBAAA,YAA1C7E,MAAM,EAAE;MAAEgkB,eAAe,GAAG;IAAM,CAAC,GAAG,CAAC,CAAC;MAC3DsJ,OAAI,CAAC5N,YAAY,GAAG4N,OAAI,CAAC5N,YAAY,CAACvlB,MAAM,CAAE0oB,CAAC,IAAKA,CAAC,KAAK7iB,MAAM,CAAC;MACjE,MAAMA,MAAM,EAAEod,QAAQ,GAAG;QAAE4G;MAAgB,CAAC,CAAC;IAAC,GAAA3e,KAAA,OAAAC,SAAA;EAChD;EACA;EACAynB,kBAAkBA,CAAC97B,OAAO,EAAE;IAC1B,OAAO;MACLqsB,qBAAqB,EAAE,eAAgBhvB,MAAM,CAAC,MAAM,IAAI,CAACq7B,IAAI,CAACrM,qBAAqB,CAAC,CAAC,EAAE,uBAAuB,CAAC;MAC/GzO,QAAQ,EAAE,eAAgBvgB,MAAM,CAAC,MAAM,IAAI,CAACq7B,IAAI,CAAC9a,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC;MACxEC,SAAS,EAAE,eAAgBxgB,MAAM,CAAE8qB,GAAG,IAAK,IAAI,CAACmU,WAAW,CAACt8B,OAAO,EAAEmoB,GAAG,CAAC,EAAE,WAAW,CAAC;MACvFpK,aAAa,EAAE,eAAgB1gB,MAAM,CAAE8qB,GAAG,IAAK,IAAI,CAACoU,eAAe,CAACv8B,OAAO,EAAEmoB,GAAG,CAAC,EAAE,eAAe;IACpG,CAAC;EACH;EACAgI,uBAAuBA,CAACtD,MAAM,EAAE1E,GAAG,EAAE;IACnC,KAAK,CAACgI,uBAAuB,CAACtD,MAAM,EAAE1E,GAAG,CAAC;IAC1C,IAAI,CAACuQ,IAAI,CAAC8D,gBAAgB,CAACrU,GAAG,CAAC;EACjC;EACAsR,kBAAkBA,CAAA,EAAG;IACnB,IAAI,CAACf,IAAI,CAAC+D,aAAa,CAAC,CAAC;IACzB,IAAI,CAACz+B,OAAO,CAAC0G,IAAI,CAACovB,aAAa,CAAC;EAClC;EACA6F,2BAA2BA,CAACD,cAAc,EAAEvR,GAAG,EAAE;IAC/CkL,OAAO,CAAC9pB,KAAK,CAAC4e,GAAG,CAAC;IAClB,IAAI,CAACuQ,IAAI,CAAC8D,gBAAgB,CAACrU,GAAG,CAAC;IAC/B,IAAI,CAACnqB,OAAO,CAAC0G,IAAI,CAACovB,aAAa,EAAE4F,cAAc,CAAC;EAClD;EACA;EACA6C,eAAeA,CAACv8B,OAAO,EAAEuJ,KAAK,EAAE;IAC9B,MAAM;MAAE3H,IAAI,GAAG,OAAO;MAAEwmB,OAAO,GAAGlgB,MAAM,CAACqB,KAAK,CAAC;MAAE8I;IAAM,CAAC,GAAG9I,KAAK;IAChE,MAAMwhB,QAAQ,GAAG,IAAI,CAACiQ,aAAa,EAAEjQ,QAAQ;IAC7C,IAAI,CAAC/sB,OAAO,CAAC0G,IAAI,CAACwvB,qBAAqB,EAAE;MAAEtyB,IAAI;MAAEwmB,OAAO;MAAE/V;IAAM,CAAC,CAAC;IAClE,IAAI,CAACrU,OAAO,CAAC0G,IAAI,CAACsvB,2BAA2B,EAAE;MAAE1I,QAAQ,EAAE,SAAS;MAAEP,QAAQ;MAAE/qB;IAAQ,CAAC,CAAC;IAC1F,IAAI,CAAC04B,IAAI,CAAC8D,gBAAgB,CAACjzB,KAAK,CAAC;IACjC8pB,OAAO,CAAC9pB,KAAK,CAAC,0BAA0BvJ,OAAO,IAAI,CAAC;IACpDqzB,OAAO,CAAC9pB,KAAK,CAACA,KAAK,CAAC;EACtB;EACA;EACA;EACA+yB,WAAWA,CAACt8B,OAAO,EAAE;IAAE+M,KAAK;IAAE+Q;EAAY,CAAC,EAAE;IAC3C,MAAMiN,QAAQ,GAAG,IAAI,CAACiQ,aAAa,EAAEjQ,QAAQ;IAC7C,IAAI,CAAC/sB,OAAO,CAAC0G,IAAI,CAACmvB,aAAa,EAAE;MAAE9mB,KAAK;MAAE+Q;IAAY,CAAC,CAAC;IACxD,IAAI,CAAC9f,OAAO,CAAC0G,IAAI,CAACsvB,2BAA2B,EAAE;MAAE1I,QAAQ,EAAE,SAAS;MAAEP,QAAQ;MAAE/qB;IAAQ,CAAC,CAAC;IAC1F,IAAI,CAAC04B,IAAI,CAAC8D,gBAAgB,CAAC;MAAEpU,OAAO,EAAErb,KAAK;MAAEsF,KAAK,EAAEyL;IAAY,CAAC,CAAC;IAClEuV,OAAO,CAAC9pB,KAAK,CAAC,yBAAyBwD,KAAK,KAAK+Q,WAAW,EAAE,CAAC;EACjE;AACF,CAAC;AACDzgB,MAAM,CAACm7B,qBAAqB,EAAE,sBAAsB,CAAC;AACrD,IAAIkE,oBAAoB,GAAGlE,qBAAqB;;AAEhD;AACA,IAAImE,iBAAiB,GAAGr/B,OAAO,CAACZ,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC;AAClD,SAASa,MAAM,IAAIq/B,OAAO,QAAQ,mBAAmB;;AAErD;AACA,SAASh1B,IAAI,IAAIi1B,KAAK,QAAQ,kCAAkC;AAChE,IAAIC,gBAAgB,GAAGx/B,OAAO,CAACZ,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC;AACjD,IAAIqgC,iBAAiB,GAAG,mBAAmB;AAC3C,IAAIC,aAAa,GAAG,uBAAuB;AAC3C,IAAIC,UAAU,GAAG,6CAA6C;AAC9D,IAAIC,YAAY,GAAG,kGAAkG;AACrH,IAAIC,YAAY,GAAG,eAAgB9/B,MAAM,CAAC,CAACqL,GAAG,GAAG,EAAE,EAAEN,KAAK,KAAK;EAC7D,IAAIM,GAAG,KAAK,IAAI,EAAE;IAChB,OAAO,KAAK;EACd;EACA,IAAIA,GAAG,KAAK,EAAE,IAAI,CAACq0B,iBAAiB,CAACnkB,IAAI,CAAClQ,GAAG,CAAC,EAAE;IAC9C,OAAO,KAAK;EACd;EACA,IAAIN,KAAK,KAAK,IAAI,IAAIA,KAAK,KAAK,KAAK,CAAC,EAAE;IACtC,OAAO,IAAI;EACb;EACA,IAAIA,KAAK,YAAY4iB,IAAI,EAAE;IACzB,OAAO,IAAI;EACb;EACA,IAAI,OAAO5iB,KAAK,KAAK,QAAQ,IAAI,OAAOA,KAAK,KAAK,SAAS,EAAE;IAC3D,OAAO,IAAI;EACb;EACA,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC7B,OAAO20B,iBAAiB,CAACnkB,IAAI,CAACxQ,KAAK,CAAC,IAAI40B,aAAa,CAACpkB,IAAI,CAACxQ,KAAK,CAAC,IAAI60B,UAAU,CAACrkB,IAAI,CAACxQ,KAAK,CAAC,IAAI80B,YAAY,CAACtkB,IAAI,CAACxQ,KAAK,CAAC;EACzH;EACA,IAAIxE,KAAK,CAACC,OAAO,CAACuE,KAAK,CAAC,EAAE;IACxB,OAAOA,KAAK,CAAChF,KAAK,CAAE+F,CAAC,IAAKg0B,YAAY,CAACz0B,GAAG,EAAES,CAAC,CAAC,CAAC;EACjD;EACA,IAAIjM,aAAa,CAACkL,KAAK,CAAC,EAAE;IACxB,OAAOxC,MAAM,CAACC,OAAO,CAACuC,KAAK,CAAC,CAAChF,KAAK,CAAC,CAAC,CAACg6B,CAAC,EAAEj0B,CAAC,CAAC,KAAKg0B,YAAY,CAACC,CAAC,EAAEj0B,CAAC,CAAC,CAAC;EACpE;EACA,OAAO,KAAK;AACd,CAAC,EAAE,cAAc,CAAC;AAClB,IAAIk0B,aAAa,GAAG;EAClBC,SAAS,EAAE,GAAG;EACd;EACAC,OAAO,EAAE,IAAI;EACbC,WAAW,EAAE,IAAI;EACjBC,iBAAiB,EAAE,SAAS;EAC5BC,aAAa,EAAE,IAAI;EACnB;EACAC,iBAAiBA,CAACC,GAAG,EAAE;IACrB,IAAIA,GAAG,CAAC9wB,UAAU,CAAC,GAAG,CAAC,EAAE;MACvB,IAAI8wB,GAAG,KAAK,YAAY,EAAE;QACxB,OAAO,KAAK,CAAC;MACf;MACA,IAAIA,GAAG,KAAK,OAAO,EAAE;QACnB,OAAO,IAAI;MACb;MACA,IAAIA,GAAG,KAAK,OAAO,EAAE;QACnB,OAAO,IAAI;MACb;MACA,IAAIA,GAAG,KAAK,QAAQ,EAAE;QACpB,OAAO,KAAK;MACd;MACA,IAAIA,GAAG,CAAC9wB,UAAU,CAAC,QAAQ,CAAC,IAAI8wB,GAAG,CAAC7rB,QAAQ,CAAC,GAAG,CAAC,EAAE;QACjD,OAAO,IAAIiZ,IAAI,CAAC4S,GAAG,CAACC,UAAU,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC5rB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;MACxD;MACA,IAAI2rB,GAAG,CAAC9wB,UAAU,CAAC,OAAO,CAAC,IAAI8wB,GAAG,CAAC7rB,QAAQ,CAAC,GAAG,CAAC,EAAE;QAChD,OAAO,IAAI6rB,GAAG,CAAC3rB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE;MAC/B;MACA,MAAM0G,KAAK,GAAGilB,GAAG,CAAC3rB,KAAK,CAAC,CAAC,CAAC,CAACN,KAAK,CAACurB,YAAY,CAAC;MAC9C,IAAIvkB,KAAK,EAAE;QACT,IAAIilB,GAAG,CAAC9wB,UAAU,CAAC,OAAO,CAAC,IAAI8wB,GAAG,CAAC9wB,UAAU,CAAC,OAAO,CAAC,EAAE;UACtD,OAAO,GAAG6L,KAAK,CAAC,CAAC,CAAC,IAAIA,KAAK,CAAC,CAAC,CAAC,KAAKA,KAAK,CAAC,CAAC,CAAC,KAAKA,KAAK,CAAC,CAAC,CAAC,KAAKA,KAAK,CAAC,CAAC,CAAC,GAAG;QAC1E;QACA,IAAIilB,GAAG,CAAC9wB,UAAU,CAAC,OAAO,CAAC,IAAI8wB,GAAG,CAAC9wB,UAAU,CAAC,OAAO,CAAC,EAAE;UACtD,OAAO,GAAG6L,KAAK,CAAC,CAAC,CAAC,IAAIA,KAAK,CAAC,CAAC,CAAC,KAAKA,KAAK,CAAC,CAAC,CAAC,MAAMA,KAAK,CAAC,CAAC,CAAC,MAAMA,KAAK,CAAC,CAAC,CAAC,GAAG;QAC5E;QACA,OAAOilB,GAAG,CAAC9wB,UAAU,CAAC,MAAM,CAAC,IAAI8wB,GAAG,CAAC9wB,UAAU,CAAC,MAAM,CAAC,GAAG,GAAG6L,KAAK,CAAC,CAAC,CAAC,IAAIA,KAAK,CAAC,CAAC,CAAC,KAAKA,KAAK,CAAC,CAAC,CAAC,KAAKA,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGA,KAAK,CAAC,CAAC,CAAC,IAAIA,KAAK,CAAC,CAAC,CAAC,KAAKA,KAAK,CAAC,CAAC,CAAC,MAAMA,KAAK,CAAC,CAAC,CAAC,IAAI;MACzK;IACF;IACA,IAAIqkB,aAAa,CAACpkB,IAAI,CAACglB,GAAG,CAAC,EAAE;MAC3B,OAAOz1B,MAAM,CAACy1B,GAAG,CAAC;IACpB;IACA,OAAOA,GAAG;EACZ;AACF,CAAC;AACD,IAAIE,cAAc,GAAG,eAAgBzgC,MAAM,CAAE0gC,UAAU,IAAK;EAC1D,MAAM1Y,KAAK,GAAG0Y,UAAU,CAACjY,KAAK,CAAC,GAAG,CAAC,CAACjjB,GAAG,CAAEm7B,IAAI,IAAKA,IAAI,CAAC9rB,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;EAC3F,OAAOtM,MAAM,CAACC,OAAO,CAAC,CAAC,CAAC,EAAEi3B,gBAAgB,CAACmB,KAAK,EAAE5Y,KAAK,CAACtb,IAAI,CAAC,GAAG,CAAC,EAAEszB,aAAa,CAAC,CAAC,CAACh1B,MAAM,CAAC,CAACC,GAAG,EAAE,CAACI,GAAG,EAAEN,KAAK,CAAC,KAAK;IAC/G,IAAI+0B,YAAY,CAACz0B,GAAG,EAAEN,KAAK,CAAC,EAAE;MAC5B,OAAOxC,MAAM,CAACgD,MAAM,CAACN,GAAG,EAAE;QAAE,CAACI,GAAG,GAAGN;MAAM,CAAC,CAAC;IAC7C;IACAy0B,KAAK,CAAC/4B,IAAI,CAAC1G,MAAM;AACrB;AACA;AACA;AACA,KAAK,CAAC;IACF,OAAOkL,GAAG;EACZ,CAAC,EAAE,CAAC,CAAC,CAAC;AACR,CAAC,EAAE,gBAAgB,CAAC;;AAEpB;AACA,IAAI;EAAE41B,OAAO;EAAE7f,QAAQ,EAAE8f;AAAU,CAAC,GAAGvB,OAAO;AAC9C,SAASwB,QAAQA,CAAClZ,IAAI,EAAE;EACtB,MAAMvT,KAAK,GAAG,CAACuT,IAAI,IAAI,EAAE,EAAEvT,KAAK,CAAC,gBAAgB,CAAC;EAClD,IAAI,CAACA,KAAK,EAAE;IACV,MAAM,IAAIvP,KAAK,CAAC,iBAAiB8iB,IAAI,+BAA+B,CAAC;EACvE;EACA,OAAOvT,KAAK,CAAC,CAAC,CAAC;AACjB;AACAtU,MAAM,CAAC+gC,QAAQ,EAAE,UAAU,CAAC;AAC5B,IAAIC,cAAc,GAAG,eAAgBhhC,MAAM,CAAC,CAAC;EAC3Ck8B,SAAS;EACT+E;AACF,CAAC,KAAK;EACJ,MAAMC,MAAM,GAAGJ,SAAS,EAAElQ,QAAQ,CAACsQ,MAAM,CAACtsB,KAAK,CAAC,CAAC,CAAC;EAClD,MAAM;IAAEiT,IAAI;IAAEsZ,YAAY;IAAEC,aAAa;IAAE,GAAGhxB;EAAK,CAAC,GAAG,CAAC,CAAC,EAAEkvB,iBAAiB,CAACsB,KAAK,EAAEM,MAAM,CAAC;EAC3F,MAAMG,QAAQ,GAAG,CAAC,CAAC,EAAE/B,iBAAiB,CAAC5sB,SAAS,EAAE;IAChD,GAAGtC,IAAI;IACP,GAAG6wB,WAAW;IACd,IAAG/E,SAAS,IAAI;MAAEt5B,EAAE,EAAEs5B,SAAS,CAACv5B,OAAO;MAAEmd,QAAQ,EAAEoc,SAAS,CAACpc;IAAS,CAAC;EACzE,CAAC,CAAC;EACF,OAAO,IAAIuhB,QAAQ,EAAE;AACvB,CAAC,EAAE,gBAAgB,CAAC;AACpB,IAAIC,OAAO,GAAG,eAAgBthC,MAAM,CAAEk8B,SAAS,IAAK;EAClD,IAAI,CAACA,SAAS,EAAE;IACd;EACF;EACA,MAAMqF,KAAK,GAAGP,cAAc,CAAC;IAAE9E;EAAU,CAAC,CAAC;EAC3C,MAAM;IAAEsF,IAAI,GAAG;EAAG,CAAC,GAAGV,SAAS,CAAClQ,QAAQ;EACxCkQ,SAAS,CAACpxB,KAAK,GAAGwsB,SAAS,CAACv5B,OAAO;EACnCk+B,OAAO,CAACY,YAAY,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,GAAGX,SAAS,CAAClQ,QAAQ,CAAC8Q,QAAQ,GAAGH,KAAK,GAAGC,IAAI,EAAE,CAAC;AAC/E,CAAC,EAAE,SAAS,CAAC;AACb,IAAIG,QAAQ,GAAG,eAAgB3hC,MAAM,CAAEsL,GAAG,IAAKA,GAAG,IAAI,IAAI,IAAI,OAAOA,GAAG,KAAK,QAAQ,IAAI/E,KAAK,CAACC,OAAO,CAAC8E,GAAG,CAAC,KAAK,KAAK,EAAE,UAAU,CAAC;AAClI,IAAIs2B,cAAc,GAAG,eAAgB5hC,MAAM,CAAE8L,CAAC,IAAK;EACjD,IAAIA,CAAC,KAAK,KAAK,CAAC,EAAE;IAChB,OAAO,KAAK,CAAC;EACf;EACA,IAAI,OAAOA,CAAC,KAAK,QAAQ,EAAE;IACzB,OAAOA,CAAC;EACV;EACA,IAAIvF,KAAK,CAACC,OAAO,CAACsF,CAAC,CAAC,EAAE;IACpB,OAAO81B,cAAc,CAAC91B,CAAC,CAAC,CAAC,CAAC,CAAC;EAC7B;EACA,IAAI61B,QAAQ,CAAC71B,CAAC,CAAC,EAAE;IACf,OAAO81B,cAAc,CACnBr5B,MAAM,CAAC2G,MAAM,CAACpD,CAAC,CAAC,CAACD,MAAM,CAACsR,OAAO,CACjC,CAAC;EACH;EACA,OAAO,KAAK,CAAC;AACf,CAAC,EAAE,gBAAgB,CAAC;AACpB,IAAI0kB,6BAA6B,GAAG,eAAgB7hC,MAAM,CAAC,MAAM;EAC/D,IAAI,OAAO8gC,SAAS,KAAK,WAAW,EAAE;IACpC,MAAMO,QAAQ,GAAGP,SAAS,CAAClQ,QAAQ,CAACsQ,MAAM,CAACtsB,KAAK,CAAC,CAAC,CAAC;IACnD,MAAM2sB,KAAK,GAAG,CAAC,CAAC,EAAEjC,iBAAiB,CAACsB,KAAK,EAAES,QAAQ,CAAC;IACpD,MAAMp9B,IAAI,GAAG,OAAOs9B,KAAK,CAACt9B,IAAI,KAAK,QAAQ,GAAGw8B,cAAc,CAACc,KAAK,CAACt9B,IAAI,CAAC,GAAG,KAAK,CAAC;IACjF,MAAMuF,OAAO,GAAG,OAAO+3B,KAAK,CAAC/3B,OAAO,KAAK,QAAQ,GAAGi3B,cAAc,CAACc,KAAK,CAAC/3B,OAAO,CAAC,GAAG,KAAK,CAAC;IAC1F,IAAIsW,QAAQ,GAAG8hB,cAAc,CAACL,KAAK,CAACzhB,QAAQ,CAAC;IAC7C,IAAI,OAAOA,QAAQ,KAAK,QAAQ,IAAI,CAACA,QAAQ,CAACxL,KAAK,CAAC,YAAY,CAAC,EAAE;MACjEwL,QAAQ,GAAG,OAAO;IACpB;IACA,MAAM+H,IAAI,GAAG+Z,cAAc,CAACL,KAAK,CAAC1Z,IAAI,CAAC;IACvC,MAAMllB,OAAO,GAAGklB,IAAI,GAAGkZ,QAAQ,CAAClZ,IAAI,CAAC,GAAG+Z,cAAc,CAACL,KAAK,CAAC3+B,EAAE,CAAC;IAChE,IAAID,OAAO,EAAE;MACX,OAAO;QAAE05B,cAAc,EAAE15B,OAAO;QAAEsB,IAAI;QAAEuF,OAAO;QAAEsW;MAAS,CAAC;IAC7D;EACF;EACA,OAAO,IAAI;AACb,CAAC,EAAE,+BAA+B,CAAC;AACnC,IAAIgiB,SAAS,GAAG,MAAMA,SAAS,CAAC;EAC9BrhC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACm7B,kBAAkB,GAAGiG,6BAA6B,CAAC,CAAC;EAC3D;EACAtF,YAAYA,CAACL,SAAS,EAAE;IACtB,IAAI,CAACA,SAAS,GAAGA,SAAS;IAC1BoF,OAAO,CAAC,IAAI,CAACpF,SAAS,CAAC;EACzB;EACAqB,cAAcA,CAACD,WAAW,EAAE;IAC1B,MAAMiE,KAAK,GAAGP,cAAc,CAAC;MAAEC,WAAW,EAAE3D;IAAY,CAAC,CAAC;IAC1D,MAAM;MAAEkE,IAAI,GAAG;IAAG,CAAC,GAAGV,SAAS,CAAClQ,QAAQ;IACxCiQ,OAAO,CAACY,YAAY,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,GAAGX,SAAS,CAAClQ,QAAQ,CAAC8Q,QAAQ,GAAGH,KAAK,GAAGC,IAAI,EAAE,CAAC;EAC/E;AACF,CAAC;AACDxhC,MAAM,CAAC8hC,SAAS,EAAE,UAAU,CAAC;AAC7B,IAAIC,QAAQ,GAAGD,SAAS;;AAExB;AACA,IAAIE,mBAAmB,GAAG/hC,OAAO,CAACP,oBAAoB,CAAC,CAAC,EAAE,CAAC,CAAC;AAC5D,IAAIuiC,iBAAiB,GAAGhiC,OAAO,CAACZ,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC;AAClD,SAASkC,MAAM,IAAI2gC,OAAO,QAAQ,kCAAkC;AACpE,SAAShiC,MAAM,IAAIiiC,OAAO,QAAQ,mBAAmB;AACrD,IAAI;EAAEnhB,QAAQ,EAAEohB;AAAU,CAAC,GAAGD,OAAO;AACrC,IAAIE,eAAe,GAAG,GAAG;AACzB,IAAIC,IAAI,GAAG,eAAgB,CAAEC,KAAK,IAAK;EACrCA,KAAK,CAAC,MAAM,CAAC,GAAG,MAAM;EACtBA,KAAK,CAAC,WAAW,CAAC,GAAG,WAAW;EAChCA,KAAK,CAAC,iBAAiB,CAAC,GAAG,iBAAiB;EAC5CA,KAAK,CAAC,gBAAgB,CAAC,GAAG,gBAAgB;EAC1CA,KAAK,CAAC,OAAO,CAAC,GAAG,OAAO;EACxB,OAAOA,KAAK;AACd,CAAC,EAAED,IAAI,IAAI,CAAC,CAAC,CAAC;AACd,IAAIE,OAAO,GAAG;EACZC,eAAe,EAAE,yBAAyB;EAC1CC,cAAc,EAAE,wBAAwB;EACxCC,IAAI,EAAE,cAAc;EACpBC,SAAS,EAAE,mBAAmB;EAC9BC,KAAK,EAAE;AACT,CAAC;AACD,IAAIC,cAAc,GAAG;EACnBC,QAAQ,EAAE,kBAAkB;EAC5BC,UAAU,EAAE,oBAAoB;EAChCC,MAAM,EAAE;AACV,CAAC;AACD,IAAIC,aAAa,GAAG,IAAIlB,mBAAmB,CAAC/yB,OAAO,CAAC;EAClDk0B,SAAS,EAAE;AACb,CAAC,CAAC;AACF,IAAIC,QAAQ,GAAG,MAAMA,QAAQ,CAAC;EAC5B3iC,WAAWA,CAAA,EAAG;IACZ,IAAI,CAAC4iC,OAAO,GAAG,KAAK;IACpB,IAAI,OAAOjB,SAAS,KAAK,WAAW,EAAE;MACpC,MAAM;QAAEkB;MAA2B,CAAC,GAAG,CAAC,CAAC,EAAErB,iBAAiB,CAACrB,KAAK,EAAEwB,SAAS,CAACxR,QAAQ,CAACsQ,MAAM,CAACtsB,KAAK,CAAC,CAAC,CAAC,CAAC;MACvG,QAAQ0uB,0BAA0B;QAChC,KAAK,iBAAiB;UAAE;YACtB,IAAI,CAAChF,kBAAkB,CAAC,CAAC;YACzB,IAAI,CAAC+E,OAAO,GAAG,IAAI;YACnB;UACF;QACA,KAAK,gBAAgB;UAAE;YACrB,IAAI,CAAC7E,iBAAiB,CAAC,CAAC;YACxB,IAAI,CAAC6E,OAAO,GAAG,IAAI;YACnB;UACF;QACA;MACF;IACF;EACF;EACA;EACAxE,eAAeA,CAACnxB,KAAK,EAAE;IACrB,IAAI,CAAC61B,SAAS,CAAC,CAAC;IAChB,IAAI,CAACC,WAAW,CAAC91B,KAAK,CAACzE,UAAU,CAACw6B,MAAM,CAAC;IACzCrB,SAAS,CAACsB,eAAe,CAACC,SAAS,GAAG,CAAC;IACvCvB,SAAS,CAACsB,eAAe,CAACE,UAAU,GAAG,CAAC;IACxC,OAAO,IAAI,CAACC,SAAS,CAAC,CAAC;EACzB;EACAA,SAASA,CAAA,EAAG;IACV,OAAOzB,SAAS,CAAC0B,cAAc,CAAC,gBAAgB,CAAC;EACnD;EACAhF,cAAcA,CAAA,EAAG;IACf,IAAI,CAACve,QAAQ,CAAC,CAAC;IACf,IAAI,CAACwjB,QAAQ,CAAC,CAAC;IACf,IAAI,CAACP,WAAW,CAAC,YAAY,CAAC;IAC9BpB,SAAS,CAACsB,eAAe,CAACC,SAAS,GAAG,CAAC;IACvCvB,SAAS,CAACsB,eAAe,CAACE,UAAU,GAAG,CAAC;IACxC,OAAO,IAAI,CAACI,QAAQ,CAAC,CAAC;EACxB;EACAA,QAAQA,CAAA,EAAG;IACT,OAAO5B,SAAS,CAAC0B,cAAc,CAAC,gBAAgB,CAAC;EACnD;EACAN,WAAWA,CAACC,MAAM,GAAG,QAAQ,EAAE;IAC7B,IAAIA,MAAM,KAAK,MAAM,EAAE;MACrBrB,SAAS,CAACnhB,IAAI,CAACgjB,SAAS,CAACC,MAAM,CAAC,IAAI,CAACC,kBAAkB,CAAC;MACxD,IAAI,CAACA,kBAAkB,GAAG,IAAI;MAC9B;IACF;IACA,IAAI,CAACC,mBAAmB,CAACX,MAAM,CAAC;IAChC,MAAMY,WAAW,GAAGvB,cAAc,CAACW,MAAM,CAAC;IAC1CrB,SAAS,CAACnhB,IAAI,CAACgjB,SAAS,CAACC,MAAM,CAAC,IAAI,CAACC,kBAAkB,CAAC;IACxD/B,SAAS,CAACnhB,IAAI,CAACgjB,SAAS,CAACt/B,GAAG,CAAC0/B,WAAW,CAAC;IACzC,IAAI,CAACF,kBAAkB,GAAGE,WAAW;EACvC;EACAD,mBAAmBA,CAACX,MAAM,EAAE;IAC1B,IAAI,CAACX,cAAc,CAACW,MAAM,CAAC,EAAE;MAC3BvB,OAAO,CAACz7B,IAAI,CACV1G,MAAM;AACd,gCAAgC0jC,MAAM;AACtC,sCAAsCl7B,MAAM,CAACI,IAAI,CAACm6B,cAAc,CAAC,CAACp2B,IAAI,CAAC,IAAI,CAAC;AAC5E,SACM,CAAC;IACH;EACF;EACA43B,QAAQA,CAACC,IAAI,EAAE;IACbC,YAAY,CAAC,IAAI,CAACC,gBAAgB,CAAC;IACnCl8B,MAAM,CAACI,IAAI,CAAC25B,IAAI,CAAC,CAACn/B,OAAO,CAAEuhC,SAAS,IAAK;MACvC,IAAIA,SAAS,KAAKH,IAAI,EAAE;QACtBnC,SAAS,CAACnhB,IAAI,CAACgjB,SAAS,CAACt/B,GAAG,CAAC69B,OAAO,CAACkC,SAAS,CAAC,CAAC;MAClD,CAAC,MAAM;QACLtC,SAAS,CAACnhB,IAAI,CAACgjB,SAAS,CAACC,MAAM,CAAC1B,OAAO,CAACkC,SAAS,CAAC,CAAC;MACrD;IACF,CAAC,CAAC;EACJ;EACAvF,gBAAgBA,CAAC;IAAEpU,OAAO,GAAG,EAAE;IAAE/V,KAAK,GAAG;EAAG,CAAC,EAAE;IAC7C,IAAI2vB,MAAM,GAAG5Z,OAAO;IACpB,IAAI6Z,MAAM,GAAG5vB,KAAK;IAClB,MAAMgT,KAAK,GAAG+C,OAAO,CAACtC,KAAK,CAAC,IAAI,CAAC;IACjC,IAAIT,KAAK,CAACliB,MAAM,GAAG,CAAC,EAAE;MACpB,CAAC6+B,MAAM,CAAC,GAAG3c,KAAK;MAChB4c,MAAM,GAAG5c,KAAK,CAACpT,KAAK,CAAC,CAAC,CAAC,CAAClI,IAAI,CAAC,IAAI,CAAC,CAACmI,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC;IACvD;IACAutB,SAAS,CAAC0B,cAAc,CAAC,eAAe,CAAC,CAACe,SAAS,GAAG3B,aAAa,CAAC4B,MAAM,CAACH,MAAM,CAAC;IAClFvC,SAAS,CAAC0B,cAAc,CAAC,aAAa,CAAC,CAACe,SAAS,GAAG3B,aAAa,CAAC4B,MAAM,CAACF,MAAM,CAAC;IAChF,IAAI,CAACN,QAAQ,CAAC,OAAO,CAAC,WAAW,CAAC;EACpC;EACAlF,aAAaA,CAAA,EAAG;IACd,IAAI,IAAI,CAACiE,OAAO,EAAE;MAChB;IACF;IACA,IAAI,CAACiB,QAAQ,CAAC,WAAW,CAAC,eAAe,CAAC;IAC1C,IAAI,CAACT,SAAS,CAAC,CAAC,EAAEkB,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC;IAChD,IAAI,CAACf,QAAQ,CAAC,CAAC,EAAEe,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC;EACjD;EACAzG,kBAAkBA,CAAC;IAAEC,SAAS,GAAG;EAAM,CAAC,GAAG,CAAC,CAAC,EAAE;IAC7CiG,YAAY,CAAC,IAAI,CAACC,gBAAgB,CAAC;IACnC,IAAIlG,SAAS,EAAE;MACb,IAAI,CAAC+F,QAAQ,CAAC,iBAAiB,CAAC,qBAAqB,CAAC;IACxD,CAAC,MAAM;MACL,IAAI,CAACG,gBAAgB,GAAG9T,UAAU,CAChC,MAAM,IAAI,CAAC2T,QAAQ,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,EAC5DjC,eACF,CAAC;IACH;EACF;EACA7D,iBAAiBA,CAAC;IAAED,SAAS,GAAG;EAAM,CAAC,GAAG,CAAC,CAAC,EAAE;IAC5CiG,YAAY,CAAC,IAAI,CAACC,gBAAgB,CAAC;IACnC,IAAIlG,SAAS,EAAE;MACb,IAAI,CAAC+F,QAAQ,CAAC,gBAAgB,CAAC,oBAAoB,CAAC;IACtD,CAAC,MAAM;MACL,IAAI,CAACG,gBAAgB,GAAG9T,UAAU,CAAC,MAAM,IAAI,CAAC2T,QAAQ,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,EAAEjC,eAAe,CAAC;IACjH;EACF;EACA9hB,QAAQA,CAAA,EAAG;IACT,IAAI,CAAC+jB,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC;EAClC;EACAP,QAAQA,CAAA,EAAG;IACT,IAAI,CAACF,SAAS,CAAC,CAAC,CAACkB,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC;IAC/C,IAAI,CAACf,QAAQ,CAAC,CAAC,CAACgB,eAAe,CAAC,QAAQ,CAAC;EAC3C;EACAzB,SAASA,CAAA,EAAG;IACV,IAAI,CAACS,QAAQ,CAAC,CAAC,CAACe,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC;IAC9C,IAAI,CAAClB,SAAS,CAAC,CAAC,CAACmB,eAAe,CAAC,QAAQ,CAAC;EAC5C;EACAhW,qBAAqBA,CAAA,EAAG;IACtBoT,SAAS,CAACnhB,IAAI,CAACgjB,SAAS,CAACt/B,GAAG,CAAC69B,OAAO,CAACG,IAAI,CAAC;EAC5C;AACF,CAAC;AACD3iC,MAAM,CAACojC,QAAQ,EAAE,SAAS,CAAC;AAC3B,IAAI6B,OAAO,GAAG7B,QAAQ;;AAEtB;AACA,IAAI8B,WAAW,GAAG,MAAMA,WAAW,SAAS7F,oBAAoB,CAAC;EAC/D5+B,WAAWA,CAAC+jB,QAAQ,EAAE0M,qBAAqB,EAAE;IAC3C,KAAK,CAAC1M,QAAQ,EAAE0M,qBAAqB,EAAE,IAAI6Q,QAAQ,CAAC,CAAC,EAAE,IAAIkD,OAAO,CAAC,CAAC,CAAC;IACrE,IAAI,CAACzgB,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAAC0M,qBAAqB,GAAGA,qBAAqB;IAClD6E,OAAO,CAACoP,qBAAqB,GAAG,IAAI;EACtC;AACF,CAAC;AACDnlC,MAAM,CAACklC,WAAW,EAAE,YAAY,CAAC;AACjC,IAAIE,UAAU,GAAGF,WAAW;;AAE5B;AACA,SAAShlC,MAAM,IAAImlC,OAAO,QAAQ,mBAAmB;AACrD,IAAI;EAAErkB,QAAQ,EAAEskB;AAAU,CAAC,GAAGD,OAAO;AACrC,IAAIE,cAAc,GAAG,CACnB,wBAAwB,EACxB,wBAAwB,EACxB,0BAA0B,EAC1B,0BAA0B,EAC1B,iBAAiB,EACjB,iBAAiB,EACjB,oBAAoB,EACpB,oBAAoB,EACpB,oBAAoB,EACpB,oBAAoB,EACpB,oBAAoB,EACpB,oBAAoB,EACpB,cAAc,EACd,iBAAiB,EACjB,mBAAmB,EACnB,mBAAmB;AACnB;AACA,QAAQ,CACT;AACD,IAAIC,MAAM,GAAG,QAAQ;AACrB,IAAIC,eAAe,GAAG,cAAc;AACpC,SAASC,wBAAwBA,CAAA,EAAG;EAClC,MAAMC,qBAAqB,GAAGL,SAAS,CAACM,WAAW,CAAC,OAAO,CAAC;EAC5DD,qBAAqB,CAACE,SAAS,CAAC,kBAAkB,EAAE,IAAI,EAAE,IAAI,CAAC;EAC/DP,SAAS,CAACQ,aAAa,CAACH,qBAAqB,CAAC;AAChD;AACA3lC,MAAM,CAAC0lC,wBAAwB,EAAE,0BAA0B,CAAC;AAC5D,SAASK,YAAYA,CAACC,OAAO,EAAE1/B,QAAQ,EAAE2/B,WAAW,EAAE;EACpD,MAAMC,QAAQ,GAAGZ,SAAS,CAACxhB,aAAa,CAAC,QAAQ,CAAC;EAClDoiB,QAAQ,CAACz9B,IAAI,GAAGu9B,OAAO,CAACv9B,IAAI,KAAK,QAAQ,GAAG,QAAQ,GAAG,iBAAiB;EACxE,IAAIu9B,OAAO,CAACG,GAAG,EAAE;IACfD,QAAQ,CAACE,MAAM,GAAG9/B,QAAQ;IAC1B4/B,QAAQ,CAACG,OAAO,GAAG//B,QAAQ;IAC3B4/B,QAAQ,CAACC,GAAG,GAAGH,OAAO,CAACG,GAAG;EAC5B,CAAC,MAAM;IACLD,QAAQ,CAACI,WAAW,GAAGN,OAAO,CAACO,SAAS;EAC1C;EACA,IAAIN,WAAW,EAAE;IACfA,WAAW,CAACliB,WAAW,CAACmiB,QAAQ,CAAC;EACnC,CAAC,MAAM;IACLZ,SAAS,CAACkB,IAAI,CAACziB,WAAW,CAACmiB,QAAQ,CAAC;EACtC;EACAF,OAAO,CAACS,UAAU,CAACxiB,WAAW,CAAC+hB,OAAO,CAAC;EACvC,IAAI,CAACA,OAAO,CAACG,GAAG,EAAE;IAChB7/B,QAAQ,CAAC,CAAC;EACZ;AACF;AACAtG,MAAM,CAAC+lC,YAAY,EAAE,cAAc,CAAC;AACpC,SAASW,yBAAyBA,CAACC,gBAAgB,EAAErgC,QAAQ,EAAE6E,KAAK,GAAG,CAAC,EAAE;EACxEw7B,gBAAgB,CAACx7B,KAAK,CAAC,CAAC,MAAM;IAC5BA,KAAK,EAAE;IACP,IAAIA,KAAK,KAAKw7B,gBAAgB,CAAC7gC,MAAM,EAAE;MACrCQ,QAAQ,CAAC,CAAC;IACZ,CAAC,MAAM;MACLogC,yBAAyB,CAACC,gBAAgB,EAAErgC,QAAQ,EAAE6E,KAAK,CAAC;IAC9D;EACF,CAAC,CAAC;AACJ;AACAnL,MAAM,CAAC0mC,yBAAyB,EAAE,2BAA2B,CAAC;AAC9D,SAASE,gBAAgBA,CAACC,UAAU,EAAE;EACpC,IAAIC,YAAY,GAAGxB,SAAS,CAACxB,cAAc,CAAC2B,eAAe,CAAC;EAC5D,IAAI,CAACqB,YAAY,EAAE;IACjBA,YAAY,GAAGxB,SAAS,CAACxhB,aAAa,CAAC,KAAK,CAAC;IAC7CgjB,YAAY,CAAClkC,EAAE,GAAG6iC,eAAe;IACjCH,SAAS,CAACrkB,IAAI,CAAC8C,WAAW,CAAC+iB,YAAY,CAAC;EAC1C,CAAC,MAAM;IACLA,YAAY,CAACjC,SAAS,GAAG,EAAE;EAC7B;EACA,MAAMkC,QAAQ,GAAGxgC,KAAK,CAACspB,IAAI,CAACgX,UAAU,CAACG,gBAAgB,CAACxB,MAAM,CAAC,CAAC;EAChE,IAAIuB,QAAQ,CAACjhC,MAAM,EAAE;IACnB,MAAM6gC,gBAAgB,GAAG,EAAE;IAC3BI,QAAQ,CAAC5jC,OAAO,CAAE6iC,OAAO,IAAK;MAC5B,MAAMiB,QAAQ,GAAGjB,OAAO,CAACpL,YAAY,CAAC,MAAM,CAAC;MAC7C,IAAI,CAACqM,QAAQ,IAAI1B,cAAc,CAAC/hC,QAAQ,CAACyjC,QAAQ,CAAC,EAAE;QAClDN,gBAAgB,CAACjgC,IAAI,CAAEJ,QAAQ,IAAKy/B,YAAY,CAACC,OAAO,EAAE1/B,QAAQ,EAAEwgC,YAAY,CAAC,CAAC;MACpF;IACF,CAAC,CAAC;IACF,IAAIH,gBAAgB,CAAC7gC,MAAM,EAAE;MAC3B4gC,yBAAyB,CAACC,gBAAgB,EAAEjB,wBAAwB,EAAE,KAAK,CAAC,CAAC;IAC/E;EACF,CAAC,MAAM;IACLA,wBAAwB,CAAC,CAAC;EAC5B;AACF;AACA1lC,MAAM,CAAC4mC,gBAAgB,EAAE,kBAAkB,CAAC;;AAE5C;AAAA,SACeM,iBAAiBA,CAAAC,IAAA,EAAAC,IAAA;EAAA,OAAAC,kBAAA,CAAAtwB,KAAA,OAAAC,SAAA;AAAA;AAAA,SAAAqwB,mBAAA;EAAAA,kBAAA,GAAA9wB,iBAAA,CAAhC,WAAiC+wB,MAAM,EAAE5hC,OAAO,EAAE;IAChD,MAAM6hC,SAAS,GAAG7hC,OAAO,CAACuD,UAAU,EAAEwwB,IAAI,EAAE6N,MAAM,EAAEC,SAAS;IAC7D,MAAM;MAAE3kC,EAAE;MAAE+W;IAAa,CAAC,GAAGjU,OAAO;IACpC,MAAM8hC,WAAW,GAAGD,SAAS,IAAID,MAAM,GAAGC,SAAS,GAAGD,MAAM,EAAE5hC,OAAO,CAAC,GAAG4hC,MAAM;IAC/E,MAAMxiC,MAAM,GAAG0iC,WAAW,SAASA,WAAW,GAAG,KAAK,CAAC;IACvDlmC,MAAM,CAACZ,UAAU,CAAC,CAAC,CAAC2G,IAAI,CAAC/H,gBAAgB,EAAE;MACzCsD,EAAE;MACF0kC,MAAM,EAAExiC,MAAM;MACdb,IAAI,EAAE0V;IACR,CAAC,CAAC;EACJ,CAAC;EAAA,OAAA0tB,kBAAA,CAAAtwB,KAAA,OAAAC,SAAA;AAAA;AACDhX,MAAM,CAACknC,iBAAiB,EAAE,mBAAmB,CAAC;AAE9C,SACE9mC,WAAW,EACXkB,MAAM,EACNuC,YAAY,EACZsB,UAAU,EACV2B,OAAO,EACPC,WAAW,EACXI,MAAM,EACNS,QAAQ,EACRC,UAAU,EACVO,SAAS,EACTC,UAAU,EACVQ,eAAe,EACfC,YAAY,EACZI,OAAO,EACPK,UAAU,EACVI,aAAa,EACbgC,WAAW,EACXiF,eAAe,EACfG,cAAc,EACdoD,iBAAiB,EACjBoB,aAAa,EACbG,0BAA0B,EAC1BG,oBAAoB,EACpBI,YAAY,EACZsC,WAAW,EACX0C,cAAc,EACdS,aAAa,EACbI,2BAA2B,EAC3BM,kBAAkB,EAClBsB,cAAc,EACdY,WAAW,EACXG,wBAAwB,EACxBC,4BAA4B,EAC5BQ,qBAAqB,EACrBG,YAAY,EACZqC,cAAc,EACdQ,oBAAoB,EACpBwF,UAAU,EACVgB,4BAA4B,EAC5BQ,eAAe,EACf2B,aAAa,EACbiL,OAAO,EACPmD,WAAW,EACXoG,oBAAoB,EACpB0C,QAAQ,EACRkD,OAAO,EACPG,UAAU,EACVM,wBAAwB,EACxBkB,gBAAgB,EAChBM,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}